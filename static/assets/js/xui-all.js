/*
* CrossUI(xui) JavaScript Library v1.4
* http://crossui.com
* 
* Copyright ( 2004 ~ present) CrossUI.com
* Released under the MIT license
*
*/
undefined;_=function(){return +new Date()};Namespace=function(e){var d=e.split("."),c=window;return _.get(c,d)||_.set(c,d,{})};Class=function(H,u,m){var e,C=[],q=Class,l=window,B=q._fun,g=q._reg,h,y,A,p,E,d=q._all,F=function(f){return(f+"").replace(/(\s*\/\*[^*]*\*+([^\/][^*]*\*+)*\/)|(\s*\/\/[^\n]*)|(\)[\s\S]*)/g,function(k){return k.charAt(0)!=")"?"":k})};m=m||{};if(!q._ignoreNSCache&&(p=_.get(l,H.split(".")))&&typeof(p)=="function"&&p.$xuiclass$){return q._last=p}if(p=_.get(l,["xui","$cache","SC"])){delete p[H]}u=(!u?[]:typeof u=="string"?[u]:u);for(A=0;p=u[A];A++){if(!(C[A]=(_.get(l,p.split("."))||(xui&&xui.SC&&xui.SC(p))))){throw"errNoParent--"+p}}if(m.Dependencies){if(typeof m.Dependencies=="string"){m.Dependencies=[m.Dependencies]}for(A=0;p=m.Dependencies[A];A++){if(!(_.get(l,p.split("."))||(xui&&xui.SC&&xui.SC(p)))){throw"errNoDependency--"+p}}}h=C[0];var c=m.$Start||(h&&h.$Start);_.tryF(c,[],m);e=m.Static||{};p={};for(A in e){if(g[A]){p[A]=1}}for(A in p){delete e[A]}e.Before=m.Before||(h&&h.Before);e.After=m.After||(h&&h.After);e.$Start=c;e.$End=m.$End||(h&&h.$End);e.__gc=m.__gc||e.__gc||(h&&h.__gc)||function(){Class.__gc(this.$key)};var n=function(){if(typeof this.initialize=="function"){this.initialize()}};if(typeof m.Constructor=="function"){y=B(m.Constructor,"Constructor",H,h||n,"constructor");y.Constructor=F(m.Constructor)}else{if(h){var D=n,r=h.Constructor;if(r){D=new Function(r.slice(r.indexOf("(")+1,r.indexOf(")")).split(","),r.slice(r.indexOf("{")+1,r.lastIndexOf("}")))}y=B(D,"Constructor",H,h.upper,"constructor");y.Constructor=F(r)}else{y=n}}E=_.fun();for(A=C.length-1;p=C[A--];){_.merge(E,p);_.merge(E.prototype,p.prototype)}y.KEY=y.$key=y.prototype.KEY=y.prototype.$key=H;q._wrap(y,e,0,E,"static");if(p=m.Instance){q._wrap(y.prototype,p,1,E.prototype,"instance")}q._inherit(y,E);q._inherit(y.prototype,E.prototype);E=null;if(_.tryF(y.Before,arguments,y)===false){return false}for(A=0;p=C[A];A++){p=(p.$children||(p.$children=[]));for(var z=0,x=p.length,G;z<x;z++){if(p[x]==H){G=true;break}}if(!G){p[p.length]=H}}y.$xui$=y.$xuiclass$=1;y.$children=[];y.$parent=C;y.prototype.constructor=y;y.prototype.$xui$=1;y[H]=y.prototype[H]=true;E=p=_.get(l,H.split("."));_.set(l,H.split("."),y);if(Object.prototype.toString.call(E)=="[object Object]"){for(A in E){y[A]=E[A]}}_.tryF(y.After,[],y);_.tryF(m.Initialize,[],y);_.tryF(y.$End,[],y);_.breakO([m.Static,m.Instance,m],2);if(!(H in d)){d[H]=d.length;d.push(H)}return q._last=y};linb=xui=function(d,c){return xui.Dom.pack(d,c)};_.merge=function(k,h,d,g){var c,e;if(typeof d=="function"){e=d;d="fun"}switch(d){case"fun":for(c in h){if((g||h.hasOwnProperty(c))&&true===e(h[c],c)){k[c]=h[c]}}break;case"all":for(c in h){if((g||h.hasOwnProperty(c))){k[c]=h[c]}}break;case"with":for(c in h){if((g||h.hasOwnProperty(c))&&k.hasOwnProperty(c)){k[c]=h[c]}}break;default:for(c in h){if((g||h.hasOwnProperty(c))&&!k.hasOwnProperty(c)){k[c]=h[c]}}}return k};new function(){var g=0,h=["ms","moz","webkit","o"],e=window,f=0,d=h.length,c;for(;f<d&&!e.requestAnimationFrame&&(c=h[f++]);){e.requestAnimationFrame=e[c+"RequestAnimationFrame"];e.cancelAnimationFrame=e[c+"CancelAnimationFrame"]||e[c+"CancelRequestAnimationFrame"]}if(!e.requestAnimationFrame){e.requestAnimationFrame=function(p,l){var k=(new Date()).getTime(),m=Math.max(0,1000/60-(k-g)),n=setTimeout(function(){p(k+m)},m);g=k+m;return n}}if(!e.cancelAnimationFrame){e.cancelAnimationFrame=function(k){clearTimeout(k)}}};_.merge(_,{rand:function(){return parseInt(_()*Math.random(),10).toString(36)},setTimeout:function(d,c){return(c||0)>1000/60?(setTimeout(d,c)*-1):requestAnimationFrame(d)},clearTimeout:function(c){if(c>=0){cancelAnimationFrame(c)}else{clearTimeout(Math.abs(c))}},fun:function(){return function(){}},exec:function(c,m){var g=this,k=document,f=k.getElementsByTagName("head")[0]||k.documentElement,e=k.createElement("script"),l;e.type="text/javascript";if(m){if((l=k.getElementById(m))&&l.parentNode==f){f.removeChild(l)}e.id=m}if(xui.browser.ie){e.text=c}else{e.appendChild(k.createTextNode(c))}f.appendChild(e);e.disalbed=true;e.disabled=false;if(!m){f.removeChild(e)}return e},get:function(g,f){if(!f){return g}if(!_.isSet(g)){return undefined}else{if(typeof f=="string"){return g[f]}else{for(var e=0,c=f.length,d;e<c;){if(!(d=f[e++]+"")){continue}if(!g||(g=d!=(d=d.replace("()",""))?(typeof(g[d])=="function"&&0!==d.indexOf("set"))?g[d]():undefined:g[d])===undefined){return}}return g}}},set:function(k,h,g){if(!k){return}if(typeof h!="string"){var d,e=0,c,f=h.length-1;for(;e<f;){d=h[e++];if(k[d]&&((c=typeof k[d])=="object"||c=="function")){k=k[d]}else{k=k[d]={}}}h=h[f]}if(h!=(h=(h+"").replace("()",""))){if(typeof(k[h])=="function"){k[h](g);return g}}else{if(g===undefined){if(k.hasOwnProperty&&k.hasOwnProperty(h)){delete k[h]}else{k[h]=undefined}}else{return k[h]=g}}},tryF:function(c,d,e,f){return(c&&typeof c=="function")?c.apply(e||{},d||[]):f},asyRun:function(c,f,d,e){return _.setTimeout(typeof c=="string"?function(){_.exec(c)}:function(){c.apply(e,d||[]);c=d=null},f||0)},asyHTML:function(e,h,f,d){var g=document.createElement("div"),c=document.createDocumentFragment();g.innerHTML=e;(function(){var k=d||10;while(--k&&g.firstChild){c.appendChild(g.firstChild)}if(g.firstChild){_.setTimeout(arguments.callee,f||0)}else{h(c)}})()},isEmpty:function(d){if(d==null){return true}if(_.isNumb(d)){return false}if(_.isArr(d)||_.isStr(d)||_.isArguments(d)){return d.length===0}for(var c in d){if(_._has.call(d,c)){return false}}return true},resetRun:function(g,c,m,f,h){var l=arguments.callee,e=g,d=l.$cache||((l.exists=function(n){return this.$cache[n]})&&(l.$cache={}));if(d[e]){_.clearTimeout(d[e])}if(typeof c=="function"){d[e]=_.setTimeout(function(){delete d[e];c.apply(h||null,f||[])},m||0)}else{delete d[e]}},observableRun:function(f,d,e,c){xui.Thread.observableRun(f,d,e,c)},breakO:function(k,m){var p=m||1,c=1+(arguments[2]||0),d=arguments.callee,g="___gc_",f;if(k&&(typeof k=="object"||typeof k=="function")&&k!==window&&k!==document&&k.nodeType!==1){try{if(k.hasOwnProperty(g)){return}else{k[g]=null}}catch(h){return}try{for(f in k){if(k.hasOwnProperty(f)&&k[f]){if(typeof k[f]=="object"||typeof k[f]=="function"){if(c<p){d(k[f],p,c)}}try{k[f]=null}catch(h){}}}}catch(h){return}if(k.length){k.length=0}delete k[g]}},each:function(f,c,e){e=e||f;for(var d in f){if(false===c.call(e,f[d],d,f)){break}}return f},toFixedNumber:function(h,k){if(!_.isSet(k)){k=2}var c=Math.abs(h),g=""+Math.round(c*Math.pow(10,k)),e,f,l,d;if(/\D/.test(g)){e=""+c}else{while(g.length<1+k){g="0"+g}l=g.substring(0,f=(g.length-k));d=g.substring(f);if(d){d="."+d}e=l+d}return parseFloat((h<0?"-":"")+e)},toNumeric:function(f,c,e,d){if(!_.isNumb(f)){f=parseFloat((f+"").replace(/\s*(e\+|[^0-9])/g,function(h,g,k){return g=="e+"||g=="E+"||(k==0&&g=="-")?g:g==d?".":""}))||0}if(_.isSet(c)&&c>=0){f=_.toFixedNumber(f,c)}return f},formatNumeric:function(g,c,f,d,e){if(_.isSet(c)){c=parseInt(c,10)}c=(c||c===0)?c:0;f=_.isSet(f)?f:",";d=d||".";g=""+parseFloat(g);if(g.indexOf("e")==-1){g=_.toFixedNumber(g,c)+"";g=g.split(".");if(e!==false){if((g[1]?g[1].length:0)<c){g[1]=(g[1]||"")+_.str.repeat("0",c-(g[1]?g[1].length:0))}}g[0]=g[0].split("").reverse().join("").replace(/(\d{3})(?=\d)/g,"$1"+f).split("").reverse().join("");return g.join(d)}else{return g}},copy:function(d,c){return _.clone(d,c,1)},clone:function(f,c,q){var m=arguments[3]||0;if(f&&(_.isHash(f)||_.isArr(f))){if(_.isObj(f)){var n=arguments.callee,e=_.isArr(f),k=e?[]:{},g=0,p,d;if(!q){if(q<=0){return f}else{q=100}}if(e){d=f.length;for(;g<d;g++){if(typeof c=="function"&&false===c.call(f,f[g],g,m+1)){continue}k[k.length]=((p=f[g])&&q&&(_.isHash(p)||_.isArr(p)))?n(p,c,q-1,m+1):p}}else{for(g in f){if(c===true?g.charAt(0)=="_":c===false?(g.charAt(0)=="_"||g.charAt(0)=="$"):typeof c=="function"?false===c.call(f,f[g],g,m+1):0){continue}k[g]=((p=f[g])&&q&&(_.isHash(p)||_.isArr(p)))?n(p,c,q-1,m+1):p}}return k}else{return f}}else{return f}},filter:function(g,d,c){if(!c&&g&&_.isArr(g)){var h,f,m,k=[],e;for(h=0,f=g.length;h<f;h++){k[k.length]=g[h]}g.length=0;for(h=0,f=k.length;h<f;h++){if(typeof d=="function"?false!==d.call(k,k[h],h):1){g[g.length]=k[h]}}}else{var h,n={};for(h in g){if(d===true?h.charAt(0)=="_":d===false?(h.charAt(0)=="_"||h.charAt(0)=="$"):typeof d=="function"?false===d.call(g,g[h],h):0){n[h]=1}}for(h in n){delete g[h]}}return g},toArr:function(g,e){if(!g){return[]}var c=[];if(typeof e=="boolean"){for(var f in g){c[c.length]=e?f:g[f]}}else{if(_.isHash(g)){for(var f in g){c.push({key:f,value:g[f]})}}else{if(typeof g=="string"){c=g.split(e||",")}else{for(var f=0,d=g.length;f<d;++f){c[f]=g[f]}}}}return c},toUTF8:function(c){return c.replace(/[^\x00-\xff]/g,function(e,d){return"\\u"+((d=e.charCodeAt())<16?"000":d<256?"00":d<4096?"0":"")+d.toString(16)})},fromUTF8:function(c){return c.replace(/\\u([0-9a-f]{3})([0-9a-f])/g,function(e,d,f){return String.fromCharCode((parseInt(d,16)*16+parseInt(f,16)))})},urlEncode:function(e){var c=[],d,f;for(d in e){if(_.isDefined(f=e[d])){c.push(encodeURIComponent(d)+"="+encodeURIComponent(typeof f=="string"?f:_.serialize(f)))}}return c.join("&")},urlDecode:function(m,p){if(!m){return p?"":{}}var h,f={},n=m.split("&"),c;for(var g=0,d=n.length;g<d;g++){c=n[g];h=c.split("=");try{f[decodeURIComponent(h[0])]=decodeURIComponent(h[1])}catch(k){f[h[0]]=h[1]}}return p?f[p]:f},preLoadImage:function(g,f,h){if(_.isArr(g)){for(var e=0,c=arr.length;e<c;e++){_.preLoadImage(g[e],f,h)}return c}var d=document.createElement("img");d.style.cssText="position:absolute;left:-999px;top:-999px";d.width=d.height=2;d.onload=function(){if(typeof f=="function"){f.call(this)}this.onload=this.onerror=null;document.body.removeChild(this)};d.onerror=function(){if(typeof h=="function"){h.call(this)}this.onload=this.onerror=null;document.body.removeChild(this)};document.body.appendChild(d);d.src=g;return 1},_to:Object.prototype.toString,_has:Object.prototype.hasOwnProperty,_ht:/^\s*function\s+Object\(\s*\)/,isDefined:function(c){return c!==undefined},isNull:function(c){return c===null},isSet:function(c){return c!==undefined&&c!==null&&c!==NaN},isObj:function(c){return !!c&&(typeof c=="object"||typeof c=="function")},isHash:function(c){return !!c&&_._to.call(c)=="[object Object]"&&c.constructor&&_._ht.test(c.constructor.toString())&&!_._has.call(c,"callee")},isBool:function(c){return typeof c=="boolean"},isNumb:function(c){return typeof c=="number"&&isFinite(c)},isFinite:function(c){return(c||c===0)&&isFinite(c)&&!isNaN(parseFloat(c))},isDate:function(c){return _._to.call(c)==="[object Date]"&&isFinite(+c)},isFun:function(c){return _._to.call(c)==="[object Function]"},isArr:function(c){return _._to.call(c)==="[object Array]"},isReg:function(c){return _._to.call(c)==="[object RegExp]"},isStr:function(c){return _._to.call(c)==="[object String]"},isArguments:function(c){return c&&(_._to.call(c)==="[object Arguments]"||_._has.call(c,"callee"))},isElem:function(c){return !!(c&&c.nodeType===1)},isNaN:function(c){return typeof c=="number"&&c!=+c},str:{startWith:function(d,c){return d.indexOf(c)===0},endWith:function(d,e){var c=d.length-e.length;return c>=0&&d.lastIndexOf(e)===c},repeat:function(d,c){return new Array(c+1).join(d)},initial:function(c){return c.charAt(0).toUpperCase()+c.substring(1)},trim:function(c){return c?c.replace(/^(\s|\uFEFF|\xA0)+|(\s|\uFEFF|\xA0)+$/g,""):c},ltrim:function(c){return c?c.replace(/^(\s|\uFEFF|\xA0)+/,""):c},rtrim:function(c){return c?c.replace(/(\s|\uFEFF|\xA0)+$/,""):c},toDom:function(h){var g=xui.$getGhostDiv(),f=[];g.innerHTML=h;for(var e=0,d=g.childNodes,c=d.length;e<c;e++){f[f.length]=d[e]}g=null;return xui(f)}},arr:{fastSortObject:function(k,h){if(!k||k.length<2){return k}var q=k.length,m=[],l=(q+"").length,d=Object.prototype,e,u,n,r;for(var g=0;g<l;g++){m[g]=new Array(l-g).join("0")}for(var f=0;f<q;f++){u=f+"";n=k[f];if(typeof n=="object"){n._xui_$s$=(_.isSet(r=h.call(n,f))?r:"")+m[u.length-1]+u}}try{e=d.toString;d.toString=function(){return this.hasOwnProperty("_xui_$s$")?(this._xui_$s$):(e.call(this))};k.sort()}finally{d.toString=e;for(var f=0;f<q;f++){if(typeof k[f]=="object"){delete k[f]._xui_$s$}}}return k},stableSort:function(d,h){if(d&&d.length>1){for(var g=0,f=d.length,e=[],c=[];g<f;g++){c[g]=d[e[g]=g]}if(_.isFun(h)){e.sort(function(k,l){return h.call(d,d[k],d[l])||(k>l?1:-1)})}else{e.sort(function(k,l){return d[k]>d[l]?1:d[k]<d[l]?-1:k>l?1:-1})}for(g=0;g<f;g++){d[g]=c[e[g]]}e.length=c.length=0}return d},subIndexOf:function(c,f,g){if(g===undefined){return -1}for(var e=0,d=c.length;e<d;e++){if(c[e]&&c[e][f]===g){return e}}return -1},removeFrom:function(c,d,e){c.splice(d,e||1);return c},removeValue:function(c,f){for(var d=c.length,e=d-1;e>=0;e--){if(c[e]===f){c.splice(e,1)}}return c},insertAny:function(c,h,g,f){var e=c.length;f=(!_.isArr(h))||f;if(g===0){if(f){c.unshift(h)}else{c.unshift.apply(c,h)}}else{var d;if(!g||g<0||g>e){g=e}if(g!=e){d=c.splice(g,e-g)}if(f){c[c.length]=h}else{c.push.apply(c,h)}if(d){c.push.apply(c,d)}}return g},indexOf:function(c,f){for(var e=0,d=c.length;e<d;e++){if(c[e]===f){return e}}return -1},each:function(c,f,h,k){var g,e,d=c;if(!d){return d}if(!_.isArr(d)){if(!_.isArr(d._nodes)){return d}d=d._nodes;if(k===undefined){k=1}}e=d.length;h=h||c;if(!k){for(g=0;g<e;g++){if(f.call(h,d[g],g,d)===false){break}}}else{for(g=e-1;g>=0;g--){if(f.call(h,d[g],g,d)===false){break}}}return c},removeDuplicate:function(c,g){var e=c.length,d=c.concat();c.length=0;for(var f=e-1;f>=0;f--){if(g?this.subIndexOf(d,g,d[f][g])===f:this.indexOf(d,d[f])===f){c.push(d[f])}}return c.reverse()}}});_.merge(_.fun,{body:function(c){var d=""+c;d=d.replace(/(\s*\/\*[^*]*\*+([^\/][^*]*\*+)*\/)|(\s*\/\/[^\n]*)|(\)[\s\S]*)/g,function(e){return e.charAt(0)!=")"?"":e});return d.slice(d.indexOf("{")+1,d.lastIndexOf("}"))},args:function(c){var d=""+c;d=d.replace(/(\s*\/\*[^*]*\*+([^\/][^*]*\*+)*\/)|(\s*\/\/[^\n]*)|(\)[\s\S]*)/g,function(e){return e.charAt(0)!=")"?"":e});d=d.slice(d.indexOf("(")+1,d.indexOf(")")).split(/\s*,\s*/);return d[0]&&d},clone:function(c){return new Function(_.fun.args(c),_.fun.body(c))}});_.merge(Class,{_reg:{$key:1,$parent:1,$children:1,KEY:1,Static:1,Instance:1,Constructor:1,Initialize:1},_reg2:{nodeType:1,constructor:1,prototype:1,toString:1,valueOf:1,hasOwnProperty:1,isPrototypeOf:1,propertyIsEnumerable:1,toLocaleString:1},_all:[],_fun:function(c,d,e,g,f){c.$name$=d;c.$original$=e;if(f){c.$type$=f}if(g&&c!==g){c.upper=g}return c},_other:["toString","valueOf"],_o:{},_inherit:function(f,h,c){var d,g,e=this._reg;for(d in h){if(d in f||(!c&&e[d])||d.charAt(0)=="$"){continue}g=h[d];if(g&&g.$xui$){continue}f[d]=g}},_wrap:function(u,d,x,w,h){var y=this,n,m,g,l=u.KEY,c=y._reg,e=y._reg2,q=y._fun,p=y._other;for(n in d){if(e[n]||(!x&&c[n])){continue}g=d[n];u[n]=(typeof g!="function")?g:q(g,n,l,typeof w[n]=="function"&&w[n],h)}for(m=0;n=p[m++];){g=d[n];if(g&&(g==y._o[n])){continue}u[n]=(typeof g!="function")?g:q(g,n,l,typeof w[n]=="function"&&w[n],h)}},__gc:function(g){var c=Class._all;if(!g){for(var f=c.length-1;f>0;f--){Class.__gc(c[f])}return}if(typeof g=="object"){g=g.KEY||""}var e=_.get(window,g.split(".")),h,f,d;if(e){if(h=_.get(window,["xui","$cache","SC"])){delete h[g]}if(e.$parent){e.$parent.length=0}if(h=e.$children){for(var f=0,k;k=h[f];f++){if(k=_.get(window,k.split("."))){k.__gc()}}h.length=0}for(f in e){if(f!="upper"&&typeof e[f]=="function"){for(d in e[f]){if(e[f].hasOwnProperty(d)){delete e[f][d]}}}}_.breakO(e);e=e.prototype;for(f in e){if(f!="upper"&&typeof e[f]=="function"){for(d in e[f]){if(e[f].hasOwnProperty(d)){delete e[f][d]}}}}_.breakO(e);_.set(window,g.split("."))}c.splice(c[g],1);delete c[g]},destroy:function(c){Class.__gc(c)}});_.merge(xui,{version:1.4,$DEFAULTHREF:"javascript:;",$IEUNSELECTABLE:function(){return xui.browser.ie?' onselectstart="return false;" ':""},SERIALIZEMAXLAYER:99,SERIALIZEMAXSIZE:9999,$localeKey:"en",$localeDomId:"xlid",$dateFormat:"",$rand:"_r_",debugMode:true,Locale:{},$cache:{thread:{},SC:{},clsByURI:{},fetching:{},hookKey:{},hookKeyUp:{},snipScript:{},subscribes:{},ghostDiv:[],data:{},callback:{},domPurgeData:{},profileMap:{},reclaimId:{},template:{},UIKeyMapEvents:{},droppable:{},unique:{}},subscribe:function(d,f,h,g){if(d===null||d===undefined||f===null||f===undefined||typeof h!="function"){return}var k=xui.$cache.subscribes,e;k[d]=k[d]||[];e=_.arr.subIndexOf(k[d],"id",f);if(e!=-1){_.arr.removeFrom(k[d],e)}return k[d].push({id:f,receiver:h,asy:!!g})},unsubscribe:function(d,f){var g=xui.$cache.subscribes,e;if(!f){if(d===null||d===undefined){g={}}else{delete g[d]}}else{if(g[d]){e=_.arr.subIndexOf(g[d],"id",f);if(e!=-1){_.arr.removeFrom(g[d],e)}}}},publish:function(e,d,g,f){var h=xui.$cache.subscribes;if(e===null||e===undefined){for(var e in h){_.arr.each(h[e],function(c){if(!g||g===c.id||(_.isArr(g)&&_.arr.indexOf(g,c.id)!=-1)){if(c.asy){_.asyRun(c.receiver,0,d,f)}else{return _.tryF(c.receiver,d,f,true)}}})}}else{if(h[e]){_.arr.each(h[e],function(c){if(!g||g===c.id||(_.isArr(g)&&_.arr.indexOf(g,c.id)!=-1)){if(c.asy){_.asyRun(c.receiver,0,d,f)}else{return _.tryF(c.receiver,d,f,true)}}})}}},getSubscribers:function(c){return(c===null||c===undefined)?xui.$cache.subscribes:xui.$cache.subscribes[c]},setDateFormat:function(c){xui.$dateFormat=c},getDateFormat:function(){return xui.$dateFormat},setAppLangKey:function(c){xui.$appLangKey=c},getAppLangKey:function(c){return xui.$appLangKey},getLang:function(){return xui.$localeKey},setLang:function(r,w){var k=xui.getRes,x,u,h,e,n,c,p,q=[],d;xui.$localeKey=r;u=xui.browser.ie?document.all.tags("span"):document.getElementsByTagName("span");for(h=0;x=u[h];h++){if(x.id==xui.$localeDomId){q[q.length]=x}}d=q.length;n=function(){(function(){e=q.splice(0,100);for(h=0;x=e[h];h++){if(x.className&&typeof(u=k(x.className))=="string"){x.innerHTML=u}}if(q.length){_.setTimeout(arguments.callee,0)}_.tryF(w,[q.length,d])}())},p="xui.Locale."+r,c=function(){var f=xui.$appLangKey;if(f){xui.include(p+"."+f,xui.getPath("Locale."+r,".js"),n,n)}else{n()}};xui.include(p+".inline.$_$",xui.getPath(p,".js"),c,c)},getTheme:function(c){try{c=xui.CSS.$getCSSValue(".setting-uikey","fontFamily")}catch(d){}finally{return c||"default"}},setTheme:function(m,k,d,c){m=m||"default";var n=xui.getTheme();if(m!=n){var p=function(q){if(n!="default"){var e;while(e=xui.CSS.$getCSSValue(".setting-uikey","fontFamily",n)){e.disabled=true;e.parentNode.removeChild(e);e=null}}if(k!==false){xui.$CSSCACHE={};if(xui.UI){xui.UI.getAll().reLayout(true)}}_.tryF(q)};if(m=="default"){p(d)}else{try{var g=xui.CSS.$getCSSValue(".setting-uikey","fontFamily")}catch(h){}finally{if(g==m){_.tryF(d);return}else{xui.CSS.includeLink(xui.getPath("xui.appearance."+m,"/theme.css"),"theme:"+m)}var f=0,l=function(){if(f++>20){l=f=null;if(false!==_.tryF(c)){throw"errLoadTheme:"+m}return}try{var r=xui.CSS.$getCSSValue(".setting-uikey","fontFamily")}catch(q){}finally{if(r==m){p(d);l=f=null}else{_.asyRun(l,100*f)}}};l()}}}else{_.tryF(d)}},$CSSCACHE:{},_langParamReg:/\x24(\d+)/g,_langscMark:/[$@{][\S]+/,_langReg:/((\$)([^\w\(]))|((\$)([\w][\w\.-]*[\w]+))|((\$)\(([\w][\w\.]*[^)\n\r]+))\)|((\$)([^\s]))|((\@)([\w][\w\.]*[\w]+)(\@?))|((\@)([^\s])(\@?))|((\{)([~!@#$%^&*+-\/?.|:][\w\[\]]*|[\w\[\]]+(\(\))?(\.[\w\[\]]+(\(\))?)*)(\}))/g,_escapeMap:{"$":"\x01",".":"\x02","-":"\x03",")":"\x04","@":"\x05"},_unescapeMap:{"\x01":"$","\x02":".","\x03":"-","\x04":")","\x05":"@"},getRes:function(g){var c,d,e,h=arguments,f;if(_.isStr(g)){g=g.replace(/\$([$.-])/g,function(l,k){return xui._escapeMap[k]||l});if(g.charAt(0)=="$"){g=g.slice(1)}if(g.indexOf("-")!=-1){e=g.split("-");g=e[0];h=e}else{if(_.isArr(h[1])){h=h[1];h.unshift(g)}}c=g.split(".");c[c.length-1]=c[c.length-1].replace(/([\x01\x02\x03\x04])/g,function(k){return xui._unescapeMap[k]})}else{if(_.isArr(g)){c=g}else{return g}}d=_.get(xui.Locale[xui.$localeKey],c);if((e=typeof d)=="function"){return d.apply(null,h)}else{if(e=="object"){return d}else{d=e=="string"?d.replace(/\$([$.-])/g,function(l,k){return xui._escapeMap[k]||l}):c[c.length-1];f=h.length>1?d.replace(xui._langParamReg,function(m,n,l){l=h[1+ +n];return(l===null||l===undefined)?m:l}):d;return f.replace(/([\x01\x02\x03])/g,function(k){return xui._unescapeMap[k]})}}},wrapRes:function(f){if(!_.isStr(f)){return f}var c=f,d,e;if(c.charAt(0)=="$"){arguments[0]=c.substr(1,c.length-1)}d=f;e=xui.getRes.apply(null,arguments);if(d==e){e=c}return'<span id="'+xui.$localeDomId+'" class="'+d.replace(/([\x01\x02\x03\x04])/g,function(g){return"$"+xui._unescapeMap[g]})+'" '+xui.$IEUNSELECTABLE()+">"+e+"</span>"},adjustRes:function(h,f,d,c,g,e){if(!_.isStr(h)){return h}f=f?xui.wrapRes:xui.getRes;h=h.replace(/\$([\$\.\-\)])/g,function(l,k){return xui._escapeMap[k]||l});h=xui._langscMark.test(h)?h.replace(xui._langReg,function(Z,Y,X,W,V,U,T,S,R,Q,P,O,N,M,L,K,J,I,H,G,F,E,D,C,B,A){return X=="$"?c?Z:W:U=="$"?c?Z:f(T,g):R=="$"?c?Z:f(Q,g):O=="$"?c?Z:f(N,g):((d?0:(L=="@"||H=="@"))||D=="{")?((A=xui.SC.get(L=="@"?K:H=="@"?G:C,e))||(_.isSet(A)?A:"")):Z}):h;return h.replace(/([\x01\x02\x03\x04])/g,function(k){return xui._unescapeMap[k]})},adjustVar:function(e,d){var c;return typeof(e)=="string"?e=="{[]}"?[]:e=="{{}}"?{}:e=="{}"?"":e=="{true}"?true:e=="{false}"?false:e=="{NaN}"?NaN:e=="{null}"?null:e=="{undefined}"?undefined:e=="{now}"?new Date():(c=/^\s*\{((-?\d\d*\.\d*)|(-?\d\d*)|(-?\.\d\d*))\}\s*$/.exec(e))?parseFloat(c[1]):(c=/^\s*\{([\S]+)\}\s*$/.exec(e))?xui.SC.get(c[1],d):xui.adjustRes(e,false,true,true,null,d):e},_getrpc:function(e,f,c){var d=(c&&c.proxyType)?c.proxyType.toLowerCase():"";return(d=="sajax"||d=="jsonp")?xui.JSONP:(d=="iajax"||d=="xdmi")?xui.XDMI:(d=="ajax")?xui.Ajax:(typeof f=="object"&&((function(h){if(!_.isHash(h)){return 0}for(var g in h){if((h[g]&&h[g].nodeType==1&&h[g].nodeName=="INPUT")||(h[g]&&h[g].$xuiFileCtrl)){return 1}}})(f)))?xui.XDMI:(c&&c.method&&c.method.toLowerCase()=="post")?xui.absIO.isCrossDomain(e)?xui.XDMI:xui.Ajax:xui.absIO.isCrossDomain(e)?xui.JSONP:xui.Ajax},request:function(d,e,g,h,f,c){return xui._getrpc(d,e,c).apply(null,arguments).start()},ajax:function(d,e,g,h,f,c){return xui.Ajax.apply(null,arguments).start()},jsonp:function(d,e,g,h,f,c){return xui.JSONP.apply(null,arguments).start()},xdmi:function(d,e,g,h,f,c){return xui.XDMI.apply(null,arguments).start()},restGet:function(d,e,g,h,f,c){if(!c){c={}}c.method="get";return xui.Ajax(d,e,g,h,f,c).start()},restPost:function(d,e,g,h,f,c){if(!c){c={}}c.method="post";return xui.Ajax(d,e,g,h,f,c).start()},restPut:function(d,e,g,h,f,c){if(!c){c={}}c.method="put";return xui.Ajax(d,e,g,h,f,c).start()},restDelete:function(d,e,g,h,f,c){if(!c){c={}}c.method="delete";return xui.Ajax(d,e,g,h,f,c).start()},getFileSync:function(e,d,f,g,c){return xui.Ajax(e,xui.$rand+"="+_.rand(),f,g,null,_.merge({asy:false,rspType:d||"text"},c,"without")).start()||null},getFileAsync:function(e,d,g,h,f,c){xui.Ajax(e,xui.$rand+"="+_.rand(),g,h,f,_.merge({asy:true,rspType:d||"text"},c,"without")).start()},include:function(h,e,f,g,d,c){if(h&&xui.SC.get(h)){_.tryF(f)}else{c=typeof c=="object"?c:{};if(!d){c.rspType="script";c.checkKey=h;xui.JSONP(e,xui.$rand+"="+_.rand(),f,g,0,c).start()}else{c.asy=!d;xui.Ajax(e,xui.$rand+"="+_.rand(),function(k){try{_.exec(k,h)}catch(l){_.tryF(g,[l.name+": "+l.message])}_.tryF(f)},g,0,c).start()}}},mailTo:function(f,g,c,h,e){var d="mailto:"+f+"?subject="+encodeURIComponent(xui.adjustRes(g||""))+"&body= "+encodeURIComponent(xui.adjustRes(c||""))+"&cc= "+(h||"")+"&bcc= "+(e||"");xui.XDMI(d).start()},fetchClass:function(g,n,d,k,e,h,u){if(/\//.test(g)&&!/\.js$/i.test(g)){g=g+".js"}u=u||{};var m=/\.js$/i.test(g),p=xui.$cache.clsByURI,l=xui.$cache.fetching,r,q;if(!m){if(!u.hasOwnProperty("appPath")&&window["/"]){u.appPath=window["/"]}r=g;g=xui.getPath(g,".js","js",u)}if(!e&&(m?((q=p[g])&&q.$xui$):(q=xui.SC.get(r)))){_.tryF(n,[g,r],q)}else{if(!l[g]){l[g]=[n=n?[n]:[],d=d?[d]:[],k=k?[k]:[],[]];if(xui.absIO.isCrossDomain(g)){Class._ignoreNSCache=1;Class._last=null;xui.JSONP(g,xui.$rand+"="+_.rand(),function(){if(Class._last){q=p[g]=Class._last}Class._ignoreNSCache=Class._last=null;if(q){for(var c in n){_.tryF(n[c],[g,q.KEY],q)}}else{for(var c in d){_.tryF(d[c],_.toArr(arguments))}}var f=xui.getClassName(g);if(q&&q.KEY!=f){var w="The last class name in '"+g+"' should be '"+f+"', but it's '"+q.KEY+"'!";for(var c in k){_.tryF(k[c],[w,g,f,q.KEY])}_.asyRun(function(){throw w})}for(var c in l[g][3]){xui.Thread(l[g][3][c]).abort()}if(l[g]){l[g][0].length=0;l[g][1].length=0;l[g][2].length=0;l[g][3].length=0;l[g].length=0;delete l[g]}},function(){Class._ignoreNSCache=1;Class._last=null;for(var c in d){_.tryF(d[c],_.toArr(arguments))}for(var c in l[g][3]){xui.Thread(l[g][3][c]).abort()}if(l[g]){l[g][0].length=0;l[g][1].length=0;l[g][2].length=0;l[g][3].length=0;l[g].length=0;delete l[g]}},h,{rspType:"script"}).start()}else{xui.Ajax(g,xui.$rand+"="+_.rand(),function(c){Class._ignoreNSCache=1;Class._last=null;var f;var x=xui.getClassName(g);try{f=_.exec(c,x)}catch(y){for(var w in d){_.tryF(d[w],[y.name+": "+y.message])}Class._last=null}if(Class._last){q=p[g]=Class._last}Class._last=null;if(q){for(var w in n){_.tryF(n[w],[g,q.KEY],q)}}else{for(var w in d){_.tryF(d[w],_.toArr(arguments))}}if(q&&q.KEY!=x){var z="The last class name in '"+g+"' should be '"+x+"', but it's '"+q.KEY+"'!";for(var w in k){_.tryF(k[w],[z,g,x,q.KEY])}_.asyRun(function(){throw z})}for(var w in l[g][3]){xui.Thread(l[g][3][w]).abort()}if(l[g]){l[g][0].length=0;l[g][1].length=0;l[g][2].length=0;l[g][3].length=0;l[g].length=0;delete l[g]}},function(){Class._ignoreNSCache=Class._last=null;for(var c in d){_.tryF(d[c],_.toArr(arguments))}for(var c in l[g][3]){xui.Thread(l[g][3][c]).abort()}if(l[g]){l[g][0].length=0;l[g][1].length=0;l[g][2].length=0;l[g][3].length=0;l[g].length=0;delete l[g]}},h,{rspType:"text",asy:true}).start()}}else{if(n){l[g][0].push(n)}if(d){l[g][1].push(d)}if(k){l[g][2].push(k)}if(h){l[g][3].push(h);xui.Thread(h).suspend()}}}},fetchClasses:function(r,c,q,d,n,e,h,u){var m={},p=function(l,f,w){w[f]=xui.Thread(null,[function(x){xui.fetchClass(l,q,d,n,e,x,u)}])};for(var k=0,g=r.length;k<g;k++){p(r[k],k,m)}return xui.Thread.group(null,m,null,function(){xui.Thread(h).suspend()},function(){_.tryF(c,arguments,this);xui.Thread(h).resume()}).start()},require:function(h,c,k,d,g,e,f,m){if(_.isStr(h)){h=[h]}var l=function(p,n){xui.fetchClasses(p,function(){var w=[],A,B;for(var z=0,x=p.length;z<x;z++){A=xui.SC.get(p[z]);if(A&&(B=A.Required)&&B.length){for(var y=0,u=B.length;y<u;y++){if(!xui.SC.get(B[y])){w.push(B[y])}}}if(A&&A["xui.Module"]&&(A=A.prototype&&A.prototype.iniComponents)){_.fun.body(A).replace(/\bxui.create\s*\(\s*['"]([\w.]+)['"]\s*[,)]/g,function(C,r){if(!(C=xui.SC.get(r))){w.push(r);C=null}})}}if(w.length){l(w,null)}else{var q=[];for(var z=0,x=h.length;z<x;z++){q.push(xui.SC.get(h[z]))}if(c){c.apply(null,q)}}},k,d,g,e,n,m)};l(h,f)},_m:[],main:function(c){if(_.arr.indexOf(xui._m,c)==-1){xui._m.push(c)}if(xui.isDomReady){xui._domReadyFuns()}},getPath:function(h,n,c,m){h=h.split(".");if(c){var g=[h[0],c];for(var f=1,e=h.length;f<e;f++){g.push(h[f])}h.length=0;h=g}var d,k=xui.ini;if(h[0]=="xui"){d=(m&&m.xuiPath)||k.path;h.shift();if(h.length==(c?1:0)){h.push("xui")}}else{d=(m&&m.appPath)||k.appPath;if(h.length==((c?1:0)+1)&&n==".js"){h.push("index")}if((m&&m.verPath)||k.verPath){d+=((m&&m.verPath)||k.verPath)+"/"}if(k.ver){d+=k.ver+"/"}}if(d.slice(-1)!="/"){d+="/"}return d+h.join("/")+(n||"/")},getClassName:function(f){if(f&&_.isStr(f)){var e=f.split(/\/js\//g),d,h,g=e.length;if(g>=2){d=e[g-2].split(/\//g);d=d[d.length-1];e=e[g-1].replace(/\.js$/i,"");return(d+(e?".":"")+e.replace(/\//g,".")).replace(/^([^.]+)\.index$/,"$1")}}},log:_.fun(),echo:_.fun(),message:_.fun(),_pool:[],getObject:function(c){return xui._pool["$"+c]},getObjectByAlias:function(d){var e;for(var c in xui._pool){e=xui._pool[c];if(("alias" in e)&&e.alias===d){return typeof(e.boxing)=="function"?e.boxing():e}}},_ghostDivId:"xui.ghost::",$getGhostDiv:function(){var e=xui.$cache.ghostDiv,d=0,c=e.length,f;do{f=e[d++]}while(d<c&&(f&&f.firstChild));if(!f||f.firstChild){f=document.createElement("div");f.id=xui._ghostDivId;e.push(f)}return f},$xid:0,$registerNode:function(e){var f,d,c=xui.$cache.domPurgeData;if(!(e.$xid&&(d=c[e.$xid])&&d.element==e)){f="!"+xui.$xid++;d=c[f]||(c[f]={});d.element=e;e.$xid=d.$xid=f}e=null;return d},getId:function(c){if(typeof c=="string"){c=document.getElementById(c)}return c?window===c?"!window":document===c?"!document":(c.$xid||""):""},getNode:function(c){return xui.use(c).get(0)},getNodeData:function(c,d){if(!c){return}return _.get(xui.$cache.domPurgeData[typeof c=="string"?c:xui.getId(c)],d)},setData:function(d,c){return _.set(xui.$cache.data,d,c)},getData:function(c){return _.get(xui.$cache.data,c)},setNodeData:function(c,e,d){if(!c){return}return _.set(xui.$cache.domPurgeData[typeof c=="string"?c:xui.getId(c)],e,d)},$purgeChildren:function(h){var d=xui.$cache,p=d.profileMap,c=d.UIKeyMapEvents,q=d.domPurgeData,z=xui.Event.$eventhandler,g=(xui.browser.ie&&h.all)?h.all:h.getElementsByTagName("*"),k=g.length,x=[],n,m,f,y,u,r,e;for(n=0;n<k;n++){if(!(u=g[n])){continue}if(y=u.$xid){if(f=q[y]){if(r=f.eHandlers){if(xui.browser.isTouch&&r.onxuitouchdown){if(u.removeEventListener){u.removeEventListener("xuitouchdown",z,false)}else{if(u.detachEvent){u.detachEvent("xuitouchdown",z)}}}for(m in r){u[m]=null}}for(m in f){f[m]=null}delete q[y]}if(xui.browser.ie){u.removeAttribute("$xid")}else{delete u.$xid}}if(e=u.id){if(e in p){f=p[e];if(!f){continue}y=f.renderId;if("!window"===y||"!document"===y){continue}f.__gc();x[x.length]=n;if(f.$domId&&f.$domId!=f.domId){x[x.length]=f.$domId}}}}for(n=0;n<x.length;){delete p[x[n++]]}h.innerHTML=""},create:function(n,k){var g,c,m,h=arguments.callee,d=h.r1||(h.r1=/</);if(typeof n=="string"){if(m=xui.absBox.$type[n]){g=[];for(var f=1,e=arguments.length;f<e;f++){g[f-1]=arguments[f]}c=new (xui.SC(m))(false);if(c._ini){c._ini.apply(c,g)}}else{if(((m=xui.SC.get(n))&&m["xui.Module"])||k=="xui.Module"){if(m){c=new m()}else{c=new xui.UI.MoudluePlaceHolder();xui.require(n,function(p){if(p&&p["xui.Module"]){if(c.get(0).renderId){var l=new p();l.create(function(){c.replaceWithModule(l)})}else{c.get(0)._module=new p()}}})}}else{if(d.test(n)){c=_.str.toDom(n)}else{c=document.createElement(n);c.id=typeof id=="string"?id:_.id();c=xui(c)}}}}else{if(n["xui.Module"]){if((m=xui.SC.get(n.key))&&m["xui.Module"]){c=new m(n)}else{c=new xui.UI.MoudluePlaceHolder();if(n.host||n.alias){c.setHost(n.host,n.alias)}if(m=n.events){c.setEvents(m)}if(m=n.properties){c.setProperties(m)}if(n.moduleClass&&n.moduleXid){c.get(0).moduleClass=n.moduleClass;c.get(0).moduleXid=n.moduleXid}xui.require(n.key,function(p){if(p&&p["xui.Module"]){var l=new p(n);l.create(function(){c.replaceWithModule(l)})}})}}else{c=new (xui.SC(n.key))(n)}}return c},use:function(d){var f=xui._tempBox||(xui._tempBox=xui()),e=f._nodes;e[0]=d;if(e.length!=1){e.length=1}return f}});new function(){var r=window,y=navigator.userAgent.toLowerCase(),p=document,k=p.documentMode,q=xui.browser={kde:/webkit/.test(y),applewebkit:/applewebkit/.test(y),opr:/opera/.test(y),ie:(/msie/.test(y)&&!/opera/.test(y)),newie:/trident\/.* rv:([0-9]{1,}[.0-9]{0,})/.test(y),gek:/mozilla/.test(y)&&!/(compatible|webkit)/.test(y),isStrict:p.compatMode=="CSS1Compat",isWebKit:/webkit/.test(y),isFF:/firefox/.test(y),isChrome:/chrome/.test(y),isSafari:(!/chrome/.test(y))&&/safari/.test(y),isWin:/(windows|win32)/.test(y),isMac:/(macintosh|mac os x)/.test(y),isAir:/adobeair/.test(y),isLinux:/linux/.test(y),isSecure:location.href.toLowerCase().indexOf("https")==0,isTouch:(("ontouchend" in p)&&!(/hp-tablet/).test(y))||(r.DocumentTouch&&p instanceof DocumentTouch)||r.PointerEvent||r.MSPointerEvent,isIOS:/iphone|ipad|ipod/.test(y),isAndroid:/android/.test(y),isBB:/blackberry/.test(y)||/BB[\d]+;.+\sMobile\s/.test(navigator.userAgent)},x=function(d,e){e=y.split(e)[1].split(".");return d+(q.ver=parseFloat((e.length>0&&isFinite(e[1]))?(e[0]+"."+e[1]):e[0]))};if(r.matchMedia&&typeof r.matchMedia=="function"){q.isTouch=r.matchMedia("(any-pointer: coarse)").matches;q.deviceType=q.isTouch?((r.matchMedia("(any-hover: hover)").matches||r.matchMedia("(any-pointer: fine)").matches)?"hybrid":"touchOnly"):"mouseOnly"}else{q.deviceType=q.isTouch?"touchOnly":"mouseOnly"}xui.$secureUrl=q.isSecure&&q.ie?'javascript:""':"about:blank";_.filter(q,function(d){return !!d});if(q.newie){q["newie"+(q.ver=k)]=true;q.cssTag1="-ms-";q.cssTag2="ms"}else{if(q.ie){if(_.isNumb(k)){q["ie"+(q.ver=k)]=true}else{q[x("ie","msie ")]=true}if(q.ie6){try{document.execCommand("BackgroundImageCache",false,true)}catch(n){}r.XMLHttpRequest=function(){return new ActiveXObject("Msxml2.XMLHTTP")}}q.cssTag1="-ms-";q.cssTag2="ms"}else{if(q.gek){q[x("gek",/.+\//)]=true;q.cssTag1="-moz-";q.cssTag2="Moz"}else{if(q.opr){q[x("opr","opera/")]=true;q.cssTag1="-o-";q.cssTag2="O"}else{if(q.kde){q[x("kde","webkit/")]=true;if(q.isSafari){if(/applewebkit\/4/.test(y)){q["safari"+(q.ver=2)]=true}else{q[x("safari","version/")]=true}}else{if(q.isChrome){q[x("chrome","chrome/")]=true}}if(q.isWebKit){q.cssTag1="-webkit-";q.cssTag2="Webkit"}else{q.cssTag1="-khtml-";q.cssTag2="Khtml"}}}}}}if(q.isBB&&!q.ver){q.ver=parseFloat(ua.split("/")[1].substring(0,3));q["bb"+q.ver]=true}q.contentBox=function(d){return(q.ie||q.opr)?!/BackCompat|QuirksMode/.test(p.compatMode):(d=(d=d||p.documentElement).style["-moz-box-sizing"]||d.style["box-sizing"])?(d=="content-box"):true}();var A=xui.ini={};if(window.xui_ini){_.merge(A,window.xui_ini)}if(!A.path){var z,h=document.getElementsByTagName("script"),c=/js\/xui(-[\w]+)?\.js$/,g=h.length;while(--g>=0){z=h[g].src;if(z.match(c)){A.path=z.replace(c,"").replace(/\(/g,"%28").replace(/\)/g,"%29");break}}}_.merge(A,{appPath:location.href.split("?")[0].replace(/[^\\\/]+$/,""),img_bg:A.path+"bg.gif",img_busy:A.path+"busy.gif",img_icon:A.path+"icon.png",img_pic:A.path+"picture.png",img_blank:q.ie&&q.ver<=7?(A.path+"bg.gif"):"data:image/gif;base64,R0lGODlhAQABAID/AMDAwAAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==",dummy_tag:"$_dummy_$"},"without");if(!A.path){A.path=A.appPath+"/xui/"}if(!A.basePath){A.basePath=A.path.replace(/xui\/$/,"").replace(/runtime\/$/,"")}A.releasePath=A.appPath;if(A.verPath){A.releasePath+=(A.verPath?(A.verPath+"/"):"")+(A.ver?(A.ver+"/"):"")}var m=xui._domReadyFuns=function(){if(!xui.isDomReady){if(p.addEventListener){p.removeEventListener("DOMContentLoaded",D,false);r.removeEventListener("load",D,false)}else{p.detachEvent("onreadystatechange",D);r.detachEvent("onload",D)}if(xui.browser.deviceType!="touchOnly"&&!xui.Dom.getScrollBarSize()){xui.browser.deviceType="touchOnly";if(xui.UI){var D=function(e){_.arr.each(e,function(f){if(f=xui.SC.get(f)){if(f.$DataModel.overflow){f.$DataModel.overflow.ini="auto";f.$DataStruct.overflow="auto"}if(f.$children&&f.$children.length){D(f.$children)}}})};D(xui.UI.$children)}}}try{if(xui.ini.customStyle&&!_.isEmpty(xui.ini.customStyle)){var u=[],C=xui.ini.customStyle,d;_.each(C,function(f,e){u.push(e+" : "+f+";")});d=".xui-custom{\r\n"+u.join("\r\n")+"\r\n}";xui.CSS.addStyleSheet(d,"xui:css:custom",1)}for(var B=0,w=xui._m.length;B<w;B++){_.tryF(xui._m[B])}xui._m.length=0;xui.isDomReady=true}catch(E){_.asyRun(function(){throw E})}};if(p.addEventListener){p.addEventListener("DOMContentLoaded",m,false);r.addEventListener("load",m,false)}else{p.attachEvent("onreadystatechange",m);r.attachEvent("onload",m);(function(){if(xui.isDomReady){return}try{p.activeElement.id;p.documentElement.doScroll("left");m()}catch(d){_.setTimeout(arguments.callee,9)}})()}(function(){((!xui.isDomReady)&&((!p.readyState)||/in/.test(p.readyState)))?_.setTimeout(arguments.callee,9):m()})()};new function(){xui._uriReg=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/;xui._localReg=/^(?:about|app|app\-storage|.+\-extension|file|widget):$/;xui._curHref=(function(c){try{return location.href}catch(d){c=document.createElement("a");c.href="";return c.href}})(),xui._localParts=xui._uriReg.exec(xui._curHref.toLowerCase())||[]};new function(){xui.pseudocode={exec:function(u,e,d,I,f){var w,C,B,z,G,h=u.type||"other",y={temp:I,page:d,args:e,global:xui.$cache.data},x=function(k,m,l){switch(_.str.trim(l)){case"=":return k===m;case"<>":case"!=":return k!==m;case"empty":return _.isEmpty(k);case"non-empty":return !_.isEmpty(k);case">":return parseFloat(k)>parseFloat(m);case"<":return parseFloat(k)<parseFloat(m);case">=":return parseFloat(k)>=parseFloat(m);case"<=":return parseFloat(k)<=parseFloat(m);case"include":return(k+"").indexOf(m+"")!=-1;case"exclude":return(k+"").indexOf(m+"")==-1;case"begin":return(k+"").indexOf(m+"")===0;case"end":return(k+"").indexOf(m+"")===(k+"").length-(m+"").length;case"objhaskey":return typeof(k)=="object"?(m in k):false;case"objnokey":return typeof(k)=="object"?!(m in k):false;case"arrhasvalue":return _.isArr(k)?_.arr.indexOf(k,m)!==-1:false;case"arrnovalue":return _.isArr(k)?_.arr.indexOf(k,m)==-1:false;case"objarrhaskey":return _.isArr(k)?_.arr.subIndexOf(k,"id",m)!==-1:false;case"objarrnokey":return _.isArr(k)?_.arr.subIndexOf(k,"id",m)==-1:false;default:return false}},E=function(p){if(typeof(p)=="string"){var n;if(_.str.startWith(p,"[data]")){p=p.replace("[data]","");n=1}p=xui.adjustVar(p,y);if(n&&typeof(p)=="string"){p=_.unserialize(xui.getFileSync(p))}}else{if(_.isHash(p)){for(var m in p){p[m]=E(p[m])}}else{if(_.isArr(p)){for(var m=0,k=p.length;m<k;m++){p[m]=E(p[m])}}}}return p},K=u.target,g=(u.method+"").split("-")[0],A=_.clone(u.params)||[],q=u.conditions||[],F=u.adjust||null,c=[],r=_.isSet(u.timeout)?parseInt(u.timeout,10):null;for(var H=0,D=q.length;H<D;H++){if(!x(xui.adjustVar(q[H].left,y),xui.adjustVar(q[H].right,y),q[H].symbol)){if(typeof f=="function"){f()}return}}if(K&&g&&K!="none"&&g!="none"){for(var H=(h=="other"&&K=="callback")?g=="call"?1:g=="set"?2:0:0,D=A.length;H<D;H++){A[H]=E(A[H])}if(g.indexOf("-")!=-1){w=g.split("-");g=w[0];for(var H=1,D=w.length;H<D;H++){if(w[H]){A[H-1]=w[H]}}}var J=function(){switch(h){case"page":if(g=="switch"){if(!xui.History._callback){xui.History.setCallback(function(P,O){if(O){return}var N=_.urlDecode(P||"");if(!N.xuicom){N.xuicom="App";N.cache=true}xui("body").children().each(function(Q){var R=xui.Module.getFromDom(Q);if(R&&R._showed){if(N.cache){R.hide()}else{R.destroy()}}});xui.showModule(N.xuimodule)})}var M="xuimodule="+K;if(A[0]){M+="&cache="+(A[0]?true:false)}xui.History.setFI(M);return}var k=_.get(window,K.split(".")),n;if(k){for(var p in k._pool){n=k._pool[p];break}}if(g=="show"||g=="pop"){A.unshift(function(O,N){if(g=="pop"&&!O){w=N.getUIComponents(true);if((w=w.getRoot())&&(w=w.get(0))){xui(w).pop(A[1]||y.args[0])}}});var l=function(O,N){if(O){return}if(_.isFun(w=N.show)){w.apply(N,A)}};if(!n){xui.getModule(K,l)}else{l(null,n)}}else{if(n&&_.isFun(w=_.get(n,[g]))){w.apply(n,A)}return}break;case"control":case"module":if(g=="pop"){w=_.get(d,[K]);if((w=w.getRoot())&&(w=w.get(0))){xui(w).pop(A[1]||y.args[0])}}else{if(g=="setProperties"){if(C=A[0]){if(C.CA){if(_.isFun(w=_.get(d,[K,"setCustomAttr"]))){w.apply(d[K],[C.CA])}delete C.CA}if(C.CC){if(_.isFun(w=_.get(d,[K,"setCustomClass"]))){w.apply(d[K],[C.CC])}delete C.CC}if(C.CS){if(_.isFun(w=_.get(d,[K,"setCustomStyle"]))){w.apply(d[K],[C.CS])}delete C.CS}}}if(_.isFun(w=_.get(d,[K,g]))){w.apply(d[K],A)}}break;case"other":switch(K){case"url":switch(g){case"close":window.close();break;case"open":window.open(A[0],A[1],A[2],A[3]);break;case"mailTo":xui.mailTo.apply(xui,A);break}break;case"msg":if(g=="busy"||g=="free"){if(_.isFun(w=_.get(xui.Dom,[g]))){w.apply(xui.Dom,A)}}else{if(g=="console"&&_.isDefined(window.console)&&(typeof console.log=="function")){console.log.apply(console,A)}else{if(_.isFun(w=_.get(xui,[g]))){w.apply(xui,A)}}}break;case"var":if(g=="cookie"){xui.$cache.data.Cookies=xui.Cookies.get()}else{if(A[0].length){if(F){switch(F){case"serialize":A[1]=_.serialize(A[1]);break;case"unserialize":A[1]=_.unserialize(A[1]);break;case"stringify":A[1]=_.stringify(A[1]);break;default:if(typeof(F=_.get(F))=="function"){A[1]=F(A[1])}break}}_.set(y,(g+"."+_.str.trim(A[0])).split(/\s*\.\s*/),A[1])}}break;case"callback":switch(g){case"set":w=A[1];if(_.isStr(w)&&/[\w\.\s*]+\(\s*\)\s*\}$/.test(w)){w=w.split(/\s*\.\s*/);C=w.pop().replace(/[()}\s]/g,"");w=xui.adjustVar(w.join(".")+"}",y);if(w&&_.isFun(w[C])){xui.$cache.callback[A[0]]=[w,C]}}break;case"call":var m=A.slice(3),L;w=A[0];if(_.isStr(w)&&/[\w\.\s*]+\(\s*\)\s*\}$/.test(w)){w=w.split(/\s*\.\s*/);C=w.pop().replace(/[()}\s]/g,"");w=w.join(".")+"}";w=xui.adjustVar(w,y)||xui.adjustVar(w);L=w&&w[C]&&_.isFun(w[C])}else{if(_.isStr(w=A[0])&&_.isFun((B=xui.$cache.callback[w])&&(w=B[0])&&w&&(w[C=B[1]]))){L=1}}if(L){w=w[C].apply(w,m);if(A[1]&&A[2]&&_.get(y,A[1].split(/\s*\.\s*/))){_.set(y,(A[1]+"."+A[2]).split(/\s*\.\s*/),w)}}break}break}break}};if(r!==null){_.asyRun(J,r)}else{J()}}return u["return"]}}};new function(){var M={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\","/":"\\/","\x0B":"\\u000b"},H={"@window":"window","@this":"this"},A1=/\uffff/.test("\uffff")?/[\\\"\x00-\x1f\x7f-\uffff]/:/[\\\"\x00-\x1f\x7f-\xff]/,A2=/\uffff/.test("\uffff")?/[\\\"\x00-\x1f\x7f-\uffff]/g:/[\\\"\x00-\x1f\x7f-\xff]/g,D=/^(-\d+|\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})(?:\.(\d{1,3}))?((?:[+-](\d{2})(\d{2}))|Z)?$/,E=function(t,i,a,v,m,n,p){for(i in t){if((a=typeof(v=t[i]))=="string"&&(v=D.exec(v))){m=v[8]&&v[8].charAt(0);if(m!="Z"){n=(m=="-"?-1:1)*((+v[9]||0)*60)+(+v[10]||0)}else{n=0}m=new Date(+v[1],+v[2]-1,+v[3],+v[4],+v[5],+v[6],+v[7]||0);n+=m.getTimezoneOffset();if(n){m.setTime(m.getTime()+n*60000)}t[i]=m}else{if(a=="object"&&t[i]&&(_.isObj(t[i])||_.isArr(t[i]))){E(t[i])}}}return t},R=function(n){return n<10?"0"+n:n},F="function",N="number",L="boolean",S="string",O="object",T={},MS=function(x,s){return"."+((s=x[s]())?s<10?"00"+s:s<100?"0"+s:s:"000")},Z=(function(a,b){a=-(new Date).getTimezoneOffset()/60;b=a>0?"+":"-";a=""+Math.abs(a);return b+(a.length==1?"0":"")+a+"00"})();T["undefined"]=function(){return"null"};T[L]=function(x){return String(x)};T[N]=function(x){return((x||x===0)&&isFinite(x))?String(x):"null"};T[S]=function(x){return H[x]||'"'+(A1.test(x)?x.replace(A2,function(a,b){if(b=M[a]){return b}return"\\u"+((b=a.charCodeAt())<16?"000":b<256?"00":b<4096?"0":"")+b.toString(16)}):x)+'"'};T[O]=function(x,filter,dateformat,deep,max){var me=arguments.callee,map=me.map||(me.map={prototype:1,constructor:1,toString:1,valueOf:1});deep=deep||1;max=max||0;if(deep>xui.SERIALIZEMAXLAYER||max>xui.SERIALIZEMAXSIZE){return'"too much recursion!"'}max++;if(x){var a=[],b=[],f,i,l,v;if(x===window){return"window"}if(x===document){return"document"}if((typeof x==O||typeof x==F)&&!_.isFun(x.constructor)){return x.nodeType?"document.getElementById('"+x.id+"')":"$alien"}else{if(_.isArr(x)){a[0]="[";l=x.length;for(i=0;i<l;++i){if(typeof filter=="function"&&false==filter.call(x,x[i],i)){continue}if(_.isNaN(v=x[i])){b[b.length]="NaN"}else{if(_.isNull(v)){b[b.length]="null"}else{if(!_.isDefined(v)){b[b.length]="undefined"}else{if(f=T[typeof v]){if(typeof(v=f(v,filter,dateformat,deep+1,max))==S){b[b.length]=v}}}}}}a[2]="]"}else{if(_.isDate(x)){if(dateformat=="utc"){return'"'+x.getUTCFullYear()+"-"+R(x.getUTCMonth()+1)+"-"+R(x.getUTCDate())+"T"+R(x.getUTCHours())+":"+R(x.getUTCMinutes())+":"+R(x.getUTCSeconds())+MS(x,"getUTCMilliseconds")+'Z"'}else{if(dateformat=="gmt"){return'"'+x.getFullYear()+"-"+R(x.getMonth()+1)+"-"+R(x.getDate())+"T"+R(x.getHours())+":"+R(x.getMinutes())+":"+R(x.getSeconds())+MS(x,"getMilliseconds")+Z+'"'}else{return"new Date("+[x.getFullYear(),x.getMonth(),x.getDate(),x.getHours(),x.getMinutes(),x.getSeconds(),x.getMilliseconds()].join(",")+")"}}}else{if(_.isReg(x)){return String(x)}else{if(typeof x.serialize==F){x=x.serialize()}if(typeof x==O){if(x.nodeType){return"document.getElementById('"+x.id+"')"}else{a[0]="{";for(i in x){if(map[i]||(filter===true?i.charAt(0)=="_":typeof filter=="function"?false===filter.call(x,x[i],i):0)){continue}if(_.isNaN(v=x[i])){b[b.length]=T.string(i)+":NaN"}else{if(_.isNull(v)){b[b.length]=T.string(i)+":null"}else{if(!_.isDefined(v)){b[b.length]=T.string(i)+":undefined"}else{if(f=T[typeof v]){if(typeof(v=f(v,filter,dateformat,deep+1,max))==S){b[b.length]=T.string(i)+":"+v}}}}}}a[2]="}"}}else{return String(x)}}}}}a[1]=b.join(", ");return a[0]+a[1]+a[2]}return"null"};T[F]=function(x){return x.$path?x.$path:String(x)};_.serialize=function(obj,filter,dateformat){return _.isNaN(obj)?"NaN":_.isNull(obj)?"null":!_.isDefined(obj)?"undefined":T[typeof obj](obj,filter,dateformat||(xui&&xui.$dateFormat))||""};_.stringify=function(obj,filter,dateformat){return _.fromUTF8(_.serialize(obj,filter,dateformat))};_.unserialize=function(str,dateformat){if(typeof str!="string"){return str}if(!str){return false}try{str="({_:"+str+"})";str=eval(str);if(dateformat||(xui&&xui.$dateFormat)){E(str)}str=str._;return str}catch(e){return false}}};new function(){_.id=function(){var self=this,me=arguments.callee;if(self.constructor!==me||self.a){return(me._||(me._=new me)).next()}self.a=[-1];self.b=[""];self.value=""};_.id.prototype={constructor:_.id,_chars:"abcdefghijklmnopqrstuvwxyz".split(""),next:function(i){with(this){i=(i||i===0)?i:b.length-1;var m,k,l;if((m=a[i])>=25){m=0;if(i===0){a.splice(0,0,1);b.splice(0,0,"a");l=a.length;for(k=1;k<l;++k){a[k]=0;b[k]="0"}++i}else{next(i-1)}}else{++m}a[i]=m;b[i]=_chars[m];return value=b.join("")}}}};Class("xui.Thread",null,{Constructor:function(d,e,g,l,m,c,f){var k=arguments.callee.upper;if(k){k.call(this)}k=null;var p=this,h=arguments.callee,n=xui.$cache.thread;if(p.constructor!==h||!!p.id){return new h(d,e,g,l,m,c,f)}if(typeof d!="string"){d="$"+(p.constructor.$xid++)}p.id=d;p.profile=n[d]||(n[d]={id:d,_start:false,time:0,_left:0,_asy:0.1,index:0,tasks:e||[],delay:g||0,callback:l,onStart:m,onEnd:c,cache:{},status:"ini",cycle:!!f})},Instance:{_fun:_.fun(),__gc:function(){var c=xui.$cache.thread,e=c[this.id];if(e){delete c[this.id];e.tasks.length=0;for(var d in e){e[d]=null}}},_task:function(){var c=this,k=c.profile;if(!k||!k.status||!k.tasks){return}k._asy=0.1;var e={},h=k.tasks[k.index],g,d,f=typeof h;if(f=="function"){e.task=h}else{if(f=="object"){for(d in h){e[d]=h[d]}}}if(typeof e.callback!="function"){e.callback=k.callback}if(typeof e.task=="function"){e.args=e.args||[];e.args.push(k.id)}k.index++;k.time=_();if(typeof e.task=="function"){g=_.tryF(e.task,e.args||[k.id],e.scope||c,null)}if(!k.status){return}if(e.id){k.cache[e.id]=g}if(e.callback&&false===_.tryF(e.callback,[k.id],c,true)){return c.abort("callback")}if(k.status!=="run"){return}c.start()},start:function(k,c){var e=this,h=e.profile,d,f;if(h.__delaycb){_.tryF(h.__delaycb,[h.id],e);delete h.__delaycb}if(c){h.__delaycb=c}if(h._start===false){h._start=true;if(h.onStart){var g=_.tryF(h.onStart,[h.id],e);if(false===g){return e.abort("start")}else{if(true===g){return}else{if(_.isNumb(g)){e.suspend(g);return}}}}}if(h.status!="run"){h.status="run"}if(!h.tasks.length){return e.abort("empty")}if(h.index>=h.tasks.length){if(h.cycle===true){e.profile.index=0}else{return e.abort("normal")}}d=h.tasks[h.index];f=typeof d=="number"?d:(d&&typeof d.delay=="number")?d.delay:h.delay;h._left=(k||k===0)?k:f;if(h._asy!=0.1){_.clearTimeout(h._asy)}h._asy=_.asyRun(e._task,h._left,[],e);h.time=_();return e},suspend:function(e,c){var f,d=this.profile;if(d.status=="pause"){return}d.status="pause";if(d._asy!==0.1){_.clearTimeout(d._asy);if(d.index>0){d.index--}}f=d._left-(_()-d.time);d._left=(f>=0?f:0);if((Number(e)||0)){this.resume(e,c)}return this},resume:function(e,c){var d=this;if(d.profile.status=="run"){return}e=e===undefined?d.profile._left:e===true?d.profile.delay:e===false?0:(Number(e)||0);d.profile.status="run";d.start(e,c);return d},abort:function(c){var d=this.profile;d.status="stop";_.clearTimeout(d._asy);_.tryF(d.onEnd,[d.id,c]);this.__gc()},links:function(c){var e=this.profile,d=e.onEnd,f=e.id;e.onEnd=function(){_.tryF(d,[f]);c.start()};return this},insert:function(c,g){var f=this,h=f.profile.tasks,e=h.length,d;if(!_.isArr(c)){c=[c]}g=g||f.profile.index;if(g<0){g=-1}if(g==-1){Array.prototype.push.apply(h,c)}else{if(g>e){g=e}d=h.splice(g,e-g);h.push.apply(h,c);h.push.apply(h,d)}return f},getCache:function(c){return this.profile.cache[c]},setCache:function(c,d){this.profile.cache[c]=d;return this},isAlive:function(){return !!xui.$cache.thread[this.id]},getStatus:function(){return this.profile.status}},After:function(){var e=this,h=function(f){e[f]=function(l){var k;if(xui.$cache.thread[l]){(k=xui.Thread(l))[f].apply(k,Array.prototype.slice.call(arguments,1))}}},d="start,suspend,resume,abort".split(",");for(var g=0,c=d.length;g<c;g++){h(d[g])}},Static:{$asFunction:1,$xid:1,__gc:function(){xui.$cache.thread={}},isAlive:function(c){return !!xui.$cache.thread[c]},observableRun:function(h,e,f,d){var c=xui.Thread,g=xui.Dom;if(!_.isArr(h)){h=[h]}if(xui.$cache.thread[f]){if(typeof e=="function"){h.push(e)}c(f).insert(h)}else{c(f,h,0,null,function(k){if(g){g.busy(k,d)}},function(k){_.tryF(e,arguments,this);if(g){g.free(k)}}).start()}},group:function(d,k,l,m,c){var n={},h=xui.Thread,g=function(u,p,r){if(typeof u=="string"){u=h(u)}if(u){var q=function(){var f=arguments.callee;_.tryF(f.onEnd,arguments,this);f.onEnd=null;delete n[p];_.tryF(l,[p,r],this);if(_.isEmpty(n)){h.resume(r)}};q.onEnd=u.profile.onEnd;u.profile.onEnd=q;u.start()}};for(var e in k){n[e]=1}return h(d,[function(p){if(!_.isEmpty(k)){h.suspend(p);for(var f in k){g(k[f],f,p)}}}],0,null,m,c)},repeat:function(e,d,c,f){return xui.Thread(null,[null],d||0,e,c,f,true).start()}}});Class("xui.absIO",null,{Constructor:function(e,q,n,c,h,x){var u=arguments.callee.upper;if(u){u.call(this)}u=null;if(typeof e=="object"){x=e}else{x=x||{};_.merge(x,{uri:e,query:q,onSuccess:n,onFail:c,threadid:h})}var w=this,p=arguments.callee,d=w.constructor;if((d!==p)||w.id){return new p(x)}_.merge(x,{id:x.id||(""+(d._id++)),uid:(""+(d.uid++)),uri:x.uri?xui.adjustRes(x.uri,0,1,1):"",username:x.username||undefined,password:x.password||undefined,query:x.query||"",contentType:x.contentType||"",Accept:x.Accept||"",header:x.header||null,asy:x.asy!==false},"all");var f=(x.method||d.method).toUpperCase();x.method="POST"==f?"POST":"PUT"==f?"PUT":"DELETE"==f?"DELETE":"PATCH"==f?"PATCH":"GET";var r="retry,timeout,reqType,rspType,optimized,customQS".split(",");for(var k=0,g=r.length;k<g;k++){x[r[k]]=(r[k] in x)?x[r[k]]:d[r[k]];if(typeof x[r[k]]=="string"){x[r[k]]=x[r[k]].toLowerCase()}}_.merge(w,x,"all");if(w.reqType=="xml"){w.method="POST"}if(d.events){_.merge(w,d.events)}w.query=w.customQS(w.query);if(typeof w.query=="object"&&w.reqType!="xml"){w.query=_.copy(w.query,function(l){return l!==undefined})}if(!w._useForm&&_.isHash(w.query)&&w.reqType!="xml"){w.query=d._buildQS(w.query,w.reqType=="json",w.method=="POST")}return w},Instance:{_fun:_.fun(),_flag:0,_response:false,_txtresponse:"",_retryNo:0,_time:function(){var d=this,e=d.constructor;d._clear();if(d._retryNo<d.retry){d._retryNo++;_.tryF(d.onRetry,[d._retryNo],d);d.start()}else{if(false!==_.tryF(d.onTimeout,[],d)){d._onError(new Error("Request timeout"))}}},_onEnd:function(){var c=this;if(!c._end){c._end=true;if(c._flag>0){_.clearTimeout(c._flag);c._flag=0}xui.Thread.resume(c.threadid);_.tryF(c.$onEnd,[],c);_.tryF(c.onEnd,[],c);c._clear()}},_onStart:function(){var c=this;xui.Thread.suspend(c.threadid);_.tryF(c.$onStart,[],c);_.tryF(c.onStart,[],c)},_onResponse:function(){var c=this;if(false!==_.tryF(c.beforeSuccess,[c._response,c.rspType,c.threadid],c)){_.tryF(c.onSuccess,[c._response,c.rspType,c.threadid],c)}c._onEnd()},_onError:function(d){var c=this;if(false!==_.tryF(c.beforeFail,[d,c.threadid],c)){_.tryF(c.onFail,[d.name?(d.name+": "+d.message):d,c.rspType,c.threadid,d],c)}c._onEnd()},isAlive:function(){return !this._end},abort:function(){this._onEnd()}},Static:{$abstract:true,get:function(d,e,g,h,f,c){c=c||{};c.mothod="GET";return this.apply(this,arguments).start()},post:function(d,e,g,h,f,c){c=c||{};c.mothod="POST";return this.apply(this,arguments).start()},_id:1,uid:1,method:"GET",retry:0,timeout:60000,reqType:"form",rspType:"json",optimized:false,callback:"callback",_buildQS:function(e,c,d){e=_.clone(e,function(g,f){return !(_.isNaN(g)||!_.isDefined(g))});return c?((c=_.serialize(e))&&(d?c:encodeURIComponent(c))):_.urlEncode(e)},customQS:function(c){return c},_if:function(g,k,e){var c=xui.browser.ie&&xui.browser.ver<9,f=c?("<iframe "+(k?("name='xui_xdmi:"+k+"'"):"")+(e?(" onload='xui.XDMI._o(\""+k+"\")'"):"")+">"):"iframe";var h=g.createElement(f),d;if(k){h.id=h.name="xui_xdmi:"+k}if(!c&&e){h.onload=e}h.style.display="none";g.body.appendChild(h);d=frames[frames.length-1].window;return[h,d,d.document]},isCrossDomain:function(e){var c=xui._localParts;e=e.replace(/#.*$/,"").replace(/^\/\//,c[1]+"//");var d=xui._uriReg.exec((e||"").toLowerCase());return !!(d&&(d[1]!==c[1]||d[2]!==c[2]||(d[3]||(d[1]==="http:"?80:443))!==(c[3]||(c[1]==="http:"?80:443))))},groupCall:function(k,l,c,d,h){var e,g=function(n,f,m){m[f]=xui.Thread(null,[function(p){n.threadid=p;n.start()}])};for(e in k){g(k[e],e,k)}return xui.Thread.group(null,k,l,function(){xui.Thread(h).suspend();_.tryF(c,arguments,this)},function(){_.tryF(d,arguments,this);xui.Thread(h).resume()}).start()}}});Class("xui.Ajax","xui.absIO",{Instance:{_XML:null,_unsafeHeader:"Accept-Charset,Accept-Encoding,Access-Control-Request-Headers,Access-Control-Request-Method,Connection,Content-Length,Cookie,Cookie2,Date,DNT,Expect,Host,Keep-Alive,Origin,Referer,TE,Trailer,Transfer-Encoding,Upgrade,User-Agent,Via".toLowerCase().split(","),_isunsafe:function(c){return xui.browser.isWebKit&&(_.str.startWith("Proxy-",c)||_.str.startWith("Sec-",c)||_.arr.indexOf(this._unsafeHeader,c.toLowerCase())!==-1)},_header:function(d,c){if(!this._isunsafe(d)){if(this._XML){this._XML.setRequestHeader(d,c)}}},start:function(){var self=this;if(false===_.tryF(self.beforeStart,[],self)){self._onEnd();return}if(!self._retryNo){self._onStart()}try{with(self){self._XML=new window.XMLHttpRequest();if(asy){self._XML.onreadystatechange=function(){if(self&&self._XML&&self._XML.readyState==4){self._complete.apply(self);self._clear()}}}if(!_retryNo&&method!="POST"){if(query){uri=uri.split("?")[0]+"?"+query}query=null}if(username&&password){self._XML.open(method,uri,asy,username,password)}else{self._XML.open(method,uri,asy)}self._header("Accept",Accept?Accept:(rspType=="json"?"application/json,text/javascript,*/*;q=0.01":rspType=="xml"?"text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8":"*/*"));self._header("Content-type",contentType?contentType:((reqType=="xml"?"text/xml; ":reqType=="json"?"application/json; ":method=="POST"?"application/x-www-form-urlencoded; ":"")+"charset="+(self.charset||"UTF-8")));self._header("X-Requested-With","XMLHttpRequest");if(optimized){try{self._header("User-Agent",null);self._header("Accept-Language",null);self._header("Connection","keep-alive");self._header("Keep-Alive",null);self._header("Cookie",null);self._header("Cookie","")}catch(e){}}try{if(_.isHash(header)){_.each(header,function(o,i){self._header(i,o)})}}catch(e){}if(false===_.tryF(self.beforeSend,[self._XML],self)){self._onEnd();return}try{self._XML.send(query)}catch(e){}if(asy){if(self._XML&&timeout>0){_flag=_.asyRun(function(){if(self&&!self._end){self._time()}},self.timeout)}}else{return _complete()}}}catch(e){self._onError(e)}return self},abort:function(){var c=this;if(c._XML){c._XML.onreadystatechange=c._fun;c._XML.abort();c._XML=null}arguments.callee.upper.call(c)},_clear:function(){var c=this;if(c._XML){c._XML.onreadystatechange=c._fun;c._XML=null}},_complete:function(){with(this){var ns=this,obj,status=ns._XML.status;_txtresponse=rspType=="xml"?ns._XML.responseXML:ns._XML.responseText;_response=rspType=="json"?((obj=_.unserialize(_txtresponse))===false?_txtresponse:obj):_txtresponse;if(!status&&xui._localReg.test(xui._localParts[1])){status=ns._XML.responseText?200:404}if(status==1223){status=204}if(status>=200&&status<300||status==304){_onResponse()}else{if(status===undefined||status<10){_onError(new Error("Network problems--"+status))}else{_onError(new Error("XMLHTTP returns--"+status))}}}return this._response}},Static:{$asFunction:1}});Class("xui.JSONP","xui.absIO",{Instance:{start:function(){var p=this,d,g=p.constructor,m,f,h=false;if(false===_.tryF(p.beforeStart,[],p)){p._onEnd();return}if(!p._retryNo){p._onStart()}if(p.rspType=="script"){p.retry=0}d=p.id;if(g._pool[d]){g._pool[d].push(p)}else{g._pool[d]=[p]}g.No["_"+d]=function(c){g.$response(c,d)};var k=document,l=function(){if(!h){h=true;if(p.rspType=="script"){if(typeof p.checkKey=="string"){_.asyRun(function(){_.exec("if(xui.SC.get('"+p.checkKey+"'))xui.JSONP._pool['"+d+"'][0]._onResponse();else xui.JSONP._pool['"+d+"'][0]._loaded();")})}else{p._onResponse()}}else{p._loaded()}}};f=p.node=k.createElement("script");var e=p.uri;if(p.query){e=e.split("?")[0]+"?"+p.query}f.src=e;f.type="text/javascript";f.charset=p.charset||"UTF-8";f.onload=f.onreadystatechange=function(){if(h){return}var c=this.readyState;if(!c||c=="loaded"||c=="complete"){l()}if(c=="interactive"&&xui.browser.opr){xui.Thread.repeat(function(){if(h){return false}if(/loaded|complete/.test(document.readyState)){l();return false}},50)}};if("onerror" in f){f.onerror=function(c){p._clear();p._onError(new Error("Not Found - "+e));p=null;return}}(k.body||k.getElementsByTagName("head")[0]).appendChild(f);f=null;if(p.timeout>0){p._flag=_.asyRun(function(){if(p&&!p._end){p._time()}},p.timeout)}},_clear:function(){var e=this,k=e.node,h=e.constructor,g=e.id,d=h._pool;if(d[g]){d[g].length=0;delete d[g]}delete h.No["_"+g];if(k){e.node=k.onload=k.onreadystatechange=k.onerror=null;var f=document.createElement("div");f.appendChild(k.parentNode&&k.parentNode.removeChild(k)||k);if(xui.browser.ie){_.asyRun(function(){f.innerHTML=k.outerHTML="";if(_.isEmpty(d)){h._id=1}d=h=k=f=null})}else{_.asyRun(function(){f.innerHTML="";k=f=null;if(_.isEmpty(d)){h._id=1}})}}else{if(_.isEmpty(d)){h._id=1}}},_loaded:function(){var c=this;_.asyRun(function(){if(c.id&&c.constructor._pool[c.id]){c._onError(new Error("JSONP return script doesn't match"))}},500)}},Static:{$asFunction:1,_pool:{},No:{},$response:function(f,g){var d=this;if(f&&(o=d._pool[g])){for(var e=0,c=o.length;e<c;e++){o[e]._response=f;o[e]._onResponse()}}else{d._onError(new Error("JSONP return value formatting error--"+f))}},customQS:function(f){var g=this.constructor,d=g.callback,e=(this.rspType!="script");if(typeof f=="string"){return(f||"")+(e?("&"+d+"=xui.JSONP.No._"+this.id):"")}else{if(e){f[d]="xui.JSONP.No._"+this.id}return f}}}});Class("xui.XDMI","xui.absIO",{Instance:{_useForm:true,start:function(){var B=this,z=window,u=B.constructor,r,f,A,l,q,g,x,e,p;if(false===_.tryF(B.beforeStart,[],B)){B._onEnd();return}if(!B._retryNo){B._onStart()}f=B.id;if(u._pool[f]){u._pool[f].push(B)}else{u._pool[f]=[B]}var y=u._if(document,f,p);B.node=y[0];B.frm=y[1];e=B.form=document.createElement("form");e.style.display="none";if(z.postMessage){B._msgcb=function(n){if(!B.node){return}if(n.source!==B.frm){return}n=n.data;if(B.rspType=="json"){n=_.unserialize(n)||n}if(n&&(A=u._pool[B.id])){for(var k=0,c=A.length;k<c;k++){A[k]._response=n;A[k]._onResponse()}}else{B._clear();B._onError(new Error("XDMI return value formatting error"))}};if(z.addEventListener){z.addEventListener("message",B._msgcb,false)}else{z.attachEvent("onmessage",B._msgcb)}}else{B._onload=p=function(G){if(B.OK){return}if(!B.node){return}var n=B.node.contentWindow,F=xui.XDMI,E,C;if(xui.browser.opr){try{if(n.location=="about:blank"){return}}catch(D){}}B.OK=1;var k=0;try{if(n.name===undefined){k=1}}catch(D){k=1}if(k){n.location.replace(F._getDummy()+"#"+xui.ini.dummy_tag)}(function(){var w=0;try{if(n.name===undefined){w=1}}catch(J){w=1}if(w){return _.asyRun(arguments.callee)}var I;if(("xui_xdmi:"+B.id)==n.name){B._clear();B._onError(new Error("XDMI no return value"));return}else{I=n.name}if(I&&(E=_.unserialize(I))&&(C=F._pool[B.id])){for(var H=0,c=C.length;H<c;H++){C[H]._response=E;C[H]._onResponse()}}else{B._clear();B._onError(new Error("XDMI return value formatting error, or no matched 'id'-- "+I))}})()}}var h=B.uri;if(B.method!="POST"){h=h.split("?")[0]}e.action=B.uri;e.method=B.method;e.target="xui_xdmi:"+f;q=B.query||{};var m,d=[];for(r in q){if(q[r]&&q[r]["xui.UIProfile"]&&q[r].$xuiFileCtrl){if(m=q[r].boxing().getUploadObj()){d.push({id:q[r].$xid,file:m});m.id=m.name=r;e.appendChild(m);x=true}}else{if(q[r]&&q[r].nodeType==1){q[r].id=q[r].name=r;e.appendChild(q[r]);x=true}else{if(_.isDefined(q[r])){A=document.createElement("textarea");A.id=A.name=r;A.value=typeof q[r]=="string"?q[r]:_.serialize(q[r],function(c){return c!==undefined});e.appendChild(A)}}}}if(B.method=="POST"&&x){e.enctype="multipart/form-data";if(e.encoding){e.encoding=e.enctype}}document.body.appendChild(e);e.submit();if(d.length){_.arr.each(d,function(k,c){if(c=xui.getObject(k.id)){if(c["xui.UIProfile"]&&c.boxing()&&c.boxing().setUploadObj){c.boxing().setUploadObj(k.file)}}})}A=e=null;if(B.timeout>0){B._flag=_.asyRun(function(){if(B&&!B._end){B._time()}},B.timeout)}},_clear:function(){var x=this,k=x.node,m=x.form,r=x.constructor,u=window,g=document.createElement("div"),h=x.id,l=r._pool;if(l[h]){l[h].length=0;delete l[h]}if(k&&u.postMessage){if(u.removeEventListener){u.removeEventListener("message",x._msgcb,false)}else{u.detachEvent("onmessage",x._msgcb)}x._msgcb=null}else{if(xui.browser.gek&&k){try{k.onload=null;var q=k.contentWindow.document;q.write(" ");q.close()}catch(p){}}}x.form=x.node=x.frm=null;if(k){g.appendChild(k.parentNode.removeChild(k))}if(m){g.appendChild(m.parentNode.removeChild(m))}g.innerHTML="";if(_.isEmpty(l)){r._id=1}m=g=null}},Static:{$asFunction:1,method:"POST",_pool:{},_o:function(f){var c=this,d=c._pool[f],e=d[d.length-1];_.tryF(e._onload)},_getDummy:function(l){l=l||window;var q=this,k,c,p=l.document,u=xui.ini,r=xui.browser,m=q.isCrossDomain;if(q.dummy){return q.dummy}if(u.dummy){return q.dummy=u.dummy}if(!m(u.path)){if(!p.getElementById("xui:img:bg")){c=p.createElement("img");c.id="xui:img:bg";c.src=u.img_bg;c.style.display="none";p.body.appendChild(c);c=null}}if(c=p.getElementById("xui:img:bg")){return q.dummy=c.src.split("#")[0]}else{k=p.getElementsByTagName("img");for(var h=0,g=k.length;h<g;h++){c=k[h];if(c.src&&!m(c.src)){return q.dummy=c.src.split("#")[0]}}if(r.gek){k=p.getElementsByTagName("link");for(var h=0,g=k.length;h<g;h++){c=k[h];if(c.rel=="stylesheet"&&!m(c.href)){return q.dummy=c.href.split("#")[0]}}}}try{if(l!=l.parent){if((l=l.parent)&&!m(""+l.document.location.href)){return q._getDummy(l)}}}catch(n){}return"/favicon.ico"},customQS:function(g){var f=this,h=f.constructor,e=h.callback,d=window;g[e]="window.name";if(window.postMessage){g[e]=g.parentDomain=d.location.origin||(d.location.protocol+"//"+d.location.hostname+(d.location.port?":"+d.location.port:""))}else{g[e]="window.name"}return g}}});new function(){xui.SAjax=xui.JSONP;xui.IAjax=xui.XDMI};Class("xui.SC",null,{Constructor:function(l,k,g,f,m,e){var h=arguments.callee.upper;if(h){h.call(this)}h=null;var d=xui.$cache.SC,c;if(c=d[l]||(d[l]=_.get(window,l.split(".")))){_.tryF(k,[l,null,f],c)}else{m=m||{};m.$cb=k;if(g){m.threadid=f}c=d[l]=xui.SC._call(l||"",m,g,e)}return c},Static:{$asFunction:1,__gc:function(c){xui.$cache.SC={}},get:function(d,c){return _.get(c||window,(d||"").replace(/\]$/g,"").split(/[\[\]\.]+/))},_call:function(w,x,n,e){n=!!n;var h,q,c,g,m=[],u=xui.SC.get,k=xui.$cache.snipScript,l=function(B,C,A){var f=this,r,y=this.uri;if(B){if(!u(w)){if(f.$p){(f.$cache||k)[f.$tag]=B}else{try{_.exec(B,w)}catch(z){throw z.name+": "+z.message+" "+f.$tag}}}}r=Class._last;Class._ignoreNSCache=Class._last=null;_.tryF(f.$cb,[f.$tag,B,A],u(w)||r||{});if(!u(w)&&r&&r.KEY!=w){_.asyRun(function(){throw"'"+w+"' doesn't in '"+y+"'. The last class '"+r.KEY+"' was triggered."})}},d=function(r){var f=this;_.tryF(f.$cb,[null,null,f.threadid],f)};if(e||!(c=u(w))){if(!e&&(q=k[w])){n=false;l.call({$cb:x.$cb},q);delete k[w]}if(e||!(c=u(w))){x=x||{};g=xui.getPath(w,".js","js",x);x.$tag=w;Class._ignoreNSCache=1;Class._last=null;var p;if(n&&!x.$p){x.rspType="script";p=xui.JSONP}else{x.asy=n;p=xui.Ajax}p(g,xui.$rand+"="+_.rand(),l,d,null,x).start();if(!n){c=u(w)}}}else{if(x.$cb){l.call(x)}}return c},loadSnips:function(k,d,m,c,f,q,h){if(!k||!k.length){_.tryF(c,[f]);return}var n={},q=_.merge(q||{},{$p:1,$cache:d||xui.$cache.snipScript});for(var g=0,e=k.length;g<e;g++){n[k[g]]=1}if(m||c){q.$cb=function(l){if(m){_.tryF(m,arguments,this)}delete n[l||this.$tag];if(_.isEmpty(n)){_.tryF(c,[f]);c=null;xui.Thread.resume(f)}}}xui.Thread.suspend(f);for(var g=0,p;p=k[g++];){this._call(p,_.merge({$tag:p},q,h),true)}},runInBG:function(g,h,k,c){var e=0,d,l,m=this,f=function(n){while(g.length>e&&(l=m.get(d=g[e++]))){}if(!l){m._call(d,{threadid:n},true)}if(g.length<e){xui.Thread(n).abort()}if(g.length==e){e++}};xui.Thread(null,[f],1000,h,k,c,true).start()},execSnips:function(c){var d,f=c||xui.$cache.snipScript;for(d in f){try{_.exec(f[d],d)}catch(g){throw g}}f={}},groupCall:function(g,f,k,h,e,c){if(g){var d=this;d.execSnips();xui.Thread.suspend(h);d.loadSnips(g,0,k,function(){d.execSnips();_.tryF(f,[h]);f=null;xui.Thread.resume(h)},null,e,c)}else{_.tryF(f,[h])}}}});Class("xui.absBox",null,{Constructor:function(){var c=arguments.callee.upper;if(c){c.call(this)}c=null;this._nodes=[];this.Class=this.constructor},Before:function(d){var c=xui.absBox;if(c){(c=c.$type)[d.replace("xui.","")]=c[d]=d}},Instance:{__gc:function(){this.each(function(c){_.tryF(c.__gc)});this._nodes=0},_get:function(c){var d=this._nodes;return _.isNumb(c)?d[c]:d},_empty:function(){this._nodes.length=0;return this},get:function(c){return this._get(c)},size:function(){return this._nodes.length},_each:function(d,h,k){var e=this,f=e._nodes,c=f.length,g,m;if(k){for(g=c;g>=0;g--){if(m=f[g]){if(false===d.call(h||e,m,g)){break}}}}else{for(g=0;g<c;g++){if(m=f[g]){if(false===d.call(h||e,m,g)){break}}}}m=null;return e},each:function(c,d,e){return this._each(c,d,e)},isEmpty:function(){return !this._nodes.length},merge:function(g){if(this==xui.win||this==xui.doc||this==xui("body")){return this}var d=this,k=d.constructor,g=g._nodes,f=0,e,h=d._nodes;if(g.length){for(;e=g[f++];){h[h.length]=e}d._nodes=k._unique(h)}return d},reBoxing:function(f,c){var d=this,e=xui.absBox.$type[f||"Dom"];if(!e){return xui.UI.pack([])}if(e==d.KEY){return d}if(e=xui.SC(e)){return e.pack(d._nodes,c)}}},Static:{$abstract:true,$type:{},pack:function(c,d){var e=new this(false);e._nodes=!c?[]:d===false?_.isArr(c)?c:[c]:typeof this._ensureValues=="function"?this._ensureValues(c):_.isArr(c)?c:[c];e.n0=e._nodes[0];return e},_unique:function(c){var n={},e=[],m=0,d=c.length,g,f;for(;m<d;m++){e[m]=c[m]}c.length=0;m=0;for(;g=e[m++];){f=typeof g=="string"?g:g.$xid;if(!n[f]){n[f]=1;c.push(g)}}return c},plugIn:function(d,c){this.prototype[d]=c;return this}}});Class("xui.absProfile",null,{Constructor:function(){var c=arguments.callee.upper;if(c){c.call(this)}c=null;if(!this.$xid){this.$xid=xui.absProfile.$xid.next()}},Instance:{getId:function(){return this.$xid},link:function(e,f,d,c){return xui.absProfile.prototype.$link(this,e,f,d,c)},$link:function(c,g,h,f,d){var e="$"+c.$xid;f=f||c;if(g[e]){c.unLink(h)}g[e]=f;if(_.isArr(g)){_.arr.insertAny(g,f,d,true)}c._links[h]=g;return c},unLink:function(c){return xui.absProfile.prototype.$unLink(this,c)},$unLink:function(c,g){var f,d,e="$"+c.$xid;if(!c._links){return}if(!(f=c._links[g])){return}if(_.isArr(f)){d=_.arr.indexOf(f,f[e]);if(d!=-1){_.arr.removeFrom(f,d)}}delete f[e];delete c._links[g];return d},unLinkAll:function(){return xui.absProfile.prototype.$unLinkAll(this)},$unLinkAll:function(d){var g="$"+d.$xid,c=d._links,f,e;for(e in c){f=c[e];if(_.isArr(f)){_.arr.removeValue(f,f[g])}delete f[g]}d._links={};return d},getModule:function(e){var d=this,f=function(h){if(h.moduleClass&&h.moduleXid){var g=xui.SC.get(h.moduleClass);if(g&&(g=g.getInstance(h.moduleXid))){return f(g)}}return h},c;if(d.moduleClass&&d.moduleXid){if(c=xui.SC.get(d.moduleClass)){if(c=c.getInstance(d.moduleXid)){return e?f(c):c}}}},getParent:function(){return this.parent&&this.parent.boxing()},getChildrenId:function(){return this.childrenId}},Static:{$xid:new _.id,$abstract:true}});Class("xui.Profile","xui.absProfile",{Constructor:function(l,h,d,c,f,m,n){var g=arguments.callee.upper,e=_.toArr(arguments);g.apply(this,e);g=null;var k=this;_.merge(k,n);k.key=h||k.key||"";k.alias=d||k.alias||"",k.properties=f?_.copy(f):(k.properties||{});k.events=m?_.copy(m):(k.events||{});k.host=l||k.host||k;k.Class=k.constructor;k.box=c||k.box;if(k.events){k.setEvents(k.events);delete k.events}k._links={}},Instance:{setEvents:function(d,e){var c=this.box.$EventHandlers;if(_.isHash(d)){return _.merge(this,d,"all",function(g,f){return c[f]})}else{if(c[d]){this[d]=e}}},getEvents:function(e){if(e){return this[e]}else{var c=this,d,f={};_.each(c.box.$EventHandlers,function(h,g){if(c[g]){f[g]=c[g]}});return f}},getProperties:function(c){if(this._getProperties){this.properties=this._getProperties()}var d=this.properties;return c?d[c]:_.copy(d)},setProperties:function(c,d){if(_.isHash(c)){_.merge(c,this.box.$DataStruct,function(f,e){if(!(e in c)){c[e]=_.isObj(f)?_.clone(f):f}});this.properties=c}else{this.properties[c]=d}if(this.propSetAction){this.propSetAction(this.properties)}},_applySetAction:function(c,d){return c.call(this,d)},__gc:function(){var c=this;if(c.$beforeDestroy){_.each(c.$beforeDestroy,function(e){_.tryF(e,[],c)});delete c.$beforeDestroy}_.tryF(c.$ondestory,[],c);if(c.onDestroy){c.boxing().onDestroy()}if(c.destroyTrigger){c.destroyTrigger()}var d;if(c.alias&&c.host&&(d=c.host[c.alias])&&(d=d._nodes)&&(d.length===0||d.length===1&&d[0]==c)){delete c.host[c.alias]}c.unLinkAll();_.tryF(c.clearCache,[],c);var d=_.get(c,["box","_namePool"]);if(d){delete d[c.alias]}c.destroyed=true;if(c.$afterDestroy){_.each(c.$afterDestroy,function(e){_.tryF(e,[],c)});delete c.$afterDestroy}if(c.afterDestroy){c.boxing().afterDestroy(c)}_.breakO([c.properties,c.events,c],2);c.destroyed=true},boxing:function(){var c=this,d;if(!c.box){return null}if(!((d=c.Instace)&&d.get(0)==c&&d._nodes.length==1)){d=c.Instace=c.box.pack([c],false)}return d},serialize:function(l,q){var m,n=this,g=(m=n.box._beforeSerialized)?m(n):n,d={alias:g.alias,key:g.key,host:g.host};if(d.host===n){delete d.host}else{if(g.host&&!q){if(l!==false){d.host="@this"}else{delete d.host}}}var k={},f=g.box.$DataStruct,e=xui.absObj.$specialChars;_.merge(k,g.properties,function(p,c){return(c in f)&&f[c]!==p&&!e[c.charAt(0)]});if(!_.isEmpty(k)){d.properties=k}if(!_.isEmpty(m=this.getEvents())){d.events=m}var h=g.box.$EventHandlers;_.filter(d.events,function(p,c){return p!=h[c]});if(_.isEmpty(d.events)){delete d.events}return l===false?d:_.serialize(d)}}});Class("xui.absObj","xui.absBox",{Constructor:function(){var d=arguments.callee.upper,c=_.toArr(arguments);d.apply(this,c);d=null;if(c[0]!==false&&typeof this._ini=="function"){return this._ini.apply(this,c)}},Before:function(d,c,e){xui.absBox.$type[d]=d;return true},After:function(){var z=this,p=arguments.callee,x,y,f,w,d,h,g,e,r,c,q;z._nameId=0;z._namePool={};z._nameTag=z.$nameTag||(z.KEY.replace(/\./g,"_").toLowerCase());z._cache=[];d=p.a1||(p.a1=_.toArr("$Keys,$DataStruct,$EventHandlers,$DataModel"));for(g=0;r=d[g++];){f={};if((y=z.$parent)&&(h=y.length)){while(h--){_.merge(f,y[h][r])}}z[r]=f}z.setDataModel(z.DataModel);delete z.DataModel;z.setEventHandlers(z.EventHandlers);delete z.EventHandlers;d=p.a5||(p.a5=_.toArr("RenderTrigger,LayoutTrigger"));for(g=0;r=d[g++];){x=[];if((y=z.$parent)&&(e=y.length)){for(h=0;h<e;h++){w=y[h];if(w=w["$"+r]){x.push.apply(x,w)}}}if(z[r]){x.push(z[r])}_.arr.stableSort(x,function(k,l){k=k.$order||0;l=l.$order||0;return k>l?1:k==l?0:-1});z["$"+r]=x;delete z[r]}},Static:{$abstract:true,$specialChars:{_:1,$:1},DataModel:{tag:"",name:"",desc:"",tagVar:{ini:{}},propBinder:{hidden:1,ini:{}},dataBinder:{ini:"",set:function(d){var c=this,f=c.properties,e=f.dataBinder;if(e){xui.DataBinder._unBind(e,c)}f.dataBinder=d;xui.DataBinder._bind(d,c)}},dataField:{ini:""}},get:function(c){return this.pack([this._cache[c||0]])},getAll:function(){return this.pack(this._cache)},pickAlias:function(){return xui.absObj.$pickAlias(this)},$pickAlias:function(d){var e,f=d._namePool,c=d._nameTag;while(f[e=(c+(++d._nameId))]){}return e},setDataModel:function(l){var x=this,u=xui.absObj.$specialChars,g=x.$DataStruct,q=x.$DataModel,d=x.prototype,p,k,w,e,f,h,c;for(p in l){if(!q[p]){q[p]={}}e=l[p];if(null===e||undefined===e){c=_.str.initial(p);delete g[p];delete q[p];if(d[k="get"+c]&&d[k].$auto$){delete d[k]}if(d[k="set"+c]&&d[k].$auto$){delete d[k]}}else{w=typeof e;if(w!="object"||e.constructor!=Object){e={ini:e}}g[p]=("ini" in e)?e.ini:(p in g)?g[p]:"";w=q[p];for(k in w){if(!(k in e)){e[k]=w[k]}}q[p]=e}}_.each(l,function(y,n){if(null===y||undefined===y||u[n.charAt(0)]){return}c=_.str.initial(n);f="set"+c;if(y.set!==null&&!(y&&(y.readonly||y.inner))){var m=y.set;h=d[f];d[f]=(typeof m!="function"&&typeof h=="function")?h:Class._fun(function(C,B,z,A){return this.each(function(E){if(!E.properties){return}if(E.properties[n]===C&&!B){return}if(E.$beforePropSet&&false===E.$beforePropSet(n,C,B,z,A)){return}else{var F=E.properties[n];if(E.beforePropertyChanged&&false===E.boxing().beforePropertyChanged(E,n,C,F)){return}if(typeof m=="function"){m.call(E,C,B,z,A)}else{var D=_.get(E.box.$DataModel,[n,"action"]);E.properties[n]=C;if(typeof D=="function"&&E._applySetAction(D,C,F,B,z,A)===false){E.properties[n]=F}}if(E.afterPropertyChanged){E.boxing().afterPropertyChanged(E,n,C,F)}if(E.$afterPropertyChanged){_.tryF(E.$afterPropertyChanged,[E,n,C,F],E)}}})},f,x.KEY,null,"instance");if(d[f]!==h){d[f].$auto$=1}}else{delete d[f]}f="get"+c;if(!(y&&y.inner)){var r=y.get;h=d[f];d[f]=(typeof r!="function"&&typeof h=="function")?h:Class._fun(function(){if(typeof r=="function"){return r.apply(this.get(0),arguments)}else{return this.get(0).properties[n]}},f,x.KEY,null,"instance");if(d[f]!==h){d[f].$auto$=1}}else{delete d[f]}});return x},setEventHandlers:function(d){var c=this;_.each(d,function(h,e){if(null===h){delete c.$EventHandlers[e];delete c.prototype[e]}else{c.$EventHandlers[e]=h;var g=function(w){var p=arguments.length;if(p==1&&(typeof w=="function"||typeof w=="string"||_.isHash(w)||_.isArr(w))){return this.each(function(l){if(l.renderId){l.clearCache()}if(l.box._addEventHanlder){l.box._addEventHanlder(l,e,w)}l[e]=w})}else{if(p==1&&null===w){return this.each(function(l){l.clearCache();if(l.box._removeEventHanlder){l.box._removeEventHanlder(l,e,l[e])}delete l[e]})}else{var u=[],x=this.get(0);if(x){var A=x[e],z=x.host||x,q,k,f;if(A&&(!_.isArr(A)||A.length)){if(x.$inDesign){return}if(arguments[0]!=x){u[0]=x}for(q=0;q<p;q++){u[u.length]=arguments[q]}x.$lastEvent=e;if(!_.isArr(A)){A=[A]}p=A.length;if(_.isNumb(q=A[0].event)){u[q]=xui.Event.getEventPara(u[q])}var y={};var m=0,w=function(n){if(_.isStr(this)){y[this+""]=n||""}for(q=m;q<p;q++){m=q+1;k=A[q];if(typeof k=="string"){k=z[k]}if(typeof k=="function"){f=_.tryF(k,u,z)}else{if(_.isHash(k)){if("onOK" in k||"onKO" in k){var l=function(B,r){if(w){w.apply(B,r)}};if("onOK" in k){onOK=(k.params||(k.params=[]))[parseInt(k.onOK,10)||0]=function(){l("okData",arguments)}}if("onKO" in k){(k.params||(k.params=[]))[parseInt(k.onKO,10)||0]=function(){l("koData",arguments)}}if(false===(f=xui.pseudocode.exec(k,u,z,y,l))){m=y=w=null}break}else{if(false===(f=xui.pseudocode.exec(k,u,z,y))){m=q;break}}}}}if(m==q){m=y=w=null}return f};return w()}}}}};g.$event$=1;g.$original$=h.$original$||c.KEY;g.$name$=e;g.$type$="event";c.plugIn(e,g)}});return c},unserialize:function(e,g){if(typeof e=="string"){e=_.unserialize(e)}var d=function(f){if(_.isArr(f)){f=f[0]}delete f.serialId;if(f.children){_.arr.each(f.children,d)}},c=[];_.arr.each(e,function(f){if(!g){d(f)}c.push((new (xui.SC(f.key))(f)).get(0))});return this.pack(c,false)}},Instance:{clone:function(){var c=[],e=arguments,d=function(g){delete g.alias;for(var f=0;f<e.length;f++){delete g[e[f]]}if(g.children){for(var f=0,h;h=g.children[f];f++){d(h[0])}}};this.each(function(f){f=f.serialize(false,true);d(f);c.push(f)});return this.constructor.unserialize(c)},serialize:function(d,e){var c=[];this.each(function(f){c[c.length]=f.serialize(false,e)});return d===false?c:c.length==1?" new "+c[0].key+"("+_.serialize(c[0])+")":"xui.UI.unserialize("+_.serialize(c)+")"},getProperties:function(d){var e={},f=this.get(0),l=f.properties,g;if(d===true){return _.copy(l)}else{if(typeof d=="string"){return l[d]}else{for(var c in l){g="get"+_.str.initial(c);if(typeof this[g]=="function"){e[c]=this[g].call(this)}}return e}}},setProperties:function(c,f,e){if(typeof c=="string"){var d={};d[c]=f;c=d}return this.each(function(g){_.each(c,function(l,h){var n="set"+_.str.initial(h),m=g.boxing();if(m&&typeof m[n]=="function"){m[n].call(m,l,!!e)}else{g.properties[h]=l}})})},getEvents:function(c){return this.get(0).getEvents(c)},setEvents:function(c,e){if(typeof c=="string"){var d={};d[c]=e;c=d}return this.each(function(g){var f=g.boxing();_.each(c,function(l,h){if(typeof f[h]=="function"){f[h].call(f,l)}})})},alias:function(c){return c?this.setAlias(c):this.getAlias()},host:function(d,c){return d?this.setHost(d,c):this.getHost()},setHost:function(d,c){return this._setHostAlias(d,c)},_setHostAlias:function(g,f){var d=this,h=this.get(0),c=h.alias;f=f||h.alias;if(c){if(h.host&&h.host!==h){try{delete h.host[c]}catch(k){h.host[c]=undefined}if(h.host._ctrlpool){delete h.host._ctrlpool[c]}}delete d.constructor._namePool[c]}d.constructor._namePool[h.alias=f]=1;if(h.box&&h.box._syncAlias){h.box._syncAlias(h,c,f)}if(g){h.host=g}if(h.host&&h.host!==h){h.host[f]=d;if(h.host._ctrlpool){h.host._ctrlpool[f]=d.get(0)}}return d},setAlias:function(c){return this._setHostAlias(null,c)},getAlias:function(){return this.get(0).alias},getHost:function(){return this.get(0).host},reBindProp:function(h,p){var l=this,d,f,m,c,k=function(){l.each(function(e){d=e.properties;if(d.propBinder&&!_.isEmpty(d.propBinder)){f=e.boxing();_.each(d.propBinder,function(q,r){if(_.isFun(q)){c=q(e);if(r=="CA"){f.setCustomAttr(c)}else{if(r=="CC"){f.setCustomClass(c)}else{if(r=="CS"){f.setCustomStyle(c)}else{if(_.isFun(f[m="set"+_.str.initial(r)])){f[m](c,true)}}}}}})}})};if(!p){var n;if(window.get){n=get}window.get=function(e){return xui.SC.get(e,h)};try{k()}catch(g){}finally{window.get=n}}else{k()}return this}}});Class("xui.Timer","xui.absObj",{Instance:{_ini:function(g,m,l){var n=this,h=n.constructor,d,p,f,k;if(g&&g["xui.Profile"]){d=g;f=d.alias||h.pickAlias()}else{if(g&&g.key&&xui.absBox.$type[g.key]){p=g;g=null;f=p.alias;f=h.pickAlias()}else{f=h.pickAlias()}d=new xui.Profile(l,n.$key,f,h,g,m,p)}d._n=d._n||[];for(var e in (k=h.$DataStruct)){if(!(e in d.properties)){d.properties[e]=typeof k[e]=="object"?_.copy(k[e]):k[e]}}d.link(h._cache,"self").link(xui._pool,"xui");n._nodes.push(d);d.Instace=n;n.n0=d;_.asyRun(function(){if(d&&d.box){d.boxing().start()}});return n},destroy:function(){this.each(function(c){if(c._threadid){xui.Thread(c._threadid).abort()}c.__gc()})},start:function(){return this.each(function(d){if(d.$inDesign){return}var f=d.properties,e=d.boxing(),c=xui.Thread.repeat(function(g){if(d.onTime&&false===e.onTime(d,g)){return false}},f.interval,function(g){d.onStart&&e.onStart(d,g)},function(g){d.onEnd&&e.onEnd(d,g)});d._threadid=c.id})},suspend:function(){return this.each(function(c){if(c._threadid){xui.Thread(c._threadid).suspend()}c.onSuspend&&box.onSuspend(c,threadId)})},getParent:function(){return this.parent&&this.parent.boxing()},getChildrenId:function(){return this.childrenId}},Static:{_objectProp:{tagVar:1,propBinder:1},_beforeSerialized:function(d){var f={};_.merge(f,d,"all");var e=f.properties=_.clone(d.properties,true);if(d.box._objectProp){for(var c in d.box._objectProp){if((c in e)&&e[c]&&_.isHash(e[c])&&_.isEmpty(e[c])){delete e[c]}}}return f},DataModel:{interval:1000},EventHandlers:{onTime:function(c,d){},onStart:function(c,d){},onSuspend:function(c,d){},onEnd:function(c,d){}}}});Class("xui.APICaller","xui.absObj",{Instance:{_ini:function(g,n,m){var p=this,h=p.constructor,d,q,k=h._namePool,f,l;if(g&&g["xui.Profile"]){d=g;f=d.alias||h.pickAlias()}else{if(g&&g.key&&xui.absBox.$type[g.key]){q=g;g=null;f=q.alias;f=(f&&!k[f])?f:h.pickAlias()}else{f=h.pickAlias()}d=new xui.Profile(m,p.$key,f,h,g,n,q)}k[f]=1;d._n=d._n||[];for(var e in (l=h.$DataStruct)){if(!(e in d.properties)){d.properties[e]=typeof l[e]=="object"?_.copy(l[e]):l[e]}}d.link(h._cache,"self").link(xui._pool,"xui");p._nodes.push(d);d.Instace=p;p.n0=d;if(!d.name){p.setName(f)}return p},destroy:function(){this.each(function(d){var e=d.box,c=d.properties.name;delete e._pool[c];d.__gc()})},setHost:function(e,d){var c=this;if(e&&d){c.setName(d)}return arguments.callee.upper.apply(c,arguments)},invoke:function(B,k,l,L,h,u,w){var N=this,f=N.constructor,E=N.get(0),p=E.properties;var D=p.responseType,J=p.requestType,r=p.requestId,m=p.queryURL,A=p.proxyType.toLowerCase(),z=p.queryUserName,n=p.queryPasswrod,Q=_.copy(p.queryArgs),c=p.oAuth2Token,q=_.copy(p.queryOptions),y=_.copy(p.queryHeader),x=p.requestDataSource,P=p.responseDataTarget;m=xui.adjustVar(m);if(A=="sajax"){A="jsonp"}else{if(A=="iajax"){A="xdmi"}}if(J=="FORM"||J=="JSON"){Q=typeof Q=="string"?_.unserialize(Q):Q}if(!Q){Q={}}if(p.avoidCache){var O=0,M="_rand_";while(Q.hasOwnProperty(M)){M="_rand_"+ ++O}Q[M]=_.rand()}if(x&&x.length){for(var O in x){var K=x[O],I;switch(K.type){case"databinder":if(I=xui.DataBinder.getFromName(K.name)){if(!I.updateDataFromUI()){return}else{if(K.path){_.set(Q,K.path.split("."),I.getData())}else{_.merge(Q,I.getData(),"without")}}}break;case"form":if((I=_.get(E,["host",K.name]))&&I.Class["xui.absContainer"]&&I.getRootNode()){if(!I.checkValid()||!I.checkRequired()){return}else{if(K.path){_.set(Q,K.path.split("."),I.getFormValues())}else{_.merge(Q,I.getFormValues(),"without")}}}break}}}if(E.beforeInvoke&&false===E.boxing().beforeInvoke(E,r)){return}var e={header:{}};if(!_.isEmpty(y)){_.merge(e.header,y)}if(q.header&&!_.isEmpty(q.header)){_.merge(e.header,q.header);delete q.header}if(D=="SOAP"||J=="SOAP"){if(!f.WDSLCache){f.WDSLCache={}}if(!f.WDSLCache[m]){var H=xui.SOAP.getWsdl(m,function(S){if(E.afterInvoke){E.boxing().afterInvoke(E,S,r||this.uid)}if(E.onError){E.boxing().onError(E,S)}_.tryF(k,arguments,this);_.tryF(L,arguments,this)});if(H){f.WDSLCache[m]=H}else{return}}}switch(D){case"TEXT":e.rspType="text";case"JSON":e.rspType="json";break;case"XML":A="ajax";e.rspType="xml";break;case"SOAP":A="ajax";e.rspType="xml";var F=xui.SOAP.getNameSpace(f.WDSLCache[m]),d=((F.lastIndexOf("/")!=F.length-1)?F+"/":F)+(Q.methodName||"");e.header.SOAPAction=d;break}switch(J){case"FORM":Q=typeof Q=="string"?_.unserialize(Q):Q;break;case"JSON":e.reqType="json";if(p.queryMethod=="auto"){e.method="POST"}Q=typeof Q=="string"?Q:_.serialize(Q);break;case"XML":e.reqType="xml";A="ajax";e.method="POST";if(z&&queryPassword){e.username=z;e.password=queryPassword;e.header.Authorization="Basic "+f._toBase64(z+":"+queryPassword)}Q=typeof Q=="string"?Q:xui.XMLRPC.wrapRequest(Q);break;case"SOAP":e.reqType="xml";A="ajax";e.method="POST";if(z&&queryPassword){e.username=z;e.password=queryPassword;e.header.Authorization="Basic "+f._toBase64(z+":"+queryPassword)}Q=typeof Q=="string"?Q:xui.SOAP.wrapRequest(Q,f.WDSLCache[m]);break}if(c){e.header.Authorization="Bearer "+c}if(A!="ajax"){e.asy=true}if(A=="jsonp"){e.method="GET"}w=w||{};if(!("asy" in w)){w.asy=!!p.queryAsync}if(!("method" in w)&&p.queryMethod!="auto"){w.method=p.queryMethod}if(!("onEnd" in w)){w.onEnd=L}if(!("onStart" in w)){w.onStart=l}_.merge(w,q);_.merge(w,e,"all");w.proxyType=A;if(_.isEmpty(w.header)){delete w.header}var R=xui.APICaller.Mocker;if(R){var g=Q.replace(R.remoteSericeURL,"").replace(/^[/]+/,"").replace(/[/]+$/,"");if((R.blacklist&&!R.blacklist[g])||(R.whitelist&&R.whitelist[g])){m=R.mockerURL.replace(/[/]+$/,"")+"/"+g}}var G={},I;if(!_.isEmpty(p.fakeCookies)){w.$onStart=function(){_.each(p.fakeCookies,function(T,S){if(_.isSet(I=xui.Cookies.get(S))){G[S]=I;xui.Cookies.remove(S)}});xui.Cookies.set(p.fakeCookies,1,"/")}}if(!_.isEmpty(p.fakeCookies)){w.$onEnd=function(){_.each(p.fakeCookies,function(T,S){xui.Cookies.remove(S)});xui.Cookies.set(G)}}var C=xui._getrpc(m,Q,w).apply(null,[m,Q,function(T){var S;if(!_.isHash(T)&&!_.isStr(T)){if(D=="XML"){T=xui.XMLRPC.parseResponse(T)}else{if(D=="SOAP"){T=xui.SOAP.parseResponse(T,Q.methodName,f.WDSLCache[m])}}}if(E.afterInvoke){S=E.boxing().afterInvoke(E,T,r||this.uid);if(_.isSet(S)){T=S}S=null}if(P&&P.length){_.arr.each(P,function(W){var V=W.path?_.get(T,W.path.split(".")):T,U;switch(W.type){case"alert":V=_.stringify(V);if(xui.Coder){V=xui.Coder.formatText(V)}alert(V);break;case"log":xui.log(V);break;case"databinder":if(U=xui.DataBinder.getFromName(W.name)){U.setData(V).updateDataToUI()}break;case"form":if((U=_.get(E,["host",W.name]))&&U.Class["xui.absContainer"]&&U.getRootNode()){U.setFormValues(V)}break}})}if(E.onData){E.boxing().onData(E,T,r||this.uid)}_.tryF(B,arguments,this)},function(S){if(E.afterInvoke){E.boxing().afterInvoke(E,S,r||this.uid)}if(P&&P.length){_.arr.each(P,function(U,T){switch(U.type){case"alert":S=_.stringify(S);if(xui.Coder){S=xui.Coder.formatText(S)}alert(S);break;case"log":xui.log(S);break}})}if(E.onError){E.boxing().onError(E,S,r||this.uid)}_.tryF(k,arguments,this)},u,w]);if(h=="quiet"){C.start()}else{if(h=="return"){return C}else{_.observableRun(function(S){C.threadid=S;C.start()})}}}},Static:{WDSLCache:{},$nameTag:"api_",_pool:{},_objectProp:{tagVar:1,propBinder:1,queryArgs:1,queryHeader:1,queryOptions:1,fakeCookies:1,requestDataSource:1,responseDataTarget:1},destroyAll:function(){this.pack(_.toArr(this._pool,false),false).destroy();this._pool={}},getFromName:function(c){var d=this._pool[c];return d&&d.boxing()},_toBase64:function(n){var c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",h=[],g=0,f,e,d,p,m,l,k;do{f=n.charCodeAt(g++);e=n.charCodeAt(g++);d=n.charCodeAt(g++);p=f>>2;m=((f&3)<<4)|(e>>4);l=((e&15)<<2)|(d>>6);k=d&63;if(isNaN(e)){l=k=64}else{if(isNaN(d)){k=64}}h.push(c.charAt(p)+c.charAt(m)+c.charAt(l)+c.charAt(k))}while(g<n.length);return h.join("")},_beforeSerialized:function(d){var f={};_.merge(f,d,"all");var e=f.properties=_.clone(d.properties,true);for(var c in d.box._objectProp){if((c in e)&&e[c]&&(_.isHash(e[c])||_.isArr(e[c]))&&_.isEmpty(e[c])){delete e[c]}}return f},DataModel:{dataBinder:null,dataField:null,requestId:"",queryAsync:true,queryURL:"",avoidCache:true,oAuth2Token:"",queryUserName:"",queryPassword:"",queryMethod:{ini:"auto",listbox:["auto","GET","POST","PUT","DELETE"]},requestType:{ini:"FORM",listbox:["FORM","JSON","XML","SOAP"]},responseType:{ini:"JSON",listbox:["JSON","TEXT","XML","SOAP"]},requestDataSource:{ini:[]},responseDataTarget:{ini:[]},queryArgs:{ini:{}},queryHeader:{ini:{}},queryOptions:{ini:{}},fakeCookies:{ini:{}},proxyType:{ini:"auto",listbox:["auto","AJAX","JSONP","XDMI"]},name:{set:function(h){var l=this,k=l.properties.name,m=l.box,d=m._pool,e=d[k],f=d[h],g;d[l.properties.name=h]=l;if(f&&!e){l._n=f._n}if(e){delete d[k]}}},proxyInvoker:{inner:true,trigger:function(){var d=this.get(0),c=d.properties.responseDataTarget;d.properties.responseDataTarget=[];this.invoke(function(e){d.properties.responseDataTarget=c;e=_.stringify(e);if(xui.Coder){e=xui.Coder.formatText(e)}alert(e)},function(e){d.properties.responseDataTarget=c;e=_.stringify(e);if(xui.Coder){e=xui.Coder.formatText(e)}alert(e)})}}},EventHandlers:{beforeInvoke:function(c,d){},afterInvoke:function(d,c,e){},onData:function(d,c,e){},onError:function(d,c,e){}}}});Class("xui.DataBinder","xui.absObj",{Instance:{_ini:function(g,n,m){var p=this,h=p.constructor,d,q,k=h._namePool,f,l;if(g&&g["xui.Profile"]){d=g;f=d.alias||h.pickAlias()}else{if(g&&g.key&&xui.absBox.$type[g.key]){q=g;g=null;f=q.alias;f=(f&&!k[f])?f:h.pickAlias()}else{f=h.pickAlias()}d=new xui.Profile(m,p.$key,f,h,g,n,q)}k[f]=1;d._n=d._n||[];for(var e in (l=h.$DataStruct)){if(!(e in d.properties)){d.properties[e]=typeof l[e]=="object"?_.copy(l[e]):l[e]}}d.link(h._cache,"self").link(xui._pool,"xui");p._nodes.push(d);d.Instace=p;p.n0=d;if(!d.name){p.setName(f)}return p},destroy:function(){this.each(function(d){var e=d.box,c=d.properties.name;_.arr.each(d._n,function(f){if(f){e._unBind(c,f)}});delete e._pool[c];d.__gc()})},setHost:function(e,d){var c=this;if(e&&d){c.setName(d)}return arguments.callee.upper.apply(c,arguments)},isDirtied:function(){var d=this.constructor._getBoundElems(this.get(0));for(var f=0,c=d.length;f<c;f++){var g=d[f],e;if(g.box["xui.absValue"]){e=g.boxing();if((e.getUIValue()+" ")!==(e.getValue()+" ")){return true}}}return false},checkValid:function(d){var c=true;xui.absValue.pack(this.constructor._getBoundElems(this.get(0)),false).each(function(e){if(!e.boxing().checkValid()){if(!d){if(!e.beforeInputAlert||false!==e.boxing().prf.beforeInputAlert(profile,e,"invalid")){xui.alert("$inline.invalid",xui.getRes("$inline.invalid")+(e.properties.labelCaption?(" : "+e.properties.labelCaption):""),function(){if(e&&e.renderId){e.boxing().activate()}})}return c=false}c=false}});return c},checkRequired:function(d){var c=true;xui.absValue.pack(this.constructor._getBoundElems(this.get(0)),false).each(function(e){if(e.properties.required&&(!(i=e.boxing().getUIValue()))&&i!==0){if(!d){if(!e.beforeInputAlert||false!==e.boxing().prf.beforeInputAlert(profile,e,"required")){xui.alert("$inline.required",xui.getRes("$inline.required")+(e.properties.labelCaption?(" : "+e.properties.labelCaption):""),function(){if(e&&e.renderId){e.boxing().activate()}})}return c=false}c=false}});return c},getUI:function(c){var d;if(!c){d=xui.UI.pack(this.constructor._getBoundElems(this.get(0)),false)}else{_.arr.each(this.constructor._getBoundElems(this.get(0)),function(e){var f=e.properties;if((f.dataField||f.name||e.alias)==c){d=e.boxing();return false}})}return d},getUIValue:function(g,f){var c=this,d=c.get(0),e={};_.arr.each(this.constructor._getBoundElems(d),function(l){if(!l.box["xui.absValue"]){return}var m=l.properties,h=l.boxing(),k=h.getUIValue();if(!f||(k+" ")!==(h.getValue()+" ")){if(g&&h.getCaption){e[m.dataField||m.name||l.alias]={value:k,caption:h.getCaption()}}else{e[m.dataField||m.name||l.alias]=k}}});return e},getDirtied:function(c){return this.getUIValue(c,true)},getData:function(d,g,c){var f=this.get(0);if(f.$inDesign||g){f.properties.data={};this.updateDataFromUI(false,false,false,null,null,c,false)}var e=f.properties.data;return _.isSet(d)?e[d]:e},setData:function(c,f,e){var d=this.get(0),g=d.properties;if(c===false){_.each(g.data,function(k,h){g.data[h]=null})}else{if(!_.isSet(c)){g.data={}}else{if(_.isHash(c)){g.data=c}else{g.data[c]=f}}}if(d.$inDesign||e){this.updateDataToUI()}return this},updateValue:function(){xui.absValue.pack(this.constructor._getBoundElems(this.get(0)),false).updateValue();return this},updateDataFromUI:function(l,q,p,k,c,m,f){var n=this,g=n.get(0),e=g.properties,d={},h;if(!m){if(!n.checkValid()){return}if(!n.checkRequired()){return}}_.merge(d,e.data,function(r,u){return !c||c===u||(_.isArr(c)?_.arr.indexOf(c,u)!=-1:false)});_.arr.each(n.constructor._getBoundElems(g),function(y){var r=y.properties,A=y.box.$EventHandlers,F=r.dataField||r.name||y.alias;if(!c||c===F||(_.isArr(c)?_.arr.indexOf(c,F)!=-1:false)){var D=y.boxing(),E,u=y.box["xui.absValue"]?D.getUIValue(_.isBool(p)?p:y.__returnArray):null;if(_.isHash(d[F])){var w=d[F].properties,B=d[F].theme,x=d[F].CC,z=d[F].CA,C=d[F].CS;if(w){delete d[F].properties}if(B){delete d[F].theme}if(z){delete d[F].CA}if(x){delete d[F].CC}if(C){delete d[F].CS}_.filter(d[F],function(H,G){return !!(G in r)});if(!_.isEmpty(d[F])){_.each(d[F],function(H,G){if(G in r){d[F][G]=r[G]}})}if(_.isHash(w)){_.filter(w,function(H,G){return G in r&&!(G in d[F])});if(!_.isEmpty(w)){_.each(w,function(H,G){if(G in r){w[G]=r[G]}});d[F].properties=w}}if(B){d[F].theme=y.theme}if(z){d[F].CA=_.clone(y.CA,true)}if(x){d[F].CC=_.clone(y.CC,true)}if(C){d[F].CS=_.clone(y.CS,true)}if("caption" in r&&("caption" in d[F]||q)&&D.getCaption){if(w&&"caption" in w){w.caption=D.getCaption()}else{d[F].caption=D.getCaption()}}if(_.isSet(u)&&"value" in r){if(w&&"value" in w){w.value=u}else{d[F].value=u}}}else{if(y.box["xui.UI.ComboInput"]&&(r.type=="file"||r.type=="upload")){d[F]=y}else{if(q&&"caption" in r){E=typeof(D.getCaption)=="function"?D.getCaption():r.caption;if((!E&&!u)||E==u){d[F]=u}else{d[F]={value:u,caption:E}}}else{d[F]=u}}}if(l!==false&&y.renderId&&y.box["xui.absValue"]){D.updateValue()}}});if(k){d=_.tryF(k,[d,g],this)}if(!f&&g.afterUpdateDataFromUI){h=this.afterUpdateDataFromUI(g,d);if(_.isHash(h)){d=h}h=null}_.merge(g.properties.data,d,"all");return true},updateDataToUI:function(r,d,h){var z,g,y,u,x,l,k,n,w=this,m=w.get(0),f=m.properties,e={},q;_.merge(e,f.data,function(c,p){return !d||d===p||(_.isArr(d)?_.arr.indexOf(d,p)!=-1:false)});if(r){e=_.tryF(r,[e,m],w)}if(!h&&m.beforeUpdateDataToUI){q=w.beforeUpdateDataToUI(m,e);if(_.isHash(q)){e=q}q=null}_.arr.each(w.constructor._getBoundElems(m),function(c){g=c.properties;n=c.box.$EventHandlers;z=g.dataField||g.name||c.alias;if(!d||d===z||(_.isArr(d)?_.arr.indexOf(d,z)!=-1:false)){if(e&&z in e){y=_.clone(e[z],null,2);k=u=null;x=c.boxing();if(_.isHash(y)){if(l=y.properties){_.filter(l,function(A,p){return p in g});u=_.isSet(l.caption)?l.caption:null;k=_.isSet(l.value)?l.value:null;delete l.caption;delete l.value;if(!_.isEmpty(l)){x.setProperties(l)}delete y.properties}if(l=y.theme){if(typeof(x.setTheme)=="function"){x.setTheme(l)}delete y.theme}if(l=y.CS){if(!_.isEmpty(l)){x.setCustomStyle(l)}delete y.CS}if(l=y.CC){if(!_.isEmpty(l)){x.setCustomClass(l)}delete y.CC}if(l=y.CA){if(!_.isEmpty(l)){x.setCustomAttr(l)}delete y.CA}if(!_.isEmpty(y)){_.filter(y,function(A,p){return(p in g)||(p in y)});if(!_.isEmpty(y)){u=_.isSet(u)?u:_.isSet(y.caption)?y.caption:null;k=_.isSet(k)?k:_.isSet(y.value)?y.value:null;delete y.caption;delete y.value;if(!_.isEmpty(y)){x.setProperties(y)}}}}else{k=y}if(_.isSet(k)&&_.isFun(x.resetValue)){x.resetValue(k);c.__returnArray=_.isArr(k)}if(_.isSet(u)&&_.isFun(x.setCaption)){_.tryF(x.setCaption,[u,true],x)}}}});return w}},Static:{$nameTag:"databinder_",_pool:{},_objectProp:{tagVar:1,propBinder:1,data:1},destroyAll:function(){this.pack(_.toArr(this._pool,false),false).destroy();this._pool={}},getFromName:function(c){var d=this._pool[c];return d&&d.boxing()},_beforeSerialized:function(d){var f={};_.merge(f,d,"all");var e=f.properties=_.clone(d.properties,true);for(var c in d.box._objectProp){if((c in e)&&e[c]&&(_.isHash(e[c])||_.isArr(e[c]))&&_.isEmpty(e[c])){delete e[c]}}return f},_getBoundElems:function(d){var c=[];_.arr.each(d._n,function(e){if(e.behavior.PanelKeys){xui.absValue.pack(e.boxing().getChildren(null,true)).each(function(f){c.push(f)})}else{if(e.box["xui.absValue"]){c.push(e)}}});return _.arr.removeDuplicate(c)},_bind:function(c,d){if(!c){return}var e=this._pool[c];if(!e){b=new xui.DataBinder();b.setName(c);e=b.get(0)}if(d){if(_.arr.indexOf(e._n,d)==-1){d.link(e._n,"databinder."+c)}}},_unBind:function(c,d){if(d&&d.box&&this._pool[c]){d.unLink("databinder."+c)}},DataModel:{dataBinder:null,dataField:null,name:{set:function(n){var e=this,q=e.properties.name,k=e.box,d=k._pool,h=d[q],p=d[n],m;d[e.properties.name=n]=e;if(h&&!p&&e._n.length){for(var g=0,f=e._n.length;g<f;g++){_.set(e._n[g],["properties","dataBinder"],n)}}if(p&&!h){e._n=p._n}if(h){delete d[q]}}},data:{ini:{}}},EventHandlers:{beforeInputAlert:function(e,c,d){},beforeUpdateDataToUI:function(d,c){},afterUpdateDataFromUI:function(d,c){}}}});(xui.Locale.en||(xui.Locale.en={})).inline={$_$:1,ok:"O K",cancel:"Cancel",set:"SET",today:"Today",now:"Now",yes:"Yes",no:"No",noFlash:"No Flash PlugIn!",transparent:"transparent",required:"There is required field need to be filled out",invalid:"There is invalid field"};xui.Locale.en.date={WEEKS:{"0":"Su","1":"Mo","2":"Tu","3":"We","4":"Th","5":"Fr","6":"Sa","7":"WK"},VIEWS:{"10 ms":"10 millisecond","100 ms":"100 milliseconds","1 s":"1 second","10 s":"10 seconds","1 n":"1 minute","5 n":"5 minutes","10 n":"10 minutes","30 n":"30 minutes","1 h":"1 hour","2 h":"2 hours","6 h":"6 hours","1 d":"1 day","1 w":"1 week","15 d":"15 days","1 m":"1 month","1 q":"1 quarter","1 y":"1 year","1 de":"10 years","1 c":"1 century"},MONTHS:{"1":"Jan.","2":"Feb.","3":"Mar.","4":"Apr.","5":"May.","6":"Jun.","7":"Jul.","8":"Aug.","9":"Sep.","10":"Oct.","11":"Nov.","12":"Dec."},MS:"ms",S:"s",N:"n",H:"h",D:"d",W:"w",M:"m",Q:"q",Y:"y",DE:"de",C:"c",HN:function(e,d,c){return(d.length==1?"0":"")+d+":"+(c.length==1?"0":"")+c},DHN:function(g,e,d,f){return e+"th "+(d.length==1?"0":"")+d+":"+(f.length==1?"0":"")+f},MDHN:function(k,f,e,h,g){return e+"th "+xui.getRes("date.MONTHS."+f)+" "+(h.length==1?"0":"")+h+":"+(g.length==1?"0":"")+g},HNS:function(g,e,d,f){return(e.length==1?"0":"")+e+":"+(d.length==1?"0":"")+d+":"+(f.length==1?"0":"")+f},HNSMS:function(k,f,e,h,g){return(f.length==1?"0":"")+f+":"+(e.length==1?"0":"")+e+":"+(h.length==1?"0":"")+h+" "+(g.length==1?"00":g.length==2?"0":"")+g},YM:function(e,d,c){return xui.getRes("date.MONTHS."+c)+" "+d},YQ:function(e,d,c){return c+"Q "+d},YMD:function(g,e,d,f){return e+"-"+(d.length==1?"0":"")+d+"-"+(f.length==1?"0":"")+f},YMD2:function(g,e,d,f){return xui.getRes("date.MONTHS."+d)+" "+f+", "+e},MD:function(e,d,c){return xui.getRes("date.MONTHS."+d)+" "+c},YMDH:function(k,f,e,h,g){return f+"-"+(e.length==1?"0":"")+e+"-"+(h.length==1?"0":"")+h+" "+(g.length==1?"0":"")+g+":00"},YMDHN:function(m,g,f,l,k,h){return g+"-"+(f.length==1?"0":"")+f+"-"+(l.length==1?"0":"")+l+" "+(k.length==1?"0":"")+k+":"+(h.length==1?"0":"")+h},YMDHNS:function(q,h,g,p,m,l,k){return h+"-"+(g.length==1?"0":"")+g+"-"+(p.length==1?"0":"")+p+" "+(m.length==1?"0":"")+m+":"+(l.length==1?"0":"")+l+":"+(k.length==1?"0":"")+k},ALL:function(u,k,h,r,q,p,m,l){return k+"-"+(h.length==1?"0":"")+h+"-"+(r.length==1?"0":"")+r+" "+(q.length==1?"0":"")+q+":"+(p.length==1?"0":"")+p+":"+(m.length==1?"0":"")+m+" "+(l.length==1?"00":l.length==2?"0":"")+l}};xui.Locale.en.color={LIST:{FFFFFF:"White",FFFFF0:"Ivory",FFFFE0:"Light Yellow",FFFF00:"Yellow",FFFAFA:"Snow",FFFAF0:"Floral White",FFFACD:"Lemon Chiffon",FFF8DC:"Cornislk",FFF5EE:"Sea Shell",FFF0F5:"Lavender Blush",FFEFD5:"Papaya Whip",FFEBCD:"Blanched Almond",FFE4E1:"Misty Rose",FFE4C4:"Bisque",FFE4B5:"Moccasin",FFDEAD:"Navajo White",FFDAB9:"Peach Puff",FFD700:"Gold",FFC0CB:"Pink","FFB6C1 ":"Light Pink",FFA500:"Orange",FFA07A:"Light Salmon",FF8C00:"Dark Orange",FF7F50:"Coral",FF69B4:"Hot Pink",FF6347:"Tomato",FF4500:"Orange Red",FF1493:"Deep Pink",FF00FF:"Magenta",FF00FF:"Fuchsia",FF0000:"Red",FDF5E6:"Old Lace",FAFAD2:"Light Goldenrod Yellow",FAF0E6:"Linen",FAEBD7:"Antique White",FA8072:"Salmon",F8F8FF:"Ghost White",F5FFFA:"Medium Spring Green",F5F5F5:"White Smoke",F5DEB3:"Wheat",F4A460:"Sandy Brown",F0FFFF:"Azure",F0FFF0:"Honeydew",F0F8FF:"Alice Blue",F0E68C:"Khaki",F08080:"Light Coral",EEE8AA:"Pale Godenrod",EE82EE:"Violet",E9967A:"Dark Salmon",E6E6FA:"Lavender",E1FFFF:"Light Cyan",DEB887:"Bruly Wood",DDA0DD:"plum",DCDCDC:"Gainsboro",DC143C:"Crimson",DB7093:"Pale Violet Red",DAA520:"Gold Enrod",DA70D6:"Orchid",D8BFD8:"Thistle",D3D3D3:"Light Grey",D2B48C:"Tan",D2691E:"Chocolate",CD853F:"Peru",CD5C5C:"Indian Red",C71585:"Medium Violet Red",C0C0C0:"Silver",BDB76B:"Dark Khaki",BC8F8F:"Rosy Brown",BA55D3:"Medium Orchid",B22222:"Fire Brick",B0E0E6:"Pow Der Blue",B0C4DE:"Light Steel Blue",AFEEEE:"Pale Turquoise",ADFF2F:"Green Yellow",ADD8E6:"Light BLue",A9A9A9:"Dark Gray",A52A2A:"Brown",A0522D:"Sienna","9932CC":"Dark Orchid","98FB98":"Pale Green","9400D3":"Dark Voilet","9370DB":"Medium Purple","90EE90":"Light Green","8FBC8F":"Dark Sea Green","8B4513":"Saddle Brown","8B008B":"Dark Magenta","8B0000":"Dark Red","8A2BE2":"Blue Violet","87CEFA":"Light Sky Blue","87CEEB":"Sky Blue","808080":"Gray","808000":"Olive","800080":"Purple","800000":"Maroon","7FFFAA":"Auqamarin","7FFF00":"Chartreuse","7CFC00":"Lawn Green","7B68EE":"Medium Slate Blue","778899":"Light Slate Gray","708090":"Slate Gray","6B8E23":"Beige","6A5ACD":"Slate Blue","696969":"Dim Gray","6495ED":"Cornflower Blue","5F9EA0":"Cadet Blue","556B2F":"Olive Drab","4B0082":"Indigo","48D1CC":"Medium Turquoise","483D8B":"Dark Slate Blue","4682B4":"Steel Blue","4169E1":"Royal Blue","40E0D0":"Turquoise","3CB371":"Spring Green","32CD32":"Lime Green","2F4F4F":"Dark Slate Gray","2E8B57":"Sea Green","228B22":"Forest Green","20B2AA":"Light Sea Green","1E90FF":"Doder Blue","191970":"Midnight Blue","00FFFF":"Cyan","00FFFF":"Aqua","00FF7F":"Mint Cream","00FF00":"Lime","00FA9A":"Medium Aquamarine","00CED1":"Dark Turquoise","00BFFF":"Deep Sky Blue","008B8B":"Dark Cyan","008080":"Teal","008000":"Green","006400":"Dark Green","0000FF":"Blue","0000CD":"Medium Blue","00008B":"Dark Blue","000080":"Navy","000000":"Black"}};xui.Locale.en.editor={bold:"Bold",italic:"Italic",underline:"Underline",strikethrough:"Strikethrough",subscript:"Subscript",superscript:"Superscript",forecolor:"Font Color",bgcolor:"Background Color",left:"Align Left",center:"Align Center",right:"Align Right",justify:"Justify",indent:"Indent",outdent:"Outdent",ol:"Ordered List",ul:"Unordered List",hr:"Insert Horizontal Rule",unlink:"Remove Link",removeformat:"Remove Formatting",html:"HTML Editor",insertimage:"Insert Image",insertimage2:"Image URL:",createlink:"Insert Link",createlink2:"Link URL:",fontsize:"Font Size",fontname:"Font Family",formatblock:"Font Block",fontsizeList:"1,1(8pt);2,2(10pt);3,3(12pt);4,4(14pt);5,5(18pt);6,6(24pt);...,...",fontnameList:"Arial;Arial Black;Comic Sans MS;Courier New;Impact;Tahoma;Times New Roman;Trebuchet MS;Verdana;...",formatblockList:"p,Normal;h1,Heading1;h2,Heading2;h3,Heading3;h4,Heading4;h5,Heading5;h6,Heading6;...,..."};Class("xui.Event",null,{Constructor:function(C,z,c,E){var q=xui.Event,l=window,G=document,I=0,y,n,k=xui.DragDrop,g,x,m;if(!(C=C||l.event)||!(g=z)){g=z=null;return false}z=null;var e=C.type,J=C.$xuievent,u=C.$xuitype,A=C.$xuiall;if(e=="xuitouchdown"){e="mousedown";J=1;A=0;u="beforeMousedown"}if("mouseover"==e||"mouseout"==e){I=(k&&k._profile.isWorking)?1:2;if(I!=1&&c){g=null;return q.$FALSE}if(!q._handleMouseHover(C,g,I==1)){g=null;return q.$FALSE}if(I==1){x=k&&k._dropElement}}else{if((m=q._tabHookStack).length&&q._kb[e]&&(C.$key||C.keyCode||C.charCode)==9&&false===q._handleTabHook(q.getSrc(C),m=m[m.length-1])){g=null;return}}y=E||q.getId(g);if(m=q._getProfile(y)){if(e=="DOMMouseScroll"){e="mousewheel"}if(e=="mousedown"||e=="mousewheel"){_.tryF(xui.Dom._blurTrigger,[m,C])}else{if(e=="resize"){e="size";if(xui.browser.ie&&l===g){var l=xui.browser.contentBox&&G.documentElement.clientWidth||G.body.clientWidth,D=xui.browser.contentBox&&G.documentElement.clientHeight||G.body.clientHeight;if(m._w==l&&m._h==D){g=null;return}else{m._w=l;m._h=D}}}}var B,F,K,p=true,H=[];for(B=0;B<=2;++B){if(I==1&&B!==0&&!C.$force){break}if(I==2&&B===0){continue}K=q._type[e+B]||(q._type[e+B]=q._getEventName(e,B));if(!J||A||(K===u)){m._getEV(H,y,K,g.$xid)}}F=function(f,d){for(var r=0,h;h=arguments.callee.tasks[r++];){if(false===h(m,f,d)){return false}}return true};F.tasks=H;p=F(C,g.$xid);if(l===g&&e=="size"){_.asyRun(function(){F(C,g.$xid);F.tasks.length=0;delete F.tasks;F=g=null},150)}if(k){if(e=="drag"){k._onDrag=F}else{if(e=="dragover"){k._onDragover=F}}}else{if(e!=="size"){F.tasks.length=0;delete F.tasks;F=null}}if(I==1){if("mouseover"==e&&k._dropElement==g.$xid&&x&&x!=g.$xid){n=xui.use(x).get(0);q({type:"mouseout",target:n,$xui:true,$xuitype:"beforeMouseout",preventDefault:function(d){xui.Event.stopDefault(d)},stopPropagation:function(d){xui.Event.stopBubble(d)}},n);k.setDropElement(g.$xid)}if("mouseout"==e&&!k._dropElement&&x&&x==g.$xid){q._preDroppable=y;_.asyRun(function(){delete xui.Event._preDroppable})}if(g.$xid==k._dropElement){p=false}}if(p===false){q.stopBubble(C)}return p}},Static:{$FALSE:xui.browser.opr?undefined:false,_type:{},_kb:{keydown:1,keypress:1,keyup:1},_reg:/(-[\w]+)|([\w]+$)/g,$eventhandler:function(){return xui.Event(arguments[0],this)},$eventhandler2:function(){return xui.Event(arguments[0],this,1)},$eventhandler3:function(){return xui.Event(arguments[0],xui.Event.getSrc(arguments[0]||window.event))},$lastMouseupTime:0,$dblcInterval:500,$lastClickFunMark:0,_events:("mouseover,mouseout,mousedown,mouseup,mousemove,mousewheel,click,dblclick,contextmenu,keydown,keypress,keyup,scroll,blur,focus,load,unload,beforeunload,abort,change,select,submit,reset,error,move,size,dragbegin,drag,dragstop,dragleave,dragenter,dragover,drop,touchstart,touchmove,touchend,touchcancel,mspointerdown,mspointermove,mspointerup,mspointercancel,pointerdown,pointermove,pointerup,pointercancel").split(","),simulateEvent:function(e,d,c,f){c=c||{};if(e[0]){e=e[0]}_.tryF(xui.Event.$eventsforSimulation[f||d],[e,d,c])},_getEventName:function(c,d){return(c=this._map1[c])&&((d===0||d==1||d==2)?c[d]:c)},_getProfile:function(e,d,c){return e&&(typeof e=="string")&&((d=(c=xui.$cache.profileMap)[e])?d["xui.UIProfile"]?d:(c=c[e.replace(this._reg,"")])?c:d:c[e.replace(this._reg,"")])},_handleTabHook:function(g,f){if(g===document){return true}var e=g,d,c=e.tabIndex;do{if(xui.getId(e)==f[0]){e=g=null;return true}}while(e&&(e=e.parentNode)&&e!==document&&e!==window);d=_.tryF(f[1],[f[0],c],g);e=g=null;return false},_handleMouseHover:function(c,g,l){if(g==document){g=null;return true}var e=(c.type=="mouseover"?c.fromElement:c.toElement)||c.relatedTarget;if(l&&c.type=="mouseover"&&this._preDroppable){try{do{if(e&&e.id&&e.id==this._preDroppable){g=e=null;return true}}while(e&&(e=e.parentNode)&&e!==document&&e!==window)}catch(k){}}if(xui.browser.gek){try{do{if(e==g){g=e=null;return false}}while(e&&(e=e.parentNode))}catch(k){var h=this.getPos(c),e=xui([g]),d=e.offset(),m=e.cssSize(),f=(h.left<d.left||h.left>d.left+m.width||h.top<d.top||h.top>d.top+m.height);g=e=null;return c.type=="mouseover"?!f:f}}else{do{if(e==g){g=e=null;return false}}while(e&&(e=e.parentNode))}g=e=null;return true},_tabHookStack:[],pushTabOutTrigger:function(d,c){this._tabHookStack.push([xui(d)._nodes[0],c]);return this},popTabOutTrigger:function(c){if(c){this._tabHookStack=[]}else{this._tabHookStack.pop()}return this},getSrc:function(d){var c;return((c=d.target||d.srcElement||null)&&xui.browser.kde&&c.nodeType==3)?c.parentNode:c},getId:function(c){return window===c?"!window":document===c?"!document":c.id},getBtn:function(c){return xui.browser.ie?c.button==4?"middle":c.button==2?"right":"left":c.which==2?"middle":c.which==3?"right":"left"},getPos:function(h){h=h||window.event;if(xui.browser.isTouch&&h.changedTouches&&h.changedTouches[0]){h=h.changedTouches[0]}if("pageX" in h){return{left:h.pageX,top:h.pageY}}else{var l=document,k=l.documentElement,c=l.body,f,e=(_.isSet(f=k&&k.scrollLeft)?f:_.isSet(f=c&&c.scrollLeft)?f:0)-(_.isSet(f=k.clientLeft)?f:0),g=(_.isSet(f=k&&k.scrollTop)?f:_.isSet(f=c&&c.scrollTop)?f:0)-(_.isSet(f=k.clientTop)?f:0);return{left:h.clientX+e,top:h.clientY+g}}},getKey:function(c){c=c||window.event;var h=[],p,e=c.$key||c.keyCode||c.charCode||0;if(typeof e=="string"){h[0]=e}else{var n=String.fromCharCode(e),m=c.type;if((m=="keypress"&&e>=33&&e<=128)||((e>=48&&e<=57)||(e>=65&&e<=90))){h[0]=n}else{if(!(p=arguments.callee.map)){p=arguments.callee.map={};var e,g=("3,enter,8,backspace,9,tab,12,numlock,13,enter,19,pause,20,capslock,27,esc,32, ,33,pageup,34,pagedown,35,end,36,home,37,left,38,up,39,right,40,down,44,printscreen,45,insert,46,delete,50,down,52,left,54,right,56,up,91,win,92,win,93,apps,96,0,97,1,98,2,99,3,100,4,101,5,102,6,103,7,104,8,105,9,106,*,107,+,109,-,110,.,111,/,112,f1,113,f2,114,f3,115,f4,116,f5,117,f6,118,f7,119,f8,120,f9,121,f10,122,f11,123,f12,144,numlock,145,scroll,186,;,187,=,189,-,190,.,191,/,192,`,219,[,220,\\,221,],222,',224,meta,63289,numlock,63276,pageup,63277,pagedown,63275,end,63273,home,63234,left,63232,up,63235,right,63233,down,63272,delete,63302,insert,63236,f1,63237,f2,63238,f3,63239,f4,63240,f5,63241,f6,63242,f7,63243,f8,63244,f9,63245,f10,63246,f11,63247,f12,63248,print").split(",");for(var f=1,d=g.length;f<d;f=f+2){p[g[f-1]]=g[f]}g.length=0;p[188]=","}h[0]=p[e]||n}}if((c.modifiers)?(c.modifiers&Event.CONTROL_MASK):(c.ctrlKey||c.ctrlLeft||e==17||e==57391)){if(e==17||e==57391){h[0]=""}h.push("1")}else{h.push("")}if((c.modifiers)?(c.modifiers&Event.SHIFT_MASK):(c.shiftKey||c.shiftLeft||e==16||e==57390)){if(e==16||e==57390){h[0]=""}h.push("1")}else{h.push("")}if((c.modifiers)?false:(c.altKey||c.altLeft||e==18||e==57388)){if(e==18||e==57388){h[0]=""}h.push("1")}else{h.push("")}h[0]=h[0];h.key=h[0];h.keyCode=e;h.type=m;h.ctrlKey=!!h[1];h.shiftKey=!!h[2];h.altKey=!!h[3];if(m=="keypress"){if(this.$keydownchar&&this.$keydownchar.length>1){h.key=this.$keydownchar}}else{if(m=="keydown"){if(h[0].length>1){this.$keydownchar=h[0]}else{if(this.$keydownchar){this.$keydownchar=null}}}else{if(m=="keyup"){if(this.$keydownchar){this.$keydownchar=null}}}}return h},getEventPara:function(k,c){if(!c){c=xui.Event.getPos(k)}var g=this.getKey(k),e=this.getBtn(k),f={button:e,pageX:c&&c.left,pageY:c&&c.top,key:g.key,keyCode:g.keyCode,ctrlKey:g.ctrlKey,shiftKey:g.shiftKey,altKey:g.altKey};for(var d in k){if(d.charAt(0)=="$"){f[d]=k[d]}}return f},stopBubble:function(c){c=c||window.event;if(c.stopPropagation){c.stopPropagation()}if("cancelBubble" in c){c.cancelBubble=true}this.stopDefault(c)},stopDefault:function(c){c=c||window.event;if(c.preventDefault){c.preventDefault()}else{if("returnValue" in c){c.returnValue=false}}},keyboardHook:function(m,c,e,g,l,h,q,n){if(m){var d=xui.$cache.hookKey,f=(m||"").toLowerCase()+":"+(c?"1":"")+":"+(e?"1":"")+":"+(g?"1":"");if(typeof l!="function"){delete d[f]}else{d[f]=[l,h,q,n]}}return this},keyboardHookUp:function(m,c,e,g,l,h,q,n){if(m){var d=xui.$cache.hookKeyUp,f=(m||"").toLowerCase()+":"+(c?"1":"")+":"+(e?"1":"")+":"+(g?"1":"");if(typeof l!="function"){delete d[f]}else{d[f]=[l,h,q,n]}}return this},getWheelDelta:function(c){return c.wheelDelta?c.wheelDelta/120:-c.detail/3},$TAGNAMES:{select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"},_supportCache:{},isSupported:function(d,g){var f=this,k=f._supportCache,h=(g?g.tagName.toLowerCase():"div")+":"+d;if(h in k){return k[h]}g=g||document.createElement(f.$TAGNAMES[d]||"div");d="on"+d;var e=(d in g);if(!e){if(!g.setAttribute){g=document.createElement("div")}if(g.setAttribute){g.setAttribute(d,"");e=typeof g[d]=="function";if(typeof g[d]!="undefined"){g[d]=undefined}g.removeAttribute(d)}}g=null;return k[h]=e},_simulateMousedown:function(c){if(!c.touches){return true}var d=xui.Event,e=c.changedTouches,f=e[0];if(c.touches.length>1){return true}d.__simulatedMousedownNode=f.target;if(!d.isSupported("mousedown")){d.simulateEvent(f.target,"mousedown",{screenX:f.screenX,screenY:f.screenY,clientX:f.clientX,clientY:f.clientY})}else{d._xuitouchdowntime=_.setTimeout(function(){d._xuitouchdowntime=0;d.simulateEvent(f.target,"xuitouchdown",{screenX:f.screenX,screenY:f.screenY,clientX:f.clientX,clientY:f.clientY},"mousedown")},100)}return true},_simulateMouseup:function(e){if(!e.touches){return true}var f=xui.Event,d=(new Date).getTime(),c=d-f.$lastMouseupTime,g=e.changedTouches,h=g[0];if(f._xuitouchdowntime){_.clearTimeout(f._xuitouchdowntime)}f.__simulatedMouseupNode=h.target;if(!f.isSupported("mouseup")){f.simulateEvent(h.target,"mouseup",{screenX:h.screenX,screenY:h.screenY,clientX:h.clientX,clientY:h.clientY})}if(f.__simulatedMouseupNode===f.__simulatedMousedownNode){if(!f.isSupported("click")){f.simulateEvent(h.target,"click",{screenX:h.screenX,screenY:h.screenY,clientX:h.clientX,clientY:h.clientY})}if(c<=f.$dblcInterval){_.asyRun(function(){f.$lastMouseupTime=0;f.simulateEvent(h.target,"dblclick",{screenX:h.screenX,screenY:h.screenY,clientX:h.clientX,clientY:h.clientY})})}}f.__simulatedMouseupNode=f.__simulatedMousedownNode=null;f.$lastMouseupTime=d;return true},stopPageTouchmove:function(){document.addEventListener((xui.browser.ie&&xui.browser.ver>=11)?"pointermove":(xui.browser.ie&&xui.browser.ver>=10)?"MSPointerMove":"touchmove",function(c){c.preventDefault()})}},Initialize:function(){var p=this,q=window,m=document,r={move:null,size:null,drag:null,dragstop:null,dragover:null,mousewheel:null,dragbegin:"onmousedown",dragenter:"onmouseover",dragleave:"onmouseout",drop:"onmouseup"},e=["before","on","after"],k,h,u;k=p._map1={};_.arr.each(p._events,function(d){u=_.str.initial(d);k[d]=[e[0]+u,e[1]+u,e[2]+u]});k=p._eventMap={};h=p._eventHandler={};_.arr.each(p._events,function(d){u=_.str.initial(d);k[d]=k[e[1]+d]=k[e[0]+u]=k[e[1]+u]=k[e[2]+u]=d;h[d]=h[e[1]+d]=h[e[0]+u]=h[e[1]+u]=h[e[2]+u]=(d in r)?r[d]:("on"+d)});q.onresize=p.$eventhandler;if(q.addEventListener){q.addEventListener("DOMMouseScroll",p.$eventhandler3,false)}if(xui.browser.isTouch){if(m.addEventListener){m.addEventListener((xui.browser.ie&&xui.browser.ver>=11)?"pointerdown":(xui.browser.ie&&xui.browser.ver>=10)?"MSPointerDown":"touchstart",p._simulateMousedown,false);m.addEventListener((xui.browser.ie&&xui.browser.ver>=11)?"pointerup":(xui.browser.ie&&xui.browser.ver>=10)?"MSPointerUp":"touchend",p._simulateMouseup,false);m.addEventListener("xuitouchdown",p.$eventhandler,false)}else{if(m.attachEvent){m.attachEvent((xui.browser.ie&&xui.browser.ver>=11)?"pointerdown":(xui.browser.ie&&xui.browser.ver>=10)?"MSPointerDown":"touchstart",p._simulateMousedown);m.attachEvent((xui.browser.ie&&xui.browser.ver>=11)?"pointerup":(xui.browser.ie&&xui.browser.ver>=10)?"MSPointerUp":"touchend",p._simulateMouseup);m.attachEvent("xuitouchdown",p.$eventhandler)}}}m.onmousewheel=q.onmousewheel=p.$eventhandler3;var l=function(A,F,J){switch(F){case"textevent":F="keypress";break;case"keyup":case"keydown":case"keypress":break}_.merge(J,{bubbles:true,cancelable:true,view:q,ctrlKey:false,altKey:false,shiftKey:false,metaKey:false,keyCode:0,charCode:0},"without");var z=J.bubbles,x=J.cancelable,G=J.view,w=J.ctrlKey,d=J.altKey,E=J.shiftKey,C=J.metaKey,I=J.keyCode,H=J.charCode;var D=null;if(m.createEvent){try{D=m.createEvent("KeyEvents");D.initKeyEvent(F,z,x,G,w,d,E,C,I,H)}catch(B){try{D=m.createEvent("Events")}catch(y){D=m.createEvent("UIEvents")}finally{D.initEvent(F,z,x);D.view=G;D.altKey=d;D.ctrlKey=w;D.shiftKey=E;D.metaKey=C;D.keyCode=I;D.charCode=H}}A.dispatchEvent(D)}else{if(m.createEventObject){D=m.createEventObject();D.bubbles=z;D.cancelable=x;D.view=G;D.ctrlKey=w;D.altKey=d;D.shiftKey=E;D.metaKey=C;D.keyCode=(H>0)?H:I;A.fireEvent("on"+F,D)}else{throw F+" cant be simulated in "+navigator.userAgent}}},c=function(K,B,A){A=A||{};_.merge(A,{bubbles:true,cancelable:true,view:q,detail:1,ctrlKey:false,altKey:false,shiftKey:false,metaKey:false,screenX:0,screenY:0,clientX:0,clientY:0,button:0,relatedTarget:null},"without");var D=A.bubbles,L=A.cancelable,F=A.view,J=A.detail,y=A.ctrlKey,x=A.altKey,G=A.shiftKey,z=A.metaKey,d=A.screenX,M=A.screenY,I=A.clientX,H=A.clientY,w=A.button,C=A.relatedTarget;var E=null;if(m.createEvent){E=m.createEvent("MouseEvents");if(E.initMouseEvent){E.initMouseEvent(B,D,L,F,J,d,M,I,H,y,x,G,z,w,C)}else{E=m.createEvent("UIEvents");E.initEvent(B,D,L);E.view=F;E.detail=J;E.screenX=d;E.screenY=M;E.clientX=I;E.clientY=H;E.ctrlKey=y;E.altKey=x;E.metaKey=z;E.shiftKey=G;E.button=w;E.relatedTarget=C}if(C&&!E.relatedTarget){if(B==="mouseout"){E.toElement=C}else{if(B==="mouseover"){E.fromElement=C}}}K.dispatchEvent(E)}else{if(m.createEventObject){E=m.createEventObject();E.bubbles=D;E.cancelable=L;E.view=F;E.detail=J;E.screenX=d;E.screenY=M;E.clientX=I;E.clientY=H;E.ctrlKey=y;E.altKey=x;E.metaKey=z;E.shiftKey=G;switch(w){case 0:E.button=1;break;case 1:E.button=4;break;case 2:break;default:E.button=0}E.relatedTarget=C;K.fireEvent("on"+B,E)}else{throw B+" cant be simulated in "+navigator.userAgent}}},g=function(C,B,y){_.merge(y,{bubbles:true,cancelable:(B==="submit"),view:q,detail:1},"without");var x=y.bubbles,w=y.cancelable,d=y.view,A=y.detail;var z=null;if(m.createEvent){z=m.createEvent("UIEvents");z.initUIEvent(B,x,w,d,A);C.dispatchEvent(z)}else{if(m.createEventObject){z=m.createEventObject();z.bubbles=x;z.cancelable=w;z.view=d;z.detail=A;C.fireEvent("on"+B,z)}else{throw B+" cant be simulated in "+navigator.userAgent}}},n=function(B,F,I){_.merge(I,{bubbles:true,cancelable:true,detail:2,view:q,ctrlKey:false,altKey:false,shiftKey:false,metaKey:false,scale:1,rotation:0},"without");var z=I.bubbles,x=I.cancelable,A=I.detail,G=I.view,w=I.ctrlKey,d=I.altKey,E=I.shiftKey,C=I.metaKey,y=I.scale,H=I.rotation;var D;D=m.createEvent("GestureEvent");D.initGestureEvent(F,z,x,G,A,screenX,screenY,clientX,clientY,w,d,E,C,B,y,H);B.dispatchEvent(D)},f=function(M,B,z){if(B==="touchstart"||B==="touchmove"){if(!z.touches||!z.touches.length){throw"No touch object in touches."}}else{if(B==="touchend"){if(!z.changedTouches||!z.changedTouches.length){throw"No touch object in changedTouches."}}}_.merge(z,{bubbles:true,cancelable:(B!=="touchcancel"),detail:1,view:q,ctrlKey:false,altKey:false,shiftKey:false,metaKey:false,screenX:0,screenY:0,clientX:0,clientY:0,scale:1,rotation:0},"without");var C=z.bubbles,O=z.cancelable,L=z.detail,E=z.view,N=z.scale,J=z.rotation,F=z.touches,K=z.targetTouches,A=z.changedTouches,x=z.ctrlKey,w=z.altKey,G=z.shiftKey,y=z.metaKey,d=z.screenX,P=z.screenY,I=z.clientX,H=z.clientY,O=B=="touchcancel"?false:z.cancelable;var D;if(m.createEvent){if(xui.browser.isAndroid){if(xui.browser.ver<4){D=m.createEvent("MouseEvents");D.initMouseEvent(B,C,O,E,L,d,P,I,H,x,w,G,y,0,M);D.touches=F;D.targetTouches=K;D.changedTouches=A}else{D=m.createEvent("TouchEvent");D.initTouchEvent(F,K,A,B,E,d,P,I,H,x,w,G,y)}}else{if(xui.browser.isIOS){if(xui.browser.ver>=2){D=m.createEvent("TouchEvent");D.initTouchEvent(B,C,O,E,L,d,P,I,H,x,w,G,y,F,K,A,N,J)}else{throw B+" cant be simulated in "+navigator.userAgent}}else{throw B+" cant be simulated in "+navigator.userAgent}}M.dispatchEvent(D)}else{throw B+" cant be simulated in "+navigator.userAgent}};p.$eventsforSimulation={click:c,dblclick:c,mouseover:c,mouseout:c,mouseenter:c,mouseleave:c,mousedown:c,mouseup:c,mousemove:c,pointerover:c,pointerout:c,pointerdown:c,pointerup:c,pointermove:c,MSPointerOver:c,MSPointerOut:c,MSPointerDown:c,MSPointerUp:c,MSPointerMove:c,keydown:l,keyup:l,keypress:l,submit:g,blur:g,change:g,focus:g,resize:g,scroll:g,select:g,touchstart:f,touchmove:f,touchend:f,touchcancel:f,gesturestart:n,gesturechange:n,gestureend:n}}});Class("xui.Date",null,{Initialize:function(){var f=this;f._mapKeys(f.$TIMEUNIT);var e=f._key1,c=f._key2,g=f.$UNIT={};for(var h=0,d=e.length;h<d;h++){g[e[h]]=1}for(var h=0,d=c.length;h<d;h++){g[c[h]]=1}g.w=1},Static:{_key1:"MILLISECOND,SECOND,MINUTE,HOUR,DAY,WEEK,MONTH,QUARTER,YEAR,DECADE,CENTURY".split(","),_key2:"ms,s,n,h,d,ww,m,q,y,de,c".split(","),$TIMEUNIT:{MILLISECOND:1,SECOND:1000,MINUTE:60000,HOUR:3600000,DAY:86400000,WEEK:604800000,MONTH:2592000000,QUARTER:7776000000,YEAR:31557600000,DECADE:315576000000,CENTURY:3155760000000},$TEXTFORMAT:{utciso:function(g,c,e){e=xui.Date._fix;return g.getUTCFullYear()+"-"+e(g.getUTCMonth()+1)+"-"+e(g.getUTCDate())+"T"+e(g.getUTCHours())+":"+e(g.getUTCMinutes())+":"+e(g.getUTCSeconds())+"Z"},iso:function(g,c,e){e=xui.Date._fix;return g.getFullYear()+"-"+e(g.getMonth()+1)+"-"+e(g.getDate())+"T"+e(g.getHours())+":"+e(g.getMinutes())+":"+e(g.getSeconds())},ms:function(e,c){return xui.Date._fix(e.getMilliseconds(),3)+(c?"":xui.wrapRes("date.MS"))},s:function(e,c){return e.getSeconds()+(c?"":xui.wrapRes("date.S"))},ss:function(e,c){return xui.Date._fix(e.getSeconds())+(c?"":xui.wrapRes("date.S"))},n:function(e,c){return e.getMinutes()+(c?"":xui.wrapRes("date.N"))},nn:function(e,c){return xui.Date._fix(e.getMinutes())+(c?"":xui.wrapRes("date.N"))},h:function(e,c){return e.getHours()+(c?"":xui.wrapRes("date.H"))},hh:function(e,c){return xui.Date._fix(e.getHours())+(c?"":xui.wrapRes("date.H"))},d:function(e,c){return e.getDate()+(c?"":xui.wrapRes("date.D"))},dd:function(e,c){return xui.Date._fix(e.getDate())+(c?"":xui.wrapRes("date.D"))},w:function(g,e,f){var c=(g.getDay()-f+7)%7;return e?c:xui.wrapRes("date.WEEKS."+c)},ww:function(f,c,e){return xui.Date.getWeek(f,e)+(c?"":xui.wrapRes("date.W"))},m:function(e,c){return(e.getMonth()+1)+(c?"":xui.wrapRes("date.M"))},mm:function(e,c){return xui.Date._fix(e.getMonth()+1)+(c?"":xui.wrapRes("date.M"))},q:function(e,c){return(parseInt((e.getMonth()+3)/3-1,10)+1)+(c?"":xui.wrapRes("date.Q"))},y:function(e,c){return e.getYear()+(c?"":xui.wrapRes("date.Y"))},yyyy:function(e,c){return e.getFullYear()+(c?"":xui.wrapRes("date.Y"))},de:function(e,c){return parseInt(e.getFullYear()/10,10)+(c?"":xui.wrapRes("date.DE"))},c:function(e,c){return parseInt(e.getFullYear()/100,10)+(c?"":xui.wrapRes("date.C"))},hn:function(e,c){return xui.wrapRes("date.HN-"+e.getHours()+"-"+e.getMinutes())},dhn:function(e,c){return xui.wrapRes("date.DHN-"+e.getDate()+"-"+e.getHours()+"-"+e.getMinutes())},mdhn:function(e,c){return xui.wrapRes("date.MDHN-"+(e.getMonth()+1)+"-"+e.getDate()+"-"+e.getHours()+"-"+e.getMinutes())},hns:function(e,c){return xui.wrapRes("date.HNS-"+e.getHours()+"-"+e.getMinutes()+"-"+e.getSeconds())},hnsms:function(e,c){return xui.wrapRes("date.HNSMS-"+e.getHours()+"-"+e.getMinutes()+"-"+e.getSeconds()+"-"+e.getMilliseconds())},yq:function(e,c){return xui.wrapRes("date.YQ-"+e.getFullYear()+"-"+(parseInt((e.getMonth()+3)/3-1,10)+1))},ym:function(e,c){return xui.wrapRes("date.YM-"+e.getFullYear()+"-"+(e.getMonth()+1))},md:function(e,c){return xui.wrapRes("date.MD-"+(e.getMonth()+1)+"-"+e.getDate())},ymd:function(e,c){return xui.wrapRes("date.YMD-"+e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate())},ymd2:function(e,c){return xui.wrapRes("date.YMD2-"+e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate())},ymdh:function(e,c){return xui.wrapRes("date.YMDH-"+e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate()+"-"+e.getHours())},ymdhn:function(e,c){return xui.wrapRes("date.YMDHN-"+e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate()+"-"+e.getHours()+"-"+e.getMinutes())},ymdhns:function(e,c){return xui.wrapRes("date.YMDHNS-"+e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate()+"-"+e.getHours()+"-"+e.getMinutes()+"-"+e.getSeconds())},all:function(e,c){return xui.wrapRes("date.ALL-"+e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate()+"-"+e.getHours()+"-"+e.getMinutes()+"-"+e.getSeconds()+"-"+e.getMilliseconds())}},$TIMEZONE:[{id:"Asia(East,North)",sub:[{id:"Brunei",v:"+0800"},{id:"Burma",v:"+0630"},{id:"Cambodia",v:"+0700"},{id:"China",v:"+0800"},{id:"China(HK,Macau)",v:"+0800"},{id:"China(TaiWan)",v:"+0800"},{id:"China(Urumchi)",v:"+0700"},{id:"East Timor",v:"+0800"},{id:"Indonesia",v:"+0700"},{id:"Japan",v:"+0900"},{id:"Kazakhstan(Aqtau)",v:"+0400"},{id:"Kazakhstan(Aqtobe)",v:"+0500"},{id:"Kazakhstan(Astana)",v:"+0600"},{id:"Kirghizia",v:"+0500"},{id:"Korea",v:"+0900"},{id:"Laos",v:"+0700"},{id:"Malaysia",v:"+0800"},{id:"Mongolia",v:"+0800",tag:"03L03|09L03"},{id:"Philippines",v:"+0800"},{id:"Russia(Anadyr)",v:"+1300",tag:"03L03|10L03"},{id:"Russia(Kamchatka)",v:"+1200",tag:"03L03|10L03"},{id:"Russia(Magadan)",v:"+1100",tag:"03L03|10L03"},{id:"Russia(Vladivostok)",v:"+1000",tag:"03L03|10L03"},{id:"Russia(Yakutsk)",v:"+0900",tag:"03L03|10L03"},{id:"Singapore",v:"+0800"},{id:"Thailand",v:"+0700"},{id:"Vietnam",v:"+0700"}]},{id:"Asia(South,West)",sub:[{id:"Afghanistan",v:"+0430"},{id:"Arab Emirates",v:"+0400"},{id:"Bahrain",v:"+0300"},{id:"Bangladesh",v:"+0600"},{id:"Bhutan",v:"+0600"},{id:"Cyprus",v:"+0200"},{id:"Georgia",v:"+0500"},{id:"India",v:"+0530"},{id:"Iran",v:"+0330",tag:"04 13|10 13"},{id:"Iraq",v:"+0300",tag:"04 13|10 13"},{id:"Israel",v:"+0200",tag:"04F53|09F53"},{id:"Jordan",v:"+0200"},{id:"Kuwait",v:"+0300"},{id:"Lebanon",v:"+0200",tag:"03L03|10L03"},{id:"Maldives",v:"+0500"},{id:"Nepal",v:"+0545"},{id:"Oman",v:"+0400"},{id:"Pakistan",v:"+0500"},{id:"Palestine",v:"+0200"},{id:"Qatar",v:"+0300"},{id:"Saudi Arabia",v:"+0300"},{id:"Sri Lanka",v:"+0600"},{id:"Syria",v:"+0200",tag:"04 13|10 13"},{id:"Tajikistan",v:"+0500"},{id:"Turkey",v:"+0200"},{id:"Turkmenistan",v:"+0500"},{id:"Uzbekistan",v:"+0500"},{id:"Yemen",v:"+0300"}]},{id:"North Europe",sub:[{id:"Denmark",v:"+0100",tag:"04F03|10L03"},{id:"Faroe Is.(DK)",v:"+0100"},{id:"Finland",v:"+0200",tag:"03L01|10L01"},{id:"Iceland",v:"+0000"},{id:"Jan Mayen(Norway)",v:"-0100"},{id:"Norwegian",v:"+0100"},{id:"Svalbard(NORWAY)",v:"+0100"},{id:"Sweden",v:"+0100",tag:"03L01|10L01"}]},{id:"Eastern Europe",sub:[{id:"Armenia",v:"+0400"},{id:"Austria",v:"+0100",tag:"03L01|10L01"},{id:"Azerbaijan",v:"+0400"},{id:"Belarus",v:"+0200",tag:"03L03|10L03"},{id:"Czech",v:"+0100"},{id:"Estonia",v:"+0200"},{id:"Georgia",v:"+0500"},{id:"Germany",v:"+0100",tag:"03L01|10L01"},{id:"Hungarian",v:"+0100"},{id:"Latvia",v:"+0200"},{id:"Liechtenstein",v:"+0100"},{id:"Lithuania",v:"+0200"},{id:"Moldova",v:"+0200"},{id:"Poland",v:"+0100"},{id:"Rumania",v:"+0200"},{id:"Russia(Moscow)",v:"+0300",tag:"03L03|10L03"},{id:"Slovakia",v:"+0100"},{id:"Switzerland",v:"+0100",tag:"03L01|10L01"},{id:"Ukraine",v:"+0200"},{id:"Ukraine(Simferopol)",v:"+0300"}]},{id:"Western Europe",sub:[{id:"Andorra",v:"+0100",tag:"03L01|10L01"},{id:"Belgium",v:"+0100",tag:"03L01|10L01"},{id:"Channel Is.(UK)",v:"+0000",tag:"03L01|10L01"},{id:"France",v:"+0100",tag:"03L01|10L01"},{id:"Gibraltar(UK)",v:"+0100",tag:"03L01|10L01"},{id:"Ireland",v:"+0000",tag:"03L01|10L01"},{id:"Isle of Man(UK)",v:"+0000",tag:"03L01|10L01"},{id:"Luxembourg",v:"+0100",tag:"03L01|10L01"},{id:"Monaco",v:"+0100"},{id:"Netherlands",v:"+0100",tag:"03L01|10L01"},{id:"United Kingdom",v:"+0000",tag:"03L01|10L01"}]},{id:"South Europe",sub:[{id:"Albania",v:"+0100"},{id:"Bosnia",v:"+0100"},{id:"Bulgaria",v:"+0200"},{id:"Croatia",v:"+0100"},{id:"Greece",v:"+0200",tag:"03L01|10L01"},{id:"Holy See",v:"+0100"},{id:"Italy",v:"+0100",tag:"03L01|10L01"},{id:"Macedonia",v:"+0100"},{id:"Malta",v:"+0100"},{id:"Montenegro",v:"+0100"},{id:"Portugal",v:"+0000",tag:"03L01|10L01"},{id:"San Marino",v:"+0100"},{id:"Serbia",v:"+0100"},{id:"Slovenia",v:"+0100"},{id:"Span",v:"+0100",tag:"03L01|10L01"}]},{id:"North America",sub:[{id:"Canada(AST)",v:"-0400",tag:"04F02|10L02"},{id:"Canada(CST)",v:"-0600",tag:"04F02|10L02"},{id:"Canada(EST)",v:"-0500",tag:"04F02|10L02"},{id:"Canada(MST)",v:"-0700",tag:"04F02|10L02"},{id:"Canada(NST)",v:"-0330",tag:"04F02|10L02"},{id:"Canada(PST)",v:"-0800",tag:"04F02|10L02"},{id:"Greenland(DK)",v:"-0300"},{id:"US(Central)",v:"-0600",tag:"03S02|11F02"},{id:"US(Eastern)",v:"-0500",tag:"03S02|11F02"},{id:"US(Mountain)",v:"-0700",tag:"03S02|11F02"},{id:"US(Pacific)",v:"-0800",tag:"03S02|11F02"},{id:"US(Alaska)",v:"-0900"},{id:"US(Arizona)",v:"-0700"}]},{id:"South America",sub:[{id:"Anguilla(UK)",v:"-0400"},{id:"Antigua&amp;Barbuda",v:"-0400"},{id:"Antilles(NL)",v:"-0400"},{id:"Argentina",v:"-0300"},{id:"Aruba(NL)",v:"-0400"},{id:"Bahamas",v:"-0500"},{id:"Barbados",v:"-0400"},{id:"Belize",v:"-0600"},{id:"Bolivia",v:"-0400"},{id:"Brazil(AST)",v:"-0500",tag:"10F03|02L03"},{id:"Brazil(EST)",v:"-0300",tag:"10F03|02L03"},{id:"Brazil(FST)",v:"-0200",tag:"10F03|02L03"},{id:"Brazil(WST)",v:"-0400",tag:"10F03|02L03"},{id:"British Virgin Is.(UK)",v:"-0400"},{id:"Cayman Is.(UK)",v:"-0500"},{id:"Chilean",v:"-0300",tag:"10F03|03F03"},{id:"Chilean(Hanga Roa)",v:"-0500",tag:"10F03|03F03"},{id:"Colombia",v:"-0500"},{id:"Costa Rica",v:"-0600"},{id:"Cuba",v:"-0500",tag:"04 13|10L03"},{id:"Dominican",v:"-0400"},{id:"Ecuador",v:"-0500"},{id:"El Salvador",v:"-0600"},{id:"Falklands",v:"-0300",tag:"09F03|04F03"},{id:"Grenada",v:"-0400"},{id:"Guadeloupe(FR)",v:"-0400"},{id:"Guatemala",v:"-0600"},{id:"Guiana(FR)",v:"-0300"},{id:"Guyana",v:"-0400"},{id:"Haiti",v:"-0500"},{id:"Honduras",v:"-0600"},{id:"Jamaica",v:"-0500"},{id:"Martinique(FR)",v:"-0400"},{id:"Mexico(Mazatlan)",v:"-0700"},{id:"Mexico(Tijuana)",v:"-0800"},{id:"Mexico(Mexico)",v:"-0600"},{id:"Montserrat(UK)",v:"-0400"},{id:"Nicaragua",v:"-0500"},{id:"Panama",v:"-0500"},{id:"Paraguay",v:"-0400",tag:"10F03|02L03"},{id:"Peru",v:"-0500"},{id:"Puerto Rico(US)",v:"-0400"},{id:"So. Georgia&amp;So. Sandwich Is.(UK)",v:"-0200"},{id:"St. Kitts&amp;Nevis",v:"-0400"},{id:"St. Lucia",v:"-0400"},{id:"St. Vincent&amp;Grenadines",v:"-0400"},{id:"Suriname",v:"-0300"},{id:"Trinidad&amp;Tobago",v:"-0400"},{id:"Turks&amp;Caicos Is.(UK)",v:"-0500"},{id:"Uruguay",v:"-0300"},{id:"Venezuela",v:"-0400"},{id:"Virgin Is.(US)",v:"-0400"}]},{id:"Africa(North)",sub:[{id:"Algeria",v:"+0100"},{id:"Egypt",v:"+0200",tag:"04L53|09L43"},{id:"Libyan",v:"+0200"},{id:"Morocco",v:"+0000"},{id:"Sudan",v:"+0200"},{id:"Tunisia",v:"+0100"}]},{id:"Africa(Western)",sub:[{id:"Benin",v:"+0100"},{id:"Burkina Faso",v:"+0000"},{id:"Canary Is.(SP)",v:"-0100"},{id:"Cape Verde",v:"-0100"},{id:"Chad",v:"+0100"},{id:"Gambia",v:"+0000"},{id:"Ghana",v:"+0000"},{id:"Guinea",v:"+0000"},{id:"Guinea-Bissau",v:"+0000"},{id:"Ivory Coast",v:"+0000"},{id:"Liberia",v:"+0000"},{id:"Mali",v:"+0000"},{id:"Mauritania",v:"+0000"},{id:"Niger",v:"+0100"},{id:"Nigeria",v:"+0100"},{id:"Senegal",v:"+0000"},{id:"Sierra Leone",v:"+0000"},{id:"Togo",v:"+0000"},{id:"Western Sahara",v:"+0000"}]},{id:"Africa(Central)",sub:[{id:"Cameroon",v:"+0100"},{id:"Cen.African Rep.",v:"+0100"},{id:"Congo,Democratic",v:"+0100"},{id:"Congo,Republic",v:"+0100"},{id:"Equatorial Guinea",v:"+0100"},{id:"Gabon",v:"+0100"},{id:"Sao Tome&amp;Principe",v:"+0000"}]},{id:"Africa(East)",sub:[{id:"Burundi",v:"+0200"},{id:"Comoros",v:"+0300"},{id:"Djibouti",v:"+0300"},{id:"Eritrea",v:"+0300"},{id:"Ethiopia",v:"+0300"},{id:"Kenya",v:"+0300"},{id:"Madagascar",v:"+0300"},{id:"Malawi",v:"+0200"},{id:"Mauritius",v:"+0400"},{id:"Mayotte(FR)",v:"+0300"},{id:"Mozambique",v:"+0200"},{id:"Reunion(FR)",v:"+0400"},{id:"Rwanda",v:"+0200"},{id:"Seychelles",v:"+0300"},{id:"Somalia",v:"+0300"},{id:"Tanzania",v:"+0300"},{id:"Uganda",v:"+0300"}]},{id:"Africa(South)",sub:[{id:"Angola",v:"+0100"},{id:"Botswana",v:"+0200"},{id:"Lesotho",v:"+0200"},{id:"Namibia",v:"+0200",tag:"09F03|04F03"},{id:"Saint Helena(UK)",v:"-0100"},{id:"South Africa",v:"+0200"},{id:"Swaziland",v:"+0200"},{id:"Zambia",v:"+0200"},{id:"Zimbabwe",v:"+0200"}]},{id:"Oceania",sub:[{id:"American Samoa(US)",v:"-1100"},{id:"Australia(Adelaide)",v:"+0930",sub:"10L03|03L03"},{id:"Australia(Brisbane)",v:"+1000"},{id:"Australia(Darwin)",v:"+0930"},{id:"Australia(Hobart)",v:"+1000",sub:"10L03|03L03"},{id:"Australia(Perth)",v:"+0800"},{id:"Australia(Sydney)",v:"+1000",sub:"10L03|03L03"},{id:"Cook Islands(NZ)",v:"-1000"},{id:"Eniwetok",v:"-1200"},{id:"Fiji",v:"+1200",sub:"11F03|02L03"},{id:"Guam",v:"+1000"},{id:"Hawaii(US)",v:"-1000"},{id:"Kiribati",v:"+1100"},{id:"Marshall Is.",v:"+1200"},{id:"Micronesia",v:"+1000"},{id:"Midway Is.(US)",v:"-1100"},{id:"Nauru Rep.",v:"+1200"},{id:"New Calednia(FR)",v:"+1100"},{id:"New Zealand",v:"+1200",sub:"10F03|04F63"},{id:"New Zealand(CHADT)",v:"+1245",sub:"10F03|04F63"},{id:"Niue(NZ)",v:"-1100"},{id:"Nor. Mariana Is.",v:"+1000"},{id:"Palau",v:"+0900"},{id:"Papua New Guinea",v:"+1000"},{id:"Pitcairn Is.(UK)",v:"-0830"},{id:"Polynesia(FR)",v:"-1000"},{id:"Solomon Is.",v:"+1100"},{id:"Tahiti",v:"-1000"},{id:"Tokelau(NZ)",v:"-1100"},{id:"Tonga",v:"+1300",tag:"10F63|04F63"},{id:"Tuvalu",v:"+1200"},{id:"Vanuatu",v:"+1100"},{id:"Western Samoa",v:"-1100"},{id:"Data Line",v:"-1200"}]}],_mapKeys:function(h){var e=this,g=e._key2,c=e._key1;for(var f=0,d=c.length;f<d;f++){h[g[f]]=h[c[f]]}},_validUnit:function(c){return this.$UNIT[c]?c:"d"},_date:function(c,d){return _.isDate(c)?c:((c||c===0)&&isFinite(c))?new Date(parseInt(c,10)):_.isDate(d)?d:new Date},_isNumb:function(c){return typeof c=="number"&&isFinite(c)},_numb:function(c,d){return this._isNumb(c)?c:this._isNumb(d)?d:0},_timeZone:-((new Date).getTimezoneOffset()/60),get:function(e,f,d){var c=this;e=c._date(e);f=c._validUnit(f);d=c._numb(d);var g=arguments.callee.map||(arguments.callee.map={ms:function(h){return h.getMilliseconds()},s:function(h){return h.getSeconds()},n:function(h){return h.getMinutes()},h:function(h){return h.getHours()},d:function(h){return h.getDate()},ww:function(k,h){return xui.Date.getWeek(k,h)},w:function(k,h){return(7+k.getDay()-h)%7},m:function(h){return h.getMonth()},q:function(h){return parseInt((h.getMonth()+3)/3-1,10)},y:function(h){return h.getFullYear()},de:function(h){return parseInt(h.getFullYear()/10,10)},c:function(h){return parseInt(h.getFullYear()/100,10)}});return g[f](e,d)},_fix:function(f,c,e){c=c||2;e=e||"0";f+="";if(f.length<c){for(var d=f.length;d<c;d++){f=e+f}}return f},add:function(d,f,g){var c=this,e=c.$TIMEUNIT,k,h;d=c._date(d);f=c._validUnit(f);if(!(k=arguments.callee.map)){k=arguments.callee.map={MILLISECOND:function(l,m){l.setTime(l.getTime()+m*e.ms)},SECOND:function(l,m){l.setTime(l.getTime()+m*e.s)},MINUTE:function(l,m){l.setTime(l.getTime()+m*e.n)},HOUR:function(l,m){l.setTime(l.getTime()+m*e.h)},DAY:function(l,m){l.setTime(l.getTime()+m*e.d)},WEEK:function(l,m){l.setTime(l.getTime()+m*e.ww)},MONTH:function(n,p){var m=n.getDate(),l;p=n.getMonth()+p;this.YEAR(n,Math.floor(p/12));n.setMonth((p%12+12)%12);if((l=n.getDate())!=m){this.DAY(n,-l)}},QUARTER:function(l,m){this.MONTH(l,m*3)},YEAR:function(n,p){var m=n.getDate(),l;n.setFullYear(n.getFullYear()+p);if((l=n.getDate())!=m){this.DAY(n,-l)}},DECADE:function(l,m){this.YEAR(l,10*m)},CENTURY:function(l,m){this.YEAR(l,100*m)}};c._mapKeys(k)}k[f](h=new Date(d),g);return h},diff:function(f,c,h,e){var d=this;f=d._date(f);c=d._date(c);h=d._validUnit(h);e=d._numb(e);var g=d.$TIMEUNIT,k;if(!(k=arguments.callee.map)){k=arguments.callee.map={MILLISECOND:function(m,l){return l.getTime()-m.getTime()},SECOND:function(m,l){var m=d.getTimSpanStart(m,"s"),l=d.getTimSpanStart(l,"s"),n=l.getTime()-m.getTime();return n/g.s},MINUTE:function(m,l){var m=d.getTimSpanStart(m,"n"),l=d.getTimSpanStart(l,"n"),n=l.getTime()-m.getTime();return n/g.n},HOUR:function(m,l){var m=d.getTimSpanStart(m,"h"),l=d.getTimSpanStart(l,"h"),n=l.getTime()-m.getTime();return n/g.h},DAY:function(m,l){var m=d.getTimSpanStart(m,"d",1),l=d.getTimSpanStart(l,"d",1),n=l.getTime()-m.getTime();return n/g.d},WEEK:function(n,l,m){var n=d.getTimSpanStart(n,"ww",1,m),l=d.getTimSpanStart(l,"ww",1,m),p=l.getTime()-n.getTime();return p/g.ww},MONTH:function(m,l){return(l.getFullYear()-m.getFullYear())*12+(l.getMonth()-m.getMonth())},QUARTER:function(m,l){return(l.getFullYear()-m.getFullYear())*4+parseInt((l.getMonth()-m.getMonth())/3,10)},YEAR:function(m,l){return parseInt((l.getFullYear()-m.getFullYear()),10)},DECADE:function(m,l){return parseInt((l.getFullYear()-m.getFullYear())/10,10)},CENTURY:function(m,l){return parseInt((l.getFullYear()-m.getFullYear())/100,10)}};d._mapKeys(k)}return k[h](new Date(f),new Date(c),e)},getTimSpanStart:function(e,k,h,c){var n=this,l=n.$TIMEUNIT,d,m;e=n._date(e);k=n._validUnit(k);c=n._numb(c);h=n._numb(h,1);if(!(d=arguments.callee.map)){var g=function(p){p.setMilliseconds(0);p.setSeconds(0);p.setMinutes(0);p.setHours(0)},f=function(p){g(p);p.setDate(1);p.setMonth(0)};d=arguments.callee.map={MILLISECOND:function(q,r){var p=q.getMilliseconds();q.setMilliseconds(p-(p%r))},SECOND:function(q,r){q.setMilliseconds(0);var p=q.getSeconds();q.setSeconds(p-(p%r))},MINUTE:function(q,r){q.setMilliseconds(0);q.setSeconds(0);var p=q.getMinutes();q.setTime(q.getTime()-(p%r)*l.n)},HOUR:function(q,r){q.setMilliseconds(0);q.setSeconds(0);q.setMinutes(0);var p=q.getHours();q.setHours(p-(p%r))},DAY:function(q,r){g(q);var p=q.getDate();q.setDate(p-(p%r))},WEEK:function(u,w,r){g(u);var z=(u.getDay()+7-r)%7,y,p,q=new Date();u.setTime(u.getTime()-z*l.d);f(q);q.setFullYear(u.getFullYear());y=(q.getDay()+7-r)%7;q.setTime(q.getTime()-y*l.d);p=(u.getTime()-q.getTime())/l.d/7;u.setTime(u.getTime()-(p%w)*l.ww)},MONTH:function(q,r){g(q);q.setDate(1);var p=q.getMonth();q.setMonth(p-(p%r))},QUARTER:function(p,q){q=n._numb(q,1);return this.MONTH(p,q*3)},YEAR:function(q,r){f(q);var p=q.getFullYear();q.setFullYear(p-(p%r))},DECADE:function(p,q){f(p);p.setFullYear(Math.floor(p.getFullYear()/10)*10)},CENTURY:function(p,q){f(p);p.setFullYear(Math.floor(p.getFullYear()/100)*100)}};n._mapKeys(d)}d[k](m=new Date(e),h,c);return m},getTimSpanEnd:function(e,f,g,d){var c=this;e=c._date(e);f=c._validUnit(f);d=c._numb(d);g=c._numb(g,1);var k=e.getTime(),h=c.getTimSpanStart(e,f,g,d);if(h.getTime()<k){h=c.add(h,f,g)}return h},offsetTimeZone:function(e,f,d){var c=this;e=c._date(e);return new Date(e.getTime()+(d?-1:1)*(f-c._timeZone)*c.$TIMEUNIT.h)},getWeek:function(e,d){var c=this,f,g;e=c._date(e);d=c._numb(d),g=e.getFullYear();e=c.add(c.getTimSpanStart(e,"ww",1,d),"d",6);if(e.getFullYear()!=g){return 1}f=c.getTimSpanStart(e,"y",1);f=c.add(c.getTimSpanStart(f,"ww",1,d),"d",6);return c.diff(f,e,"ww")+1},parse:function(w,A){var q;if(_.isDate(w)){q=w}else{w+="";if(isFinite(w)){q=new Date(parseInt(w,10))}else{if(typeof A=="string"){var z=A.split(/[^ymdhns]+/),x=w.split(/[^0-9]+/),d={y:0,m:0,d:0,h:0,n:0,s:0,ms:0};if(z.length&&z.length===x.length){for(var k=0;k<z.length;k++){if(z[k].length){d[z[k]=="ms"?"ms":z[k].charAt(0)]=parseInt(x[k].replace(/^0*/,""),10)}}q=new Date(d.y,d.m-1,d.d,d.h,d.n,d.s,d.ms)}else{q=null}}else{var C=this,y,u=arguments.callee,g=u.dp||(u.dp={FullYear:2,Month:4,Date:6,Hours:8,Minutes:10,Seconds:12,Milliseconds:14}),p=w.match(u.iso||(u.iso=/^((-\d+|\d{4,})(-(\d{2})(-(\d{2}))?)?)?T((\d{2})(:(\d{2})(:(\d{2})(\.(\d{1,3})(\d)?\d*)?)?)?)?(([+-])(\d{2})((\d{2}))?|Z)?$/)),f=new Date(0);if(p){if(p[4]){p[4]--}if(p[15]>=5){p[14]++}y=p[16]||p[18]?"UTC":"";for(var k in g){var B=p[g[k]];if(!B){continue}f["set"+y+k](B);if(f["get"+y+k]()!=p[g[k]]){q=null}}if(p[18]){var l=Number(p[17]+p[18]),e=Number(p[17]+(p[20]||0));f.setUTCMinutes(f.getUTCMinutes()+(l*60)+e)}q=f}else{if(/^((-\d+|\d{4,})(-(\d{1,2})(-(\d{1,2}))))/.test(w)){w=w.replace(/-/g,"/")}var c=Date.parse(w);q=c?f.setTime(c)&&f:null}}}}return q===null?null:isFinite(+q)?q:null},getText:function(e,f,d){var c=this,g=c.$TEXTFORMAT;e=c._date(e);d=c._numb(d);return g[f]?g[f](e,false,d):f},format:function(e,g,d){var c=this,f=c.$TEXTFORMAT;e=c._date(e);d=c._numb(d);return g.replace(/(utciso|iso|yyyy|mm|ww|dd|hh|nn|ss|ms|de|c|y|q|m|w|d|h|n|s)/g,function(k,h){return f[h]?f[h](e,true,d):h})}}});Class("xui.CSS",null,{Static:{_r:xui.browser.ie?"rules":"cssRules",_baseid:"xui:css:base",_firstid:"xui:css:first",_lastid:"xui:css:last",_reg1:/\.(\w+)\[CLASS~="\1"\]/g,_reg2:/\[ID"([^"]+)"\]/g,_reg3:/\*([.#])/g,_reg4:/\s+/g,_reg5:/\*\|/g,_reg6:/(\s*,\s*)/g,_rep:function(d){var c=this;return d.replace(c._reg1,".$1").replace(c._reg2,"#$1").replace(c._reg3,"$1").replace(c._reg4," ").replace(c._reg5,"").replace(c._reg6,",").toLowerCase()},_appendSS:function(d,c,g){var e=document.createElement("style");e.type="text/css";if(g){e.id=g}if(xui.browser.ie&&e.styleSheet&&"cssText" in e.styleSheet){e.styleSheet.cssText=c||""}else{try{e.appendChild(document.createTextNode(c||""))}catch(f){e.styleSheet.cssText=c||""}}d.appendChild(e);return e},_createCss:function(e,h,q){var m=this,n=this._getHead(),g=m._firstid,k=m._lastid,f,l;f=document.createElement("style");f.type="text/css";f.id=e;if(h){if(xui.browser.ie&&f.styleSheet&&"cssText" in f.styleSheet){f.styleSheet.cssText=h||""}else{try{f.appendChild(document.createTextNode(h||""))}catch(d){f.styleSheet.cssText=h||""}}}if(!q){l=document.getElementById(g)||n.firstChild;while((l=l.nextSibling)&&!/^(script|link|style)$/i.test(""+l.tagName)){}if(l){n.insertBefore(f,l)}else{if(l=document.getElementById(k)){n.insertBefore(f,l)}else{n.appendChild(f)}}}else{n.appendChild(f)}return f},_getCss:function(e,c,d){return document.getElementById(e)||this._createCss(e,c,d)},_getBase:function(){return this._getCss(this._baseid)},_getFirst:function(){return this._getCss(this._firstid)},_getLast:function(){return this._getCss(this._lastid,null,true)},_getHead:function(){return this._head||(this._head=document.getElementsByTagName("head")[0]||document.documentElement)},_check:function(){if(!xui.browser.ie){return}var g=0;for(var f=this._getHead(),e=0,d=f.childNodes,c;c=d[e++];){if(c.type=="text/css"){g++}}return g>20},get:function(h,g){for(var f=this._getHead(),e=0,d=f.childNodes,c;c=d[e++];){if(c.type=="text/css"&&h in c&&c[h]==g){return c}}},addStyleSheet:function(c,m,d){var k,g=this,f=g._getHead(),h=function(n,w,q){var u=document.createElement("style");u.type="text/css";if(w){u.id=w}if(xui.browser.ie&&u.styleSheet&&"cssText" in u.styleSheet){u.styleSheet.cssText=n||""}else{try{u.appendChild(document.createTextNode(n||""))}catch(r){u.styleSheet.cssText=n||""}}if(q===-1){if(f.firstChild){f.insertBefore(u,f.firstChild)}else{f.appendChild(u)}}else{if(q===1){f.appendChild(u)}else{f.insertBefore(u,q?g._getLast():g._getBase())}}u.disabled=true;u.disabled=false;return u},l=function(n,p){var q=p?g._getLast():g._getBase();q.styleSheet.cssText+=n;return q};if(m&&(m=m.replace(/[^\w\-\_\.\:]/g,"_"))&&(k=g.get("id",m))){return k}if(g._check()){return l(c,d)}else{return h(c,m,d)}},includeLink:function(d,l,h,c){var k,g=this,f=g._getHead();if(d&&(k=g.get("href",d))){}else{k=document.createElement("link");k.type="text/css";k.rel="stylesheet";k.href=d;if(l){k.id=l}k.media="all";_.each(c,function(m,e){k.setAttribute(e,m)})}f.insertBefore(k,h?g._getBase():g._getLast());k.disabled=true;k.disabled=false;return k},remove:function(e,d){var c=this._getHead();if(d=this.get(e,d)){d.disabled=true;c.removeChild(d)}},replaceLink:function(c,n,h,d){var k=this,l=k._getHead(),g={},f,m;g[n]=d;f=k.includeLink(c,null,false,g);if(m=k.get(n,h)){l.replaceChild(f,m)}f.disabled=true;f.disabled=false},_build:function(c,f,d){var e="";_.each(f,function(h,g){e+=g.replace(/([A-Z])/g,"-$1").toLowerCase()+":"+h+";"});return d?e:c+"{"+e+"}"},setStyleRules:function(g,q,d){var p=this,x=true,f=document.styleSheets,n,k,c,u,l,m,w,r;g=_.str.trim(g.replace(/\s+/g," "));if(!(q&&d)){u=g.toLowerCase();_.arr.each(_.toArr(f),function(y){try{y[p._r]}catch(h){return}_.arr.each(_.toArr(y[p._r]),function(e,z){if(!e.selectorText){return}if(e.disabled){return}c=p._rep(e.selectorText);r=c.split(",");if(!q){x=false;if(_.arr.indexOf(r,u)!=-1&&r.length>1){r=_.arr.removeFrom(r,_.arr.indexOf(r,u)).join(",");w=e.cssText.slice(e.cssText.indexOf("{")+1,e.cssText.lastIndexOf("}"));if(y.insertRule){y.insertRule(r+"{"+w+"}",y[p._r].length)}else{if(y.addRule){y.addRule(r,w||"{}")}}if(y.deleteRule){y.deleteRule(z)}else{y.removeRule(z)}y.disabled=true;y.disabled=false}else{if(c==u){if(y.deleteRule){y.deleteRule(z)}else{y.removeRule(z)}y.disabled=true;y.disabled=false}}}else{if(c==u){n=e;return false}if(_.arr.indexOf(r,u)!=-1){k=e;return false}}},null,true);if(n){x=false;try{_.each(q,function(z,e){e=e.replace(/(-[a-z])/gi,function(A,B){return B.charAt(1).toUpperCase()});n.style[e]=typeof z=="function"?z(n.style[e]):z})}catch(h){}y.disabled=true;y.disabled=false;return false}else{if(k){x=false;y.insertRule(p._build(g,q),y[p._r].length);y.disabled=true;y.disabled=false;return false}}},null,true)}if(d||x){p._addRules(g,q)}return p},$getCSSValue:function(p,h,w){var y=this,q=y._r,f=document.styleSheets,n=f.length,g,d,z,u,r,c;p=_.str.trim(p.replace(/\s+/g," "));for(u=n-1;u>=0;u--){try{d=f[u][q]}catch(x){continue}if(!f[u].disabled){g=(d=f[u][q]).length;for(r=g-1;r>=0;r--){if((z=d[r]).selectorText&&!z.disabled){c=y._rep(z.selectorText);if(_.arr.indexOf(c.split(/\s*,\s*/g),p)!=-1){if(!w){return(z.style[h]||"").replace(/^\"|\"$/g,"")}else{if(w===z.style[h]){return f[u].ownerNode||f[u].owningElement}}}}}}}},_addRules:function(c,e){var d=this,f=d._getLast(),g=f.sheet||f.styleSheet;if(g.insertRule){g.insertRule(d._build(c,e),g[d._r].length)}else{if(g.addRule){g.addRule(c,d._build(c,e,true)||"{}")}}f.disabled=true;f.disabled=false;return d},resetCSS:function(){var c=xui.browser,d="html{color:#000;background:#FFF;}body,div,dl,dt,dd,ul,ol,li,h1,h2,h3,h4,h5,h6,pre,code,form,fieldset,legend,input,textarea,p,blockquote,th,td{margin:0;padding:0;}table{border-collapse:collapse;border-spacing:0;}fieldset,img{border:0;}address,caption,cite,code,dfn,em,strong,th,ar{font-style:normal;font-weight:normal;}li{list-style:none;}caption,th{text-align:left;}h1,h2,h3,h4,h5,h6{font-size:100%;font-weight:normal;}q:before,q:after{content:'';}abbr,acronym{border:0;font-variant:normal;}sup{vertical-align:text-top;}sub{vertical-align:text-bottom;}input,textarea,select{font-family:inherit;font-size:inherit;font-weight:inherit;}input,textarea,select{*font-size:100%;}"+(c.isWebKit?"input,textarea,select{-webkit-user-select: auto;}":"")+"legend{color:#000;}span{outline-offset:-1px;"+(c.gek?c.ver<3?((c.ver<3?"-moz-outline-offset:-1px !important;":"")+"display:-moz-inline-block;display:-moz-inline-box;display:inline-block;"):"display:inline-block;":c.ie6?"display:inline-box;display:inline;":"display:inline-block;")+(c.ie?"zoom:1;":"")+"}";this.addStyleSheet(d,"xui.CSSreset")}},Initialize:function(){var c=xui.browser,d=".xui-node{margin:0;padding:0;line-height:1.22em;-webkit-text-size-adjust:none;}.xui-wrapper{color:#000;font-family:arial,helvetica,clean,sans-serif;font-style:normal;font-weight:normal;font-size:12px;line-height:1.22em;vertical-align:middle;}.xui-cover{cursor:wait;background:url("+xui.ini.img_bg+") transparent repeat;font-size:12px;}.xui-node-table{border-collapse:collapse;border-spacing:0;empty-cells:show;font-size:inherit;"+(c.ie?"font:100%;":"")+"}.xui-node-fieldset,.xui-node-img{border:0;}.xui-node-ol,.xui-node-ul,.xui-node-li{list-style:none;}.xui-node-caption,.xui-node-th{text-align:left;}.xui-node-th{font-weight:normal;}.xui-node-q:before,.xui-node-q:after{content:'';}.xui-node-abbr,.xui-node-acronym{border:0;font-variant:normal;}.xui-node-sup{vertical-align:text-top;}.xui-node-sub{vertical-align:text-bottom;}.xui-node-input,.xui-node-textarea,.xui-node-select{cursor:text;font-family:inherit;font-size:inherit;font-weight:inherit;"+(c.ie?"font-size:100%;":"")+"}.xui-node-del,.xui-node-ins{text-decoration:none;}.xui-node-pre,.xui-node-code,.xui-node-kbd,.xui-node-samp,.xui-node-tt{font-family:monospace;"+(c.ie?"font-size:108%;":"")+"line-height:100%;}.xui-node-select,.xui-node-input,.xui-node-button,.xui-node-textarea{font:99% arial,helvetica,clean,sans-serif;border-width:1px;}.xui-node-a{cursor:pointer;color:#0000ee;text-decoration:none;}.xui-node-a:hover{color:red}"+(c.gek?(".xui-node-a:focus{outline-offset:-1px;"+(c.ver<3?"-moz-outline-offset:-1px !important":"")+"}"):"")+".xui-node-span, .xui-node-div{border:0;font-size:12px;}.xui-node-span, .xui-wrapper span"+((c.ie&&c.ver<=7)?"":", .xui-v-wrapper:before, .xui-v-wrapper > .xui-v-node")+"{outline-offset:-1px;"+(c.gek?c.ver<3?((c.ver<3?"-moz-outline-offset:-1px !important;":"")+"display:-moz-inline-block;display:-moz-inline-box;display:inline-block;"):"display:inline-block;":c.ie6?"display:inline-box;display:inline;":"display:inline-block;")+(c.ie?"zoom:1;":"")+"}.xui-node-h1,.xui-node-h2,.xui-node-h3,.xui-node-h4,.xui-node-h5,.xui-node-h6{font-size:100%;font-weight:normal;}.xui-node-h1{font-size:138.5%;}.xui-node-h2{font-size:123.1%;}.xui-node-h3{font-size:108%;}.xui-node-h1,.xui-node-h2,.xui-node-h3{margin:1em 0;}.xui-node-h1,.xui-node-h2,.xui-node-h3,.xui-node-h4,.xui-node-h5,.xui-node-h6,.xui-node-strong{font-weight:bold;}.xui-node-em{font-style:italic;}.xui-node-legend{color:#000;}"+(c.ie6?("#"+xui.$localeDomId+"{vertical-align:baseline;}"):"")+".xui-nooutline:focus{outline:0;}.xui-cls-wordwrap{white-space: pre-wrap;word-break: break-all;"+(c.gek?"white-space: -moz-pre-wrap;":"")+(c.opr?"white-space: -pre-wrap;":"")+(c.opr?"white-space: -o-pre-wrap;":"")+(c.ie?"word-wrap: break-word;":"")+"}"+((c.ie&&c.ver<=7)?"":(".xui-v-wrapper:before{content:'';height:100%;font-size:0;vertical-align:middle;}.xui-v-wrapper > .xui-v-node{vertical-align:middle;}.xui-v-top > .xui-v-wrapper:before{vertical-align:top;}.xui-v-top > .xui-v-wrapper > .xui-v-node{vertical-align:top;}.xui-v-bottom > .xui-v-wrapper:before{vertical-align:bottom;}.xui-v-bottom > .xui-v-wrapper > .xui-v-node{vertical-align:bottom;}"));this.addStyleSheet(d,"xui.CSS")}});Class("xui.DomProfile","xui.absProfile",{Constructor:function(d){var c=arguments.callee.upper;if(c){c.call(this)}c=null;xui.$cache.profileMap[this.domId=d]=this},Instance:{__gc:function(){delete xui.$cache.profileMap[this.domId]},_getEV:function(d,h,e){var g=xui.$cache.profileMap[h];if(g&&(g=g.events)&&(g=g[e])){for(var f=0,c=g.length;f<c;f++){if(typeof g[g[f]]=="function"){d[d.length]=g[g[f]]}}}}},Static:{get:function(c){return xui.$cache.profileMap[c]},$abstract:true}});Class("xui.Dom","xui.absBox",{Instance:{get:function(f){var e=xui.$cache.domPurgeData,h=this._nodes,k;if(_.isNumb(f)){return(k=h[f])&&(k=e[k])&&k.element}else{var d=[],c=h.length;for(var g=0;g<c;g++){d[d.length]=(k=e[h[g]])&&k.element}return d}},each:function(d,k){var h=this,e=xui.$cache.domPurgeData,m,g,f=h._nodes,c=f.length;if(k){for(g=c;g>=0;g--){if((m=e[f[g]])&&(m=m.element)){if(false===d.call(h,m,g)){break}}}}else{for(g=0;g<c;g++){if((m=e[f[g]])&&(m=m.element)){if(false===d.call(h,m,g)){break}}}}m=null;return h},serialize:function(){var c=[];this.each(function(d){c[c.length]=d.id});return"xui(['"+c.join("','")+"'])"},xid:function(){return xui.getId(this.get(0))},id:function(f,g){var e,d,c=xui.$cache.profileMap;if(typeof f=="string"){return this.each(function(h){if((d=h.id)!==f){if(!g&&(e=c[d])){c[f]=e;delete c[d]}h.id=f}})}else{return this.get(0)&&this.get(0).id}},$sum:function(d,e){var c=[],g,f;this.each(function(h){g=d.apply(h,e||[]);if(g){if(_.isArr(g)){for(f=0;h=g[f];f++){c[c.length]=h}}else{c[c.length]=g}}});return xui(c)},children:function(){return this.$sum(function(){return _.toArr(this.childNodes)})},clone:function(c){return this.$sum(function(){var h=this.cloneNode(c?true:false),e=h.getElementsByTagName("*"),g=xui.browser.ie&&xui.browser.ver<9,d=0,f;if(g){h.removeAttribute("$xid")}else{delete h.$xid}for(;f=e[d];d++){if(g){f.removeAttribute("$xid")}else{delete f.$xid}}return h},arguments)},$iterator:function(e,d,g,c,f){return this.$sum(function(u,l,y,w,x){var A=arguments.callee;if(typeof w!="function"){var p=w||0;w=function(B,m){return m==p}}var q=0,k,h=this,r=0,z;while(h){if(h.nodeType==1){if(w(h,q++)===true){break}}if(u=="x"){h=l?h.nextSibling:h.previousSibling}else{if(u=="y"){h=l?A.call(l===1?h.lastChild:h.firstChild,"x",(l!==1),true,0,x):h.parentNode}else{y=_.isBool(y)?y:true;k=null;h=l?(z=y&&h.firstChild)?z:(z=h.nextSibling)?z:(k=h.parentNode):(z=y&&h.lastChild)?z:(z=h.previousSibling)?z:(k=h.parentNode);if(k){while(!(k=l?h.nextSibling:h.previousSibling)){h=h.parentNode;if(!h){if(r){return null}else{r=true;k=l?document.body.firstChild:document.body.lastChild;break}}}h=k}y=true}}}return h},arguments)},query:function(d,p,n){d=d||"*";var l="getElementsByTagName",m=arguments.callee,k=m.f1||(m.f1=function(r,q,x){var w=this[l](r),f=[];if(x.test(this[q])){f[f.length]=this}for(var y,u=0;y=w[u];u++){if(x.test(y[q])){f[f.length]=y}}return f}),h=m.f2||(m.f2=function(r,q,x){var w=this[l](r),f=[];if(this[q]==x){f[f.length]=this}for(var y,u=0;y=w[u];u++){if(y[q]==x){f[f.length]=y}}return f}),g=m.f3||(m.f3=function(r,q,x){var w=this[l](r),f=[];if(this[q]){f[f.length]=this}for(var y,u=0;y=w[u];u++){if(y[q]){f[f.length]=y}}return f}),e=m.f4||(m.f4=function(f){return _.toArr(this[l](f))}),c=m.f5||(m.f5=function(r,q){var w=this[l](r),f=[];if(q(this)){f[f.length]=this}for(var x,u=0;x=w[u];u++){if(q(x)){f[f.length]=x}}return f});return this.$sum(p?typeof p=="function"?c:n?_.isReg(n)?k:h:g:e,[d,p,n])},querySelector:function(c){return this.$sum(function(){return _.toArr(this.querySelector(c))})},querySelectorAll:function(c){return this.$sum(function(){return _.toArr(this.querySelectorAll(c))})},$add:function(r,n,k){if(_.isHash(n)||_.isStr(n)){n=xui.create(n)}if(k){k=xui(n);n=this}else{n=xui(n);k=this}if(n._nodes.length){var m=k.get(0),u=n.get(),g=xui.Dom,c=xui.$cache.profileMap,q,x,d,h,e,f,w,x,l=[];n.each(function(p){x=(d=p.id)&&(d=c[d])&&d.LayoutTrigger&&(m===xui("body").get(0)||g.getStyle(m,"display")!="none")&&d.LayoutTrigger;if(x){l.push([x,d])}});if(u.length==1){q=u[0]}else{q=document.createDocumentFragment();for(h=0;e=u[h];h++){q.appendChild(e)}}r.call(m,q);for(h=0;e=l[h];h++){for(f=0;w=e[0][f];f++){w.call(e[1])}if(e[1].onLayout){e[1].boxing().onLayout(e[1])}}l.length=0;m=e=q=null}return this},prepend:function(c,d){return this.$add(function(e){if(this.previousSibling!=e){if(this.firstChild){this.insertBefore(e,this.firstChild)}else{this.appendChild(e)}}},c,d)},append:function(d,e,c){return this.$add(function(f){if(c||this!=f.parentNode){this.appendChild(f)}},d,e)},addPrev:function(c,d){return this.$add(function(e){if(this.firstChild!=e){this.parentNode.insertBefore(e,this)}},c,d)},addNext:function(c,d){return this.$add(function(e){if(this.nextSibling!=e){if(this.nextSibling){this.parentNode.insertBefore(e,this.nextSibling)}else{this.parentNode.appendChild(e)}}},c,d)},replace:function(k,h){if(_.isHash(k)||_.isStr(k)){k=xui.create(k)}k=xui(k);var e,f,m=this.get(0),g=k.get(),d=g.length;if(d>0&&(e=g[d-1])){m.parentNode.replaceChild(e,m);for(f=0;f<d-1;f++){e.parentNode.insertBefore(g[f],e)}if(h){this.remove()}}m=e=null;return k},swap:function(e){var c=this,d=xui.Dom.getEmptyDiv().html("*",false);if(_.isHash(e)||_.isStr(e)){e=xui.create(e)}e=xui(e);c.replace(d,false);e.replace(c,false);d.replace(e,false);d.get(0).innerHTML="";document.body.insertBefore(d.get(0),document.body.firstChild);return c},remove:function(e,d){if(e===false){this.each(function(f,c){if(f.raphael&&f.remove){f.remove()}else{if(f.parentNode){f.parentNode.removeChild(f)}}})}else{var h=xui.$getGhostDiv();this.each(function(c){h.appendChild(c)});var g=function(){xui.$purgeChildren(h);h.innerHTML="";h=null};if(d){g()}else{_.asyRun(g)}}return this},empty:function(c){return this.each(function(d){xui([d]).html("",c)})},html:function(w,e,q,h){var z="",y,l=this.get(0);e=e!==false;if(w!==undefined){if(l){if(l.nodeType==3){l.nodeValue=w}else{if(!l.firstChild&&w===""){return this}if(e){var x=xui.$getGhostDiv();xui(l).children().each(function(c){x.appendChild(c)});var r=function(){xui.$purgeChildren(x);x.innerHTML="";x=null};if(h){r()}else{_.asyRun(r)}}var p;if(q){var n=/(?:<script([^>]*)?>)((\n|\r|.)*?)(?:<\/script>)/ig,m=/(?:<script.*?>)((\n|\r|.)*?)(?:<\/script>)/ig,k=/\ssrc=([\'\"])(.*?)\1/i,g,u,d;p=[];while((g=n.exec(w))){u=g[1];d=u?u.match(k):false;if(d&&d[2]){p.push([1,d[2]])}else{if(g[2]&&g[2].length>0){p.push([2,g[2]])}}}w=w.replace(m,"")}l.innerHTML=w;if(p&&p.length>0){_.arr.each(p,function(c){if(c[0]==1){xui.include(null,c[1])}else{_.exec(c[1])}})}}l=null}return this}else{if(l){z=(l.nodeType==3)?l.nodeValue:l.innerHTML;l=null}return z}},loadHtml:function(e,c,d){var f=this;if(typeof e=="string"){e={url:e}}_.tryF(c);xui.Ajax(e.url,e.query,function(g){var h=xui.create("div");h.html(g,false,true);f.append(h.children());_.tryF(d)},function(g){f.append("<div>"+g+"</div>");_.tryF(d)},null,e.options).start()},loadIframe:function(c,g){if(typeof c=="string"){c={url:c}}var k=g||("aiframe_"+_()),d;if(d=xui.Dom.byId(g)){xui(d).remove()}var f=xui.browser.ie&&xui.browser.ver<9,h=document.createElement(f?"<iframe name='"+k+"'>":"iframe");h.id=h.name=k;h.src=c.url;h.frameBorder="0";h.marginWidth="0";h.marginHeight="0";h.vspace="0";h.hspace="0";h.allowTransparency="true";h.width="100%";h.height="100%";this.append(h);xui.Dom.submit(c.url,c.query,c.method,h.name,c.enctype)},outerHTML:function(h,c){var l=this,k,p="",e=l.get(0),d=e.id;if(h!==undefined){var f=l.replace(_.str.toDom(h),false);l._nodes[0]=f._nodes[0];xui([e]).remove(c);return l}else{if(xui.browser.gek){var g=xui.$getGhostDiv();g.appendChild(l.get(0).cloneNode(true));p=g.innerHTML;g.innerHTML="";g=null}else{p=e.outerHTML}e=null;return p}},text:function(e){if(e!==undefined){var d=this,c=[];d.each(function(g){var f=g.firstChild;if(f&&f.nodeType!=1){f.nodeValue=e}else{c[c.length]=g}});if(c.length){xui(c).empty().each(function(f){f.appendChild(document.createTextNode(e))})}return d}else{return(function(f){if(!f){return""}return f.textContent||f.innerText})(this.get(0))}},attr:function(d,m){var p=this,l=arguments.callee,h=l.map1||(l.map1={"class":"className",readonly:"readOnly",tabindex:"tabIndex","for":"htmlFor",maxlength:"maxLength",cellspacing:"cellSpacing",rowspan:"rowSpan",value:"value"}),g=l.map2||(l.map2={href:1,src:1,style:1});if(typeof d=="object"){for(var f in d){l.call(p,f,d[f])}return p}var n=xui.browser.ie&&d=="style",k=!g[d=h[d]||d];if(m!==undefined){return p.each(function(r){if(m===null){if(n){r.style.cssText=""}else{if(k){try{r[d]=null;if(r.nodeType==1){r.removeAttribute(d)}}catch(q){}}}}else{m=d=="style"?(m+"").replace(/[;]+/g,";").replace(/^;/,""):m;if(n){r.style.cssText=""+m}else{if(k){r[d]=m;if(r.nodeType==1&&d!="value"&&typeof m=="string"){r.setAttribute(d,m)}}else{r.setAttribute(d,m)}}}})}else{var c,e=p.get(0);if(n){return e.style.cssText}if(d=="selected"&&xui.browser.kde){return e.parentNode.selectedIndex}c=((d in e)&&k)?e[d]:e.getAttribute(d,xui.browser.ie&&!k?2:undefined);e=null;return d=="style"?c.replace(/[;]+/g,";").replace(/^;/,""):c}},$touchscroll:function(g){if(xui.browser.isTouch&&(xui.browser.isAndroid||xui.browser.isBB)){var h={x:1,y:1,xy:1},c=0,k=0,f=null,d=null,e=this._nodes;if(!h[g]){g=null}xui(e).onTouchstart(h[g]?function(q,n,r){if(xui.DragDrop._profile.isWorking){return true}if(n.touches.length>1){return true}var m=n.touches[0],l=xui(r).get(0);if(l){if(g=="xy"||g=="x"){c=m.pageX}if(g=="xy"||g=="y"){k=m.pageY}}return true}:null);xui(e).onTouchmove(h[g]?function(u,r,x){if(xui.DragDrop._profile.isWorking){return true}if(r.touches.length>1){return true}var q=r.touches[0],m=xui(x).get(0),l,n,w;if(m){l=m.scrollLeft;n=m.scrollTop;if(g=="xy"||g=="x"){if(f===null){w=1;f=m.scrollLeft+q.pageX+(c==q.pageX?0:c>q.pageX?1:-1)*10}m.scrollLeft=f-q.pageX}if(g=="xy"||g=="y"){if(d===null){w=1;d=m.scrollTop+q.pageY+(k==q.pageY?0:k>q.pageY?1:-1)*10}m.scrollTop=d-q.pageY}return(!w)&&l==m.scrollLeft&&n==m.scrollTop}}:null);xui(e).onTouchend(h[g]?function(m,l,n){if(xui.DragDrop._profile.isWorking){return true}if(l.touches.length>1){return true}f=d=null}:null)}return this},isScrollBarShowed:function(c){c=c=="x"?"scrollLeft":"scrollTop";if(this[c]()!==0){return true}this[c](1);if(this[c]()===0){return false}this[c](0);return true},scrollIntoView:function(){if(this.get(0)){this.get(0).scrollIntoView()}return this},css:function(c,d){if(typeof c=="object"||d!==undefined){this.each(function(e){xui.Dom.setStyle(e,c,d)});if(xui.browser.isTouch&&(xui.browser.isAndroid||xui.browser.isBB)){if(c=="overflow"||c=="overflow-x"||c=="overflow-y"){if(d=="auto"||d=="scroll"){this.$touchscroll(c=="overflow"?"xy":c=="overflow-x"?"x":"y")}else{this.$touchscroll(null)}}}return this}else{return xui.Dom.getStyle(this.get(0),c)}},rotate:function(d){if(_.isSet(d)){d=parseInt(d,10)||0;d=d%360;if(d<0){d=d+360}return this.each(function(k){if(k.raphael&&k.id){var h=xui.Event._getProfile(k.id);if((h=h&&h.parent&&h.parent._paper)&&(k=h.getById(k.raphaelid))){k.transform("r"+d)}}else{d+="deg";var g=k.style.transform||"";if(/rotate\([^)]*\)/i.test(g)){g=g.replace(/(rotate\()([^)]+)/i,"$1"+d)}else{g+=" rotate("+d+")"}xui.Dom.setStyle(k,"transform",g)}})}else{var f=this.get(0);if(f.raphael&&f.id){var e=xui.Event._getProfile(f.id);if((e=e&&e.parent&&e.parent._paper)&&(f=e.getById(f.raphaelid))){f=f.transform();if(_.isArr(f)){if(!f.length){f=""}else{f=f.join()}}else{if(!f){f=""}else{f=Raphael.parseTransformString(f).join()}}var c=/r,([-\d.]+)/i.exec(f);d=c?parseFloat(c[1]||0):0;d=d%360;if(d<0){d=d+360}return d}return 0}else{var c=/rotate\(([-\d.]+)/i.exec(f.style.transform);return c?parseFloat(c[1]||0):0}}},scaleX:function(d){if(_.isSet(d)){return this.each(function(l){if(l.raphael&&l.id){d=parseFloat(d);var k=xui.Event._getProfile(l.id),h;if((k=k&&k.parent&&k.parent._paper)&&(l=k.getById(l.raphaelid))){h=_.clone(Raphael.parseTransformString(l.transform()),true);if(h&&h[0]&&h[0][0]=="s"){h[0][1]=d}else{h=h||[];h.unshift(["s",d,1])}l.transform(h)}}else{var g=l.style.transform||"";if(/(scale\()([^,]+),([^)]+)/i.test(g)){g=g.replace(/(scale\()([^,]+),([^)]+)/i,"$1"+d+",$3")}else{if(/scale\([-\d.]*\)/i.test(g)){g=g.replace(/scale\([-\d.]*\)/i,"scale("+d+",1)")}else{g+=" scale("+d+",1)"}}xui.Dom.setStyle(l,"transform",g)}})}else{var f=this.get(0);if(f.raphael&&f.id){d=1;var e=xui.Event._getProfile(f.id);if((e=e&&e.parent&&e.parent._paper)&&(f=e.getById(f.raphaelid))){_.arr.each(Raphael.parseTransformString(f.transform()),function(g){if(g[0]=="s"){d*=g[1]}})}return d}else{var c=/(scale\()([^,]+),([^)]+)/i.exec(this.get(0).style.transform);if(c){return parseFloat(c[2]||1)}else{c=/scale\(([-\d.]*)\)/i.exec(this.get(0).style.transform);return c?c[1]:1}}}},scaleY:function(d){if(_.isSet(d)){return this.each(function(l){if(l.raphael&&l.id){d=parseFloat(d);var k=xui.Event._getProfile(l.id),h;if((k=k&&k.parent&&k.parent._paper)&&(l=k.getById(l.raphaelid))){h=_.clone(Raphael.parseTransformString(l.transform()),true);if(h&&h[0]&&h[0][0]=="s"){h[0][2]=d}else{h=h||[];h.unshift(["s",1,d])}l.transform(h)}}else{var g=l.style.transform||"";if(/(scale\()([^,]+),([^)]+)/i.test(g)){g=g.replace(/(scale\()([^,]+),([^)]+)/i,"$1$2,"+d)}else{if(/scale\([-\d.]*\)/i.test(g)){g=g.replace(/scale\([-\d.]*\)/i,"scale(1,"+d+")")}else{g+=" scale(1,"+d+")"}}xui.Dom.setStyle(l,"transform",g)}})}else{var f=this.get(0);if(f.raphael&&f.id){d=1;var e=xui.Event._getProfile(f.id);if((e=e&&e.parent&&e.parent._paper)&&(f=e.getById(f.raphaelid))){_.arr.each(Raphael.parseTransformString(f.transform()),function(g){if(g[0]=="s"){d*=g[2]}})}return d}else{var c=/(scale\()([^,]+),([^)]+)/i.exec(this.get(0).style.transform);if(c){return parseFloat(c[3]||1)}else{c=/scale\(([-\d.]*)\)/i.exec(this.get(0).style.transform);return c?c[1]:1}}}},translateX:function(d){if(_.isSet(d)){return this.each(function(l){if(l.raphael&&l.id){d=parseFloat(d);var k=xui.Event._getProfile(l.id),h;if((k=k&&k.parent&&k.parent._paper)&&(l=k.getById(l.raphaelid))){h=_.clone(Raphael.parseTransformString(l.transform()),true);if(h&&h.length&&h[h.length-1]&&(h[h.length-1][0]=="t")){h[h.length-1][1]=d}else{h=h||[];h.push(["t",d,0])}l.transform(h)}}else{if(_.isFinite(d)){d+="px"}var g=l.style.transform||"";if(/translate\([^)]*\)/i.test(g)){g=g.replace(/(translate\()([^,]+),([^)]+)/i,"$1"+d+",$3")}else{g+=" translate("+d+",0)"}xui.Dom.setStyle(l,"transform",g)}})}else{var f=this.get(0);if(f.raphael&&f.id){d=0;var e=xui.Event._getProfile(f.id);if((e=e&&e.parent&&e.parent._paper)&&(f=e.getById(f.raphaelid))){_.arr.each(Raphael.parseTransformString(f.transform()),function(g){if(g[0]=="t"){d+=g[1]}})}return d}else{var c=/(translate\()([^,]+),([^)]+)/i.exec(this.get(0).style.transform);return c?(c[2]||"").replace(/\s/g,""):""}}},translateY:function(d){if(_.isSet(d)){return this.each(function(k){if(k.raphael&&k.id){d=parseFloat(d);var h=xui.Event._getProfile(k.id);if((h=h&&h.parent&&h.parent._paper)&&(k=h.getById(k.raphaelid))){t=_.clone(Raphael.parseTransformString(k.transform()),true);if(t&&t.length&&t[t.length-1]&&(t[t.length-1][0]=="t")){t[t.length-1][2]=d}else{t=t||[];t.push(["t",0,d])}k.transform(t)}}else{if(_.isFinite(d)){d+="px"}var g=k.style.transform||"";if(/translate\([^)]*\)/i.test(g)){g=g.replace(/(translate\()([^,]+),([^)]+)/i,"$1$2,"+d)}else{g+=" translate(0,"+d+")"}xui.Dom.setStyle(k,"transform",g)}})}else{var f=this.get(0);if(f.raphael&&f.id){d=0;var e=xui.Event._getProfile(f.id);if((e=e&&e.parent&&e.parent._paper)&&(f=e.getById(f.raphaelid))){_.arr.each(Raphael.parseTransformString(f.transform()),function(g){if(g[0]=="t"){d+=g[2]}})}return d}else{var c=/(translate\()([^,]+),([^)]+)/i.exec(this.get(0).style.transform);return c?(c[3]||"").replace(/\s/g,""):""}}},skewX:function(d){if(_.isSet(d)){if(_.isFinite(d)){d+="deg"}return this.each(function(f){var e=f.style.transform||"";if(/skew\([^)]*\)/i.test(e)){e=e.replace(/(skew\()([^,]+),([^)]+)/i,"$1"+d+",$3")}else{e+=" skew("+d+",0deg)"}xui.Dom.setStyle(f,"transform",e)})}else{var c=/(skew\()([^,]+),([^)]+)/i.exec(this.get(0).style.transform);return c?parseFloat(c[2]||0):0}},skewY:function(d){if(_.isSet(d)){if(_.isFinite(d)){d+="deg"}return this.each(function(f){var e=f.style.transform||"";if(/skew\([^)]*\)/i.test(e)){e=e.replace(/(skew\()([^,]+),([^)]+)/i,"$1$2,"+d)}else{e+=" skew(0deg,"+d+")"}xui.Dom.setStyle(f,"transform",e)})}else{var c=/(skew\()([^,]+),([^)]+)/i.exec(this.get(0).style.transform);return c?parseFloat(c[3]||0):0}},caret:function(g,p){var z=this.get(0),B=z.nodeName.toLowerCase(),x=typeof g,f=xui.browser.ie,y;if(!/^(input|textarea)$/i.test(B)){return}if(B=="input"&&z.type.toLowerCase()!="text"&&z.type.toLowerCase()!="password"){return}z.focus();if(x=="number"){if(f){var c=z.createTextRange();c.collapse(true);c.moveEnd("character",p);c.moveStart("character",g);c.select()}else{z.focus();z.setSelectionRange(g,p)}return this}else{if(x=="string"){var c=this.caret(),n=0,k=0,w,A=z.value,h=/\r/g;if(f){n=A.substr(0,c[0]).match(h);n=(n&&n.length)||0;k=g.match(h);k=(k&&k.length)||0}if(xui.browser.opr){n=g.match(/\n/g);n=(n&&n.length)||0;k=g.match(/\r\n/g);k=(k&&k.length)||0;k=n-k;n=0}z.value=A.substr(0,c[0])+g+A.substr(c[1],A.length);w=c[0]-n+k+g.length;this.caret(w,w);return w}else{if(f&&document.selection){var c=document.selection.createRange(),q=c.text,n=q.length,u,k;if(B.toLowerCase()=="input"){c.moveStart("character",-z.value.length);u=c.text.length;return[u-n,u]}else{var d=c.duplicate();d.moveToElementText(z);d.setEndPoint("EndToEnd",c);u=d.text.length;return[u-n,u]}}else{return[z.selectionStart,z.selectionEnd]}}}},show:function(d,f,k,m,e){var c,l,h=xui.Dom.HIDE_VALUE,g;return this.each(function(p){if(p.nodeType!=1){return}var n=xui.getNodeData(p,"_inthread");if(n){xui.Thread(n).abort("force");xui.setNodeData(p,"_inthread")}c=p.style;g=xui.getNodeData(p);if(g._xuihide){if(l=g._left){if(c.left!=l){c.left=l}}if(l=g._top){if(c.top!=l){c.top=l}}if(l=g._position){if(c.position!=l){c.position=l}}if(c.visibility!="visible"){c.visibility="visible"}g._xuihide=0}if(_.isSet(d)){c.left=d}if(_.isSet(f)){c.top=f}m=e?null:m?m:_.get(xui.UIProfile.getFromDom(p),["properties","showEffects"]);if(m){m=xui.Dom._getEffects(m,1)}if(m){xui.Dom._vAnimate(p,true,m,k)}else{if(k){k()}}})},hide:function(g,f,c){var d,e;return this.each(function(l){if(l.nodeType!=1){return}var k=xui.getNodeData(l,"_inthread");if(k){xui.Thread(k).abort("force");xui.setNodeData(l,"_inthread")}d=l.style;e=xui.getNodeData(l);var h=function(){if(e._xuihide!==1){e._position=d.position;e._visibility=d.visibility;e._top=d.top;e._left=d.left;e._xuihide=1}if(d.position!="absolute"){d.position="absolute"}d.visibility="hidden";d.top=d.left=xui.Dom.HIDE_VALUE;if(g){g()}};f=c?null:f?f:_.get(xui.UIProfile.getFromDom(l),["properties","hideEffects"]);if(f){f=xui.Dom._getEffects(f,0)}if(f){xui.Dom._vAnimate(l,false,f,h)}else{h()}})},cssRegion:function(r,u){var y=this;if(typeof r=="object"){var l,x,e,d=y.get(0),k=xui.Dom,n=k._setPxStyle,e={};for(var h=0,p=k._boxArr;l=p[h++];){e[l]=((l in r)&&r[l]!==null)?n(d,l,r[l]):false}if(u){var n=k.$hasEventHandler;if(n(d,"onsize")&&(e.width||e.height)){y.onSize(true,{width:e.width,height:e.height})}if(n(d,"onmove")&&(e.left||e.top)){y.onMove(true,{left:e.left,top:e.top})}}return y}else{var g=r,w=u,q=g?y.offset(null,w):y.cssPos(),z=y.cssSize();return{left:q.left,top:q.top,width:z.width,height:z.height}}},cssSize:function(p,k){var n=this,d=n.get(0),c,e=xui.Dom,g=e._setPxStyle,l,h;if(p){var m;l=p.width!==null?g(d,"width",p.width):false;h=p.height!==null?g(d,"height",p.height):false;if(k&&(l||h)&&e.$hasEventHandler(d,"onsize")){n.onSize(true,{width:l,height:h})}c=n}else{c={width:n._W(d,1)||0,height:n._H(d,1)}}return c},cssPos:function(h,l){var d=this.get(0),e=xui.Dom,g=e._setPxStyle,m,k,c;if(h){var n;m=h.left!=null?g(d,"left",h.left):false;k=h.top!==null?g(d,"top",h.top):false;if(l&&(m||k)&&e.$hasEventHandler(d,"onmove")){this.onMove(true,{left:m,top:k})}c=this}else{g=e.getStyle;c={left:parseInt(g(d,"left"),10)||0,top:parseInt(g(d,"top"),10)||0}}d=null;return c},offset:function(h,x){var p,m,C=xui.browser,G=this,u=G.get(0),z=u,l=u.parentNode,k=u.offsetParent,F=u.ownerDocument,B=F.documentElement,D=F.body,e=/^inline|table.*$/i,g=xui.Dom.getStyle,f=g(u,"position")=="fixed",E=arguments.callee,n=E.add||(E.add=function(H,d,r){H.left+=parseInt(d,10)||0;H.top+=parseInt(r,10)||0}),w=E.border||(E.border=function(d,r){n(r,g(d,"borderLeftWidth"),g(d,"borderTopWidth"))}),q=E.TTAG||(E.TTAG={TABLE:1,TD:1,TH:1}),y=E.HTAG||(E.HTAG={BODY:1,HTML:1}),c=E.posDiff||(E.posDiff=function(I,H){var r=I.cssPos(),d=I.offset(null,H);return{left:d.left-r.left,top:d.top-r.top}});x=x?xui(x).get(0):F;if(h){if(h.left===null&&h.top===null){return G}var A=c(G,x);G.cssPos({left:h.left===null?null:(h.left-A.left),top:h.top===null?null:(h.top-A.top)});p=G}else{if(!(xui.browser.gek&&u===document.body)&&u.getBoundingClientRect){m=u.getBoundingClientRect();h={left:m.left,top:m.top};if(x.nodeType==1&&x!==document.body){n(h,-(m=x.getBoundingClientRect()).left+x.scrollLeft,-m.top+x.scrollTop)}else{n(h,(B.scrollLeft||D.scrollLeft||0)-B.clientLeft,(B.scrollTop||D.scrollTop||0)-B.clientTop)}}else{h={left:0,top:0};n(h,u.offsetLeft,u.offsetTop);while(k&&k!=x&&k!=x.offsetParent){n(h,k.offsetLeft,k.offsetTop);if(C.kde||(C.gek&&!q[k.nodeName])){w(k,h)}if(!f&&g(k,"position")=="fixed"){f=true}if(k.nodeName!="BODY"){z=k.nodeName=="BODY"?z:k}k=k.offsetParent}while(l&&l.nodeName&&l!=x&&!y[l.nodeName]){if(!e.test(g(l,"display"))){n(h,-l.scrollLeft,-l.scrollTop)}if(C.gek&&g(l,"overflow")!="visible"){w(l,h)}l=l.parentNode}if((C.gek&&g(z,"position")!="absolute")){n(h,-D.offsetLeft,-D.offsetTop)}if(f){n(h,B.scrollLeft||D.scrollLeft||0,B.scrollTop||D.scrollTop||0)}}p=h}return p},hasClass:function(f){var g,e,d=_.isReg(f),c=xui.Dom._getClass(this.get(0)).split(/\s+/);if(d){for(g=0,e=c.length;g<e;g++){if(f.test(c[g])){return true}}}else{return _.arr.indexOf(c,f+"")!=-1}return false},addClass:function(c){var g,f,e,k=arguments.callee,d=(k.reg||(k.reg=/\s+/)),n,m,h=(c+"").split(d);if(!h.length){return this}return this.each(function(l){m=0;g=xui.Dom._getClass(l).split(d);n=[];for(f=0,e=g.length;f<e;f++){if(g[f]){n.push(g[f])}}for(f=0,e=h.length;f<e;f++){if(h[f]&&_.arr.indexOf(g,h[f])==-1){m=1;n.push(h[f])}}if(m){xui.Dom._setClass(l,n.join(" "))}})},removeClass:function(c){var h,g,f,d=_.isReg(c),m=arguments.callee,e=(m.reg||(m.reg=/\s+/)),n,k;if(!d){k=(c+"").split(e);if(!k.length){return this}}return this.each(function(l){n=0;h=xui.Dom._getClass(l).split(e);if(!d){for(g=0,f=k.length;g<f;g++){if(_.arr.indexOf(h,k[g])!=-1){n=1;_.arr.removeValue(h,k[g])}}}else{_.filter(h,function(q,p){if(c.test(q)){n=1;return false}})}if(n){xui.Dom._setClass(l,h.join(" "))}})},replaceClass:function(e,c){var f,d;return this.each(function(g){d=(f=xui.Dom._getClass(g)).replace(e,c);if(f!=d){xui.Dom._setClass(g,d)}})},tagClass:function(c,g){var f=this,h=arguments.callee,e=h["_r1_"+c]||(h["_r1_"+c]=new RegExp("([-\\w]+"+c+"[-\\w]*)")),d=h._r2||(h._r2=/([-\w]+)/g);f.removeClass(e);return(false===g)?f:f.replaceClass(d,"$1 $1"+c)},$addEventHandler:function(c){var f=xui.Event,e,d=f.$eventhandler;return this.each(function(g){if(g.nodeType==3){return}xui.setNodeData(g,["eHandlers","on"+f._eventMap[c]],d);if(e=f._eventHandler[c]){g[e]=d;xui.setNodeData(g,["eHandlers",e],d);if(xui.browser.isTouch&&e=="onmousedown"){xui.setNodeData(g,["eHandlers","onxuitouchdown"],d);if(g.addEventListener){g.addEventListener("xuitouchdown",d,false)}else{if(g.attachEvent){g.attachEvent("xuitouchdown",d)}}}}})},$removeEventHandler:function(c){var f=xui.Event,e=f.$eventhandler,d;return this.each(function(g){if(d=f._eventHandler[c]){g[d]=null;if(xui.browser.isTouch&&d=="onmousedown"){if(g.removeEventListener){g.removeEventListener("xuitouchdown",e,false)}else{if(g.detachEvent){g.detachEvent("xuitouchdown",e)}}}}if(g=xui.getNodeData(g,"eHandlers")){d="on"+f._eventMap[c];delete g[d];if(xui.browser.isTouch&&d=="onmousedown"){delete g.onxuitouchdown}}})},$addEvent:function(e,n,p,k){var u=this,d=xui.Event,h=_.arr.removeValue,q=_.arr.insertAny,f,l,r,g;if(!k&&k!==0){k=-1}if(typeof p=="string"){p="$"+p}else{p=undefined}u.$addEventHandler(e).each(function(c){if(c.nodeType==3){return}if(!(f=d.getId(c))&&c!==window&&c!==document){f=c.id=xui.Dom._pickDomId()}if(!(l=xui.$cache.profileMap[f])){l=new xui.DomProfile(f)}r=l.events||(l.events={});g=r[e]||(r[e]=[]);if(p===undefined){g.length=0;g=r[e]=[];k=-1;p="_"}g[p]=n;h(g,p);if(k==-1){g[g.length]=p}else{q(g,p,k)}if(xui.Event&&(l=xui.Event._getProfile(f))&&l.clearCache){l.clearCache()}});return u},$removeEvent:function(e,q,g){var u=this,p,r,h,f,m,n,d=xui.Event,l=xui.$cache.profileMap,n=d._eventMap[e];u.each(function(c){if(!(f=d.getId(c))){return}if(!(p=l[f])){return}if(!(r=p.events)){return}if(g){_.arr.each(d._getEventName(n),function(k){delete r[k]})}else{if(typeof q=="string"){q="$"+q;if(h=r[e]){if(_.arr.indexOf(h,q)!=-1){_.arr.removeValue(h,q)}delete h[q]}}else{delete r[e]}}if(xui.Event&&(p=xui.Event._getProfile(f))&&p.clearCache){p.clearCache()}});return u},$getEvent:function(e,d){var g;if(!(g=xui.Event.getId(this.get(0)))){return}if(d){return _.get(xui.$cache.profileMap,[g,"events",e,"$"+d])}else{var f=[],c=_.get(xui.$cache.profileMap,[g,"events",e]);_.arr.each(c,function(k,h){f[f.length]={o:c[k]}});return f}},$clearEvent:function(){return this.each(function(d,c){if(!(c=xui.Event.getId(d))){return}if(!(c=xui.$cache.profileMap[c])){return}_.breakO(c.events,2);delete c.events;_.arr.each(xui.Event._events,function(e){if(d["on"+e]){d["on"+e]=null}})})},$fireEvent:function(c,k){var m=xui.Event._eventMap[c],p,q="on"+m,n,g,l=arguments.callee,h=xui.Event.$eventhandler,e=l.f1||(l.f1=function(){this.returnValue=false}),d=l.f2||(l.f2=function(){this.cancelBubble=true});return this.each(function(r){if(!(n=xui.getNodeData(r,["eHandlers",q]))){return}if("blur"==m||"focus"==m){try{r[m]()}catch(f){}}else{g=_.copy(k);_.merge(g,{type:m,target:r,button:1,$xuievent:true,$xuitype:c,preventDefault:e,stopPropagation:d},"all");n.call(r,g)}})},nativeEvent:function(c){return this.each(function(f){if(f.nodeType===3||f.nodeType===8){return}try{f[c]()}catch(d){}})},$canFocus:function(){var f=arguments.callee,c=xui.Dom.getStyle,g=f.map||(f.map={a:1,input:1,select:1,textarea:1,button:1,object:1}),d,e;return !!((e=this.get(0))&&e.focus&&(((d=g[e.nodeName.toLowerCase()])&&!(parseInt(e.tabIndex,10)<=-1))||(!d&&parseInt(e.tabIndex,10)>=(xui.browser.ie?1:0)))&&c(e,"display")!="none"&&c(e,"visibility")!="hidden"&&e.offsetWidth>0&&e.offsetHeight>0)},focus:function(d){var c=this;if(d||c.$canFocus()){try{c.get(0).focus()}catch(f){}}return c},setSelectable:function(e){var d=arguments.callee,c;this.removeClass("xui-ui-selectable").removeClass("xui-ui-unselectable");this.addClass(e?"xui-ui-selectable":"xui-ui-unselectable");return this.each(function(f){if(xui.browser.ie&&xui.browser.ver<10){xui.setNodeData(f,"_onxuisel",e?"true":"false")}})},setInlineBlock:function(){var c=this;if(xui.browser.gek){if(xui.browser.ver<3){c.css("display","-moz-inline-block").css("display","-moz-inline-box").css("display","inline-block")}else{c.css("display","inline-block")}}else{if(xui.browser.ie6){c.css("display","inline-block").css({display:"inline",zoom:"1"})}else{c.css("display","inline-block")}}return c},topZindex:function(c){var g=1000,e=0,d,h=this.get(0),l=h.offsetParent,f,m;if(xui.browser.ie&&(!l||(l.nodeName+"").toUpperCase()=="HTML")){l=xui("body").get(0)}if(h.nodeType!=1||!l){return 1}f=l.childNodes;for(d=0;m=f[d];d++){if(m==h||m.nodeType!=1||!m.$xid||m.style.display=="none"||m.style.visibility=="hidden"||m.zIndexIgnore||xui.getNodeData(m,"zIndexIgnore")){continue}e=parseInt(m.style&&m.style.zIndex,10)||0;g=g>e?g:e}g++;if(g>=xui.Dom.TOP_ZINDEX){xui.Dom.TOP_ZINDEX=g+1}if(c){h.style.zIndex=g}else{e=parseInt(h.style.zIndex,10)||0;return g>e?g:e}return this},nextFocus:function(f,e,d,h){f=_.isBool(f)?f:true;var c=this.get(0),g=this.$iterator("",f,e,function(k){return k!==c&&(!h||(k.id&&h.test(k.id)))&&xui([k]).$canFocus()});if(!g.isEmpty()&&d!==false){g.focus()}c=null;return g},animate:function(y,x,k,c,g,e,l,n,D,m,d){var C=arguments.callee,f=xui.Dom.$AnimateEffects||(xui.Dom.$AnimateEffects={linear:function(E,F){return(1/E)*F},sineIn:function(E,F){return -1*Math.cos(F/E*(Math.PI/2))+1},sineOut:function(E,F){return Math.sin(F/E*(Math.PI/2))},sineInOut:function(E,F){return -1/2*(Math.cos(Math.PI*F/E)-1)},quadIn:function(E,F){return(F/=E)*F},quadOut:function(E,F){return -1*(F/=E)*(F-2)},quadInOut:function(E,F){if((F/=E/2)<1){return 1/2*F*F}return -1/2*((--F)*(F-2)-1)},cubicIn:function(E,F){return(F/=E)*F*F},cubicOut:function(E,F){return((F=F/E-1)*F*F+1)},cubicInOut:function(E,F){if((F/=E/2)<1){return 1/2*F*F*F}return 1/2*((F-=2)*F*F+2)},quartIn:function(E,F){return(F/=E)*F*F*F},quartOut:function(E,F){return -1*((F=F/E-1)*F*F*F-1)},quartInOut:function(E,F){if((F/=E/2)<1){return 1/2*F*F*F*F}return -1/2*((F-=2)*F*F*F-2)},quintIn:function(E,F){return(F/=E)*F*F*F*F},quintOut:function(E,F){return((F=F/E-1)*F*F*F*F+1)},quintInOut:function(E,F){if((F/=E/2)<1){return 1/2*F*F*F*F*F}return 1/2*((F-=2)*F*F*F*F+2)},expoIn:function(E,F){return(F==0)?0:Math.pow(2,10*(F/E-1))},expoOut:function(E,F){return(F==E)?1:(-Math.pow(2,-10*F/E)+1)},expoInOut:function(E,F){if(F==0){return 0}if(F==E){return 1}if((F/=E/2)<1){return 1/2*Math.pow(2,10*(F-1))}return 1/2*(-Math.pow(2,-10*--F)+2)},circIn:function(E,F){return -1*(Math.sqrt(1-(F/=E)*F)-1)},circOut:function(E,F){return Math.sqrt(1-(F=F/E-1)*F)},circInOut:function(E,F){if((F/=E/2)<1){return -1/2*(Math.sqrt(1-F*F)-1)}return 1/2*(Math.sqrt(1-(F-=2)*F)+1)},bounceIn:function(E,F){return 1-f.bounceOut(E,E-F)},bounceOut:function(F,G){var E=7.5625;if((G/=F)<(1/2.75)){return(E*G*G)}else{if(G<(2/2.75)){return(E*(G-=(1.5/2.75))*G+0.75)}else{if(G<(2.5/2.75)){return(E*(G-=(2.25/2.75))*G+0.9375)}else{return(E*(G-=(2.625/2.75))*G+0.984375)}}}},bounceInOut:function(E,F){if(F<E/2){return f.bounceIn(E,F*2)*0.5}else{return f.bounceOut(E,F*2-E)*0.5+1*0.5}},backIn:function(F,G){var E=1.70158;return(G/=F)*G*((E+1)*G-E)},backOut:function(F,G){var E=1.70158;return((G=G/F-1)*G*((E+1)*G+E)+1)},backInOut:function(F,G){var E=1.70158;if((G/=F/2)<1){return 1/2*(G*G*(((E*=(1.525))+1)*G-E))}return 1/2*((G-=2)*G*(((E*=(1.525))+1)*G+E)+2)},elasticIn:function(G,J,H,E,I){if(J==0){return 0}if((J/=G)==1){return 1}if(!I){I=G*0.3}if(!E||E<1){E=1;var F=I/4}else{var F=I/(2*Math.PI)*Math.asin(1/E)}return -(E*Math.pow(2,10*(J-=1))*Math.sin((J*G-F)*(2*Math.PI)/I))},elasticOut:function(G,J,H,E,I){if(J==0){return 0}if((J/=G)==1){return 1}if(!I){I=G*0.3}if(!E||E<1){E=1;var F=I/4}else{var F=I/(2*Math.PI)*Math.asin(1/E)}return(E*Math.pow(2,-10*J)*Math.sin((J*G-F)*(2*Math.PI)/I)+1)},elasticInOut:function(G,J,H,E,I){if(J==0){return 0}if((J/=G/2)==2){return 1}if(!I){I=G*(0.3*1.5)}if(!E||E<1){E=1;var F=I/4}else{var F=I/(2*Math.PI)*Math.asin(1/E)}if(J<1){return -0.5*(E*Math.pow(2,10*(J-=1))*Math.sin((J*G-F)*(2*Math.PI)/I))}return E*Math.pow(2,-10*(J-=1))*Math.sin((J*G-F)*(2*Math.PI)/I)*0.5+1}}),r=C.color||(C.color=function(K,J,F){if(typeof K!="string"||typeof J!="string"){return"#fff"}if(F<0){return K}if(F>1){return J}var G,E,I,H;G=function(L){return(L.charAt(0)!="#")?("#"+L):L};K=G(K);J=G(J);E=function(N,M,L){return parseInt(N.slice(M,L),16)||0};I=function(L){return{red:E(L,1,3),green:E(L,3,5),blue:E(L,5,7)}};K=I(K);J=I(J);H=function(P,O,M,N){var L=P[N]+Math.round(M*(O[N]-P[N]));return(L<16?"0":"")+L.toString(16)};return"#"+H(K,J,F,"red")+H(K,J,F,"green")+H(K,J,F,"blue")});if(!y){if(k){_.tryF(k)}return}var w=y;y=_.clone(y);if((g||0)>0){c=g*16}else{c=c||200}m=m||1;e=(e in f)?e:"circIn";var h,q=this.get(0),p=this,B=function(I){var J=_()-h,E,F,G,H;if(J>=c){J=c}_.each(y,function(L,K){G=L[0];H=L[1];F=L[2];E=f[e](c,J);if(typeof L=="function"){L.call(p,E)}else{if(_.str.endWith(K.toLowerCase(),"color")){E=r(G,H,E)}else{if(!_.isFinite(H)){F=H.replace(/[-\d.]*/,"");G=parseFloat(G);H=parseFloat(H)}E=(G+(H-G)*E).toFixed(5)}E+=F||n||"";(p[K])?(p[K](E)):(p.css(K,E))}});if(J==c){if(D&&!d){h=_();d=1;_.each(y,function(L,K){K=L[0];L[0]=L[1];L[1]=K})}else{if(m==-1||m>0){h=_();if(m>0){m-=1}if(d){d=0;_.each(y,function(L,K){K=L[0];L[0]=L[1];L[1]=K})}}}if(!m){xui.Thread(I).abort("normal")}return false}},A=[B];var u=xui.getNodeData(q,"_inthread");if(u&&xui.Thread.isAlive(u)){xui.Thread(u).abort("force");xui.setNodeData(q,"_inthread",null)}var z=xui.getNodeData(q,"_animationreset");if(typeof z=="function"){z();xui.setNodeData(q,"_animationreset",null)}return xui.Thread(l||_.id(),A,0,null,function(E){xui.setNodeData(q,"_inthread",E);h=_();xui.setNodeData(q,"_animationreset",function(){_.merge(y,w,"all");h=_();B()});return _.tryF(x,arguments,this)},function(F,E){if("force"!=E){_.tryF(k,arguments,this)}if(q&&q.$xid){xui.setNodeData(q,"_inthread",null);xui.setNodeData(q,"_animationreset",null)}},true)},pop:function(k,f,e,c,g){var d=this,h=_()+":"+d.xid();d.popToTop(k,f||"outer",e).setBlurTrigger(h,function(){if(typeof(c)=="function"){_.tryF(c)}else{d.hide()}});return h},popToTop:function(k,f,l,g,q,A){var e,B=this,p;l=xui(l);if(l.isEmpty()){l=xui("body")}B.css({position:"absolute",left:xui.Dom.HIDE_VALUE,top:xui.Dom.HIDE_VALUE,display:"block",zIndex:xui.Dom.TOP_ZINDEX++});if(k["xui.UI"]||k["xui.UIProfile"]||k["xui.Dom"]||k.nodeType==1||typeof k=="string"){if(typeof(f)!="function"){f=(f||12)+""}var r=xui(k),x=r.offset(null,l);e={left:x.left,top:x.top,width:r.offsetWidth(),height:r.offsetHeight()}}else{if(typeof(f)!="function"){f=f?"3":"0"}p=f=="0"?0:8;e=k.region||{left:k.left-p,top:k.top-p,width:p*2,height:p*2}}k={left:0,top:0};var p=(l.get(0)===document.body||l.get(0)===document||l.get(0)===window)?xui.win:l,m={};B.cssPos(k).css({visibility:"hidden",display:"block"});l.append(B);m.left=p.scrollLeft();m.top=p.scrollTop();m.width=p.width()+m.left;m.height=p.height()+m.top;if(typeof(f)=="function"){k=f(e,m,B,p)}else{var n=B.offsetWidth(),y=B.offsetHeight(),d=f.split(/-/g);if(d.length==2){var c=d[0],z=d[1];switch(z){case"outertop":k.top=e.top-y;break;case"top":k.top=e.top;break;case"middle":k.top=e.top+e.height/2-y/2;break;case"bottom":k.top=e.top+e.height-y;break;default:k.top=e.top+e.height}switch(c){case"outerleft":k.left=e.left-n;break;case"left":k.left=e.left;break;case"center":k.left=e.left+e.width/2-n/2;break;case"right":k.left=e.left+e.width-n;break;default:k.left=e.left+e.width}}else{if(f=="outer"){f="12"}else{if(f=="inner"){f="4"}}var u=function(C){var w,h;switch(C){case"2":w=true;h=false;break;case"3":w=h=false;break;case"4":w=h=true;break;default:w=false;h=true}if(w){if(e.top+y<m.height){k.top=e.top}else{k.top=e.top+e.height-y}}else{if(e.top+e.height+y<m.height){k.top=e.top+e.height}else{k.top=e.top-y}}if(h){if(e.left+n<m.width){k.left=e.left}else{k.left=e.left+e.width-n}}else{if(e.left+e.width+n<m.width){k.left=e.left+e.width}else{k.left=e.left-n}}if(k.left+n>m.width){k.left=m.width-n}if(k.left<m.left){k.left=m.left}if(k.top+y>m.height){k.top=m.height-y}if(k.top<m.top){k.top=m.top}};if(f=="12"){u("1");if(k.top<e.top+e.height&&k.top+y>e.top){u("2")}}else{if(f=="21"){u("2");if(k.left<e.left+e.width&&k.left+n>e.left){u("1")}}else{u(f)}}}}B.cssPos(k).css({visibility:"visible"});q=A?null:q?q:_.get(xui.UIProfile.getFromDom(B),["properties","showEffects"]);if(q){q=xui.Dom._getEffects(q,1)}if(q){xui.Dom._vAnimate(B,true,q,g)}else{if(g){g()}}return this},hoverPop:function(d,g,f,n,k,e,m,h){d=xui(d);if(m){m=xui.Dom._getEffects(m,1)}if(h){h=xui.Dom._getEffects(h,0)}if(!_.isDefined(g)){g="outer"}var c=e||(this.xid()+":"+d.xid()),l=this;this.onMouseover(g===null?null:function(p,q,r){if(q.$force){return}_.resetRun(c,null);var u=xui.getData([c,"$ui.hover.pop"])&&xui.getNodeData(d.get(0)||"empty","$ui.hover.parent")==r;if(!u){xui.setData([c,"$ui.hover.pop"],1);xui.setNodeData(d.get(0)||"empty","$ui.hover.parent",r);if(!f||false!==f(p,d,q,r)){d.popToTop(r,g,k,m);d.onMouseover(function(){l.onMouseover(true)},"hoverPop").onMouseout(function(){l.onMouseout(true)},"hoverPop")}}},c).onMouseout(g===null?null:function(p,q,r){if(q.$force){return}_.resetRun(c,function(){xui.setData([c,"$ui.hover.pop"]);xui.setNodeData(d.get(0)||"empty","$ui.hover.parent",0);if(!n||false!==n(p,d,q,r,"host")){d.hide(null,h);d.onMouseover(null,"hoverPop").onMouseout(null,"hoverPop")}})},c);if(d){d.onMouseover(g===null?null:function(p){if(p.$force){return}_.resetRun(c,null)},c).onMouseout(g===null?null:function(p,q,r){if(q.$force){return}_.resetRun(c,function(){xui.setData([c,"$ui.hover.pop"]);xui.setNodeData(d.get(0)||"empty","$ui.hover.parent",0);if(!n||false!==n(p,d,q,r,"pop")){d.hide(null,h);d.onMouseover(null,"hoverPop").onMouseout(null,"hoverPop")}})},c)}d.css("display","none");return this},setBlurTrigger:function(c,f,n,p,d){var l=this,m=document,e="$blur_triggers$",k=xui.Dom._blurTrigger||(xui.Dom._blurTrigger=function(q,x){var q=xui.Event.getPos(x),u=arguments.callee.arr,D=xui.Event.getSrc(x),A=_.copy(u),z,y,B,r,C;_.arr.each(A,function(w){z=true;if(!(C=u[w].target)){z=false}else{C.each(function(E){if(E!==window&&E!==document&&!xui.Dom.byId(E.id)){return z=false}})}if(!z){_.arr.removeValue(u,w);delete u[w]}});A=_.copy(u);_.arr.each(A,function(E){C=u[E];if(!C){return}z=true;var w=function(){var F=C.target.get();while(D&&D.nodeName&&D.nodeName!="BODY"&&D.nodeName!="HTML"){if(_.arr.indexOf(F,D)!=-1){return true}D=D.parentNode}};if(!C.checkChild||w()){C.target.each(function(F){if(F.parentNode&&(B=F.offsetWidth)&&(r=F.offsetHeight)){y=xui([F]).offset();if(q.left>=y.left&&q.top>=y.top&&q.left<=(y.left+B)&&q.top<=(y.top+r)){return z=false}}})}w=null;if(!z&&!_.isFun(C.trigger)){return false}if(z){_.arr.removeValue(u,E);delete u[E];_.tryF(C.trigger,[q,x],C.target);C=null}else{if(C.stopNext){return false}}},null,true);D=null;A.length=0}),g=k.arr||(k.arr=[]),h;if(g[c]){if(f===true){_.tryF(g[c].trigger);f=false}_.arr.removeValue(g,c);delete g[c]}if(f){if(n){if(n["xui.Dom"]){h=n}else{if(_.isArr(n)){h=xui();h._nodes=n}}h.merge(l)}else{h=l}h.each(function(q){if(!q.id&&q!==window&&q!==document){q.id=xui.Dom._pickDomId()}});g[c]={trigger:f,target:h,checkChild:!!p,stopNext:!d};g.push(c);if(!m.onmousedown){m.onmousedown=xui.Event.$eventhandler}m=k=null}return this},$firfox2:function(){if(!xui.browser.gek2){return this}var c=this;c.css("overflow","hidden");_.asyRun(function(){c.css("overflow","auto")});return c},ieRemedy:function(){if(xui.browser.ie6){var e=this.get(),c=[],g=[],d=e.length;for(var f=0;f<d;f++){if(!_.isSet(e[f].$ieRemedy)){if(_.isSet(e[f].style.width)){e[f].$ieRemedy=e[f].style.width;e[f].style.width=((parseFloat(e[f].$xuirem)||0)+1)+"px"}}}_.asyRun(function(){for(var h=0;h<d;h++){if(_.isSet(e[h].$ieRemedy)){e[h].style.width=e[h].$ieRemedy;e[h].removeAttribute("$ieRemedy")}}e.length=c.length=g.length=0})}return this}},Static:{HIDE_VALUE:"-10000px",TOP_ZINDEX:10000,_boxArr:_.toArr("width,height,left,top,right,bottom"),_cursor:{},_pickDomId:function(){var c;do{c="xui_"+_.id()}while(document.getElementById(c));return c},_map:{html:1,head:1,body:1},fixPng:function(f){if(xui.browser.ie6){if(f.nodeName=="IMG"&&f.src.toLowerCase().search(/\.png$/)!=-1){f.style.height=f.height;f.style.width=f.width;f.style.backgroundImage="none";var d=((f.style.filter?(f.style.filter+","):"")+"progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled=true, src="+f.src+"', sizingMethod='image')").replace(/(^[\s,]*)|([\s,]*$)/g,"").replace(/[,\s]+/g,", ");if(xui.browser.ie8){f.style.msfilter=d}f.style.filter=d;f.src=xui.ini.img_bg}var e=f.currentStyle.backgroundImage||f.style.backgroundImage,c=(e||"").toLowerCase().match(/^url[("']+(.*\.png[^\)"']*)[\)"']+[^\)]*$/i);if(c){f.style.backgroundImage="none";var d=((f.style.filter?(f.style.filter+","):"")+"progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled=true, src="+c[1]+"', sizingMethod='crop')").replace(/(^[\s,]*)|([\s,]*$)/g,"").replace(/[,\s]+/g,", ");if(xui.browser.ie8){f.style.msfilter=d}f.style.filter=d}}},_getTag:function(c){return c?c.$xid?c.$xid:c.nodeType==1?xui.$registerNode(c).$xid:0:0},_ensureValues:function(h){var f,e,g=this._map,d=[],c=h===window?["!window"]:h===document?["!document"]:_.isArr(h)?h:(h=="[object NodeList]"||h=="[object HTMLCollection]")?_.toArr(h):h["xui.Dom"]?h._nodes:h._toDomElems?h._toDomElems():typeof h=="function"?h():[h];for(e=0;e<c.length;e++){if(f=!(f=c[e])?0:f===window?"!window":f===document?"!document":(typeof f=="string"||(f["xui.DomProfile"]&&(f=f.domId)))?f.charAt(0)=="!"?f:this._getTag(g[f]?document.getElementsByTagName(f)[0]:document.getElementById(f)):((f=c[e])["xui.UIProfile"]||f["xui.Template"])?f.renderId?f.renderId:(f.boxing().render()&&f.renderId):this._getTag(f)){d[d.length]=f}}return d.length<=1?d:this._unique(d)},_scrollBarSize:0,_getClass:function(c){return(typeof c.className=="string"&&c.className)||(typeof c.className.baseVal=="string"&&c.className.baseVal)||(typeof c.getAttribute!=="undefined"&&c.getAttribute("class"))||""},_setClass:function(d,c){if(typeof d.className=="string"){d.className=c}else{if(typeof d.className.baseVal=="string"){d.className.baseVal=c}else{if(typeof d.getAttribute!="undefined"){d.setAttribute(c)}}}},getScrollBarSize:function(d){var c=this;if(d||!c._scrollBarSize){var e;xui("body").append(e=xui.create('<div style="width:50px;height:50px;visibility:hidden;position:absolute;margin:0;padding:0;left:-10000px;overflow:scroll;"></div>'));c._scrollBarSize=e.get(0).offsetWidth-e.get(0).clientWidth;e.remove()}return c._scrollBarSize},getStyle:function(e,d){if(!e||e.nodeType!=1){return""}if(d=="rotate"){return xui(e).rotate()}var u=xui.Dom,n=xui.Dom._css3prop;var x,w;if(d=="opacity"&&(!u.css3Support("opacity"))&&xui.browser.ie){w=d="filter"}x=e.style[d];if(!x||x==="initial"){var r=arguments.callee,y,q=xui.browser,c=r.map||(r.map={"float":1,cssFloat:1,styleFloat:1}),k=r._c1||(r._c1={}),g=r._c2||(r._c2={}),f=r._c3||(r._c3={}),d=k[d]||(k[d]=d.replace(/\-(\w)/g,function(A,z){return z.toUpperCase()})),m=g[d]||(g[d]=d.replace(/([A-Z])/g,"-$1").toLowerCase()),l,h;var p=d;if(p.indexOf("border")===0){p=p.replace(/[-]?(left|top|right|bottom)/ig,"")}if(_.arr.indexOf(n,p)!=-1){if(!u.css3Support(d)){return""}else{if(d!="textShadow"){l=q.cssTag2+m.charAt(0).toUpperCase()+m.substr(1);h=q.cssTag1+m}}}if(c[d]){d=xui.browser.ie?"styleFloat":"cssFloat"}x=((y=document.defaultView)&&y.getComputedStyle)?(y=y.getComputedStyle(e,null))?(y.getPropertyValue(m)||(h&&y.getPropertyValue(h))):"":e.currentStyle?(e.currentStyle[d]||e.currentStyle[m]||(l&&(e.currentStyle[l]||e.currentStyle[h]))):((e.style&&(e.style[d]||(l&&e.style[l])))||"")}return w?x?(parseFloat(x.match(/alpha\(opacity=(.*)\)/)[1])||0)/100:1:(x||"")},$transformIE:function(f,r){var x=(f.style.filter||"").replace(/progid\:DXImageTransform\.Microsoft\.Matrix\([^)]+\)/ig,"").replace(/(^[\s,]*)|([\s,]*$)/g,"").replace(/,[\s]+/g,","+(xui.browser.ver==8?"":" "));if(xui.browser.ie8){f.style.msfilter=x}f.style.filter=x;f.style.marginTop=f.style.marginLeft="";if(r){var n=function(){var B,z=Math.PI/180,y=function(G,F,I,H,E,D){var C={};C.m11=_.isSet(G)?parseFloat(G):1;C.m12=_.isSet(F)?parseFloat(F):0;C.m21=_.isSet(I)?parseFloat(I):0;C.m22=_.isSet(H)?parseFloat(H):1;C.dx=_.isSet(E)?parseFloat(E):0;C.dy=_.isSet(D)?parseFloat(D):0;return C},w=function(E,D){var C={};C.m11=A(E.m11*D.m11+E.m21*D.m12,10);C.m12=A(E.m12*D.m11+E.m22*D.m12,10);C.m21=A(E.m11*D.m21+E.m21*D.m22,10);C.m22=A(E.m12*D.m21+E.m22*D.m22,10);C.dx=A(D.dx+E.dx,10);C.dy=A(D.dy+E.dy,10);return C},h=function(C){return z*C},A=function(D,E){var C=Math.round(D*Math.pow(10,E))/Math.pow(10,E);return C};this.rotate=function(E){var D=_.isSet(E)?parseFloat(h(parseFloat(E))):0;var C=y(Math.cos(D),-Math.sin(D),Math.sin(D),Math.cos(D),0,0);B=w(C,B)};this.translate=function(D,E){var C=y(1,0,0,1,parseFloat(D),parseFloat(E));B=w(C,B)};this.translateX=function(C){this.translate(C,0)};this.translateY=function(C){this.translate(0,C)};this.scale=function(D,E){var C=y(_.isSet(D)?parseFloat(D):1,0,0,_.isSet(E)?parseFloat(E):1,0,0);B=w(C,B)};this.scaleX=function(C){this.scale(C,1)};this.scaleY=function(C){this.scale(1,C)};this.skew=function(D,E){D=_.isSet(D)?parseFloat(h(parseFloat(D))):0;E=_.isSet(E)?parseFloat(h(parseFloat(E))):0;var C=y(1,Math.tan(D),Math.tan(E),1,0,0);B=w(C,B)};this.skewX=function(C){this.skew(C,0)};this.skewY=function(C){this.skew(0,C)};this.matrix=function(F,E,H,G,D,C){B=w(y(F,E,H,G,D,C),B)};this.getMatrix=function(){return B};this.getFilter=function(){return"progid:DXImageTransform.Microsoft.Matrix(M11="+B.m11+", M12="+B.m12+", M21="+B.m21+", M22="+B.m22+", Dx="+B.dx+", Dy="+B.dy+", SizingMethod='auto expand')"};this.getX=function(){return B.dx};this.getY=function(){return B.dy};this.reset=function(){B=y(1,0,0,1,0,0)};this.reset()};var d=function(A){var w=new n();var D=A.match(/[A-z]+\([^\)]+/g)||[];for(var z=0;z<D.length;z++){var h=D[z].split("("),B=h[0],C=h[1],y;switch(B){case"rotate":w.rotate(C);break;case"scale":y=C.split(",");w.scale(y[0],y[1]);break;case"scaleX":w.scaleX(C);break;case"scaleY":w.scaleY(C);break;case"skew":y=C.split(",");w.skew(y[0],y[1]);break;case"skewX":w.skewX(C);break;case"skewY":w.skewY(C);break;case"translate":y=C.split(",");w.translate(y[0],y[1]);break;case"translateX":w.translateX(C);break;case"translateY":w.translateY(C);break}}return w};var p=d(r);var e=f.offsetWidth,u=f.offsetHeight;var c=p.getFilter();var x=((f.style.filter?(f.style.filter+","):"")+c).replace(/(^[\s,]*)|([\s,]*$)/g,"").replace(/,[\s]+/g,","+(xui.browser.ver==8?"":" "));if(xui.browser.ie8){f.style.msfilter=x}f.style.filter=x;if(f.getBoundingClientRect){var k=p.getX(),g=p.getY(),m=f.getBoundingClientRect(),q=m.right-m.left,l=m.bottom-m.top;f.style.marginLeft=((e-q)/2+10+k)+"px";f.style.marginTop=((u-l)/2+10+g)+"px"}f.style.transform=r}},$textShadowIE:function(h,l,g){if(!l){var k=function(f){return(f||"").replace(/progid\:DXImageTransform\.Microsoft\.(Chroma|DropShadow|Glow)\([^)]+\)/ig,"").replace(/(^[\s,]*)|([\s,]*$)/g,"").replace(/,[\s]+/g,","+(xui.browser.ver==8?"":" "))},d=h.style.filter;if(d){if(xui.browser.ie8){h.style.msfilter=k(d)}h.style.filter=k(d)}if(!g){h.style.backgroundColor=""}}else{var k=function(f,p,m,n){return(g?"":"progid:DXImageTransform.Microsoft.Chroma(Color=#cccccc) ")+"progid:DXImageTransform.Microsoft.DropShadow(Color="+n+", OffX="+f+", OffY="+p+") "+(parseFloat(m)>0?"progid:DXImageTransform.Microsoft.Glow(Strength="+m+", Color="+n+")":"")},e=l.match(/([\d\.-]+)px\s+([\d\.-]+)px(\s+([\d\.-]+)px)?(\s+([#\w]+))?/);if(e){var c=((h.style.filter?(h.style.filter+","):"")+k(e[1],e[2],e[4],e[6]||"#000000")).replace(/(^[\s,]*)|([\s,]*$)/g,"").replace(/,[\s]+/g,","+(xui.browser.ver==8?"":" "));if(xui.browser.ie8){h.style.msfilter=c}h.style.filter=c;if(!g){h.style.backgroundColor="#cccccc"}}}},$setGradients:function(w,u){var C=this,x=xui.browser,e=x.ver,g="0123456789ABCDEF",r=function(E,D){E=parseInt(E*D,10)||0;E=(E>255||E<0)?0:E;return g.charAt((E-E%16)/16)+g.charAt(E%16)},f=function(D){D=D.split("");return g.indexOf(D[0].toUpperCase())*16+g.indexOf(D[1].toUpperCase())};if(!window.btoa){window.btoa=function(J){if(/([^\u0000-\u00ff])/.test(J)){return}var H="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",F=0,I,G,E,D=[];while(F<J.length){I=J.charCodeAt(F);E=(F+1)%3;switch(E){case 1:D.push(H.charAt(I>>2));break;case 2:D.push(H.charAt((G&3)<<4|(I>>4)));break;case 0:D.push(H.charAt((G&15)<<2|(I>>6)));D.push(H.charAt(I&63));break}G=I;F++}if(E==1){D.push(H.charAt((G&3)<<4));D.push("==")}else{if(E==2){D.push(H.charAt((G&15)<<2));D.push("=")}}return D.join("")}}var q=function(S,I,G,D,O,aa){var P="xui.s-ie8gdfix";if(!S||S.nodeType!=1||!S.style){return}var R=C.getStyle(S,"overflow"),Q=C.getStyle(S,"display");if(R!="hidden"||(Q!="block"&&Q!="relative")){return}if(!I){var V,Z=S.childNodes,T=Z.length;for(V=0;V<T;V++){if(Z[V].nodeType==1&&Z[V].id==P){S.removeChild(Z[V]);break}}S.style.backgroundColor="";var L=((S.style.filter||"").replace(/progid\:DXImageTransform\.Microsoft\.Alpha\([^)]+\)/ig,"")).replace(/(^[\s,]*)|([\s,]*$)/g,"").replace(/,[\s]+/g,","+(xui.browser.ver==8?"":" "));if(xui.browser.ie8){S.style.msfilter=L}S.style.filter=L}else{aa=aa||1;var U=G[0].clr,E=G[G.length-1].clr;var Y=S.offsetWidth||0,F=S.offsetHeight||0,K=Y*aa*2,X=F*aa*2;if(D=="circle"){K=X=Math.min(K,X)}var T=-K/2,L=-X/2,J=K,W=X;if(_.isObj(I)){T=I.left||(T+"px");L=I.top||(L+"px")}else{switch(I){case"LT":T=-K/2;L=-X/2;break;case"T":T=(Y-K)/2;L=-X/2;break;case"RT":T=Y-K/2;L=-X/2;break;case"L":T=-K/2;L=(F-X)/2;break;case"C":T=(Y-K)/2;L=(F-X)/2;break;case"R":T=Y-K/2;L=(F-X)/2;break;case"LB":T=-K/2;L=F-X/2;break;case"B":T=(Y-K)/2;L=F-X/2;break;case"RB":T=Y-K/2;L=F-X/2;break}T+="px";L+="px"}var N=document.createElement("div"),M=N.style;N.id=P;M.position="absolute";M.zIndex="0";M.top=L;M.left=T;M.width=J+"px";M.height=W+"px";M.backgroundColor=U;var H=G[0].opacity?parseFloat(G[0].opacity)*100:100;var L=((M.filter?(M.filter+","):"")+"progid:DXImageTransform.Microsoft.Alpha(opacity="+H+", finishopacity=0, style=2)").replace(/(^[\s,]*)|([\s,]*$)/g,"").replace(/,[\s]+/g,","+(xui.browser.ver==8?"":" "));if(xui.browser.ie8){M.msfilter=L}M.filter=L;if(S.firstChild){S.insertBefore(N,S.firstChild)}else{S.appendChild(N)}S.style.backgroundColor=E;if(G[G.length-1].opacity){var L=((S.style.filter?(S.style.filter+","):"")+"progid:DXImageTransform.Microsoft.Alpha(opacity="+(parseFloat(G[G.length-1].opacity)*100)+")").replace(/(^[\s,]*)|([\s,]*$)/g,"").replace(/,[\s]+/g,","+(xui.browser.ver==8?"":" "));if(xui.browser.ie8){S.style.msfilter=L}S.style.filter=L}}},B=function(R,J,G){var O="xui.s-ie8gdfix";if(!R||R.nodeType!=1||!R.style){return}var Q=C.getStyle(R,"overflow"),P=C.getStyle(R,"display");if(Q!="hidden"){C.setStyle(R,"overflow","hidden")}if(P!="block"&&P!="relative"){C.setStyle(R,"display","relative")}if(!J){var W,Y=R.childNodes,T=Y.length;for(W=0;W<T;W++){if(Y[W].nodeType==1&&Y[W].id==O){R.removeChild(Y[W]);break}}R.style.backgroundColor="";var K=(R.style.filter||"").replace(/progid\:DXImageTransform\.Microsoft\.Alpha\([^)]+\)/ig,"").replace(/(^[\s,]*)|([\s,]*$)/g,"").replace(/,[\s]+/g,","+(xui.browser.ver==8?"":" "));if(xui.browser.ie8){R.style.msfilter=K}R.style.filter=K}else{var V=G[0].clr,E=G[G.length-1].clr;var X=R.offsetWidth||0,F=R.offsetHeight||0,N=Math.min(X,F),I=0,S=N,U=0,D=N;switch(J){case"LT":I=0;U=0;S=N;D=N;break;case"RT":I=N;U=0;S=0;D=N;break;case"LB":I=0;U=N;S=N;D=0;break;case"RB":I=N;U=N;S=0;D=0;break}var M=document.createElement("div"),L=M.style;M.id=O;L.position="absolute";L.zIndex="0";L.top=0;L.left=0;L.width=X;L.height=F;L.backgroundColor=V;var H=G[0].opacity?parseFloat(G[0].opacity)*100:100;var K=((L.filter?(L.filter+","):"")+"progid:DXImageTransform.Microsoft.Alpha(style=1, opacity="+H+", finishopacity=0, startX="+I+",finishX="+S+",startY="+U+",finishY="+D+")").replace(/(^[\s,]*)|([\s,]*$)/g,"").replace(/,[\s]+/g,","+(xui.browser.ver==8?"":" "));if(xui.browser.ie8){L.msfilter=K}L.filter=K;if(R.firstChild){R.insertBefore(M,R.firstChild)}else{R.appendChild(M)}R.style.backgroundColor=E;if(G[G.length-1].opacity){var K=((R.style.filter?(R.style.filter+","):"")+"progid:DXImageTransform.Microsoft.Alpha(opacity="+(parseFloat(G[G.length-1].opacity)*100)+")").replace(/(^[\s,]*)|([\s,]*$)/g,"").replace(/,[\s]+/g,","+(xui.browser.ver==8?"":" "));if(xui.browser.ie8){R.style.msfilter=K}R.style.filter=K}}},n=function(F,H,M){var D="xui.s-ie8gdfix";if(!F||F.nodeType!=1||!F.style){return}if(!H){var N=((F.style.filter||"").replace(/progid\:DXImageTransform\.Microsoft\.Gradient\([^)]+\)/ig,"")).replace(/(^[\s,]*)|([\s,]*$)/g,"").replace(/,[\s]+/g,","+(xui.browser.ver==8?"":" "));if(xui.browser.ie8){F.style.msfilter=N}F.style.filter=N;var I,J=F.childNodes,G=J.length;for(I=0;I<G;I++){if(J[I].nodeType==1&&J[I].id==D){F.removeChild(J[I]);break}}F.style.backgroundColor="";var N=((F.style.filter||"").replace(/progid\:DXImageTransform\.Microsoft\.Alpha\([^)]+\)/ig,"")).replace(/(^[\s,]*)|([\s,]*$)/g,"").replace(/,[\s]+/g,","+(xui.browser.ver==8?"":" "));if(xui.browser.ie8){F.style.msfilter=N}F.style.filter=N}else{var L=M[0].clr,E=M[M.length-1].clr,K=1,N;if(M[0].opacity){L=L.replace("#","#"+r(M[0].opacity,255))}if(M[M.length-1].opacity){E=E.replace("#","#"+r(M[M.length-1].opacity,255))}switch(H){case"LT":case"RT":case"LB":case"RB":B(F,H,M);return;case"L":K=1;break;case"R":K=1;N=L;L=E;E=N;break;case"T":K=0;break;case"B":K=0;N=L;L=E;E=N;break}var N=((F.style.filter?(F.style.filter+","):"")+"progid:DXImageTransform.Microsoft.Gradient(StartColorstr='"+L+"',EndColorstr='"+E+"',GradientType="+K+")").replace(/(^[\s,]*)|([\s,]*$)/g,"").replace(/,[\s]+/g,","+(xui.browser.ver==8?"":" "));if(xui.browser.ie8){F.style.msfilter=N}F.style.filter=N}},z=function(F,J,O,N,P,M){if(!J){F.style.backgroundImage=""}else{M=M||1;var E="svg:"+_.id(),I="0%",H="0%",D=M*100+"%";if(_.isObj(J)){I=J.left||I;H=J.left||H}else{switch(J){case"T":I="50%";H="0%";break;case"B":I="50%";H="100%";break;case"L":I="0%";H="50%";break;case"R":I="100%";H="50%";break;case"LT":I="0%";H="0%";break;case"RT":I="100%";H="0%";break;case"RB":I="100%";H="100%";break;case"LB":I="0%";H="100%";break;case"C":I="50%";H="50%";break}}var L='<svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 1 1" preserveAspectRatio="none"><radialGradient id="'+E+'" gradientUnits="userSpaceOnUse" cx="'+I+'" cy="'+H+'" r="'+D+'">';for(var K=0,G=O.length;K<G;K++){L+='<stop stop-color="'+O[K].clr+'" offset="'+O[K].pos+'" '+(_.isSet(O[K].opacity)?(' stop-opacity="'+O[K].opacity+'"'):"")+" />"}L+='</radialGradient><rect x="-50" y="-50" width="101" height="101" fill="url(#'+E+')" /></svg>';F.style.backgroundImage='url("data:image/svg+xml;base64,'+window.btoa(L)+'")'}},y=function(G,I,N){if(!I){G.style.backgroundImage=""}else{var E="svg"+_.id(),F="0%",M="0%",D="0%",L="100%";switch(I){case"T":F="50%";M="0%";D="50%";L="100%";break;case"B":F="50%";M="100%";D="50%";L="0%";break;case"L":F="0%";M="50%";D="100%";L="50%";break;case"R":F="100%";M="50%";D="0%";L="50%";break;case"LT":F="0%";M="0%";D="100%";L="100%";break;case"RT":F="100%";M="0%";D="0%";L="100%";break;case"RB":D="0%";L="0%";F="100%";M="100%";break;case"LB":F="0%";M="100%";D="100%";L="0%";break;default:}var K='<svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 1 1" preserveAspectRatio="none"><linearGradient id="'+E+'" gradientUnits="userSpaceOnUse" x1="'+F+'" y1="'+M+'" x2="'+D+'" y2="'+L+'">';for(var J=0,H=N.length;J<H;J++){K+='<stop stop-color="'+N[J].clr+'" offset="'+N[J].pos+'" '+(_.isSet(N[J].opacity)?(' stop-opacity="'+N[J].opacity+'"'):"")+"/>"}K+='</linearGradient><rect x="0" y="0" width="1" height="1" fill="url(#'+E+')" /></svg>';G.style.backgroundImage='url("data:image/svg+xml;base64,'+window.btoa(K)+'")'}},m=function(E,F,M,I,N,H){var K=[],J=[],D=E.style;_.arr.each(M,function(P){var O=P.clr;if(_.isSet(P.opacity)&&O.charAt(0)=="#"){O=O.slice(1);O="rgba("+f(O.substr(0,2))+","+f(O.substr(2,2))+","+f(O.substr(4,2))+","+parseFloat(P.opacity)+")"}K.push(O+" "+P.pos);if(x.isWebKit){J.push("color-stop("+P.pos+","+O+")")}});if(!F){D.backgroundImage=""}else{var G;if(_.isObj(F)){G=F.left+" "+F.top}else{switch(F){case"LT":G="left top";break;case"T":G="center top";break;case"RT":G="right top";break;case"L":G="left center";break;case"C":G="center center";break;case"R":G="right center";break;case"LB":G="left bottom";break;case"B":G="center bottom";break;case"RB":G="right bottom";break;default:G="left top"}}if(x.isWebKit){D.backgroundImage="-webkit-gradient(radial,"+G+", 0px, "+G+", 100%,"+J.join(",")+")"}var L="radial-gradient("+G+","+I+" "+N+","+K.join(",")+")";if(x.cssTag1){D.backgroundImage=x.cssTag1+L}D.backgroundImage="radial-gradient("+N+" "+I+" at "+G+","+K.join(",")+")"}},l=function(F,H,M){var J=[],I=[],D=F.style;_.arr.each(M,function(O){var N=O.clr;if(_.isSet(O.opacity)&&N.charAt(0)=="#"){N=N.slice(1);N="rgba("+f(N.substr(0,2))+","+f(N.substr(2,2))+","+f(N.substr(4,2))+","+parseFloat(O.opacity)+")"}J.push(N+" "+O.pos);if(x.isWebKit){I.push("color-stop("+O.pos+","+N+")")}});if(!H){D.backgroundImage=""}else{var K="to bottom";var G="top";var E="left top, left bottom";switch(H){case"LT":K="135deg";G="-45deg";E="left top, right bottom";break;case"T":G="top";K="to bottom";E="left top, left bottom";break;case"RT":K=G="-135deg";E="right top, left bottom";break;case"L":G="left";K="to right";E="left top, right top";break;case"R":G="right";K="to left";E="right top, left top";break;case"LB":K=G="45deg";E="left bottom, right top";break;case"B":G="bottom";K="to top";E="left bottom, left top";break;case"RB":K="-45deg";G="135deg";E="right bottom, left top";break;default:K=H;G=H;E="left top, right bottom"}if(x.isWebKit){D.backgroundImage="-webkit-gradient(linear,"+E+", "+I.join(",")+")"}var L="linear-gradient({#},"+J.join(",")+")";if(x.cssTag1){D.backgroundImage=x.cssTag1+L.replace("{#}",G)}D.backgroundImage=L.replace("{#}",K)}};var d=u?(u.type||u||"linear").toLowerCase():null,A=u?(u.rate||1):null,c=u?(u.shape||"circle").toLowerCase():null,p=u?(u.size||"farthest-corner").toLowerCase():null,k=u?u.orient:null,h=u?u.stops:null;if(d!="linear"){d="radial"}if(h){if(h.length>1){_.arr.stableSort(h,function(D,E){D=parseFloat(D.pos);E=parseFloat(E.pos);return D>E?1:D==E?0:-1})}else{return}}if(x.ie&&e>=6&&e<9){if(d=="linear"){n(w,k,h)}else{q(w,k,h,c,p,A)}}else{if((x.ie&&e>=9&&e<10)||(x.opr&&e<11.1)){if(d=="linear"){y(w,k,h)}else{z(w,k,h,c,p,A)}}else{if((x.gek&&e>=3.6)||(x.isChrome&&e>=10)||(x.isSafari&&e>=5.1)||(x.ie&&e>=10)||(x.opr&&e>=11.1)){if(d=="linear"){l(w,k,h)}else{if(x.opr&&e<12){z(w,k,h,c,p,A)}else{m(w,k,h,c,p,A)}}}}}},_vAnimate:function(e,f,c,h){if(!c||!c.params||_.isEmpty(c.params)){if(h){_.tryF(h)}return}var g=c.params,d={};e=xui(e);_.each(g,function(l,k){d[k]=l[0]});e.animate(g,function(k){if(f){e.css(d)}},function(k){if(!f){e.css(d)}if(h){_.tryF(h)}},c.duration,0,c.type).start()},$adjustCss:function(f,e){var d={nodeType:1,style:{}};xui.Dom.setStyle(d,f);if(e){var c=[];if(xui.browser.ie&&xui.browser.ver==8&&d.style.filter){d.style["-ms-filter"]=d.style.filter}_.each(d.style,function(h,g){c.push(g.replace(/([A-Z])/g,"-$1").toLowerCase()+":"+h)});return c.join(";").replace(/[;]+/g,";")}else{return d.style}},_cssfake:{rotate:1,scaleX:1,scaleY:1,translateX:1,translateY:1,skewX:1,skewY:1},setStyle:function(g,d,w){if(d=="rotate"){xui(g).rotate(w);return this}var u=xui.Dom,p=xui.Dom._css3prop,y=xui.browser,x=u._cssfake;if(g.nodeType!=1){return}if(typeof d=="string"){if(x[d]){xui(g)[d](w)}else{var r=this.getStyle,l=r._c1||(r._c1={}),e=r._r1||(r._r1=/alpha\([^\)]*\)/ig),c=r.map||(r.map={"float":1,cssFloat:1,styleFloat:1});var n,m,k;d=l[d]||(l[d]=d.replace(/\-(\w)/g,function(A,z){return z.toUpperCase()}));var q=d;if(q.indexOf("border")===0){q=q.replace(/[-]?(left|top|right|bottom)/ig,"")}if(d=="$gradient"){return u.$setGradients(g,w)}else{if(d=="opacity"){w=_.isFinite(w)?parseFloat(w)>1?1:parseFloat(w)<=0?0:parseFloat(w):1;w=w>0.9999?"":w;if((!u.css3Support("opacity"))&&y.ie){if(w===""){w=1}g.style.opacity=w;g.style.zoom=1;w="alpha(opacity="+100*w+")";var f=(g.style.filter||"").replace(e,"");w=(f?(f+","):"")+w;d="filter";if(y.ver==8){n="msfilter"}}}else{if(_.arr.indexOf(p,q)!=-1){if(!u.css3Support(d)){if(y.ie&&y.ver<9){switch(d){case"transform":linb.Dom.$transformIE(g,w);break;case"boxShadow":linb.Dom.$textShadowIE(g,w,true);break}}if(d=="textShadow"&&y.ie&&y.ver<10){linb.Dom.$textShadowIE(g,w)}return this}else{if(y.cssTag2){if(d!="textShadow"){n=y.cssTag2+d.charAt(0).toUpperCase()+d.substr(1)}}}}else{if(c[d]){d=y.ie?"styleFloat":"cssFloat"}}}}if(d=="filter"){w=w.replace(/(^[\s,]*)|([\s,]*$)/g,"").replace(/,[\s]+/g,","+(xui.browser.ver==8?"":" "))}g.style[d]=w;if(n){g.style[n]=w}if(m){g.style[m]=w}if(k){g.style[k]=w}}}else{for(var h in d){arguments.callee.call(this,g,h,d[h])}}},_css3prop:"opacity,textShadow,animationName,columnCount,flexWrap,boxDirection,backgroundSize,perspective,boxShadow,borderImage,borderRadius,boxReflect,transform,transition".split(","),css3Support:function(D){var w=arguments.callee,g=w._c||(w._c={});D=D.replace("$","").replace(/\-(\w)/g,function(k,f){return f.toUpperCase()});if(D in g){return g[D]}var y=document.createElement("div"),q=y.style,l=false,A=xui.browser,B=function(f){f=f.replace(/\-(\w)/g,function(n,k){return k.toUpperCase()});if(q[f]!==undefined){return true}if(xui.browser.cssTag2){f=xui.browser.cssTag2+f.charAt(0).toUpperCase()+f.substr(1);if(q[f]!==undefined){return true}}return false};y.id="xui_css3_"+_();if(D.indexOf("border")===0){D=D.replace(/[-]?(left|top|right|bottom)/ig,"")}switch(D){case"opacity":case"textShadow":l=q[D]==="";break;case"generatedContent":var x="tmp_css3_test"+_.id(),m="#"+y.id+"{line-height:auto;margin:0;padding:0;border:0;font:0/0 a}#"+y.id+":after{content:'a';visibility:hidden;line-height:auto;margin:0;padding:0;border:0;font:3px/1 a}";linb.CSS.addStyleSheet(m,x);xui("body").append(y);var p=y.offsetHeight;linb.CSS.remove("id",x);xui(y.id).remove(y);l=p>=3;break;case"fontFace":if(A.ie&&A.ver>=6){l=true}else{var x="tmp_css3_test"+_.id(),m='@font-face{font-family:"font";src:url("https://")}',q=linb.CSS.addStyleSheet(m,x),C=q.sheet||q.styleSheet,h=C?((C.cssRules&&C.cssRules[0])?C.cssRules[0].cssText:C.cssText||""):"";l=/src/i.test(h)&&h.indexOf("@font-face")===0;linb.CSS.remove("id",x)}break;case"rgba":q.cssText="background-color:rgba(0,0,0,0.1)";l=q.backgroundColor.indexOf("rgba")!=-1;break;case"hsla":q.cssText="background-color:hsla(120,40%,100%,.5)";l=q.backgroundColor.indexOf("hsla")!=-1||q.backgroundColor.indexOf("rgba")!=-1;break;case"multiplebgs":q.cssText="background:url(//:),url(//:),red url(//:)";l=/(url\s*\(.*?){3}/.test(q.background);break;case"gradient":var z="background-image:",e="-webkit-gradient(linear,left top,right bottom,from(#000),to(#fff));",d="linear-gradient(left top,#000,#fff);",c=[z,d];if(xui.browser.cssTag1){c.push(z);c.push(xui.browser.cssTag1+d)}if(xui.browser.isWebKit){c.push(z);c.push(e)}q.cssText=c.join("");l=!!q.backgroundImage;break;case"transform3d":var u=B("perspective");if(u&&"webkitPerspective" in document.documentElement.style){var x="tmp_css3_test"+_.id(),m="@media (transform-3d),(-webkit-transform-3d){#"+y.id+"{font:0/0;line-height:0;margin:0;padding:0;border:0;left:9px;position:absolute;height:3px;}}";linb.CSS.addStyleSheet(m,x);xui("body").append(y);var e=y.offsetLeft,d=y.offsetHeight;linb.CSS.remove("id",x);xui(y.id).remove(y);l=e===9&&d===3}l=u;break;default:l=B(D)}return g[D]=l},$preDefinedAnims:{blinkAlert:{params:{opacity:[1,0]},duration:200,returned:true,times:3},zoomAlert:{params:{scaleX:[1,1.1],scaleY:[1,1.1]},duration:100,returned:true,times:3},translateXAlert:{params:{translateX:[0,5]},duration:100,returned:true,times:3},translateYAlert:{params:{translateY:[0,5]},duration:100,returned:true,times:3},rotateAlert:{params:{rotate:[0,360]},duration:400,returned:false}},$preDefinedEffects:{Classic:[{type:"circOut",duration:200,params:{opacity:[0,1],scaleX:[0.75,1],scaleY:[0.75,1]}},{type:"circIn",duration:200,params:{opacity:[1,0],scaleX:[1,0.75],scaleY:[1,0.75]}}],Blur:[{type:"circOut",duration:200,params:{opacity:[0,1]}},{type:"circIn",duration:200,params:{opacity:[1,0]}}],Drop:[{type:"circOut",duration:200,params:{opacity:[0,1],translateY:["-25%","0%"],scaleY:[0.5,1]}},{type:"circIn",duration:200,params:{opacity:[1,0],translateY:["0%","-25%"],scaleY:[1,0.5]}}],"From Below":[{type:"circOut",duration:200,params:{opacity:[0,1],scaleX:[0,1],scaleY:[0,1]}},{type:"circIn",duration:200,params:{opacity:[1,0],scaleX:[1,0],scaleY:[1,0]}}],"From Above":[{type:"circOut",duration:200,params:{opacity:[0,1],scaleX:[2,1],scaleY:[2,1]}},{type:"circIn",duration:200,params:{opacity:[1,0],scaleX:[1,2],scaleY:[1,2]}}],"Slide In LR":[{type:"circOut",duration:200,params:{opacity:[0,1],translateX:["-150%","0%"],scaleX:[0.2,1],scaleY:[0.2,1]}},{type:"circIn",duration:200,params:{opacity:[1,0],translateX:["0%","150%"],scaleX:[1,0.2],scaleY:[1,0.2]}}],"Slide In TB":[{type:"circOut",duration:200,params:{opacity:[0,1],translateY:["-150%","0%"],scaleX:[0.2,1],scaleY:[0.2,1]}},{type:"circIn",duration:200,params:{opacity:[1,0],translateY:["0%","150%"],scaleX:[1,0.2],scaleY:[1,0.2]}}],"Flip V":[{type:"circOut",duration:200,params:{opacity:[0,1],scaleY:[0,1]}},{type:"circIn",duration:200,params:{opacity:[1,0],scaleY:[1,0]}}],"Flip H":[{type:"circOut",duration:200,params:{opacity:[0,1],scaleX:[0,1]}},{type:"circIn",duration:200,params:{opacity:[1,0],scaleX:[1,0]}}]},_getEffects:function(c,d){if(c&&typeof(c)=="string"){c=this.$preDefinedEffects[c];c=c?d?c[0]:c[1]:null}if(c&&xui.browser.ie&&xui.browser.ver<=8){_.filter(c,function(f,e){return !!xui.Dom._cssfake[e]})}return c},_setPxStyle:function(e,c,f){if(e.nodeType!=1){return false}var d=e.style;if(f||f===0){f=_.isFinite(f)?((parseInt(f,10)||0)+"px"):(f+"");if((c=="width"||c=="height")&&f.charAt(0)=="-"){f="0"}if(d[c]!=f){d[c]=f;return true}}return false},_emptyDivId:"xui.empty::",getEmptyDiv:function(g){var h=1,d,f,c,e,n,l=0,m=document,k=m.body,p=function(q){q.id=d;xui([q]).attr("style","position:absolute;visibility:hidden;overflow:visible;left:"+xui.Dom.HIDE_VALUE+";top:"+xui.Dom.HIDE_VALUE+";")};g=g||1;while(1){d=this._emptyDivId+h;if(e=xui.Dom.byId(d)){if(!e.firstChild&&++l==g){return xui([e])}}else{e=m.createElement("div");p(e,d);if(k.firstChild){k.insertBefore(e,k.firstChild)}else{k.appendChild(e)}f=xui([e]);k=e=null;return f}h++}k=e=null},setCover:function(e,k,m){var h=arguments.callee,c="xui.temp:cover:",l="xui.temp:message:",g=(typeof(e)=="string"||typeof(e)=="function")?e:"",f,d;if((f=xui(c)).isEmpty()){xui("body").prepend(f=xui.create('<div id="'+c+'" class="xui-cover xui-custom" style="position:absolute;display:none;left:0;top:0;"><div id="'+l+'" class="xui-coverlabel xui-custom" style="position:absolute;"></div></div>'));f.setSelectable(false);xui.setNodeData(f.get(0),"zIndexIgnore",1)}if(xui.Dom.byId(l)){d=xui(l)}if(!e){if(typeof h._label=="string"&&h._label!==k){return}if(h._showed){if(d){d.empty(false)}f.css({zIndex:0,cursor:"",display:"none",cursor:""});h._showed=false}delete h._label}else{if(typeof k=="string"){h._label=k}var n=xui.win;if(!h._showed){f.css({zIndex:xui.Dom.TOP_ZINDEX*10,display:"",width:n.scrollWidth()+"px",height:n.scrollHeight()+"px",cursor:m||"progress"});h._showed=true}if(g){if(typeof(g)=="function"){g(f,d)}else{if(d){d.html(g+"",false);d.css({left:n.scrollLeft()+n.width()/2-d.width()/2+"px",top:n.scrollTop()+n.height()/2-d.height()/2+"px"})}}}}},byId:function(c){return document.getElementById(c||"")},$hasEventHandler:function(d,c){return xui.getNodeData(d,["eHandlers",c])},submit:function(h,g,l,k,f){g=_.isHash(g)?g:{};g=_.clone(g,function(m){return m!==undefined});h=h||"";k=k||(h.substring(0,6).toLowerCase()=="mailto"?"_self":"_blank");var e=[];if(!_.isEmpty(g)){var c,d=[];_.each(g,function(n,m){if(n&&n["xui.UIProfile"]&&n.$xuiFileCtrl){if(c=n.boxing().getUploadObj()){d.push({id:n.$xid,file:c});c.id=c.name=m;g[m]=c}}});l=l||(c?"post":"get");if(l.toLowerCase()=="get"){window.open(h+"?"+_.urlEncode(g),k)}else{_.each(g,function(n,m){if(_.isDefined(n)&&!_.isElem(n)){e.push('<textarea name="'+m+'">'+(typeof n=="object"?_.serialize(n):n)+"</textarea>")}});e.push('<input type="hidden" name="rnd" value="'+_()+'">');e=_.str.toDom('<form target="'+k+'" action="'+h+'" method="'+l+(f?'" enctype="'+f:"")+'">'+e.join("")+"</form>");xui.Dom.getEmptyDiv().append(e);if(d.length){_.arr.each(d,function(n,m){e.append(n.file)})}e.get(0).submit();e.remove();e=null}if(d.length){_.arr.each(d,function(n,m){if(m=xui.getObject(n.id)){if(m["xui.UIProfile"]&&m.boxing()&&m.boxing().setUploadObj){m.boxing().setUploadObj(n.file)}}})}}else{window.open(h,k)}},selectFile:function(f,d){var e=document.createElement("input");e.type="file";if(d){e.accept=d}e.onchange=function(){_.tryF(f,[this,this.files[0]],this)};if(!!window.ActiveXObject||"ActiveXObject" in window){var c=document.createElement("div");e.appendChild(c);c.click();e.removeChild(c)}else{e.click()}e=null},busy:function(d,c){xui.Dom.setCover(c||true,d)},free:function(c){xui.Dom.setCover(false,c)},animate:function(m,k,q,c,l,e,n,g,p,h,d){var f=document.createElement("div");_.merge(m,{position:"absolute",left:this.HIDE_VALUE,zIndex:this.TOP_ZINDEX++});xui.Dom.setStyle(f,m);document.body.appendChild(f);return xui([f]).animate(k,q,function(){_.tryF(c);if(f.parentNode){f.parentNode.removeChild(f)}f=null},l,e,n,g,p,h,d)},$enableEvents:function(d){if(!_.isArr(d)){d=[d]}var c=this,e;_.arr.each(d,function(f){e=function(h,l,g){if(typeof h=="function"){return this.$addEvent(f,h,l,g)}else{if(h===null){return this.$removeEvent(f,l,g)}}var k=arguments[1]||{};k.$xuiall=(arguments[0]===true);return this.$fireEvent(f,k)};e.$event$=1;c.plugIn(f,e)})}},After:function(G){var z=this;_.each({parent:["y",false],prev:["x",false],next:["x",true],first:["y",true],last:["y",1]},function(d,c){z.plugIn(c,function(h){return this.$iterator(d[0],d[1],true,h||1)})});_.arr.each(_.toArr("offsetLeft,offsetTop,scrollWidth,scrollHeight"),function(c){z.plugIn(c,function(){var p=this.get(0),m=window,r=document;if(p==m||p==r){if("scrollWidth"==c||"scrollHeight"==c){var l=r.documentElement,h=r.body;return Math.max(l[c],h[c])}else{p=xui.browser.contentBox?r.documentElement:r.body}}return p[c]})});var A="padding",D="margin",J="border",I="inner",C="offset",x="outer",q="width",F="height",e="Width",n="Height",f="Top",k="Left",u="top",E="left",g="Right",y="Bottom";_.arr.each([["_"+A+"H",A+f,A+y],["_"+A+"W",A+k,A+g],["_"+J+"H",J+f+e,J+y+e],["_"+J+"W",J+k+e,J+g+e],["_"+D+"W",D+k,D+g],["_"+D+"H",D+f,D+y]],function(h){var d,c=xui.Dom.getStyle;z.plugIn(h[0],function(l){l=l||"both";d=this.get(0);return((l=="both"||l=="left"||l=="top")?parseInt(c(d,h[1]),10):0)+((l=="both"||l=="right"||l=="bottom")?parseInt(c(d,h[2]),10):0)||0})});_.arr.each([["_W",q,"_"+A+"W","_"+J+"W","_"+D+"W",I+e,C+e],["_H",F,"_"+A+"H","_"+J+"H","_"+D+"H",I+n,C+n]],function(c){z.plugIn(c[0],function(P,w,O,X){var N,L,H,R=P.style,W=arguments.callee,K=xui.browser.contentBox,Q=W.r1||(W.r1=/%$/),m=xui.Dom.getStyle,S=xui.Dom._setPxStyle,l=typeof O,B;if(l=="undefined"||l=="boolean"){if(O===true){N=(m(P,"display")=="none");if(N){var U=xui.Dom.getEmptyDiv().html("*",false);xui([P]).swap(U);var V,M,T;V=R.visibility,M=R.position,T=R.display;M=M||"";V=V||"";T=T||"";R.visibility="hidden";R.position="absolute";R.display="block"}}H=xui([P]);switch(w){case 1:L=m(P,c[1]);if((isNaN(parseInt(L,10))||Q.test(L))&&!X){L=W(P,2,undefined,true)-(K?H[c[2]]():0)}L=parseInt(L,10)||0;break;case 2:L=P[c[6]];if(!L){if(!X){L=W(P,1,undefined,true)+(K?H[c[2]]():0)}}else{L-=H[c[3]]()}break;case 3:L=P[c[6]];if(!L){L=W(P,1)+(K?H[c[2]]():0)+H[c[3]]()}break;case 4:L=W(P,3);L+=H[c[4]]();break}if(N){R.display=T;R.position=M;R.visibility=V;H.swap(U);U.empty(false)}return parseInt(L,10)||0}else{switch(w){case 1:if(S(P,c[1],O)){if(xui.Dom.$hasEventHandler(P,"onsize")){var h={};h[c[1]]=1;xui([P]).onSize(true,h)}}break;case 2:W(P,1,O-(K?xui([P])[c[2]]():0));break;case 3:W(P,1,O-(H=xui([P]))[c[3]]()-(K?H[c[2]]():0));break;case 4:W(P,1,O-(H=xui([P]))[c[4]]()-H[c[3]]()-(K?H[c[2]]():0));break}}})});_.arr.each([[I+e,"_W",2],[C+e,"_W",3],[x+e,"_W",4],[I+n,"_H",2],[C+n,"_H",3],[x+n,"_H",4]],function(c){z.plugIn(c[0],function(h){var d=typeof h;if(d=="undefined"||d=="boolean"){return this[c[1]](this.get(0),c[2])}else{return this.each(function(l){this[c[1]](l,c[2],h)})}})});_.arr.each([[E+"By",E],[u+"By",u],[q+"By",q],[F+"By",F]],function(c){z.plugIn(c[0],function(r,p){if(r===0){return this}var d,l,h=c[1];return this.each(function(m){d=xui.use(m.$xid)[h]();d=(parseInt(d,10)||0)+r;if(h=="width"||h=="height"){d=d>0?d:0}m.style[h]=d+"px";if(p){l={};l[h]=1;var w=xui.Dom.$hasEventHandler;if((h=="left"||h=="top")&&w(m,"onmove")){xui([m]).onMove(true,l)}if((h=="width"||h=="height")&&w(m,"onsize")){xui([m]).onSize(true,l)}}},this)})});_.arr.each(["scrollLeft","scrollTop"],function(c){z.plugIn(c,function(m){var h=document.documentElement,d=document.body;if(m!==undefined){return this.each(function(p){if(p===window||p===document){h[c]=d[c]=m}else{p[c]=m}})}else{var l=this.get(0);if(l===window||l===document){if("scrollTop"==c){return window.pageYOffset||(h[c]||d[c]||0)}if("scrollLeft"==c){return window.pageXOffset||(h[c]||d[c]||0)}}return l[c]}})});_.arr.each("width,height,left,top".split(","),function(c){z.plugIn(c,function(B){var K=this,h=K.get(0),p=xui.browser,m=typeof B,w=document,H;if(!h||h.nodeType==3){return}if(m=="undefined"||m=="boolean"){if((c=="width"&&(H="Width"))||(c=="height"&&(H="Height"))){if(w===h){return Math.max(w.body["scroll"+H],w.body["offset"+H],w.documentElement["scroll"+H],w.documentElement["offset"+H])}if(window===h){return p.opr?Math.max(w.body["client"+H],window["inner"+H]):p.kde?window["inner"+H]:(xui.browser.contentBox&&w.documentElement["client"+H])||w.body["client"+H]}}if(c=="width"){B=parseInt(h.style.width,10)||K._W(h,1,B)}else{if(c=="height"){B=parseInt(h.style.height,10)||K._H(h,1,B)}else{B=xui.Dom.getStyle(h,c)}}return B=="auto"?B:(parseInt(B,10)||0)}else{var l=xui.Dom._setPxStyle,H,r,d=_.isFinite(B)?(B+"px"):B;return K.each(function(L){if(L.nodeType!=1){return}if(L.style[c]!==d){if(c=="width"){K._W(L,1,B)}else{if(c=="height"){K._H(L,1,B)}else{if(l(L,c,B)){if((c=="top"||c=="left")&&xui.Dom.$hasEventHandler(h,"onmove")){r={};r[c]=1;xui([L]).onMove(true,r)}}}}}})}})});_.arr.each(xui.Event._events,function(c){_.arr.each(xui.Event._getEventName(c),function(d){z.$enableEvents(d)})})},Initialize:function(){var c=window,e=document;_.set(xui.$cache.domPurgeData,"!window",{$xid:"!window",element:c});_.set(xui.$cache.domPurgeData,"!document",{$xid:"!document",element:e});xui.win=xui(["!window"],false);xui.doc=xui(["!document"],false);xui.busy=xui.Dom.busy;xui.free=xui.Dom.free;xui.$inlineBlock=xui.browser.gek?xui.browser.ver<3?["-moz-inline-block","-moz-inline-box","inline-block"]:"inline-block":xui.browser.ie6?["inline-block","inline"]:"inline-block",xui.doc.onKeydown(function(h,g,d){xui.Event.$keyboard=xui.Event.getKey(g);var f=xui.Event,l,k=f.getKey(g);if(k){if(k[0].length==1){k[0]=k[0].toLowerCase()}l=xui.$cache.hookKey[k.join(":")];if(l){if(l[3]){if(typeof l[3]=="function"?false===(l[3])():(!xui(l[3]).size())){delete xui.$cache.hookKey[k.join(":")];return}}if(_.tryF(l[0],l[1],l[2])===false){f.stopBubble(g);return false}}}return true},"document").onKeyup(function(g,f){delete xui.Event.$keyboard;var d=xui.Event,k,h=d.getKey(f);if(h){if(h[0].length==1){h[0]=h[0].toLowerCase()}k=xui.$cache.hookKeyUp[h.join(":")];if(k){if(k[3]){if(typeof k[3]=="function"?false===(k[3])():(!xui(k[3]).size())){delete xui.$cache.hookKeyUp[h.join(":")];return}}if(_.tryF(k[0],k[1],k[2])===false){d.stopBubble(f);return false}}}return true},"document");xui.doc.onClick(function(l,k,n){var m=xui.Event.getSrc(k),g=0,d,f;do{if(m.nodeName=="A"){d=true;break}if(++g>8){break}}while(m=m.parentNode);if(d){f=_.str.trim(m.href||"").toLowerCase();if(xui.History){var h=location.href.split("#")[0];if(!xui.Event.getKey(k).shiftKey&&xui.Event.getBtn(k)=="left"&&(f.indexOf(h+"#")==0||f.indexOf("#")==0)){xui.History.setFI(m.href.replace(h,""))}}if(xui.browser.ie&&(f.indexOf("javascript:")==0||f.indexOf("#")!==-1)){return false}}},"hookA",0);if(xui.browser.ie&&xui.browser.ver<10&&e.body){e.body.onselectstart=function(f,d){f=event.srcElement;while(f&&f.nodeName&&f.nodeName!="BODY"&&f.nodeName!="HTML"){if(d=xui.getNodeData(f,"_onxuisel")){return d!="false"}if(f.nodeName=="INPUT"||f.nodeName=="TEXTAREA"){break}f=f.parentNode}return true}}xui.win.afterUnload(function(){c.onresize=null;if(c.removeEventListener){c.removeEventListener("DOMMouseScroll",xui.Event.$eventhandler3,false)}e.onmousewheel=c.onmousewheel=null;if(xui.browser.isTouch){if(e.removeEventListener){e.removeEventListener((xui.browser.ie&&c.PointerEvent)?"pointerdown":(xui.browser.ie&&c.MSPointerEvent)?"MSPointerDown":"touchstart",xui.Event._simulateMousedown,false);e.removeEventListener((xui.browser.ie&&xui.browser.ver>=11)?"pointerup":(xui.browser.ie&&xui.browser.ver>=10)?"MSPointerUp":"touchend",xui.Event._simulateMouseup,false)}else{if(e.detachEvent){e.detachEvent((xui.browser.ie&&xui.browser.ver>=11)?"pointerdown":(xui.browser.ie&&xui.browser.ver>=10)?"MSPointerDown":"touchstart",xui.Event._simulateMousedown);e.detachEvent((xui.browser.ie&&xui.browser.ver>=11)?"pointerup":(xui.browser.ie&&xui.browser.ver>=10)?"MSPointerUp":"touchend",xui.Event._simulateMouseup)}}}if(xui.browser.ie&&e.body){e.body.onselectstart=null}if("onhashchange" in c){c.onhashchange=null}xui("body").empty();xui([c,e]).$clearEvent();xui.SC.__gc();xui.Thread.__gc();Class.__gc();_.breakO(xui.$cache,2);_.breakO([xui,Class,_],3);c.Namespace=c.Class=c.xui=c.xui_ini=c.linb=c._=undefined},"window",-1)}});Class("xui.Template","xui.absProfile",{Constructor:function(h,f,e,k){var g=arguments.callee.upper,d=_.toArr(arguments);g.apply(this,d);g=null;var c=this;c.$domId=c.KEY+":"+(c.serialId=c._pickSerialId())+":";c.domId=typeof k=="string"?k:c.$domId;c._links={};c.template={root:[["<div></div>"],[]]};c.properties={};c.events={};c.$template={};c.link(c.constructor._cache,"self").link(xui._pool,"xui");c.Class=c.constructor;c.box=c.constructor;c.boxing=function(){return this};if(h){c.setTemplate(typeof h=="string"?{root:h}:h)}if(e){c.setEvents(e)}if(f){c.setProperties(f)}return c},Instance:{renderId:null,__gc:function(){var c=this,d=xui.$cache.reclaimId;if(!c.$noReclaim){(d[c.KEY]||(d[c.KEY]=[])).push(c.serialId)}else{delete c.$noReclaim}delete xui.$cache.profileMap[c.domId];delete xui.$cache.profileMap[c.$domId];c.unLinkAll();_.breakO([c.properties,c.event,c],2)},_reg0:/^\w[\w_-]*$/,show:function(c){if(!c){c=xui("body")}c=xui(c);c.append(this);return this},getRootNode:function(){return xui.getNodeData(this.renderId,"element")},getRoot:function(){return xui([this.renderId],false)},setDomId:function(g){var d=this,f=xui.$cache.profileMap,e=d._reg0;if(typeof g=="string"&&e.test(g)&&!document.getElementById(g)){if(d.domId!=d.$domId){delete f[d.domId]}d.domId=g;if(d.renderId){d.getRootNode().id=g}if(f[d.$domId]){f[g]=d}}return d},destroy:function(){if(this.renderId){var c=this.getRootNode();xui.$purgeChildren(c);if(c.parentNode){c.parentNode.removeChild(c)}c=null}else{this.__gc()}},setEvents:function(d,e){var c=this;if(typeof d=="object"){c.events=d}else{c.events[d]=e}return c},setTemplate:function(f,k){var c=this,e=c.template,l=c.$template,g;if(typeof f=="object"){c.template=f;g={};for(var d in f){g[d||"root"]=c._buildTemplate(f[d])}c.$template=g}else{if(typeof k=="string"){l[f]=c._buildTemplate(e[f]=k)}else{l.root=c._buildTemplate(e.root=f)}}return c},setProperties:function(d,e){var c=this;if(typeof d=="object"){c.properties=d}else{c.properties[d]=e}return c},getItem:function(h){var g=xui.getNodeData(h);if(!g){return}var k=g.tpl_evid,d=g.tpl_evkey;if(!k||!d){return}var c=arguments.callee,e=c.f||(c.f=function(p,n,r){var m,q,l,f;for(l in p){q=p[l];if(_.isArr(q)&&(n==l||n.indexOf((p.tpl_evkey||l)+".")===0)){for(m=0;f=q[m];m++){if(f.tpl_evkey==n&&f.id==r){return f}else{if(f=e(f,n,r)){return f}}}}}});return e(this.properties,d,k)},_pickSerialId:function(){var c=xui.$cache.reclaimId[this.KEY];if(c&&c[0]){return c.shift()}return this.constructor._ctrlId.next()},render:function(){var A=this;if(!A.renderId){var d=xui.$getGhostDiv();xui.$cache.profileMap[A.domId]=xui.$cache.profileMap[A.$domId]=this;d.innerHTML=A.toHtml();var c=A.events,q=xui.Event._eventHandler,h=d.getElementsByTagName("*"),n=A.$domId,w=function(){return xui.Event(arguments[0],this,0,n)},u,m,r,p,g,y,e,z,x;if(m=h.length){for(u=0;u<m;u++){if((g=h[u]).nodeType!=1){continue}y=g.getAttribute("tpl_evkey");e=g.getAttribute("tpl_evid");if(y!==null&&e!==null){x=xui.$registerNode(g);x.tpl_evkey=y;x.tpl_evid=e;if(z=c[y]){x=x.eHandlers||(x.eHandlers={});for(r in z){x[r]=w;if(p=q[r]){x[p]=g[p]=w}}}g.removeAttribute("tpl_evkey");g.removeAttribute("tpl_evid")}}if(!d.firstChild.$xid){xui.$registerNode(d.firstChild)}A.renderId=d.firstChild.$xid}g=d=null}return A},refresh:function(){var e=this;if(e.renderId){var d=document.createElement("span"),f=e.getRootNode(),c=xui.$cache.profileMap;delete c[e.domId];delete c[e.$domId];if(f.parentNode){f.parentNode.replaceChild(d,f)}e.destroy();delete e.renderId;e.render();if(d.parentNode){d.parentNode.replaceChild(e.getRootNode(),d)}d=f=null}return e},renderOnto:function(g){var c=this,h,f,e="style",d;if(typeof g=="string"){g=document.getElementById(g)}h=g.id||c.domId;if(!c.renderId){c.render()}f=c.getRootNode();g.parentNode.replaceChild(f,g);if(f.tabIndex!=g.tabIndex){f.tabIndex!=g.tabIndex}if(g.className){f.className+=g.className}if(xui.browser.ie&&(d=g.style.cssText)){f.style.cssText+=d+""}else{if(d=g.getAttribute(e)){f.setAttribute(e,(f.getAttribute(e)||"")+d)}}this.setDomId(h)},toHtml:function(c){var d=_.copy(c||this.properties||{});d.tpl_evkey="root";return this._doTemplate(d)},_reg1:/([^{}]*)\{([\w]+)\}([^{}]*)/g,_reg2:/\[event\]/g,_buildTemplate:function(f){if(typeof f=="string"){var e=[[],[]],d=e[0],c=e[1];f=f.replace(this._reg2,' tpl_evid="{id}" tpl_evkey="{tpl_evkey}" ');f.replace(this._reg1,function(h,g,l,k){if(g){d[d.length]=g}c[d.length]=d[d.length]=l;if(k){d[d.length]=k}return""});return e}else{return f}},_getEV:function(k,d,c,f){var g=xui.getNodeData(f);if(!g){return}var m=this.events,e=g.tpl_evkey,h=(e&&m&&m[e])||m,l=h&&h[c];if(l){k.push(l)}},_reg3:/(^\s*<\w+)(\s|>)(.*)/,_doTemplate:function(k,z,A){if(!k){return""}var w=this,m=arguments.callee,y,u,f,x=_.isArr(k),p=w.$template,q=p[z||"root"],c=!A;A=A||[];if(x){if(typeof q!="function"){q=m}for(var h=0;u=k[h++];){u.tpl_evkey=z;q.call(w,u,z,A)}}else{if(typeof q=="function"){q.call(w,k,z,A)}else{z=z?z+".":"";var e=q[0],d=q[1];for(var h=0,g=e.length;h<g;h++){if(f=d[h]){if(f in k){u=typeof k[f]=="function"?k[f].call(w,f,k):k[f];if(p[y=z+f]){m.call(w,u,y,A)}else{A[A.length]=u}}}else{A[A.length]=e[h]}}}}if(c){return A.join("").replace(w._reg3,'$1 id="'+w.$domId+'" $2$3')}},serialize:function(){var c=this,f=_.serialize,e=xui.absObj.$specialChars,d=_.isEmpty(c.properties)?null:_.clone(c.properties,function(h,g){return !e[(g+"").charAt(0)]});return"new xui.Template("+f(c.template||null)+","+f(d)+","+f(_.isEmpty(c.events)?null:c.events)+","+f(c.$domId!=c.domId?c.domId:null)+")"}},Static:{getFromDom:function(c){if((c=typeof c=="string"?c:(c&&c.id))&&(c=xui.$cache.profileMap[c])&&c["xui.Template"]){return c.boxing()}},_cache:[],_ctrlId:new _.id()}});Class("xui.Module","xui.absProfile",{Initialize:function(){var c=this;xui.launch=function(d,e,h,g,f){c.load.apply(c,arguments)};c["xui.Com"]=c.prototype["xui.Com"]=1;xui.Com=c},After:function(){var f=this,d,l,h,c,g;_.arr.each(["$DataModel","$EventHandlers"],function(e){d=f[e]||{};if((h=f.$parent)&&(l=h.length)){while(l--){c=h[l][e];for(g in c){if(!(g in d)){d[g]=c[g]}}}}f[e]=d});l=f.prototype;if("_events" in l){c=l._events;h=l._pevents=l._pevents||{};for(g in c){if(h[g]){if(!_.isArr(h[g])){h[g]=[h[g]]}_.arr.insertAny(h[g],c[g])}else{h[g]=_.clone(c[g])}}l._events=null}if("events" in l){l._events=l.events;l.events={}}f._nameId=0;f._namePool={};f._nameTag=f.$nameTag||(f.KEY.replace(/\./g,"_").toLowerCase());f._cache=[]},Constructor:function(g,f,k){var c=this,e,d;if(g&&g.constructor==c.constructor){if(g.$xid){c.$xid=g.$xid}}var h=arguments.callee.upper;if(h){h.call(c)}h=null;if(g&&g.constructor==c.constructor){var l=g;f=l.events||{};d=l.alias;k=l.host;g=l.properties||{};c=l}else{if(g&&g.key&&g["xui.Module"]){var e=g;g=(e&&e.properties)||{};f=(e&&e.events)||{};d=e.alias;k=e.host}else{g=g||(c.properties?_.clone(c.properties):{});f=f||(c.events?_.clone(c.events):{})}}c.Class=c.constructor;c.box=c.constructor;c.key=c.KEY;if(!d){d=c.constructor.pickAlias()}if(!_.isEmpty(c.constructor.$DataModel)){_.merge(g,_.clone(c.constructor.$DataModel),"without")}c._links={};c.link(c.constructor._cache,"self");c.link(xui.Module._cache,"xui.module");c.link(xui._pool,"xui");c.host=k||c;c.alias=d;c.$UIValue="";c._nodes=[];c._ctrlpool={};c.events=f;c.properties={};if(c._events){c._events=_.clone(c._events)}if(c._pevents){c._pevents=_.clone(c._pevents)}c.setProperties(g);c._innerCall("initialize");return c},Instance:{autoDestroy:true,background:"",get:function(c){return _.isNumb(c)?this:[this]},size:function(){return 1},boxing:function(){return this},each:function(c,d){c.call(d,this);return this},getRoot:function(){if(!this._innerModulesCreated){this._createInnerModules()}var c=function(d){if(d["xui.Module"]){for(var f=0,e=d._nodes,g;f<e,g=d._nodes[f];f++){if(g["xui.Module"]){return c(g)}if(g["xui.UIProfile"]&&!g.box.$initRootHidden){return g.getRoot()}}}};return c(this)},getRootNode:function(){var c=this.getRoot();if(!c.isEmpty()){return c.get(0)}},getModule:function(c){var d=function(f){if(f.moduleClass&&f.moduleXid){var e=xui.SC.get(f.moduleClass);if(e&&(e=e.getInstance(f.moduleXid))){return d(e)}}return f};return c?d(this):this},_toDomElems:function(){var c=this,d=c.getUIComponents();if(!c.created){c.create(null,false)}c.render();d.each(function(f,e){if((f=f.getModule())&&f!=c){f._toDomElems()}});return d._toDomElems()},setAlias:function(c){return xui.absObj.prototype._setHostAlias.call(this,null,c)},getAlias:function(){return this.alias},setHost:function(d,c){return xui.absObj.prototype._setHostAlias.call(this,d,c)},getName:function(){return this.properties.name||this.alias},setName:function(c){this.properties.name=c},getDesc:function(){return this.properties.desc},setDesc:function(c){this.properties.desc=c},getTabindex:function(){return this.properties.tabindex},setTabindex:function(c){this.properties.tabindex=c},getHost:function(){return this.host},setProperties:function(d,f){var c=this,e;if("dataBinder" in c.properties){e=c.properties.dataBinder}if(!d){c.properties={}}else{if(typeof d=="string"){c.properties[d]=f}else{if(_.isHash(d)){if(f){c.properties=_.clone(d)}else{_.merge(c.properties,d,"all")}}}}if(c.propSetAction){c.propSetAction(c.properties)}if("dataBinder" in c.properties){if(e!==c.properties){if(e){xui.DataBinder._unBind(e,c)}xui.DataBinder._bind(c.properties.dataBinder,c)}}return c},getProperties:function(d){var c=this;if(c._getProperties){c.properties=c._getProperties()}return d?c.properties[d]:c.properties},setEvents:function(d,e){var c=this;if(!d){c.events={}}else{if(typeof d=="string"){c.events[d]=e}else{if(_.isHash(d)){if(e){c.events=_.clone(d)}else{_.merge(c.events,d,"all")}}}}return c},getEvents:function(c){return c?this.events[c]:this.events},serialize:function(n,w,g){var q,h,u=this,f=(q=u.constructor._beforeSerialized)?q(u):u,d={"xui.Module":true,alias:f.alias,key:f.KEY,host:f.host};if(d.host===u){delete d.host}else{if(f.host&&!w){if(n!==false){d.host="@this"}else{delete d.host}}}var l={},e=f.box.$DataModel;_.merge(l,f.properties,function(m,c){return e[c]!==m});if(!_.isEmpty(l)){d.properties=l}if(!_.isEmpty(q=this.getEvents())){d.events=q}var k=f.box.$EventHandlers;_.filter(d.events,function(m,c){return m!==k[c]});if(_.isEmpty(d.properties)){delete d.properties}if(!_.isEmpty(q=this.getEvents())){d.events=q}if(_.isEmpty(d.events)){delete d.events}return n===false?d:_.serialize(d)},clone:function(){var c=this.serialize(false,true);delete c.alias;return this.constructor.unserialize(c)},fireEvent:function(e,k,p){var f,c,h,q=this,m=q._pevents&&q._pevents[e],d=q._events&&q._events[e],n=q.events&&q.events[e],g=function(u,x,y,w){w=w||[];if(!_.isArr(x)){x=[x]}h=x.length;if(_.isNumb(j=x[0].event)){w[j]=xui.Event.getEventPara(w[j])}var r={};var z=0,l=function(A){if(_.isStr(this)){r[this+""]=A||""}for(j=z;j<h;j++){z=j+1;f=x[j];if(typeof f=="string"){f=y[f]}if(typeof f=="function"){c=_.tryF(f,w,y)}else{if(_.isHash(f)){if("onOK" in f||"onKO" in f){if("onOK" in f){(f.params||(f.params=[]))[parseInt(f.onOK,10)||0]=function(){if(l){l.apply("okData",arguments)}}}if("onKO" in f){(f.params||(f.params=[]))[parseInt(f.onKO,10)||0]=function(){if(l){l.apply("koData",arguments)}}}if(false===(c=xui.pseudocode.exec(f,w,y,r))){z=r=l=null}break}else{if(false===(c=xui.pseudocode.exec(f,w,y,r))){z=j;break}}}}}if(z==j){z=r=l=null}return c};return l()},p=p||q.host||q;if(m&&(!_.isArr(m)||m.length)){c=g(q,m,p,k)}if(d&&(!_.isArr(d)||d.length)){c=g(q,d,p,k)}if(n&&(!_.isArr(n)||events.t)){c=g(q,n,p,k)}return c},_fireEvent:function(e,k){var f,c,h,q=this,m=q._pevents&&q._pevents[e],d=q._events&&q._events[e],p=q.events&&q.events[e],g=function(l,w,x,r){l.$lastEvent=e;r=r||[];r.splice(0,0,l,l.threadid);if(!_.isArr(w)){w=[w]}h=w.length;for(var u=0;u<h;u++){f=w[u];if(typeof f=="string"){f=x[f]}if(typeof f=="function"){c=f.apply(x,r)}else{if(_.isHash(f)){c=xui.pseudocode.exec(f,r,l)}}}},n=q.host||q;if(m&&(!_.isArr(m)||m.length)){c=g(q,m,n,k)}if(d&&(!_.isArr(d)||d.length)){c=g(q,d,n,k)}if(p&&(!_.isArr(p)||events.t)){c=g(q,p,n,k)}return c},_innerCall:function(d){var c=this;return _.tryF(c[d],[c,c.threadid],c)},customAppend:function(d,c,g,f,e){return false},show:function(e,g,d,m,l,k){if(false===this._fireEvent("beforeShow")){return false}g=g||xui("body");if(g["xui.UIProfile"]){g=g.boxing()}var c=this,h=function(){var p=c.customStyle;if(p&&!_.isEmpty(p)){var n=[];_.each(p,function(r,q){n.push(q+" : "+r+";")});var f=".xui-module-"+c.$xid+"{\r\n"+n.join("\r\n")+"\r\n}";xui.CSS.addStyleSheet(f,"xui:css:module-"+c.$xid,1)}if(c.getUIComponents().isEmpty()){_.tryF(c.customAppend,[g,d,l,k,m],c);_.tryF(e,[null,c,m],c.host)}else{if(!(g&&g["xui.UI"]&&!g.get(0).renderId)){c.render()}if(false===_.tryF(c.customAppend,[g,d,l,k,m],c)){g.append(c.getUIComponents(false),d);c.getUIComponents(true).each(function(r){r.boxing().show(g,d);if(r.KEY=="xui.UIProfile"&&_.get(r,["properties","defaultFocus"])){try{_.asyRun(function(){r.boxing().activate()})}catch(q){}}})}c.renderId="ok";_.tryF(e,[null,c,m],c.host)}c._showed=1;c._fireEvent("afterShow")};c.threadid=m;if(c.created){h()}else{c.create(h,m)}return c},hide:function(){this.getUIComponents(true).hide();this._showed=0},render:function(d){var c=this;if(c.renderId!="ok"){c.getUIComponents().render(d);c._fireEvent("onRender");c.renderId="ok"}return c},refresh:function(u){var y,m,d,x,l,e=this,r,c,h=e.box,w=e.host,g=e.alias,q=e.$xid,f=e.$refreshTrigger,k=e.moduleClass,n=e.moduleXid;if(!e.renderId){return}if((r=e.getUIComponents()).isEmpty()){return}c=r.get(0);if(w&&w["xui.Module"]){w.$ignoreAutoDestroy=true}if(m=!!c.parent){d=c.parent.boxing();childId=c.childrenId}else{d=c.parent()}x=e.serialize(false,true);e.destroy(true,true,true);_.merge(e,x,"all");delete e.destroyed;e.$xid=q;new h(e);if(w){e.setHost(w,g)}e.moduleClass=k;e.moduleXid=n;e.create(function(){var p=function(A,z){if(f){f.call(f.target,e)}if(u){_.tryF(u)}};if(m){e.show(p,d,childId)}else{if(!d.isEmpty()){e.show(p,d)}}});if(e.host&&e.host["xui.Module"]){delete e.host.$ignoreAutoDestroy}return this},getParent:function(){var c=this.getUIComponents().get(0);if(c){return c.parent&&c.parent.boxing()}},getChildrenId:function(){var c=this.getUIComponents().get(0);if(c){return c.childrenId}},create:function(g,l){var f=this;if(f.created){_.tryF(g,[null,f,l],f.host);return}var h,d=[];f.threadid=l;if(false===f._fireEvent("beforeCreated")){return}d.push(function(e){if(e){f.threadid=e}f._fireEvent("onCreated")});if((h=f.Dependencies)&&h.length){d.push(function(e){xui.require(f.Dependencies,null,function(m,n){f._fireEvent("onLoadBaseClass",[uri,n])},function(){f._fireEvent("onLoadBaseClassErr",_.toArr(arguments))},function(){f._fireEvent("onLoadBaseClassErr",_.toArr(arguments))},false,e)})}if(f.iniComponents){var c=[];try{(f.iniComponents+"").replace(/append\s*\(\s*xui.create\(['"]([\w.]+)['"]\)/g,function(m,e){if(!xui.SC.get(e)){c.push(e)}})}catch(k){}if(c.length){if(f.Required&&_.isArr(f.Required)){f.Required.concat(c)}else{f.Required=c}}}if((h=f.Required)&&h.length){d.push(function(e){xui.require(f.Required,null,function(n,m){f._fireEvent("onLoadRequiredClass",[n,m])},function(){f._fireEvent("onLoadRequiredClassErr",_.toArr(arguments))},function(m){f._fireEvent("onLoadRequiredClassErr",_.toArr(arguments))},false,e)})}if(f.iniComponents){d.push(function(){f._createInnerModules()})}if(f.iniResource){d.push(function(){f._fireEvent("onIniResource");f._innerCall("iniResource")})}if(f.iniExComs){f.iniExModules=f.iniExComs;delete f.iniExComs}if(f.iniExModules){d.push(function(){f._innerCall("iniExModules")})}d.push(function(e){if(f.background){xui.SC.runInBG(f.background)}f._fireEvent("onReady")});d.push(function(e){f.created=true;_.tryF(g,[null,f,e],f.host)});if(l===false){_.arr.each(d,function(e){e.call()})}else{xui.Thread.observableRun(d,null,l)}return f},_createInnerModules:function(){var d=this;if(d._recursived||d._innerModulesCreated){return}var f,c=function(g){if(g&&g["xui.Module"]&&g.moduleClass&&g.moduleXid){if(d.KEY==g.moduleClass){if(d.$xid!=g.moduleXid){d._recursived=g._recursived=true;g.destroy();d.destroy();f=1}else{return}}else{c(g.host)}}};c(d.host);if(f){alert("There's a ["+d.KEY+"] in another ["+d.KEY+"], check this recursive call please!");return}if(false===d._fireEvent("beforeIniComponents")){return}Array.prototype.push.apply(d._nodes,d._innerCall("iniComponents")||[]);_.arr.each(d._nodes,function(g){xui.Module.$attachModuleInfo(d,g);if(g["xui.Module"]){g._createInnerModules()}});var e=d.autoDestroy||d.properties.autoDestroy;if(e){_.arr.each(d._nodes,function(g){if(g.box&&g.box["xui.UI"]&&!g.box["xui.UI.MoudluePlaceHolder"]&&!g.box.$initRootHidden){(g.$afterDestroy=(g.$afterDestroy||{}))["moduleDestroyTrigger"]=function(){if(e&&!d.destroyed&&!d.$ignoreAutoDestroy){d.destroy()}d=null};return false}})}d._fireEvent("afterIniComponents");d._innerModulesCreated=true},iniComponents:function(){},getProfile:function(){if(!this._innerModulesCreated){this._createInnerModules()}var c={};_.each(this._ctrlpool,function(d){c[d.alias]=d.serialize(false,false,false);delete c[d.alias].key;delete c[d.alias].alias;delete c[d.alias].events;delete c[d.alias]["xui.Module"]});return c},setProfile:function(c){if(!this._innerModulesCreated){this._createInnerModules()}_.each(this._ctrlpool,function(f,e){if(f.alias in c){e=c[f.alias];var d=f.boxing();if(e&&_.isHash(e)&&!_.isEmpty(e)){if(e.theme&&typeof(d.setTheme)=="function"){d.setTheme(e.theme)}if(e.properties&&!_.isEmpty(e.properties)){d.setProperties(e.properties)}if(e.CA&&!_.isEmpty(e.CA)){d.setCustomAttr(e.CA)}if(e.CC&&!_.isEmpty(e.CC)){d.setCustomClass(e.CC)}if(e.CS&&!_.isEmpty(e.CS)){d.setCustomStyle(e.CS)}}else{d.setValue(e)}}});return this},_getPropBinderKeys:function(){if(!this._innerModulesCreated){this._createInnerModules()}var c;if(window.get){c=get}var f={};window.get=function(g){if(g){var e=g.split(".");if(e.length){f[e.shift()]=1}}};try{_.each(this._ctrlpool,function(e){var g=e.properties;if(g.propBinder){_.each(g.propBinder,function(h,k){if((k in g)&&_.isFun(h)){h()}})}})}catch(d){}finally{window.get=c}return _.toArr(f,true)},reBindProp:function(d){if(!this._innerModulesCreated){this._createInnerModules()}var c;if(window.get){c=get}window.get=function(e){return xui.SC.get(e,d)};try{_.each(this._ctrlpool,function(e){e.boxing().reBindProp(d,true)})}catch(f){window.get=c}},getData:function(d){if(!this._innerModulesCreated){this._createInnerModules()}var c={};_.each(this._ctrlpool,function(g){var h=g.properties,e=g.boxing(),f=c[g.alias]={};_.arr.each(["src","html","items","lsitKey","header","rows","target","toggle","attr","JSONData","XMLData","JSONUrl","XMLUrl","dateStart","name","labelCaption"],function(l){if(l in h){f[l]=h[l]}});if(d){if("value" in h){f.value=h.value}}if("caption" in h&&_.isSet(h.caption)){f.caption=typeof(e.getCaption)=="function"?e.getCaption():h.caption}});return c},setData:function(c){if(!this._innerModulesCreated){this._createInnerModules()}_.each(this._ctrlpool,function(f){var g=f.properties,d=f.boxing(),e;if(f.alias in c){e=c[f.alias];if(e&&_.isHash(e)&&!_.isEmpty(e)){_.arr.each(["src","html","items","lsitKey","header","rows","target","toggle","attr","JSONData","XMLData","JSONUrl","XMLUrl","dateStart","name","value","labelCaption","caption"],function(h){if(h in g&&h in e){d["set"+_.str.initial(h)](e[h])}})}else{d.setValue(e)}}});return this},getValue:function(f){if(f){if(!this._innerModulesCreated){this._createInnerModules()}var e={},c,d;_.each(this._ctrlpool,function(g){if("value" in g.properties){if(_.isSet(g.properties.caption)){c=g.properties.caption;d=g.properties.value;if((!c&&!d)||c==d){e[g.alias]=d}else{e[g.alias]={value:d,caption:c}}}else{e[g.alias]=g.properties.value}}});return e}else{return this.properties.value}},setValue:function(c,d){if(d){if(!this._innerModulesCreated){this._createInnerModules()}if(!_.isEmpty(c)){_.each(this._ctrlpool,function(g){if("value" in g.properties&&g.alias in c){var f=c[g.alias],e=_.isHash(f);g.boxing().setValue((e&&("value" in f))?f.value:f,true,"module");if(typeof(g.boxing().setCaption)=="function"&&e&&"caption" in f){g.boxing().setCaption(f.caption,null,true,"module")}}})}}else{this.properties.value=c}return this},getUIValue:function(d){if(d){if(!this._innerModulesCreated){this._createInnerModules()}var c={};_.each(this._ctrlpool,function(e){if("$UIValue" in e.properties){c[e.alias]=e.properties.$UIValue}});return c}else{return this.$UIValue}},setUIValue:function(c,d){if(d){if(!this._innerModulesCreated){this._createInnerModules()}if(!_.isEmpty(c)){_.each(this._ctrlpool,function(g){if("value" in g.properties&&g.alias in c){var f=c[g.alias],e=_.isHash(f);g.boxing().setUIValue((e&&("value" in f))?f.value:f,true,false,"module");if(typeof(g.boxing().setCaption)=="function"&&e&&"caption" in f){g.boxing().setCaption(f.caption,null,true,"module")}}})}}else{this.$UIValue=c}return this},resetValue:function(c){if(c){if(!this._innerModulesCreated){this._createInnerModules()}_.each(this._ctrlpool,function(d){if(d.boxing().resetValue){d.boxing().resetValue()}})}else{this.$UIValue=this.properties.value}return this},updateValue:function(c){if(c){if(!this._innerModulesCreated){this._createInnerModules()}_.each(this._ctrlpool,function(d){if(d.boxing().updateValue){d.boxing().updateValue()}})}else{this.properties.value=this.$UIValue;return this}return this},isDirtied:function(d){if(d){if(!this._innerModulesCreated){this._createInnerModules()}var c=false;_.each(this._ctrlpool,function(e){if(e.boxing().isDirtied){if(e.boxing().isDirtied()){return false}}});return c}else{return this.properties.value===this.$UIValue}},checkValid:function(c){if(c){if(!this._innerModulesCreated){this._createInnerModules()}_.each(this._ctrlpool,function(d){if(d.boxing().checkValid){if(!d.boxing().checkValid()){return false}}})}else{return true}},getDataBinders:function(){if(!this._innerModulesCreated){this._createInnerModules()}var d=_.copy(this._nodes),e,c="xui.DataBinder";_.filter(d,function(f){return !!(f.box[c])});return d},getForms:function(){if(!this._innerModulesCreated){this._createInnerModules()}var d=_.copy(this._ctrlpool),e,c="xui.absContainer";_.filter(d,function(f){return !!(f.box[c])});return d},getAllComponents:function(){if(!this._innerModulesCreated){this._createInnerModules()}var d=[];var c=function(e){if(e["xui.Module"]){_.each(e._ctrlpool,function(f){if(f["xui.Module"]){c(f)}else{d.push(f)}})}};c(this);return xui.absObj.pack(d,false)},getComponents:function(){if(!this._innerModulesCreated){this._createInnerModules()}var d=[];var c=function(e){if(e["xui.Module"]){_.arr.each(e._nodes,function(f){if(f["xui.Module"]){c(f)}else{d.push(f)}})}};c(this);return xui.absObj.pack(d,false)},getUIComponents:function(c){var e=this.getComponents().get(),d="xui.UI",f="$initRootHidden";_.filter(e,function(g){return !!(g&&g.box&&g.box[d])&&(c===true?!g.box[f]:c===false?g.box[f]:true)});return xui.UI.pack(e,false)},setComponents:function(e){var c=this,d;_.arr.each(c._nodes,function(f){if((d=c[f.alias])&&d.get(0)==f){delete c[f.alias]}});_.arr.each(c._nodes=e.get(),function(f){f.boxing().setHost(c,f.alias)});_.arr.each(c._nodes,function(f){xui.Module.$attachModuleInfo(c,f)});return c},AddComponents:function(d){var c=this;_.arr.each(d.get(),function(e){e.boxing().setHost(c,e.alias);c._nodes.push(e);xui.Module.$attachModuleInfo(c,e)});return c},isDestroyed:function(){return !!this.destroyed},destroy:function(c,h,e){var f=this,d=f.constructor,g=f._nodes;if(f.destroyed){return}f._fireEvent("onDestroy");if(f.alias&&f.host&&f.host[f.alias]){delete f.host[f.alias]}f.destroyed=true;if(g&&g.length){_.arr.each(g,function(k){if(k&&k.box){k.boxing().destroy(c,h)}},null,true)}if(g&&g.length){f._nodes.length=0}f._ctrlpool=null;delete d._namePool[f.alias];f.unLinkAll();if(!e){_.breakO(f)}else{delete f.renderId;delete f.created;delete f._innerModulesCreated}if(f.$afterDestroy){_.each(f.$afterDestroy,function(k){_.tryF(k,[],f)});_.breakO(f.$afterDestroy,2)}f.destroyed=true}},Static:{"xui.absValue":true,refresh:function(f){var c=this,d={"$children":c.$children,_cache:c._cache,_nameId:c._nameId,_namePool:c._namePool},e=c.KEY,g=e.split("."),h;if(s=_.get(window,["xui","$cache","SC"])){delete s[e]}_.set(window,g);_.exec(f);h=_.get(window,g);_.merge(c,h,function(l,k){return h.hasOwnProperty(k)});_.merge(c.prototype,h.prototype,function(l,k){return h.prototype.hasOwnProperty(k)});_.merge(c,d,"all");_.breakO(h.prototype,1);_.breakO(h,1);_.set(window,g,c);return c},pickAlias:function(){return xui.absObj.$pickAlias(this)},getFromDom:function(d){var c=xui.UIProfile.getFromDom(d);if(c&&(c=c.host)){return(!c.destroyed)&&c}},getClsFromDom:function(c){return _.get(this.getFromDom(c),["KEY"])},getAllInstance:function(){var c={};_.arr.each(this._cache,function(d){c[d.$xid]=d});return c},getInstance:function(g,e){var d=this;if(!e){if(g["xui.Profile"]&&g.moduleClass&&g.moduleXid){e=g.moduleXid;g=g.moduleClass}else{e=g;g=null}}if(g){d=xui.SC.get(g);if(!d||!d["xui.Module"]){return}}var h=d._cache;for(var f in h){if(_.isFinite(f)?(e+"")==f:("$"+e)==f){return h[f]}}},destroyAll:function(){_.arr.each(this._cache,function(c){if(!c.destroyed){c.destroy()}})},load:function(d,f,l,k,g){if(!d){var h=new Error("No cls");_.tryF(f,[h,null]);throw h}if(typeof k=="function"){thowUI=k}var c=function(){var e=function(q){if(q){if(this.viewStyles&&_.isHash(this.viewStyles)){try{if(this.viewStyles.theme){k=this.viewStyles.theme;delete this.viewStyles.theme}_.each(this.viewStyles,function(u,r){xui("html").css(r,xui.adjustRes(u))})}catch(p){}}var m=this,n=function(){if(!_.isFun(m)){var r=new Error("'"+d+"' is not a constructor");_.tryF(f,[r,null]);throw r}else{var u=new m();m._callfrom=d;_.set(xui.ModuleFactory,["_cache",d],u);if(g!==false){u.show(f)}else{_.tryF(f,[null,u],u)}}};if(k&&k!="default"){xui.setTheme(k,true,function(){if(l){xui.setLang(l,n)}else{n()}})}else{if(l){xui.setLang(l,n)}else{n()}}}else{var p=new Error("No class name");_.tryF(f,[p,null]);throw p}};if(typeof(d)=="function"&&d.$xui$){e(ok)}else{d=d+""}if(/\//.test(d)&&!/\.js$/i.test(d)){d=d+".js"}if(/\.js$/i.test(d)){xui.fetchClass(d,e,function(m){_.tryF(f,[m,null])})}else{xui.SC(d,e,true,null,{retry:0,onFail:function(m){_.tryF(f,[m,null])}})}};if(xui.isDomReady){c()}else{xui.main(c)}},unserialize:function(c){return new this(c)},$attachModuleInfo:function(d,e){if(e.moduleClass&&e.moduleXid){var c=xui.SC.get(e.moduleClass);c=c.getInstance(e.moduleXid);if(c!==d){c.moduleClass=d.KEY;c.moduleXid=d.$xid;return}}e.moduleClass=d.KEY;e.moduleXid=d.$xid;_.arr.each(e.children,function(f){xui.Module.$attachModuleInfo(d,f[0])})},$DataModel:{autoDestroy:true,dataBinder:"",value:""},$EventHandlers:{beforeCreated:function(c,d){},onLoadBaseClass:function(d,f,e,c){},onLoadBaseClassErr:function(d,e,c){},onLoadRequiredClass:function(d,f,e,c){},onLoadRequiredClassErr:function(c,e,d){},onIniResource:function(c,d){},beforeIniComponents:function(c,d){},afterIniComponents:function(c,d){},onReady:function(c,d){},onRender:function(c,d){},onDestroy:function(c){}}}});Class("xui.Cookies",null,{Static:{set:function(c,g,k,h,f,e){if(_.isHash(c)){for(var d in c){this.set(d,c[d],k,h,f,e)}}else{if(typeof g!="string"){g=_.serialize(g)}document.cookie=escape(c+"")+"="+escape(g)+(k?"; expires="+(new Date((new Date()).getTime()+(24*60*60*1000*k))).toGMTString():"")+(h?"; path="+h:"")+(f?"; domain="+f:"")+(e?"; secure":"")}return this},get:function(f){var g,e,h,d=document.cookie.split("; "),k={},c=function(l){return/^\s*\{[\s\S]*\}$/.test(l)?_.unserialize(l):/^\s*\[[\s\S]*\]$/.test(l)?_.unserialize(l):l};for(g=0;g<d.length;g++){e=d[g].split("=");h=e[1]?unescape(e[1]):"";k[e[0]]=c(h)||h;if(f&&e[0]==escape(f)){return k[e[0]]}}return f?null:k},remove:function(c){return this.set(c,"",-1).set(c,"/",-1)},clear:function(){_.arr.each(document.cookie.split(";"),function(c){xui.Cookies.remove(_.str.trim(c.split("=")[0]))})}}});Class("xui.MessageService",null,{Instance:{initialize:function(){this.$subscribers={}},subscribe:function(d,f,h,g){if(d===null||d===undefined||f===null||f===undefined||typeof h!="function"){return}var k=this.$subscribers,e;k[d]=k[d]||[];e=_.arr.subIndexOf(k[d],"id",f);if(e!=-1){_.arr.removeFrom(k[d],e)}return k[d].push({id:f,receiver:h,asy:!!g})},unsubscribe:function(d,f){var g=this.$subscribers,e;if(!f){if(d===null||d===undefined){g={}}else{delete g[d]}}else{if(g[d]){e=_.arr.subIndexOf(g[d],"id",f);if(e!=-1){_.arr.removeFrom(g[d],e)}}}},publish:function(e,d,f){var g=this.$subscribers;if(e===null||e===undefined){for(var e in g){_.arr.each(g[e],function(c){if(c.asy){_.asyRun(c.receiver,0,d,f)}else{return _.tryF(c.receiver,d,f,true)}})}}else{if(g[e]){_.arr.each(g[e],function(c){if(c.asy){_.asyRun(c.receiver,0,d,f)}else{return _.tryF(c.receiver,d,f,true)}})}}},getSubscribers:function(c){return(c===null||c===undefined)?this.$subscribers:this.$subscribers[c]}}});Class("xui.XML",null,{Static:{json2xml:function(h,e,d){var c=[],g=function(q,r,m){if(typeof r=="object"){if(_.isArr(r)){if(r.length){for(var p=0,n=r.length;p<n;p++){m.push(g(q,r[p],m))}}else{m.push("<"+(e?e(q):q)+">__[]__</"+(e?e(q):q)+">")}}else{var k;m.push("<"+(e?e(q):q));for(var p in r){if(p.charAt(0)=="@"){m.push(" "+p.substr(1)+'="'+(d?d(r[p]):r[p])+'"')}else{k=1}}m.push(k?">":"/>");if(k){for(var p in r){if(p=="#text"){m.push((d?d(r[p]):r[p]))}else{if(p=="#cdata"){m.push("<![CDATA["+(d?d(r[p]):r[p])+"]]>")}else{if(p.charAt(0)!="@"){m.push(g(p,r[p],m))}}}}m.push("</"+(e?e(q):q)+">")}}}else{m.push("<"+(e?e(q):q)+">"+(d?d(r):r)+"</"+(e?e(q):q)+">")}};for(var f in h){g(f,h[f],c)}return'<?xml version="1.0" encoding="UTF-8" ?>'+c.join("")},xml2json:function(h){if(h.nodeType==9){h=h.documentElement}var c={},k={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},e=/^-?(\d\d*\.\d*$)|(^-?\d\d*$)|(^-?\.\d\d*$)/,d={"__[]__":[],"null":null,"false":false,"true":true},g=function(n){return n.replace(/[\s\S]/g,function(q,p){return(p=k[q])?p:q})},l=function(q){var r,p;q.normalize();for(r=q.firstChild;r;){p=r;if(r.nodeType==1){l(r)}r=r.nextSibling;if(p.nodeType==3&&!p.nodeValue.match(/\S/)){q.removeChild(p)}}return q},m=function(w){if("innerHTML" in w){w=w.innerHTML;w=w in d?d[w]:e.test(w)?parseFloat(w):w}else{var q=[],r,u=function(A){if(A.nodeType==1){q.push("<"+A.nodeName);var x=A.attributes;for(var z=0,y=x.length;z<y;z++){q.push(" "+x[z].nodeName+'="'+(x[z].nodeValue||"")+'"')}if(A.firstChild){q.push(">");for(x=A.firstChild;x;x=x.nextSibling){q.push(u(x))}q.push("</"+A.nodeName+">")}else{q.push("/>")}}else{if(A.nodeType==3){A=A.nodeValue;q.push(A in d?d[A]:e.test(A)?parseFloat(A):A)}else{if(A.nodeType==4){q.push("<![CDATA["+A.nodeValue+"]]>")}}}};for(var p=w.firstChild;p;p=p.nextSibling){u(p)}w=(q.length==1?q[0]:q.join(""))}return typeof w=="string"?g(w):w},f=function(x){var q=null,B,y;if(x.nodeType==1&&((B=x.attributes).length||x.firstChild)){q={};if(B.length){for(var w=0,u=B.length;w<u;w++){q["@"+B[w].nodeName]=(B[w].nodeValue||"")+""}}if(x.firstChild){var A=0,z=0,p=0,r;for(r=x.firstChild;r;r=r.nextSibling){y=r.nodeType;if(y==1){p++}else{if(y==3){A++}else{if(y==4){z++}}}}if(p){if(A<2&&z<2){for(r=x.firstChild;r;r=r.nextSibling){if(r.nodeType==3){q["#text"]=g(r.nodeValue)}else{if(r.nodeType==4){q["#cdata"]=g(r.nodeValue)}else{if(q[y=r.nodeName]){if(q[y] instanceof Array){q[y][q[y].length]=f(r)}else{q[y]=[q[y],f(r)]}}else{q[y]=f(r)}}}}}else{if(!B.length){q=m(x)}else{q["#text"]=m(x)}}}else{if(A){if(!B.length){q=m(x)}else{q["#text"]=m(x)}}else{if(z){if(z>1){q=m(x)}else{for(r=x.firstChild;r;r=r.nextSibling){q["#cdata"]=g(r.nodeValue)}}}}}}}return q};c[h.nodeName]=f(l(h));return c},parseXML:function(c){var g=null;if(typeof DOMParser=="undefined"){try{g=new ActiveXObject("Microsoft.XMLDOM");g.async=false;g.loadXML(c||"")}catch(f){g=null}}else{try{var d=new DOMParser();g=d.parseFromString(c||"","text/xml")}catch(f){g=null}finally{d=null}}return g}}});Class("xui.XMLRPC",null,{Static:{wrapRequest:function(c,h){if(typeof c=="object"){h=c.params;c=c.methodName}if(!c){return null}if(h&&!h instanceof Array){return null}var g=this,e=['<?xml version="1.0"?><methodCall><methodName>'+c+"</methodName>"];if(h){e.push("<params>");for(var f=0,d=h.length;f<d;f++){e.push("<param>"+g._wrapParam(h[f])+"</param>")}e.push("</params>")}e.push("</methodCall>");return e.join("")},parseResponse:function(g){if(!g||!g.documentElement){return null}var h=g.documentElement;if(h.nodeName!="methodResponse"){return null}var d=this,c={},f,e;e=h.getElementsByTagName("value")[0];if(e.parentNode.nodeName=="param"&&e.parentNode.parentNode.nodeName=="params"){c.result=d._parseElem(e)}else{if(e.parentNode.nodeName=="fault"){f=d._parseElem(e);c.error={code:f.faultCode,message:f.faultString}}else{return null}}if(!c.result&&!c.error){return null}return c},_dateMatcher:/^(?:(\d\d\d\d)-(\d\d)(?:-(\d\d)(?:T(\d\d)(?::(\d\d)(?::(\d\d)(?:\.(\d+))?)?)?)?)?)$/,_parseElem:function(g){var r=this,d=g.childNodes,w,x,c,u,q;if(d.length==1&&d.item(0).nodeType==3){return d.item(0).nodeValue}for(var p=0,h=d.length;p<h;p++){if(d.item(p).nodeType==1){w=d.item(p);switch(w.nodeName.toLowerCase()){case"i4":case"int":u=parseInt(w.firstChild.nodeValue,10);return isNaN(u)?null:u;case"double":u=parseFloat(w.firstChild.nodeValue);return isNaN(u)?null:u;case"boolean":return Boolean(parseInt(w.firstChild.nodeValue,10)!==0);case"string":return w.firstChild?w.firstChild.nodeValue:"";case"datetime.iso8601":if(q=w.firstChild.nodeValue.match(r._dateMatcher)){u=new Date;if(q[1]){u.setUTCFullYear(parseInt(q[1],10))}if(q[2]){u.setUTCMonth(parseInt(q[2]-1,10))}if(q[3]){u.setUTCDate(parseInt(q[3],10))}if(q[4]){u.setUTCHours(parseInt(q[4],10))}if(q[5]){u.setUTCMinutes(parseInt(q[5],10))}if(q[6]){u.setUTCSeconds(parseInt(q[6],10))}if(q[7]){u.setUTCMilliseconds(parseInt(q[7],10))}return u}return null;case"base64":return null;case"nil":return null;case"struct":u={};for(var e,n=0;e=w.childNodes.item(n);n++){if(e.nodeType==1&&e.nodeName=="member"){c="";g=null;for(var f,m=0;f=e.childNodes.item(m);m++){if(f.nodeType==1){if(f.nodeName=="name"){c=f.firstChild.nodeValue}else{if(f.nodeName=="value"){g=f}}}}if(c&&g){u[c]=r._parseElem(g)}}}return u;case"array":u=[];x=w.firstChild;while(x&&(x.nodeType!=1||x.nodeName!="data")){x=x.nextSibling}if(!x){return null}g=x.firstChild;while(g){if(g.nodeType==1){u.push(g.nodeName=="value"?r._parseElem(g):null)}g=g.nextSibling}return u;default:return null}}}return null},_map:{"<":"&lt;",">":"&gt;","&":"&amp;",'"':"&quot;","'":"&apos;"},_date2utc:function(f){var c=this,e=this._zeroPad;return f.getUTCFullYear()+"-"+e(f.getUTCMonth()+1)+"-"+e(f.getUTCDate())+"T"+e(f.getUTCHours())+":"+e(f.getUTCMinutes())+":"+e(f.getUTCSeconds())+"."+e(f.getUTCMilliseconds(),3)},_zeroPad:function(d,c){if(!c){c=2}d=((!d&&d!==0)?"":(""+d));while(d.length<c){d="0"+d}return d},_wrapParam:function(k){var h=this,l=h._map,e=["<value>"],c;switch(typeof k){case"number":e.push(!isFinite(k)?"<nil/>":parseInt(k,10)===Math.ceil(k)?("<int>"+k+"</int>"):("<double>"+k+"</double>"));break;case"boolean":e.push("<boolean>"+(k?"1":"0")+"</boolean>");break;case"string":e.push("<string>"+k.replace(/[<>&"']/g,function(m){return l[m]})+"</string>");break;case"undefined":e.push("<nil/>");case"function":e.push("<string>"+(""+k).replace(/[<>&"']/g,function(m){return l[m]})+"</string>");case"object":c=Object.prototype.toString.call(k);if(k===null){e.push("<nil/>")}else{if(c==="[object Array]"){e.push("<array><data>");for(var g=0,d=k.length;g<d;g++){e.push(h._wrapParam(k[g]))}e.push("</data></array>")}else{if(c==="[object Date]"&&isFinite(+k)){e.push("<dateTime.iso8601>"+h._date2utc(k)+"</dateTime.iso8601>")}else{e.push("<struct>");for(var f in k){if(k.hasOwnProperty(f)){e.push("<member><name>"+f+"</name>"+h._wrapParam(k[f])+"</member>")}}e.push("</struct>")}}}break}e.push("</value>");return e.join("")}}});Class("xui.SOAP",null,{Static:{RESULT_NODE_NAME:"return",getNameSpace:function(c){var d=c.documentElement.attributes.targetNamespace;return d===undefined?c.documentElement.attributes.getNamedItem("targetNamespace").nodeValue:d.value},getWsdl:function(c,e){var d=false;xui.Ajax(c+"?wsdl",null,function(f){d=f},function(){_.tryF(e,arguments,this)},null,{method:"GET",rspType:"xml",asy:false}).start();return d},wrapRequest:function(d,g,c){if(typeof d=="object"){c=g;g=d.params;d=d.methodName}var f=this,e=f.getNameSpace(c);return'<soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"><soap:Body><'+d+' xmlns="'+e+'">'+f._wrapParams(g)+"</"+d+"></soap:Body></soap:Envelope>"},parseResponse:function(f,d,c){if(typeof d=="object"){d=d.methodName}var e=this,g={},h=f.getElementsByTagName(d+"Result");if(!h.length){h=f.getElementsByTagName(e.RESULT_NODE_NAME)}if(!h.length){g.fault={faultcode:f.getElementsByTagName("faultcode")[0].childNodes[0].nodeValue,faultstring:f.getElementsByTagName("faultstring")[0].childNodes[0].nodeValue}}else{g.result=e._rsp2Obj(h[0],c)}return g},_rsp2Obj:function(e,c){var f=this,d=f._getTypesFromWsdl(c);return f._node2obj(e,d)},_getTypesFromWsdl:function(d){var g=[],c,h;c=d.getElementsByTagName("s:element");if(c.length){h=true}else{c=d.getElementsByTagName("element");h=false}for(var f=0,e=c.length;f<e;f++){if(h){if(c[f].attributes.getNamedItem("name")!=null&&c[f].attributes.getNamedItem("type")!=null){g[c[f].attributes.getNamedItem("name").nodeValue]=c[f].attributes.getNamedItem("type").nodeValue}}else{if(c[f].attributes.name!=null&&c[f].attributes.type!=null){g[c[f].attributes.name.value]=c[f].attributes.type.value}}}return g},_getTypeFromWsdl:function(c,d){return d[c]==undefined?"":d[c]},_node2obj:function(q,k){if(q==null){return null}var n=this,p,f;if(q.nodeType==3||q.nodeType==4){p=q.nodeValue;switch(n._getTypeFromWsdl(q.parentNode.nodeName,k).toLowerCase()){case"s:boolean":return p+""=="true";case"s:int":case"s:long":return p===null?0:parseInt(p+"",10);case"s:double":return p===null?0:parseFloat(p+"");case"s:datetime":if(p==null){return null}else{if(f=p.match(n._dateMatcher)){var m=new Date;if(f[1]){m.setUTCFullYear(parseInt(f[1],10))}if(f[2]){m.setUTCMonth(parseInt(f[2]-1,10))}if(f[3]){m.setUTCDate(parseInt(f[3],10))}if(f[4]){m.setUTCHours(parseInt(f[4],10))}if(f[5]){m.setUTCMinutes(parseInt(f[5],10))}if(f[6]){m.setUTCSeconds(parseInt(f[6],10))}if(f[7]){m.setUTCMilliseconds(parseInt(f[7],10))}return m}return null}default:return p===null?"":(p+"")}}else{if(q.childNodes.length==1&&(q.childNodes[0].nodeType==3||q.childNodes[0].nodeType==4)){return n._node2obj(q.childNodes[0],k)}else{if(n._getTypeFromWsdl(q.nodeName,k).toLowerCase().indexOf("arrayof")==-1){var e=q.hasChildNodes()?{}:null;for(var g=0,c=q.childNodes.length;g<c;g++){e[q.childNodes[g].nodeName]=n._node2obj(q.childNodes[g],k)}return e}else{var h=[];for(var g=0,c=q.childNodes.length;g<c;g++){h.push(n._node2obj(q.childNodes[g],k))}return h}}}return null},_wrapParams:function(f){var d=this,c=[];for(var e in f){switch(typeof(f[e])){case"string":case"number":case"boolean":case"object":c.push("<"+e+">"+d._wrapParam(f[e])+"</"+e+">");break;default:break}}return c.join("")},_map:{"<":"&lt;",">":"&gt;","&":"&amp;",'"':"&quot;","'":"&apos;"},_wrapParam:function(f){var k=this,m="",c=k._map,e,g,h,l;switch(typeof(f)){case"string":m+=f.replace(/[<>&"']/g,function(n){return c[n]});break;case"number":case"boolean":m+=f+"";break;case"object":e=Object.prototype.toString.call(f);if(e==="[object Date]"&&isFinite(+f)){m+=k._date2utc(f)}else{if(e==="[object Array]"){for(var d in f){l=f[d];switch(typeof l){case"number":h=parseInt(l,10)===Math.ceil(l)?"int":"double";break;case"boolean":h="bool";break;case"string":h="string";break;case"object":g=Object.prototype.toString.call(l);if(g==="[object Array]"){h="Array"}else{if(g==="[object Date]"&&isFinite(+l)){h="DateTime"}else{h="object"}}break}m+="<"+h+">"+k._wrapParam(f[d])+"</"+h+">"}}else{for(var d in f){if(f.hasOwnProperty(d)){m+="<"+d+">"+k._wrapParam(f[d])+"</"+d+">"}}}}break}return m},_date2utc:function(f){var c=this,e=this._zeroPad;return f.getUTCFullYear()+"-"+e(f.getUTCMonth()+1)+"-"+e(f.getUTCDate())+"T"+e(f.getUTCHours())+":"+e(f.getUTCMinutes())+":"+e(f.getUTCSeconds())+"."+e(f.getUTCMilliseconds(),3)},_zeroPad:function(d,c){if(!c){c=2}d=((!d&&d!==0)?"":(""+d));while(d.length<c){d="0"+d}return d}}});Class("xui.DragDrop",null,{Static:{_eh:"_dd",_id:"xui.dd:proxy:",_idi:"xui.dd:td:",_type:{blank:1,move:1,shape:1,deep_copy:1,copy:1,icon:1,none:1},_Icons:{none:"0 0",move:"0 -16px",link:"0 -32px",add:"0 -48px"},_profile:{},_left:function(value){with(this._profile){if(magneticDistance>0&&xMagneticLines.length){var l=xMagneticLines.length;while(l--){if(Math.abs(value-xMagneticLines[l])<=magneticDistance){return xMagneticLines[l]}}}if(widthIncrement>1){return Math.floor(value/widthIncrement)*widthIncrement}return value}},_top:function(value){with(this._profile){if(magneticDistance>0&&yMagneticLines.length){var l=yMagneticLines.length;while(l--){if(Math.abs(value-yMagneticLines[l])<=magneticDistance){return yMagneticLines[l]}}}if(heightIncrement>1){return Math.floor(value/heightIncrement)*heightIncrement}return value}},_ini:function(g){var f=this,e=f._profile,c=xui.win;f._box={width:c.width()+c.scrollLeft(),height:c.height()+c.scrollTop()};e.ox=e.x;e.oy=e.y;if(f._proxy=g){f._proxystyle=g.get(0).style;f._profile.curPos=f._cssPos=f._proxy.cssPos();f._cssPos_x=e.x-f._cssPos.left;f._cssPos_y=e.y-f._cssPos.top;e.restrictedLeft=e.x-(e.maxLeftOffset||0);e.restrictedRight=e.x+(e.maxRightOffset||0);e.restrictedTop=e.y-(e.maxTopOffset||0);e.restrictedBottom=e.y+(e.maxBottomOffset||0);f._proxyLeft=f._pre.left=f._cssPos.left;f._proxyTop=f._pre.top=f._cssPos.top;if("move"!==e.dragType){f._proxy.css("zIndex",xui.Dom.TOP_ZINDEX*10);xui.setNodeData(f._proxy.get(0),"zIndexIgnore",1)}}},_reset:function(){var f=this,e=null,c=false;_.tryF(f.$reset);f.setDropFace();f._resetProxy();f.$proxySize=50;f.$mousemove=f.$mouseup=f.$onselectstart=f.$ondragstart="*";f._cursor="";f._pre={};f._proxyLeft=f._proxyTop=f._cssPos_x=f._cssPos_y=0;f._stop=c;if(f._onDrag&&f._onDrag.tasks){f._onDrag.tasks.length=0;delete f._onDrag.tasks}if(f._onDragover&&f._onDragover.tasks){f._onDragover.tasks.length=0;delete f._onDragover.tasks}if(f._c_droppable){f._c_droppable.length=0}f._c_droppable=f._c_dropactive=f._cssPos=f._box=f._dropElement=f._source=f._proxy=f._proxystyle=f._onDrag=f._onDragover=e;f._profile={$id:_()+"",dragType:"shape",dragCursor:"move",targetReposition:true,dragIcon:xui.ini.path+"ondrag.gif",magneticDistance:0,xMagneticLines:[],yMagneticLines:[],widthIncrement:0,heightIncrement:0,dragDefer:0,horizontalOnly:c,verticalOnly:c,maxBottomOffset:e,maxLeftOffset:e,maxRightOffset:e,maxTopOffset:e,targetNode:e,targetCSS:e,dragKey:e,dragData:e,targetLeft:e,targetTop:e,targetWidth:e,targetHeight:e,targetOffsetParent:e,targetCallback:e,tagVar:e,shadowFrom:e,proxyNode:e,x:0,y:0,ox:0,oy:0,curPos:{},offset:{},isWorking:c,restrictedLeft:e,restrictedRight:e,restrictedTop:e,restrictedBottom:e,dropElement:e};f.__touchingfordd=0;return f},abort:function(){this._stop=true},_end:function(){var h=this,f=window,m=document,e=m.body,k="onmousedown",c="onmousemove",n="onmouseup",g,l;if(xui.browser.isTouch){g=(xui.browser.ie&&f.PointerEvent)?"onpointermove":(xui.browser.ie&&f.MSPointerEvent)?"onmspointermove":"ontouchmove";l=(xui.browser.ie&&f.PointerEvent)?"onpointerup":(xui.browser.ie&&f.MSPointerEvent)?"onmspointerup":"ontouchend"}if(h._proxy){h._unpack()}if(h.$onselectstart!="*"){e.onselectstart=h.$onselectstart}if(h.$ondragstart!="*"){m.ondragstart=h.$ondragstart}if(h.$mousemove!="*"){m[c]=h.$mousemove}if(h.$mouseup!="*"){m[n]=h.$mouseup}if(xui.browser.isTouch){if(h.$touchmove!="*"){m[g]=h.$touchmove}if(h.$touchend!="*"){m[l]=h.$touchend}}return h},startDrag:function(y,h,f,q,g){var z=this,k=window,p;if(z._profile.isWorking){return false}z._end()._reset();z._profile.isWorking=true;z.__touchingfordd=y.type=="xuitouchdown";f=_.isHash(f)?f:{};y=y||k.event;if(xui.Event.getBtn(y)!=="left"){return true}z._source=f.targetNode=xui(h);z._cursor=z._source.css("cursor");if((p=f.targetNode.get(0))&&!p.id){p.id=xui.Dom._pickDomId();p=null}z._defer=f.dragDefer=_.isNumb(f.dragDefer)?f.dragDefer:0;if(true===f.dragCursor){f.dragCursor=z._cursor}if(typeof f.dragIcon=="string"){f.dragType="icon"}var B=document,n=B.body,m=xui.Event.getPos(y),A="onmousedown",x="onmousemove",r="onmouseup",l,c;if(xui.browser.isTouch){l=(xui.browser.ie&&k.PointerEvent)?"onpointermove":(xui.browser.ie&&k.MSPointerEvent)?"onmspointermove":"ontouchmove";c=(xui.browser.ie&&k.PointerEvent)?"onpointerup":(xui.browser.ie&&k.MSPointerEvent)?"onmspointerup":"ontouchend"}f.x=m.left;f.y=m.top;f.dragKey=q||f.dragKey||null;f.dragData=g||f.dragData||null;var w=xui.Event.getSrc(y);z._start=function(E){var D=z._profile;_.merge(D,f,"with");z._source.beforeDragbegin();if(z._stop){z._end()._reset();return false}if(xui.Event&&(p=z._source.get(0))){xui.Event._preDroppable=p.id;p=null}if(D.dragType=="icon"){D.targetReposition=false}z._ini(D.dragType=="none"?null:z._pack(m,D.targetNode));if(f.x>=z._box.width||f.y>=z._box.height){z._end()._reset();return true}z._source.onDragbegin();if(D.dragDefer<1){z.$mousemove=B[x];z.$mouseup=B[r];if(xui.browser.isTouch){z.$touchmove=B[l];z.$touchend=B[c]}}if(xui.browser.ie){_.setTimeout(function(){if(w.releaseCapture){w.releaseCapture()}})}B[x]=z.$onDrag;B[r]=z.$onDrop;if(xui.browser.isTouch){B[l]=z.$onDrag;B[c]=z.$onDrop}z._source.afterDragbegin();if(D.dragDefer>0){z.$onDrag.call(z,E)}if(xui.browser.isTouch&&z.__touchingfordd){z._c_droppable=[];var C=xui.$cache.droppable[D.dragKey],d=[];_.arr.each(C,function(H){if(!xui.use(H).get(0)){d.push(H);return}var G=xui.use(H),I=G.offsetHeight(),e=G.offsetWidth(),F=G.css("visibility"),J;if(e&&I&&F!="hidden"){J=G.offset();J.width=e;J.height=I;J.id=H;z._c_droppable.unshift(J)}});if(d.length){_.arr.each(d,function(e){_.arr.removeValue(C,e)})}}};if(xui.browser.ie){z.$ondragstart=B.ondragstart;z.$onselectstart=n.onselectstart;B.ondragstart=n.onselectstart=null;if(B.selection&&B.selection.empty){try{B.selection.empty()}catch(y){}}}xui.Event.stopBubble(y);if(f.targetNode.get(0)!==B){xui(B).onMousedown(true,xui.Event.getEventPara(y,m))}if(f.dragDefer<1){_.tryF(z._start,[y],z);return false}else{z.$mouseup=B[r];B[r]=function(d){xui.DragDrop._end()._reset();return _.tryF(document.onmouseup,[d],null,true)};if(xui.browser.isTouch){z.$touchend=B[c];B[c]=B[r]}var u={};z.$mousemove=B[x];B[x]=function(C){var d=xui.Event.getPos(C);if(d.left===u.left&&d.top===u.top){return}u=d;if(--z._defer<=0){xui.DragDrop._start(C)}return false};if(xui.browser.isTouch){z.$touchmove=B[l];B[l]=B[x]}}},$onDrag:function(n){var r=xui.DragDrop,c=r._profile;if(r.$SimulateMousemoveInMobileDevice){return false}n=n||window.event;if(!c.isWorking||r._stop){r.$onDrop(n);return true}var w=xui.Event.getPos(n);c.x=w.left;c.y=w.top;if(!c.isWorking){return false}if(r._proxy){if(!c.verticalOnly){r._proxyLeft=Math.floor(r._left(((c.maxLeftOffset!==null&&c.x<=c.restrictedLeft)?c.restrictedLeft:(c.maxRightOffset!==null&&c.x>=c.restrictedRight)?c.restrictedRight:c.x)-r._cssPos_x));if(r._proxyLeft-r._pre.left){r._proxystyle.left=r._proxyLeft+"px"}r._pre.left=r._proxyLeft;c.curPos.left=r._proxyLeft+r.$proxySize}if(!c.horizontalOnly){r._proxyTop=Math.floor(r._top(((c.maxTopOffset!==null&&c.y<=c.restrictedTop)?c.restrictedTop:(c.maxBottomOffset!==null&&c.y>=c.restrictedBottom)?c.restrictedBottom:c.y)-r._cssPos_y));if(r._proxyTop-r._pre.top){r._proxystyle.top=r._proxyTop+"px"}r._pre.top=r._proxyTop;c.curPos.top=r._proxyTop+r.$proxySize}}else{c.curPos.left=c.x;c.curPos.top=c.y}if(r._onDrag!=1){if(r._onDrag){r._onDrag(n,r._source._get(0))}else{r._onDrag=1;r._source.onDrag(true,xui.Event.getEventPara(n,w))}}if(xui.browser.isTouch&&r.__touchingfordd){if(r._c_droppable){for(var h=0,g=r._c_droppable.length;h<g;h++){var f=r._c_droppable[h],q=xui.use(f.id).get(0),m=r._c_dropactive,u=xui.use(m).get(0);if(c.x>=f.left&&c.y>=f.top&&c.x<=(f.left+f.width)&&c.y<=(f.top+f.height)){if(m==f.id){var k=n.changedTouches[0];r.$SimulateMousemoveInMobileDevice=1;xui.Event.simulateEvent(q,"mousemove",{screenX:k.screenX,screenY:k.screenY,clientX:k.clientX,clientY:k.clientY});delete r.$SimulateMousemoveInMobileDevice}else{xui.Event.simulateEvent(q,"mouseover",{screenX:c.left,screenY:c.top,clientX:c.left,clientY:c.top});r._c_dropactive=f.id;if(m&&u){xui.Event.simulateEvent(u,"mouseout",{screenX:c.left,screenY:c.top,clientX:c.left,clientY:c.top})}}break}else{if(m==f.id){if(u){xui.Event.simulateEvent(u,"mouseout",{screenX:c.left,screenY:c.top,clientX:c.left,clientY:c.top})}r._c_dropactive=null;break}}}}}return false},$onDrop:function(h){var k=xui.DragDrop,g=k._profile,c=xui.Event;h=h||window.event;k._end();if(g.isWorking){k.setDropFace();var f=k._source.onDragstop(true,c.getEventPara(h));if(k._dropElement){xui.use(k._dropElement).onDrop(true,c.getEventPara(h))}}k._reset();c.stopBubble(h);_.tryF(document.onmouseup,[h]);return !!f},setDropElement:function(c){this._profile.dropElement=this._dropElement=c;return this},getProfile:function(){var e=this,c=e._profile;c.offset=e._proxy?{x:e._proxyLeft-c.ox+e._cssPos_x,y:e._proxyTop-c.oy+e._cssPos_y}:{x:c.x-c.ox,y:c.y-c.oy};return c},setDropFace:function(l,h){var m=this,g='<div style="position:absolute;z-index:'+xui.Dom.TOP_ZINDEX+";font-size:0;line-height:0;border-",e=":dashed 1px #ff6600;",k=m._Region,c=m._rh,f="backgroundColor";if(k&&k.parent()){k.remove(false)}if(m._R){m._R.css(f,m._RB);delete m._R;delete m._RB}if(l){if(!k||!k.get(0)){k=m._Region=xui.create(g+"top"+e+'left:0;top:0;width:100%;height:0;"></div>'+g+"right"+e+'right:0;top:0;height:100%;width:0;"></div>'+g+"bottom"+e+'bottom:0;left:0;width:100%;height:0;"></div>'+g+'left:solid 2px #ff6600;width:0;left:0;top:0;height:100%;"></div>');c=m._rh=xui([k.get(1),k.get(3)])}l=xui(l);if(xui.browser.ie6){c.height("100%")}if(l.css("display")=="block"){xui.setNodeData(k.get(0),"zIndexIgnore",1);l.append(k);k.top(l.scrollTop()).left(l.scrollLeft());if(xui.browser.ie6&&!c.get(0).offsetHeight){c.height(l.get(0).offsetHeight)}}else{m._RB=l.get(0).style[f];m._R=l;l.css(f,"#FA8072")}m.setDragIcon(h||"move")}else{m.setDragIcon("none")}return m},setDragIcon:function(f){_.resetRun("setDropFace",null);var h=this,g=h._profile,e=g.proxyNode,c=h._Icons;if(e&&g.dragType=="icon"){e.first(4).css(typeof f=="object"?f:{backgroundPosition:(c[f]||f)})}return h},_setProxy:function(l,k){var e,c,h=this,f=h._profile,g=xui.Dom;if(!g.byId(h._id)){xui("body").prepend(xui.create('<div id="'+h._id+'" style="left:0;top:0;border:0;font-size:0;line-height:0;padding:'+h.$proxySize+"px;position:absolute;background:url("+xui.ini.img_bg+') repeat;"><div style="font-size:0;line-height:0;" id="'+h._idi+'">'+(xui.browser.ie6?"&nbsp;":"")+"</div></div>"))}e=xui(h._id);if(f.dragKey){h.$proxySize=0;e.css("padding",0)}else{k.left-=h.$proxySize;k.top-=h.$proxySize;if(!f.targetOffsetParent){g.setCover(true,null,f.dragCursor)}}if(c=f.targetOffsetParent){xui(c).append(e)}if(l){xui(h._idi).empty(false).append(l);f.proxyNode=l}else{f.proxyNode=xui(h._idi)}e.css({display:"",zIndex:g.TOP_ZINDEX*10,cursor:f.dragCursor}).offset(k,c);xui.setNodeData(e.get(0),"zIndexIgnore",1);return e},_resetProxy:function(){var n=this,h=n._profile,m=xui.Dom,g=n._id,f=n._idi;if(m.byId(g)){var e,c,l=xui(f),e=xui(g);if(xui.browser.ie6){l.html("&nbsp;")}else{l.empty()}l.attr("style","font-size:0;line-height:0;");xui("body").prepend(e.css({zIndex:0,cursor:"",display:"none",padding:n.$proxySize+"px"}));h.proxyNode=n._proxystyle=null;m.setCover(false)}},_pack:function(l,f){var g,k={},q={},h=this,c=h._profile,m;if(c.targetLeft===null||null===c.targetTop){m=f.offset(null,c.targetOffsetParent)}k.left=null!==c.targetLeft?c.targetLeft:m.left;k.top=null!==c.targetTop?c.targetTop:m.top;switch(c.dragType){case"deep_copy":case"copy":var m;q.width=_.isNumb(c.targetWidth)?c.targetWidth:(f.cssSize().width||0);q.height=_.isNumb(c.targetHeight)?c.targetHeight:(f.cssSize().height||0);var e=f.clone(c.dragType=="deep_copy").css({position:"relative",margin:"0",left:"0",top:"0",right:"",bottom:"",cursor:c.dragCursor,cssFloat:"none"}).cssSize(q).id("",true).css("opacity",0.8);if(c.targetCallback){c.targetCallback(e)}e.query("*").id("",true);if(c.targetCSS){e.css(c.targetCSS)}g=h._setProxy(e,k);break;case"shape":q.width=null!==c.targetWidth?c.targetWidth:f.offsetWidth();q.height=null!==c.targetHeight?c.targetHeight:f.offsetHeight();q.width-=2;q.height-=2;g=h._setProxy(xui.create("div").css({border:"dashed 1px",fontSize:"0",lineHeight:"0"}).cssSize(q),k);break;case"blank":g=h._setProxy(null,k);break;case"icon":k.left=_.isNumb(c.targetLeft)?c.targetLeft:(l.left+16);k.top=_.isNumb(c.targetTop)?c.targetTop:(l.top+16);m='<table border="0" class="xui-node xui-node-table"><tr><td valign="top"><span class="xui-node xui-node-span" style="background:url('+c.dragIcon+") no-repeat left top;width:"+(_.isNumb(c.targetWidth)?c.targetWidth:16)+"px;height:"+(_.isNumb(c.targetHeight)?c.targetHeight:16)+'px;" ></span></td><td id="xui:dd:shadow" '+(c.shadowFrom?'style="border:solid 1px #e5e5e5;background:#fff;font-size:12px;line-height:14px;"':"")+">"+(c.shadowFrom?xui(c.shadowFrom).clone(true).css({left:"auto",top:"auto",position:"relative"}).outerHTML().replace(/\s*id\=[^\s\>]*/g,""):"")+"</td></tr></table>";g=h._setProxy(xui.create(m).css("opacity",0.8),k);break;case"move":h.$proxySize=0;g=f;if(g.css("position")!="absolute"){g.css("position","absolute").offset(k)}g.css("cursor",c.dragCursor)}return g},_unpack:function(){var h=this,g=h._profile,c,e;if(g.targetReposition&&("move"!=g.dragType)){if((c=xui(h._source))){if(!c.isEmpty()){if(c.css("position")!="absolute"){c.css("position","absolute").cssPos(c.offset(null,c.get(0).offsetParent))}if(xui.browser.ie){c.cssRegion({right:"",bottom:""})}c.offset(g.curPos,g.targetOffsetParent||document.body)}}}if("move"==g.dragType){h._source.css("cursor",h._cursor)}},_unRegister:function(f,e){var h=this._eh;xui([f]).$removeEvent("beforeMouseover",h).$removeEvent("beforeMouseout",h).$removeEvent("beforeMousemove",h);var g=xui.getNodeData(f.$xid,["_dropKeys"]),k=xui.$cache.droppable;if(g){for(var d in g){if(k[d]){_.arr.removeValue(k[d],f.$xid)}}}xui.setNodeData(f.$xid,["_dropKeys"])},_register:function(e,q){var g=this._eh;xui(e).beforeMouseover(function(r,l,h){var c=xui.DragDrop,r=c._profile;if(r.dragKey&&xui.getNodeData(h,["_dropKeys",r.dragKey])){c.setDropElement(h);c._onDragover=null;xui.use(h).onDragenter(true);if(c._dropElement){_.resetRun("setDropFace",c.setDropFace,0,[h],c)}}},g).beforeMouseout(function(r,l,h){var c=xui.DragDrop,r=c._profile;if(r.dragKey&&xui.getNodeData(h,["_dropKeys",r.dragKey])){xui.use(h).onDragleave(true);if(c._dropElement==h){c.setDropElement(c._onDragover=null);_.resetRun("setDropFace",c.setDropFace,0,[null],c)}}},g).beforeMousemove(function(c,x,r){var l=xui.DragDrop,u=l._onDragover,w=l._profile;if(u==1){return}if(l._dropElement==r&&w.dragKey&&xui.getNodeData(r,["_dropKeys",w.dragKey])){if(u){u(x,r)}else{l._onDragover=1;xui.use(r).onDragover(true,xui.Event.getEventPara(x))}}},g);var d=xui.getNodeData(e.$xid,["_dropKeys"]),n=xui.$cache.droppable;if(d){for(var k in d){if(n[k]){_.arr.removeValue(n[k],e.$xid)}}}var m={},p=q.split(/[^\w-]+/);for(var k=0,f=p.length;k<f;k++){m[p[k]]=1;n[p[k]]=n[p[k]]||[];n[p[k]].push(e.$xid)}xui.setNodeData(e.$xid,["_dropKeys"],m)}},After:function(){this._reset();_.each({startDrag:function(g,d,c,f){xui.DragDrop.startDrag(g,this.get(0),d,c||"",f||null);return this},draggable:function(d,h,g,m,l){var e=this,l=l?typeof(l)=="function"?_.tryF(getTarget,[],this):xui(l):null,c=xui.DragDrop;if(!l||!l.get(0)){l=e}e.addClass("xui-ui-unselectable");if(d===undefined){d=true}else{if(typeof d=="object"){h=d;d=true}}var k=function(n,f,q){if(xui.getId(xui.Event.getSrc(f))!=q){return true}l.startDrag(f,h,g,m)};if(!!d){e.$addEvent("beforeMousedown",k,c._eh,-1)}else{e.$removeEvent("beforeMousedown",c._eh)}return e},droppable:function(c,e){if(c===undefined){c=true}e=e||"default";var f=xui.DragDrop;return this.each(function(d){if(!!c){f._register(d,e)}else{f._unRegister(d,e)}})}},function(d,c){xui.Dom.plugIn(c,d)})}});Class("xui.Tips",null,{Constructor:function(){return null},Initialize:function(){var d=xui.DragDrop,c=this;if(d){d.$reset=function(){c._pos={left:d._profile.x,top:d._profile.y}}}xui.CSS.addStyleSheet(".xui-tips{font-size:0;line-height:0;position:absolute;overflow:visible;visibility:hidden;left:-10000px;} .xui-tips-i{font-size:12px;overflow:hidden;position:relative;}.xui-tips-i span{display:inline;}.xui-tips-c {padding:1px 2px 2px 2px;}",this.KEY);xui.doc.afterMousedown(function(){c._cancel()},"$Tips",-1).afterMousemove(function(k,h){if(d.isWorking){return}var f=xui.Event,g,l;if((g=_.resetRun.$cache)&&g["$Tips"]){c._pos=f.getPos(h)}if(c._from){c._pos=f.getPos(h);c._showF();_.resetRun("$Tips3")}else{if(c._showed&&c.MOVABLE){g=f.getPos(h);l=c._Node.style;l.left=(parseInt(l.left,10)||0)+(g.left-c._pos.left)+"px";l.top=(parseInt(l.top,10)||0)+(g.top-c._pos.top)+"px";c._pos=g}}},"$Tips",-1).afterMouseover(function(q,w){var f=xui.Event,m=f.$FALSE,h=f.getSrc(w),g,u,z,p,r=0,A,x=function(e){if(c._markId){c._cancel()}return e};if(!h){return x(m)}try{while((!h.id||h.id==xui.$localeDomId)&&h.parentNode!==document&&r++<10){h=h.parentNode}if(!(g=(typeof h.id=="string"?h.id:null))){h=null;return x(m)}}catch(w){}if((u=f._getProfile(g))&&u.box&&u.KEY=="xui.UIProfile"){if(u.properties.disableTips||u.behavior.disableTips){h=null;return x(false)}var y=u.behavior.NoTips;if(y){for(var n=0,k=y.length;n<k;n++){if(g.indexOf(u.keys[y[n]])===0){return x(false)}}}y=u.behavior.PanelKeys;if(y){for(var n=0,k=y.length;n<k;n++){if(g.indexOf(u.keys[y[n]])===0){return x(false)}}}z=u.onShowTips?g:g.replace(c._reg,":");if(c._markId&&z==c._markId){return m}c._markId=z;c._pos=f.getPos(w);if(c._showed){c._from=u;c._enode=g;c._showF()}else{_.resetRun("$Tips",function(){c._from=u;c._enode=g;_.resetRun("$Tips3",function(){if(c._from){c._showF()}})},c.DELAYTIME)}}else{c._cancel()}h=null;return m},"$Tips",-1).afterMouseout(function(m,l){if(c._markId){var k=xui.Event,n,f,g=0,h=l.toElement||l.relatedTarget;if(!h){f=1}else{try{while((!h.id||h.id==xui.$localeDomId)&&h.parentNode!==document&&g++<10){h=h.parentNode}if(!(n=(typeof h.id=="string"?h.id:null))){h=null;f=1}}catch(l){f=1}}if(f){c._cancel()}return k.$FALSE}},"$Tips",-1).afterMouseup(function(g,f){c._cancel()},"$Tips",-1);this._Types={"default":new function(){this.show=function(u,n,r){if(!n){return}var x=this,g,f,y,q,l;if(!(g=x.node)||!g.get(0)){g=x.node=xui.create('<div class="xui-node xui-node-div xui-tips xui-custom"><div class="xui-node xui-wrapper xui-node-div xui-tips-i xui-custom"></div></div>');f=x._ruler=xui.create('<div class="xui-node xui-wrapper xui-node-div xui-tips xui-custom"><div class="xui-node xui-node-div xui-tips-i xui-custom"></div></div>');x.n=g.first();x._n=f.first();if(xui.Dom.css3Support("boxShadow")){g.css("boxShadow","2px 2px 2px #717C8C");f.css("boxShadow","2px 2px 2px #717C8C")}else{if(typeof g.addShadow=="function"){g.addShadow();f.addShadow()}}xui("body").append(f)}f=x._ruler;if(document.body.lastChild!=g.get(0)){xui("body").append(g,false,true)}y=typeof u=="object"?u[r||xui.Tips.TIPSKEY]:u;if(typeof y=="function"){y=y()}if(y+=""){var k=/^\s*\</.test(y);y=xui.adjustRes(y);xui.Tips._curTips=y;if(!u.transTips||!k){y='<div class="xui-node xui-node-div  xui-uiborder-flat xui-uitd-alt xui-tips-c xui-custom">'+y+"</div>"}x._n.get(0).innerHTML=y;q=f.get(0).offsetWidth+2;if(!k){q=Math.min(c.MAXWIDTH,q)}var e=g.get(0).style,m=x.n.get(0),p=m.style;e.visibility="hidden";m.innerHTML=y;if(xui.browser.ie){e.width=p.width=q+(q%2)+"px";l=m.offsetHeight;e.height=l-(l%2)+"px"}else{p.width=q+"px"}if(n===true){e.visibility="visible"}else{g.popToTop((n["xui.UI"]||n["xui.UIProfile"]||n["xui.Dom"]||n.nodeType==1||typeof n=="string")?n:{left:n.left,top:n.top,region:{left:n.left,top:n.top-12,width:24,height:32}},1)}e=p=m=null}else{g.css("zIndex",0).hide()}};this.hide=function(){this.node.css("zIndex",0).hide()}}}},Static:{_reg:/-[\w]+:/,TIPSKEY:"tips",MAXWIDTH:600,MOVABLE:true,DELAYTIME:400,AUTOHIDETIME:5000,_showF:function(){var d=this,g=d._from,f=xui.Dom.byId(d._enode),l=d._pos,k,h,e,c=true;d._from=d._enode=null;if(!f||!g||!l||!(h=g.box)){return}c=false!==((e=g.CF)&&(e=e.showTips)&&e(g,f,l));if(c!==false){c=false!==(h._showTips&&h._showTips(g,f,l))}if(c!==false){if(((e=g)&&e.tips)||(e&&(e=e.properties)&&e.tips)){d.show(l,e);c=false}else{if((e=g)&&(e=e.properties)&&e.autoTips&&("caption" in e)&&e.tips===""){if(e.caption){d.show(l,{tips:e.caption});c=false}}}}if(c!==false){d.hide()}else{if(!d.MOVABLE){_.resetRun("$Tips2",d.hide,d.AUTOHIDETIME,null,d)}}f=l=g=null},getTips:function(){return this._curTips},setTips:function(c){if(this._curTips&&this._tpl&&this._Node){this._tpl.show(c,true)}},setPos:function(d,c){var e=this;if((e=e._Node)&&(e=e.style)){if(d||d===0){e.left=parseFloat(d)+"px"}if(c||c===0){e.top=parseFloat(c)+"px"}}},show:function(g,f,e){var c=this,d;c._pos=g;if(c._item===f){return}if(typeof f=="string"||(f&&(f[e||xui.Tips.TIPSKEY]))){d=c._tpl=c._Types[f.tipsTemplate]||c._Types["default"];d.show(f,g,e);c._Node=d.node.get(0);c._item=f;c._showed=true}else{c._cancel()}},hide:function(){var c=this;if(c._showed){if(c._tpl){c._tpl.hide()}c._clear()}},_cancel:function(){var c=this;if(c._markId){if(c._showed){c.hide()}else{_.resetRun("$Tips");_.resetRun("$Tips3");c._clear()}}},_clear:function(){var c=this;c._Node=c._curTips=c._markId=c._from=c._tpl=c._item=c._showed=null}}});Class("xui.History",null,{Static:{_fid:"xui:history",_type:(xui.browser.ie&&(xui.browser.ver<8))?"iframe":("onhashchange" in window)?"event":"timer",setCallback:function(f){var c=this,e=location.hash;if(e){e="#!"+encodeURIComponent((""+decodeURIComponent(e)).replace(/^#!/,""))}else{e="#!"}c._callback=f;if(f){c._lastFI=decodeURIComponent(e);switch(c._type){case"event":window.onhashchange=c._checker;break;case"iframe":document.body.appendChild(document.createElement('<iframe id="'+c._fid+'" src="about:blank" style="display: none;"></iframe>'));var d=document.getElementById(c._fid).contentWindow.document;d.open("javascript:'<html></html>'");d.write('<html><head><script type="text/javascript">parent.xui.History._checker(\''+e+"');<\/script></head><body></body></html>");d.close();case"timer":if(c._itimer){clearInterval(c._itimer)}c._itimer=setInterval(c._checker,100);break}c._callback(decodeURIComponent(c._lastFI.replace(/^#!/,"")),true)}else{if(c._itimer){clearInterval(c._itimer)}}return c},_checker:function(d){var c=xui.History;if(typeof c._callback!="function"){if(c._itimer){clearInterval(c._itimer)}return}switch(c._type){case"iframe":if(_.isSet(d)){location.hash=d}case"event":case"timer":if(decodeURIComponent(location.hash)!=decodeURIComponent(c._lastFI)){c._lastFI=decodeURIComponent(location.hash);c._callback(decodeURIComponent(location.hash.replace(/^#(!)?/,"")))}break}},getFI:function(){return this._lastFI},setFI:function(f,e){var c=this;if(!c._callback){return}if(f){f="#!"+encodeURIComponent((""+decodeURIComponent(f)).replace(/^#!/,""))}else{f="#!"}if(c._lastFI==decodeURIComponent(f)){return false}switch(c._type){case"iframe":var d=document.getElementById(c._fid).contentWindow.document;d.open("javascript:'<html></html>'");d.write('<html><head><script type="text/javascript">parent.xui.History._checker(\''+f+"');<\/script></head><body></body></html>");d.close();break;case"event":case"timer":location.hash=c._lastFI=decodeURIComponent(f);if(e!==false){_.tryF(c._callback,[decodeURIComponent(f.replace(/^#!/,""))])}break}}}});Class("xui.ModuleFactory",null,{Initialize:function(){var c=this;xui.getModule=function(d,e,k,h,g,f){return c.getModule.apply(c,arguments)};xui.newModule=function(d,e,h,g,f){return c.newModule.apply(c,arguments)};xui.showModule=function(q,h,e,k,g,l,p,n,d,f,m){return c.getModule(q,function(u,r,w){if(!u&&false!==_.tryF(h,[r,w],r)){this.show.apply(r,[e,n,d,w,f,m])}else{_.tryF(e,[u,r,w],r)}},k,g,l,p)};xui.getCom=xui.getModule;xui.newCom=xui.newModule;xui.showCom=xui.showModule;c.setCom=c.setModule;c.getComFromCache=c.getModuleFromCache;c.getCom=c.getModule;c.newCom=c.newModule;c.storeCom=c.storeModule;c.prepareComs=c.prepareModules;xui.ComFactory=c},Static:{_pro:{},_cache:{},_domId:"xui:ModuleFactory:",getProfile:function(c){return c?this._pro[c]:this._pro},setProfile:function(c,d){if(typeof c=="string"){this._pro[c]=d}else{if(_.isHash(c)){this._pro=c}}return this},destroyAll:function(){_.each(this._cache,function(c){_.tryF(c.destroy,[],c)});this._cache={}},broadcast:function(d){if(typeof d=="function"){var e,f=this._cache;for(e in f){d.call(f[e],e)}}},setModule:function(d,c){this._cache[d]=c;if(c){c.moduleRefId=d}return this},getModuleFromCache:function(c){return this._cache[c]||null},getModule:function(g,d,n,m,r,y){if(!g){var q=new Error("No id");_.tryF(d,[q,null,n]);if(n&&xui.Thread.isAlive(n)){xui.Thread(n).abort()}throw q;return}m=m!==false;var w=this._cache,f=this._pro,l,k;if(m&&w[g]&&!w[g].destroyed){_.tryF(d,[null,w[g],n],w[g]);return w[g]}else{if(!(l=f[g])){l={cls:g,cached:m,properties:r,events:y};k=g}else{k=l.cls||l}var x=arguments.callee,u=this,h=function(c,p,z){if(!_.isFun(c)){throw"'"+k+"' is not a constructor"}var A=new c();if(p.properties){_.merge(A.properties,p.properties,"all")}if(p.events){_.merge(A.events,p.events,"all")}if(p.cached!==false){xui.ModuleFactory.setModule(g,A)}var e=[function(E,D,F){var B=D.getUIComponents().get(),C=function(G,J,H){var I=arguments.callee;_.arr.each(G,function(L,M){if(L.children){var K=[];_.arr.each(L.children,function(N){K[K.length]=N[0]});I(K,J)}})};C(B,p.children,1)}];e.push(z||null);if(d){xui.Thread(z).insert({task:d,args:[null,A,z],scope:A})}_.tryF(A[p.iniMethod||"create"],e,A)};xui.Thread.observableRun(function(e){var c=function(A){var p=this||xui.SC.get(k);if(p&&p.$xui$){xui.Thread(A).insert({task:h,args:[p,l,A]})}else{var z=new Error("Cant find Class '"+k+"' in the corresponding file (maybe SyntaxError)");_.tryF(d,[z,null,A]);if(A&&xui.Thread.isAlive(A)){xui.Thread(A).abort()}throw z}};xui.SC(k,function(z){if(z){c.call(this,e)}else{var p=new Error("No class name");_.tryF(d,[p,null,e]);if(e&&xui.Thread.isAlive(e)){xui.Thread(e).abort()}throw p}},true,e,{retry:0,onFail:function(p){_.tryF(d,[p,null,e])}})},null,n)}},newModule:function(c,d,g,f,e){return this.getModule(c,d,g,false,f,e)},storeModule:function(h){var d,e,g=this._cache,f=this._domId;if(e=g[h]){if(!(d=xui.Dom.byId(f))){xui("body").prepend(xui.create('<div id="'+f+'" style="display:none;"></div>'))}d=xui(f);e=e.getUIComponents();if(!e.isEmpty()){e.get(0).unlinkParent();d.append(e)}}},prepareModules:function(c){var e=this,d=[];_.arr.each(c,function(f){d.push(function(){e.getModule(f)})});xui.Thread(null,d,500).start();return this}}});Class("xui.Debugger",null,{Static:{$time:_(),_id1:"xui:dbg::_frm",_id4:"xui:dbg::_head",_id2:"xui:dbg::_con",_id3:"xui:dbg::_inp",err:function(c,e,d){if(xui.browser.gek&&c=="Error loading script"){return true}xui.Debugger.log(">>"+c+" at File: "+e+" ( line "+d+" ).");return true},trace:function(l){var g=_.toArr(arguments),f=g[1]||arguments.callee.caller,c=g[2]||[];if(f){c.push('function "'+(f.$name$||"")+'" in Class "'+(f.$original$||"")+'"');if(f.caller){try{arguments.callee(null,f.caller,c,1)}catch(k){}}}if(!g[3]){var d=[];d.push(" >> Object Info:");if(typeof l=="object"){for(var h in l){d.push(" -- "+h+" : "+l[h])}}else{d.push(l)}d.push(" >> Function Trace: "+c.join(" <= "));xui.Debugger.log.apply(xui.Debugger,d)}f=null},log:function(){var t1,t2,time,self=this,arr=_.toArr(arguments),str;if(!arr.length){return}t1=document.createElement("div");t2=document.createElement("div");t2.className="xui-uibg-content xui-dbg-con1";time=_();t2.appendChild(document.createTextNode("Time stamp : "+time+"("+(time-self.$time)+")"));self.$time=time;t1.appendChild(t2);for(var i=0,l=arr.length;i<l;i++){str=arr[i];t2=document.createElement("div");t2.className="xui-uibg-content xui-dbg-con2";t2.appendChild(document.createTextNode(" "+_.stringify(_.isArguments(str)?_.toArr(str):str)));t1.appendChild(t2)}if(!xui.Dom.byId(self._id2)){var ns=xui.create("<div id="+self._id1+' style="left:5px;top:'+(xui.win.scrollTop()+5)+'px;" class="xui-node xui-node-div xui-wrapper xui-dbg-frm xui-custom"><div class="xui-node xui-node-div xui-dbg-box xui-custom"><div id='+self._id4+' class="xui-node xui-node-div xui-uibg-bar xui-dbg-header xui-custom">&nbsp;&nbsp;:&nbsp;)&nbsp;&nbsp;CrossUI Monitor window <span class="xui-node xui-node-span xui-dbg-cmds xui-custom"><a class="xui-node xui-node-a xui-custom" href="javascript:;" onclick="xui(\''+self._id2+'\').empty();">Clear</a><a class="xui-node xui-node-a xui-custom" href="javascript:;" onclick="xui(\''+self._id1+"').remove();\"> &Chi; </a></span></div><div id="+self._id2+' class="xui-node xui-node-div xui-uibg-content xui-dbg-content xui-custom"></div><div class="xui-node xui-node-div xui-uibg-content xui-dbg-tail xui-custom"><table class="xui-node xui-node-table xui-custom"><tr><td style="font-family:serif;">&nbsp;>>>&nbsp;</td><td style="width:100%"><input class="xui-node xui-node-input xui-custom" id='+self._id3+" /></td></tr></table></div></div></div>");xui("body").append(ns);self.$con=xui(self._id2);xui(self._id4).draggable(true,null,null,null,xui(self._id4).parent(2));if(xui.Dom.css3Support("boxShadow")){ns.css("boxShadow","2px 2px 2px #717C8C")}else{if(ns.addShadow){ns.addShadow()}}if(xui.browser.ie6){ns.height(ns.offsetHeight());ns.width(299);_.asyRun(function(){ns.width(300)})}var bak="",temp;xui(self._id3).onKeydown(function(p,e,s){var k=xui.Event.getKey(e).key;s=xui.use(s).get(0);if(k=="enter"){switch(s.value){case"?":case"help":self.$con.append(xui.create("<div class='xui-node xui-node-div xui-uibg-content xui-dbg-con3 xui-custom'><p class='xui-node xui-node-p xui-custom'><strong  class='xui-node xui-node-strong xui-custom'>vailable commands:</strong></p><ul  class='xui-node xui-node-ul xui-custom'><li  class='xui-node xui-node-li xui-custom'> -- <strong  class='xui-node xui-node-strong xui-custom'>[clr]</strong> or <strong>[clear]</strong> : clears the message</li><li  class='xui-node xui-node-li xui-custom'> -- <strong  class='xui-node xui-node-strong xui-custom'>[?]</strong> or <strong  class='xui-node xui-node-strong xui-custom'>[help]</strong> : shows this message</li><li  class='xui-node xui-node-li xui-custom'> -- <strong class='xui-node xui-node-strong xui-custom'>any other</strong>: shows its string representation</li></ul></div>"));break;case"clr":case"clear":xui(self._id2).empty();break;default:try{temp=s.value;if(/^\s*\x7b/.test(temp)){temp="("+temp+")"}self.log(eval(temp))}catch(e){self.$con.append(xui.create("<div  class='xui-node xui-node-div xui-uibg-content xui-dbg-con4 xui-custom'>"+String(e)+"</div>"));return}}bak=s.value;s.value=""}else{if(k=="up"||k=="down"){var a=s.value;s.value=bak||"";bak=a}}k=s=temp=bak=null})}self.$con.append(t1).scrollTop(self.$con.scrollHeight());t1=t2=null}},Initialize:function(){xui.CSS.addStyleSheet(".xui-dbg-frm{position:absolute;width:300px;z-index:2000;}.xui-dbg-header{cursor:move;height:18px;padding-top:2px;position:relative;border-bottom:solid 1px #CCC;background-color:#FFAB3F;font-weight:bold;}.xui-dbg-cmds{position:absolute;right:2px;top:2px;}.xui-dbg-cmds a{margin:2px;}.xui-dbg-box{position:relative;overflow:hidden;border:solid 1px #AAA;}.xui-dbg-content{position:relative;width:100%;overflow:auto;height:300px;}.xui-dbg-con1{background-color:#CCC;width:298px;}.xui-dbg-con2{padding-left:6px;border-bottom:dashed 1px #CCC;width:292px;}.xui-dbg-con3{padding-left:6px;border-bottom:dashed 1px #CCC;background:#EEE;color:#0000ff;width:292px;}.xui-dbg-con4{padding-left:6px;border-bottom:dashed 1px #CCC;background:#EEE;color:#ff0000;width:292px;}.xui-dbg-tail{overflow:hidden;position:relative;border-top:solid 1px #CCC;height:16px;background:#fff;color:#0000ff;}.xui-dbg-tail input{width:100%;border:0;background:transparent;}",this.KEY);xui.echo=function(){if(!xui.debugMode){return false}xui.Debugger.log.apply(xui.Debugger,_.toArr(arguments))};xui.message=function(n,q,d,g){d=d||300;if(xui.browser.ie){d=d+(d%2)}var c,m,p=arguments.callee,r=p.stack||(p.stack=[]),k=p.allmsg||(p.allmsg=[]),z=xui.win,e=z.scrollLeft()+z.width()/2-d/2,x=z.height(),y=z.scrollTop();c=r.pop();while(c&&!c.get(0)){c=r.pop()}if(!c){c='<div class="xui-node xui-node-div xui-wrapper xui-uibg-bar xui-uiborder-outset xui-custom" style="font-size:0;line-height:0;border:solid 1px #cdcdcd;position:absolute;overflow:visible;top:-50px;"><div class="xui-node xui-node-div xui-custom" style="font-size:14px;overflow:hidden;font-weight:bold;padding:2px;"></div><div class="xui-node xui-node-div xui-custom" style="font-size:12px;padding:5px;overflow:hidden;"></div></div>';c=xui.create(c);if(c.addBorder){c.addBorder()}k.push(c);if(xui.Dom.css3Support("boxShadow")){c.css("boxShadow","2px 2px 2px #717C8C")}}if(document.body.lastChild!=c.get(0)){xui("body").append(c,false,true)}c.topZindex(true);c.__hide=0;c.css({left:e+"px",width:d+"px",visibility:"visible"}).first().html(q||"").css("display",q?"":"none").next().html(n||"");if(xui.browser.ie&&xui.browser.ver<=8){c.ieRemedy()}if(p.last&&p.last.get(0)&&c!=p.last){var u=p.last;var f=u.left();if(u._thread&&u._thread.id&&u._thread.isAlive()){u._thread.abort()}u._thread=u.animate({left:[f,f+(u.width+d)/2+20]},function(){u.left(f)},function(){u.left(f+(u.width+d)/2+20)}).start();var w=u.offsetHeight();_.filter(k,function(h){if(h.isEmpty()){return false}if(!h.__hide&&h!=c&&h!=u){if(h._thread.id&&h._thread.isAlive()){h._thread.abort()}h.topBy(w)}})}p.last=c;p.last.width=d;m=c.height();if(xui.browser.ie6){c.cssSize({height:m,width:d+2})}if(c._thread&&c._thread.id&&c._thread.isAlive()){c._thread.abort()}c._thread=c.animate({top:[y-m-20,y+20]},function(){c.top(y-m-20)},function(){c.top(y+20)},300,0,"expoOut").start();_.asyRun(function(){if(c._thread&&c._thread.id&&c._thread.isAlive()){c._thread.abort()}c._thread=c.animate({top:[c.top(),x+20]},null,function(){r.push(c);c.hide();c.__hide=1},300,0).start()},g||5000);p=null};if(_.isDefined(window.console)&&(typeof window.console.log=="function")){xui.log=function(){window.console.log.apply(window.console,_.toArr(arguments))}}else{if(xui.debugMode){xui.log=xui.echo;window.onerror=this.err}}}});Class("xui.UIProfile","xui.Profile",{Instance:{renderId:null,_render:function(){var k=this,h=k.boxing(),n,c=xui.$cache.profileMap;if(k.beforeRender&&false===h.beforeRender(k)){return}if(!k.renderId){var p=xui.Dom.byId(k.$domId);if(!p){return}if(k.domId!=k.$domId){p.id=k.domId}c[k.domId]=c[k.$domId]=k;if(!p.$xid){xui.UI.$addEventsHanlder(k,p,true)}if(k._elset){for(var f=1,e=k._elset.length;f<e;f++){xui.UI.$addEventsHanlder(k,k._elset[f].node,true)}}if(xui.browser.ie&&xui.browser.ver<10&&"selectable" in k.properties){xui.setNodeData(p,"_onxuisel",k.properties.selectable?"true":"false")}k.rendered=k.renderId=p.$xid;p=null}if(k.CA&&!_.isEmpty(k.CA)){h.setCustomAttr(k.CA)}if(k.CS&&!_.isEmpty(k.CS)){h.setCustomStyle(k.CS)}if(xui.browser.isTouch){if((n=k.box.$Behaviors.DroppableKeys)&&n.length){_.arr.each(n,function(l){h.getSubNode(l,true).each(function(x){var w=k.box.getDropKeys(k,x.$xid);if(w){var y=xui.$cache.droppable,r=w.split(/[^\w-]+/);for(var u=0,q=r.length;u<q;u++){y[r[u]]=y[r[u]]||[];y[r[u]].push(x.$xid)}}})})}}if(xui.browser.isTouch&&(xui.browser.isAndroid||xui.browser.isBB)){var d={auto:1,scroll:1};_.each(k.box.$Appearances,function(q,l){if(d[q.overflow]){k.getSubNode(l,true).$touchscroll("xy")}else{if(d[q["overflow-x"]]){k.getSubNode(l,true).$touchscroll("x")}else{if(d[q["overflow-y"]]){k.getSubNode(l,true).$touchscroll("y")}}}});if(d[k.properties.overflow]){h.setOverflow(k.properties.overflow,true)}}if(n=k.RenderTrigger){for(var f=0,e=n.length;f<e;f++){n[f].call(k)}delete k.RenderTrigger}if(k.onRender){h.onRender(k)}_.tryF(k.$onrender,[],k);if(arguments[0]===true&&(n=k.LayoutTrigger)){for(var f=0,e=n.length;f<e;f++){n[f].call(k)}if(k.onLayout){h.onLayout(k)}}if(!k.properties.lazyAppend){if(k.children){for(var f=0,m;m=k.children[f++];){if(m[0]._render){m[0]._render(true)}}}if(k.$attached){for(var f=0,m;m=k.$attached[f++];){if(m._render){m._render(true)}}delete k.$attached}if(k.exchildren){var g=[];for(var f=0,m;m=k.exchildren[f++];){h.append(m[0],m[1])}delete k.exchildren}if(k.exmodules){var g=[];for(var f=0,m;m=k.exmodules[f++];){m[0].show(null,h,m[1],false)}delete k.exmodules}}k.renderCompleted=1},__gc:function(){var e=this,d;if(e.destroyed){return}if(e.$beforeDestroy){_.each(e.$beforeDestroy,function(g){_.tryF(g,[],e)});_.breakO(e.$beforeDestroy,2)}_.tryF(e.$ondestory,[],e);if(e.onDestroy){e.boxing().onDestroy()}if(e.destroyTrigger){e.destroyTrigger()}if(!e.serialId){return}if(d=e._$composed){_.each(d,function(g){g.__gc()})}e.clearCache();if(!e.$noReclaim){d=xui.$cache.reclaimId;(d[e.key]||(d[e.key]=[])).push(e.serialId)}else{delete e.$noReclaim}delete xui.$cache.profileMap[e.domId];delete xui.$cache.profileMap[e.$domId];if(e.box){delete e.box._namePool[e.alias]}var f;if(e.alias&&e.host&&(f=e.host[e.alias])&&(f=f._nodes)&&(f.length===0||f.length===1&&f[0]==e)){delete e.host[e.alias]}e.unLinkAll();if(e.LayoutTrigger){e.LayoutTrigger.length=0}if(e.RenderTrigger){e.RenderTrigger.length=0}if((d=e.children).length){d=_.copy(d);for(var c=0;c<d.length;c++){d[c][0].__gc();d[c].length=0}d.length=0}e.destroyed=true;if(e.$afterDestroy){_.each(e.$afterDestroy,function(g){_.tryF(g,[],e)});_.breakO(e.$afterDestroy,2)}if(e.afterDestroy){e.boxing().afterDestroy(e)}_.breakO([e.properties,e.events,e.CF,e.CB,e.CC,e.CA,e.CS,e],2);e.destroyed=true},linkParent:function(d,f,c){var e=this;e.unlinkParent();if(!e.destroyed){e.parent=d;e.childrenId=f;e.link(d.children,"$parent",[e,f],c)}return e},unlinkParent:function(){var c=this;delete c.parent;delete c.childrenId;c.unLink("$parent");return c},getRootNode:function(){return xui.getNodeData(this.renderId,"element")},getRoot:function(){return xui(this.renderId?[this.renderId]:[],false)},getContainer:function(c){if(c!==true&&(c=typeof c=="string"?c:null)){c=this.getSubIdByItemId(c)}return this.box._CONTAINERKEY?this.getSubNodes(this.box._CONTAINERKEY,c):this.keys.PANEL?this.getSubNodes(this.keys.PANEL,c):this.getRoot()},_cacheR1:/^\w[\w_-]*$/,setDomId:function(f){var d=this,e=xui.$cache.profileMap;if(typeof f=="string"&&(d._cacheR1.test(f)||f==d.$domId)&&!xui.Dom.byId(f)){if(d.domId!=d.$domId){delete e[d.domId]}d.domId=f;if(d.renderId){d.getRootNode().id=f}if(e[d.$domId]){e[f]=d}}return d},getDomId:function(){return this.domId},clearCache:function(){var e=this,d=e.$_egetter;for(var c in d){d[c].length=0;delete d[c]}d=e.$_domid;for(var c in d){d[c].__gc();delete d[c]}return e},_getEV:function(n,e,d){var u=this,p=e+"+"+d,m=u.$_egetter||(u.$_egetter={}),c;if(m[p]){Array.prototype.push.apply(n,m[p]);return}else{c=m[p]=[]}var h=xui.$cache.profileMap,r,q;if((r=h[e])&&(r=r.events)&&(r=r[d])){for(var k=0,f=r.length;k<f;k++){if(typeof r[r[k]]=="function"){c.push(n[n.length]=r[r[k]])}}}q=e.split(":")[0].split("-")[1];if(typeof(((r=u._CB)&&(q?(r=r[q]):1))&&(r=r[d]))=="function"){c.push(n[n.length]=r)}else{if(typeof(((r=u.CB)&&(q?(r=r[q]):1))&&(r=r[d]))=="function"){c.push(n[n.length]=r)}else{if(typeof(((r=u.behavior)&&(q?(r=r[q]):1))&&(r=r[d]))=="function"){c.push(n[n.length]=r)}}}},_cacheR2:/<!--\x03([^>^\s]*)\x04-->/g,toHtml:function(f){var C=this,d=C.properties,y=C.box,r={},z,x="xui.UIProfile",w="xui.Module",e,q,n,g,k,B,A,p;if(C.destroyed){return""}if(y["xui.svg"]){y._RenderSVG(C);return""}else{p=y._prepareData(C);if(y._dynamicTemplate){y._dynamicTemplate(C)}z=y._build(C,p);if((!d.lazyAppend||f)&&(k=C.children)){for(q=0,n=k.length;q<n;q++){g=k[q];if(g&&g[0]){if(g[0][w]){var u=new xui.UI.MoudluePlaceHolder({host:g[0].host,alias:g[0].alias});u.get(0)._module=g[0];g[0]=u.get(0)}if(g[0][x]){e=g[1]||"";B=r[e]||(r[e]=[]);B[B.length]=g[0].toHtml(f)}}}}return z.replace(C._cacheR2,function(h,c){return r[c]?r[c].join(""):""})}},_buildItems:function(e,d,h){var f=this,g=f.box,k=g._rpt(f,xui.UI.$doTemplate(f,_.get(xui.$cache.template,[g.KEY,f._hash]),d,e)),c=xui.UI.$toDom(f,k.replace(f._cacheR2,""),h);if(f.CA&&!_.isEmpty(f.CA)){f.boxing().setCustomAttr(f.CA,undefined,c)}if(f.CS&&!_.isEmpty(f.CS)){f.boxing().setCustomStyle(f.CS,undefined,c)}return c},serialize:function(u,y,h){var w,k,n={},x=this,g=(w=x.box._beforeSerialized)?w(x):x,d={alias:g.alias,key:g.key,host:g.host};if(d.host===x){delete d.host}else{if(g.host&&!y){if(u!==false){d.host="@this"}else{delete d.host}}}if(typeof g.theme=="string"){d.theme=g.theme}if(g.$domId!=g.domId){d.domId=g.domId}var q={},f=g.box.$DataStruct,e=xui.absObj.$specialChars;_.merge(q,g.properties,function(m,c){return(c in f)&&f[c]!==m&&!e[c.charAt(0)]});if(!_.isEmpty(q)){d.properties=q}if(!_.isEmpty(w=this.getEvents())){d.events=w}var l=g.box.$EventHandlers;_.filter(d.events,function(m,c){return m!=l[c]});if(_.isEmpty(d.events)){delete d.events}if(!_.isEmpty(g.CB)){d.CB=_.copy(g.CB)}if(!_.isEmpty(g.CC)){d.CC=_.copy(g.CC)}if(!_.isEmpty(g.CF)){d.CF=_.copy(g.CF)}if(!_.isEmpty(g.CS)){d.CS=_.clone(g.CS,function(m,c){return !((c+"").charAt(0)=="$"&&!m)})}if(!_.isEmpty(g.CA)){d.CA=_.copy(g.CA)}if(typeof g.theme=="string"){d.theme=g.theme}if(false!==h&&g.children&&g.children.length){if(g.box.KEY!="xui.UI.SVGPaper"){_.arr.stableSort(g.children,function(c,m){c=(c[0].properties.tabindex||0);m=(m[0].properties.tabindex||0);return c>m?1:c==m?0:-1})}w=d.children=[];_.arr.each(g.children,function(m,c,r,p){c=m[0];if(c.moduleClass&&c.moduleXid&&(r=xui.SC.get(c.moduleClass))&&(r=r.getInstance(c.moduleXid))&&r["xui.Module"]){if(n[p=c.moduleClass+"["+c.moduleXid+"]"]){return}else{n[p]=1;c=r}}k=[c.serialize(false,y)];if(m[1]){k[1]=m[1]}w[w.length]=k})}if(false!==h&&g.exchildren&&g.exchildren.length){d.exchildren=g.exchildren}n=null;return u===false?d:_.serialize(d)},_applySetAction:function(c,d,e){if(this.renderId){return c.call(this,d,e)}},getKey:function(e,d){var c;if(e.charAt(0)=="!"){e=xui.use(e).id()}if(e.indexOf(":")==-1){e=(c=xui.$cache.profileMap[e])&&(c.$domId)}if(e){e=e.split(":")[0];if(d){e=e.split("-")[1]||"KEY"}}return e||""},getSubId:function(d){var c;if(d.charAt(0)=="!"){d=xui.use(d).id()}if(d.indexOf(":")==-1){d=(c=xui.$cache.profileMap[d])&&(c.$domId)}return d?d.split(":")[2]:""},pickSubId:function(d){var c=this,e,f=c.cache_subid||(c.cache_subid={});if((f[d]||(f[d]=[]))[0]){return f[d].shift()}f=c.subId||(c.subId={});e=(f[d]||(f[d]=new _.id)).next();return e},reclaimSubId:function(e,c){var d=this.cache_subid||(this.cache_subid={});(d[c]||(d[c]=[])).push(e)},_cacheR3:/\./g,_cacheH1:{},getClass:function(e,c){e=this.keys[e]||e;var d=this,f=e+":"+(c||"");return d._cacheH1[f]||(d._cacheH1[f]=e.replace(d._cacheR3,"-").toLowerCase().replace("xui-ui","xui")+(c||""))},_getSubNodeId:function(f,e,d){var c=this.$domId.split(":");c[0]=f;c[2]=_.isSet(e)?(e+""):"";if(d){c[2]+="_"+d}f=c.join(":");return f==this.$domId?xui.$cache.profileMap[f].domId:f},getSubNode:function(g,e,c){var d=this;if(!d.renderId){return xui()}var g=d.keys[g]||g,m,f,l,k=d.$_domid||(d.$_domid={});if(e===true){m=xui([d.renderId]).query("*","id",g==d.keys.KEY?d.domId:new RegExp("^"+g+":"+d.serialId+(c?("_"+c):"")))}else{if(!_.isSet(e)&&k[g]&&k[g]._nodes.length==1){return k[g]}m=(f=xui.Dom.byId(l=d._getSubNodeId(g,e,c)))?xui([f]):((f=d.renderId)&&xui.use(f).query("*","id",l));if(!_.isSet(e)){k[g]=m}}return m},getSubNodes:function(g,c,n){if(!_.isDefined(c)){c=true}var h=[],l=typeof g=="string",k=typeof c=="string"||c===true||_.isNull(c),d,m;if(l){if(k){Array.prototype.push.apply(h,this.getSubNode(g,c,n).get())}else{for(var e=0;m=c[e++];){Array.prototype.push.apply(h,this.getSubNode(g,m,n).get())}}}else{for(var f=0;d=g[f++];){if(k){Array.prototype.push.apply(h,this.getSubNode(d,c,n).get())}else{for(var e=0;m=c[e++];){Array.prototype.push.apply(h,this.getSubNode(d,m,n).get())}}}}return xui(h)},getSubNodeByItemId:function(d,e,c){return(e=this.getSubIdByItemId(e))?this.getSubNode(d,e,c):xui()},getItemByItemId:function(e){var d=this,c;if((c=d.ItemIdMapSubSerialId)&&(c=c[e])){return d.SubSerialIdMapItem[c]}c=d.queryItems(d.properties.items,function(g,f){return g.id==e},1,1);return c&&c[0]},getItemByDom:function(c){return this.SubSerialIdMapItem&&this.SubSerialIdMapItem[this.getSubId(typeof c=="string"?c.charAt(0)=="!"?((c=xui.use(c).get(0))&&c.id):c:c.id)]},getItemIdByDom:function(d){var c;return(c=this.getItemByDom(d))&&c.id},getSubIdByItemId:function(d){var c;return(c=this.ItemIdMapSubSerialId)&&c[d]},queryItems:function(g,e,d,m,c){var k=[],h=arguments.callee,l=h.f||(h.f=function(q,p,n,w,f,u){_.arr.each(q,function(x,r){if(p===true||p.call(null,x,r,q)){u.push(f?[x,r,q]:x);if(w){return false}}if(n&&x.sub&&x.sub.length){l(x.sub,p,n,w,f,u)}})});l(g,e,d,m,c,k);return k}},Static:{getFromDom:function(c){if((c=(c&&c.KEY=="xui.Dom")?c.get(0).id:typeof c=="string"?c.charAt(0)=="!"?((c=xui.use(c).get(0))&&c.id):c:(c&&c.id))&&(c=xui.Event._getProfile(c))&&c["xui.UIProfile"]){return c}}}});Class("xui.UI","xui.absObj",{Before:function(d,c,e){xui.absBox.$type[d.replace("xui.UI.","").replace("xui.","")]=xui.absBox.$type[d]=d;return true},After:function(){var B=this,p=arguments.callee,z,A,f,y,n,h,g,l,r,x,q,m;xui.absObj.After.apply(this,arguments);if(B.Behaviors&&B.Behaviors.PanelKeys&&B.$DataModel&&B.$DataModel.dataField){delete B.$DataModel.dataField;delete B.$DataStruct.dataField;delete B.prototype.setDataField;delete B.prototype.getDataField}B._ctrlId=new _.id();B._idCache=[];B.$cssKeys={};A=B.$Keys;A.KEY=A.$key=B.KEY;B.addTemplateKeys(_.toArr(A,true));x="$Behaviors";f={};if((A=B.$parent)&&(l=A.length)){while(l--){q=A[l][x];for(h in q){if(typeof q[h]=="object"){if(_.isArr(q[h])){y=f[h]||(f[h]=[]);y.push.apply(y,q[h])}else{y=f[h]||(f[h]={});_.merge(y,q[h])}}else{f[h]=q[h]}}}}B[x]=f;x="$Templates";f={};if((A=B.$parent)&&(l=A[0])){for(h in l[x]){if(h.charAt(0)!="$"){f[h]=l[x][h]}}}B[x]=_.clone(f);x="$Appearances";f={};if((A=B.$parent)&&(l=A.length)){while(l--){q=A[l];for(h in q[x]){A=q[x][h];y=f[h]||(f[h]={});_.merge(y,A)}}}B[x]=f;B.setTemplate(B.Templates);delete B.Templates;B.setBehavior(B.Behaviors||{});delete B.Behaviors;B.setAppearance(B.Appearances);delete B.Appearances;if(A=B.PublicAppearance){xui.UI.$cache_css+=B.buildCSSText(A);delete B.PublicAppearance}},Instance:{hoverPop:function(f,k,h,m,l,g){var e=this.get(0),c=e.boxing();if(!e.box.$EventHandlers.beforeHoverEffect){c.getRoot().hoverPop(f,k,h,m,l,g);return this}f=xui(f);if(!_.isDefined(k)){k="outer"}var d=g||(c.getRoot().xid()+":"+f.xid());c.each(function(n){n.$beforeHover=k===null?null:function(q,p,r,u,x){if(r.$force){return}if(x=="mouseover"){_.resetRun(d,null);var w=xui.getData([d,"$ui.hover.pop"])&&xui.getNodeData(f.get(0)||"empty","$ui.hover.parent")==u;if(!w){xui.setData([d,"$ui.hover.pop"],p);xui.setNodeData(f.get(0)||"empty","$ui.hover.parent",u);if(!h||false!==h(q,f,r,u,p)){f.popToTop(u,k,l);f.onMouseover(function(){xui(u).onMouseover(true)},"hoverPop").onMouseout(function(){xui(u).onMouseout(true)},"hoverPop")}}}else{_.resetRun(d,function(){xui.setData([d,"$ui.hover.pop"]);xui.setNodeData(f.get(0)||"empty","$ui.hover.parent",0);if(!m||false!==m(q,f,r,u,"host",p)){f.hide();f.onMouseover(null,"hoverPop").onMouseout(null,"hoverPop")}})}}});if(f){f.onMouseover(k===null?null:function(n){if(n.$force){return}_.resetRun(d,null)},d).onMouseout(k===null?null:function(n,p,q){if(p.$force){return}_.resetRun(d,function(){xui.setData([d,"$ui.hover.pop"]);xui.setNodeData(f.get(0)||"empty","$ui.hover.parent",0);var r=xui.getData([d,"$ui.hover.pop"]);if(!m||false!==m(n,f,p,q,"pop",r)){f.hide();f.onMouseover(null,"hoverPop").onMouseout(null,"hoverPop")}})},d)}f.css("display","none");return this},setTheme:function(e){if(typeof e!="string"||!e){e=null}var d,c=[];this.each(function(f){if(e!=f.theme){if(e===null){delete f.theme}else{f.theme=e}c.push(f)}});xui.UI.pack(c,false).refresh();return this},getTheme:function(){return this.get(0)&&this.get(0).theme},getModule:function(d){var c=this.get(0);if(c){return c.getModule(d)}},destroy:function(c,e){var d=this;this.each(function(l,h){if(l.destroyed){return}if(l.beforeDestroy&&false===l.boxing().beforeDestroy()){return}var k=l.properties,g=c?null:xui.Dom._getEffects(k.hideEffects,0),f=function(){if(l.$beforeDestroy){_.each(l.$beforeDestroy,function(m){_.tryF(m,[],l)});_.breakO(l.$beforeDestroy,2)}if(l.$afterDestroy){_.each(l.$afterDestroy,function(m){_.tryF(m,[],l)});_.breakO(l.$afterDestroy,2)}if(l.renderId){l.getRoot().remove(true,e)}else{l.__gc()}_.arr.removeFrom(d._nodes,h)};if(g){xui.Dom._vAnimate(l.getRoot(),false,g,f)}else{f()}},null,true)},isDestroyed:function(){return !!(this.get(0)?this.get(0).destroyed:1)},_toDomElems:function(){var c=[];_.arr.each(this._nodes,function(d){if(!d.renderId){c.push(d)}});if(c.length){xui.UI.pack(c,false).render()}c.length=0;_.arr.each(this._nodes,function(d){c.push(d.renderId)});return c},_ini:function(l,f,u,C,d,m,n,k,p){var y=this,B=y.constructor,g,r="default",h,e=B._namePool,F=xui.UI.__resetDftProp,E=B.__resetDftProp,D=B.$adjustProp,x=B.$DataStruct,w,A;if(l&&l["xui.Profile"]){g=l;w=g.alias||B.pickAlias();xui.UIProfile.apply(g,[u,y.$key,w,B,null,f])}else{if(l&&l.key&&xui.absBox.$type[l.key]){h=l;l=null;w=h.alias;w=(w&&!e[w])?w:B.pickAlias()}else{w=B.pickAlias()}g=new xui.UIProfile(u,y.$key,w,B,l,f,h)}e[w]=1;for(var z in x){if(!(z in g.properties)){A=E&&(z in E)?E[z]:F&&(z in F)?F[z]:x[z];g.properties[z]=typeof A=="object"?_.clone(A,true):A}}if(typeof(D)=="function"){D(g)}g.keys=B.$Keys;g.CS=d?_.copy(d):(g.CS||{});g.CB=n?_.copy(n):(g.CB||{});g.CC=m?_.copy(m):(g.CC||{});g.CF=k?_.copy(k):(g.CF||{});g.CA=p?_.copy(p):(g.CA||{});if(typeof C=="string"){g.theme=C}g.template=B.getTemplate();g.behavior=B.$Behaviors;if(!g.serialId){g.serialId=B._pickSerialId()}g.$domId=g.key+":"+g.serialId+":";g.domId=g.domId||g.$domId;g.RenderTrigger=_.copy(B.$RenderTrigger);g.LayoutTrigger=_.copy(B.$LayoutTrigger);g.link(xui.UI._cache,"UI").link(B._cache,"self").link(xui._pool,"xui");A=g.children;g.children=[];if(A&&A.length){for(var z=0,q;q=A[z++];){if(!q[0]["xui.UIProfile"]){q[0]=xui.create(q[0]).get(0)}if(q[0]["xui.UIProfile"]){q[0].linkParent(g,q[1])}else{if(q[0]["xui.Module"]){q[0].getUIComponents().each(function(c){c.linkParent(g,q[1])})}}}}y._nodes.push(g);g.Instace=y;y.n0=g;return y},busy:function(g,f,e,d){var h=typeof g=="string"?g:"Loading...",c=typeof f=="string"?f:'<span style="background:url('+xui.ini.img_busy+') no-repeat left center;padding-left:16px;">'+h+"</span>";if(g===true||f===true){xui.Dom.busy()}return this.each(function(k){_.resetRun(k.$xid+":busy",function(p,n,m){if(!p.box){return}var r=p.keys,q;n=r[n]||r.BORDER||r.PANEL||r.KEY;var l=p.getSubNode(n,m);if(l.isEmpty()){return}if(!p.$busy||p.$busy.isEmpty()){q=p.$busy=xui.create('<div style="left:0;top:0;z-index:10;position:absolute;background-color:#DDD;width:100%;height:100%"></div><div style="left:0;top:0;z-index:20;text-align:center;position:absolute;width:100%;height:100%;font-size:12px;line-height:24px;cursor:wait;"><div>'+c+"</div></div>");xui([q.get(0)]).css({opacity:0.5})}q=p.$busy;xui([q.get(1).firstChild]).html(c,false).css("paddingTop",(l.offsetHeight()||0)/2+"px");l.append(q)},50,[k,e,d])})},free:function(){xui.Dom.free();return this.each(function(c){_.resetRun(c.$xid+":busy");if(c.$busy){c.$busy.remove();delete c.$busy}})},reLayout:function(c){return this.each(function(e){if(!e.renderId){return}var d=e.properties;if((!e.$noB)&&d.border&&e.boxing()._border){e.boxing()._border(null,false)}if(d.dock&&d.dock!="none"){e.boxing().adjustDock(c)}else{if(c){e._resize_h=e._resize_w=-1}xui.UI.$tryResize(e,d.width,d.height,c)}})},toHtml:function(d){var c=[];_.arr.each(this._nodes,function(e){c[c.length]=e.toHtml(d)});return c.join("")},render:function(d){var k=this,h=[],g,f,c,e=k._nodes,p,m=[],q=xui.Dom.byId;xui.UI.$applyCSS();for(g=0;c=e[g++];){if(!c.renderId&&!xui.Dom.byId(c.domId)&&!xui.Dom.byId(c.$domId)){h[h.length]=c}}if(f=h.length){for(g=0;g<f;g++){if(c=h[g].toHtml()){m[m.length]=c}}if(m.length){xui.UI.$toDom(k.get(0),m.join(""))}}for(g=0;c=e[g++];){c._render(d)}m.length=h.length=0;return k},renderOnto:function(g,f){g=xui(g);if(g.isEmpty()){return this}var c=this,h=c.get(0),e=arguments.callee,d=e.paras||(e.paras=function(m){var l=m.cssRegion();l.tabindex=m.attr("tabIndex");if(l.tabindex<=0){delete l.tabindex}l.zIndex=m.css("zIndex");l.position=m.css("position");return l}),k=g.id();_.merge(h.properties,d(g),"all");h.properties.dock="none";if(!h.alias&&k){h.alias=k}if(h.alias){c.setHost(f||window,h.alias)}c.render(true);g.replace(c.getRoot());if(k){c.setDomId(k)}return c},setDomId:function(c){this.get(0).setDomId(c);return this},hide:function(c){return this.each(function(f){if(f.renderId){var e=f.properties,d=c?null:xui.Dom._getEffects(e.hideEffects,0);f.getRoot().hide(function(){e.top=e.left=parseInt(xui.Dom.HIDE_VALUE,10);e.dockIgnore=true},d)}})},show:function(e,d,g,f,c){return this.each(function(q){var l=q.properties,k=q.boxing(),h;g=(g||g===0)?(parseInt(g,10)||0):null;f=(f||f===0)?(parseInt(f,10)||0):null;if(g!==null){l.left=g}if(f!==null){l.top=f}if(xui.getNodeData(q.renderId,"_xuihide")){h=1;l.dockIgnore=false;q.getRoot().show(g&&(g+"px"),f&&(f+"px"),null,c);if(l.dock&&l.dock!="none"){xui.UI.$dock(q,false,true)}}else{e=e||q.parent;if(!e&&(!q.renderId||(q.getRootNode().id||"").indexOf(xui.Dom._emptyDivId)===0)){e=xui("body")}}var m=e,r;if(m){if(m["xui.UIProfile"]){r=m.renderId;m=m.boxing()}else{if(m["xui.UI"]){r=(r=m.get(0))&&r.renderId}else{r=(m=xui(m))&&m._nodes[0]}}if(r){m.append(k,d);if(!h){q.getRoot().show(g&&(g+"px"),f&&(f+"px"))}}}})},clone:function(){return arguments.callee.upper.apply(this,["domId"])},refresh:function(h){var u,e,m,c,r,q,f,k,g,d,n,l=this;return l.each(function(B,z){if(!B.renderId){return}g=B.box;var A=B.host,y=B.alias;if(B.host&&B.host["xui.Module"]){B.host.$ignoreAutoDestroy=true}q=B.$xid;f=B.serialId,mcls=B.moduleClass,mxid=B.moduleXid;var w=B.$afterRefresh;if(typeof B.boxing().getUIValue=="function"){n=B.boxing().getUIValue();if((B.boxing().getValue()+" ")==(n+" ")){n=null}}if(m=!!B.parent){c=B.parent.boxing();u=B.childrenId}else{c=B.getRoot().parent()}e=h?xui.Dom.getEmptyDiv():xui.$getGhostDiv();B.boxing().getChildren().reBoxing().each(function(D){e.appendChild(D)});e=null;d=_.copy(B.children);B.boxing().removeChildren();r=B.serialize(false,true);k=B.$refreshTrigger;var x=xui.create("span");B.getRoot().replace(x);B.$noReclaim=1;var p=B.Instace;B.boxing().destroy(true,true);_.merge(B,r,"all");delete B.destroyed;B.$xid=q;B.serialId=f;B.moduleClass=mcls;B.moduleXid=mxid;var C=new g(B).render();if(p){_.merge(p,C,"all");C.get(0).Instace=p;C=p}l[z]=C.get(0);if(k){k.call(k.target,C.get(0))}if(m){c.append(C,u)}else{c.append(C)}if(A){C.setHost(A,y)}_.arr.each(d,function(D){delete D[0].$dockParent;C.append.apply(C,D)});x.replace(C.get(0).getRoot());x.remove();x=null;if(n){C.setUIValue(n,true,null,"refresh")}if(w){C.get(0).$afterRefresh=w;w(C.get(0))}if(C.host&&C.host["xui.Module"]){delete C.host.$ignoreAutoDestroy}})},append:function(l,c,f,e){var q=this.get(0),d=q.properties;var k,m,n=arguments[4],h=arguments[5];f=!!f;if(e){if(e["xui.UI"]){e=e.get(0)}_.arr.each(q.children,function(u,r){if(u[0]===e){k=r;return false}});if(_.isNumb(k)){k=f?k:(k+1);m=e.getRoot();if(m.isEmpty()){m=null}}}else{k=f?0:-1}if(_.isHash(l)||_.isStr(l)){l=xui.create(l)}if(l["xui.UIProfile"]){l=l.boxing()}if(q.beforeAppend&&false===this.beforeAppend(q,l,c,f,e)){return}if(l["xui.Module"]){if(c!==false){var g=k;l.getUIComponents().each(function(r){r.linkParent(q,c,e?(g++):g)})}if(q.renderId){h=n?h:q.getContainer(c);if(h&&(!h.isEmpty())&&(!d.lazyAppend||h.css("display")!="none")){if(!e){h[f?"prepend":"append"](l)}else{if(m){m[f?"addPrev":"addNext"](l)}}}}else{_.arr.insertAny(q.exmodules||(q.exmodules=[]),[l,c],k,true)}}else{if(c!==false){if(l["xui.UI"]){var g=k;l.each(function(r){r.linkParent(q,c,e?(g++):g)})}}if(q.renderId){var p;if(q.parent&&_.get(q,["properties","dock"])!="none"&&!_.get(q,["properties","dockIgnore"])&&!_.get(q,["properties","dockFloat"])){if(l["xui.absBox"]){p=l.reBoxing().parent()}}h=n?h:q.getContainer(c);if(h&&(!h.isEmpty())&&(!d.lazyAppend||h.css("display")!="none")){if(!e){h[f?"prepend":"append"](l)}else{if(m){m[f?"addPrev":"addNext"](l)}}}if(p&&p.get(0)){p.onSize()}}else{if(!l["xui.UI"]){_.arr.insertAny(q.exchildren||(q.exchildren=[]),[l,c],k,true)}}}if(q.afterAppend){this.afterAppend(q,l,c,f,e)}return this},getParent:function(){var c=this.get(0);if(c){return c.parent&&c.parent.boxing()}},getChildrenId:function(){var c=this.get(0);if(c){return c.childrenId}},getChildren:function(c,l){if(l===false||l=="withModule"){var d=this.get(0),e={},m=[],k,p=d.moduleClass,n=d.moduleXid,h=function(r){if(r.moduleClass&&r.moduleXid){if(r.moduleClass!==p&&r.moduleXid!==n){if(e[k=r.moduleClass+"'"+r.moduleXid+"]"]){return null}else{e[k]=1;var f=r.getModule();if(f&&f.moduleClass&&f.moduleXid){if(f.moduleClass!==p&&f.moduleXid!==n){return h(f)}else{return f}}}}}return r},g=function(f){_.arr.each(f.children,function(q,r){r=h(q[0]);if(r){m.push(r);if(r["xui.UIProfile"]&&r.children&&r.children.length){g(r)}}})};_.arr.each(d.children,function(f,q){if((c&&typeof(c)=="string")?f[1]===c:1){q=h(f[0]);if(q){m.push(q);if(q["xui.UIProfile"]&&q.children&&q.children.length){g(q)}}}});return m}else{var m=[],g=function(f){_.arr.each(f.children,function(q){m.push(q[0]);if(q[0].children&&q[0].children.length){g(q[0])}})};_.arr.each(this.get(0).children,function(f){if((c&&typeof(c)=="string")?f[1]===c:1){m.push(f[0]);if((l===true||l=="recurse")&&f[0].children&&f[0].children.length){g(f[0])}}});return xui.UI.pack(m)}},removeChildren:function(c,d){return this.each(function(h){var k=_.copy(h.children),g=h.box.$DataModel.valueSeparator||";",f,e;_.arr.each(k,function(l){f=0;if(!c||c===true){f=1}else{if(_.isStr(c)||_.isArr(c)){e=_.isArr(c)?c:(c+"").split(g);f=_.arr.indexOf(e,l[1])!=-1||_.arr.indexOf(e,l[0])!=-1||_.arr.indexOf(e,l[0].boxing())!=-1}else{f=l[0]==c["xui.UI"]?c.get(0):c}}if(f){if(h.beforeRemove&&false===h.boxing().beforeRemove(h,l[0],l[1],d)){return}l[0].unlinkParent();if(h.afterRemove){h.boxing().afterRemove(h,l[0],l[1],d)}if(d&&!l[0].destroyed){l[0].boxing().destroy(true)}}})})},draggable:function(d,g,e,c,f){return this.each(function(h){h.getSubNode(h.keys[e]||"KEY",true).beforeMousedown(d?function(n,l,m){if(xui.Event.getBtn(l)!="left"){return}if(n.properties.disabled){return}var k=k?typeof(k)=="function"?_.tryF(getTarget,[],h):xui(k):null;if(!k||!k.get(0)){k=xui(m)}c=c||{};c.dragKey=d;c.dragData=typeof g=="function"?g():g;_.merge(c,{dragCursor:"pointer",dragType:"icon",dragDefer:2});k.startDrag(l,c)}:null,"_d",-1).beforeDragbegin(d?function(k,l,m){xui.use(m).onMouseout(true,{$force:true}).onMouseup(true)}:null,"_d",-1);if(!d){h.clearCache()}})},setCustomFunction:function(c,d){return this.each(function(e){if(typeof c=="string"){if(d){e.CF[c]=d}else{delete e.CF[c]}}else{e.CF=c||{}}})},setCustomClass:function(d,f){var e=arguments.callee,c=(e.fun||(e.fun=function(p,l,m,k){if(!m[l]){return}var n=p.getSubNode(l,true),g;if(!n.isEmpty()){_.arr.each(m[l].split(/\s+/),function(h){n[k?"removeClass":"addClass"](h)})}}));return this.each(function(l){var g=_.copy(l.CC),k;if(typeof d=="string"){k=d;d=_.copy(l.CC);d[k]=f}_.filter(d,function(n,m){if(!/^[A-Z][A-Z0-9]*$/.test(m)){k=d.KEY=d.KEY||{};if(!(m in k)){k[m]=n}return false}if(!n){return false}});if(d&&typeof d=="object"){if(l.renderId){for(var h in g){c(l,h,g,true)}for(var h in d){c(l,h,d)}}l.CC=d}else{if(l.renderId){for(var h in g){c(l,h,g,true)}}l.CC={}}})},setCustomAttr:function(e,g,d){var f=arguments.callee,c=(f.fun||(f.fun=function(r,p,n,l,m){if(!n[p]){return}var k=r.keys[p]||p,q,h;if(m){q=m.query("*","id",k==r.keys.KEY?r.domId:new RegExp("^"+k+":"+r.serialId))}else{q=r.getSubNode(p,true)}if(!q.isEmpty()){if(_.isHash(n[p])){_.each(n[p],function(w,u){q.attr(u,l?"":(w&&typeof w=="string")?xui.adjustRes(w,0,1):w)})}}}));return this.each(function(m){var h=_.copy(m.CA),l;if(typeof e=="string"){l=e;e=_.copy(m.CA);e[l]=g}_.filter(e,function(p,n){if(!/^[A-Z][A-Z0-9]*$/.test(n)){l=e.KEY=e.KEY||{};if(!(n in l)){l[n]=p}return false}if(!p){return false}});if(!!e&&typeof e=="object"){if(e){_.filter(e,function(p,n){return n!="id"&&n!="class"&&n!="style"&&n!="$xid"})}if(m.renderId){for(var k in e){c(m,k,h,true,d)}for(var k in e){c(m,k,e,false,d)}}m.CA=e}else{if(m.renderId){for(var k in h){c(m,k,h,true,d)}}m.CA={}}})},setCustomStyle:function(e,g,d){var f=arguments.callee,c=(f.fun||(f.fun=function(r,p,n,l,m){if(!n[p]){return}var k=r.keys[p]||p,q,h;if(m){q=m.query("*","id",k==r.keys.KEY?r.domId:new RegExp("^"+k+":"+r.serialId))}else{q=r.getSubNode(p,true)}if(!q.isEmpty()){if(_.isStr(n[p])){_.arr.each(n[p].split(";"),function(w,u){if((h=w.split(":")).length>=2){u=h.shift();w=h.join(":");u=u.replace(/\-(\w)/g,function(y,x){return x.toUpperCase()});q.css(u,(l?"":(w&&typeof w=="string")?xui.adjustRes(w,0,1):w)||"")}})}else{if(_.isHash(n[p])){_.each(n[p],function(u,w){if(_.isStr(u)){if(u.indexOf(";")==-1){q.css(w,(l?"":(u&&typeof u=="string")?xui.adjustRes(u,0,1):u)||"")}else{_.arr.each(u.split(";"),function(x){if((h=x.split(":")).length>=2){w=h.shift();x=h.join(":");w=w.replace(/\-(\w)/g,function(z,y){return y.toUpperCase()});q.css(w,(l?"":(x&&typeof x=="string")?xui.adjustRes(x,0,1):x)||"")}})}}else{w=w.replace(/\-(\w)/g,function(y,x){return x.toUpperCase()});q.css(w,(l?"":(u&&typeof u=="string")?xui.adjustRes(u,0,1):u)||"")}})}}}}));return this.each(function(m){var h=_.copy(m.CS),l;if(typeof e=="string"){l=e;e=_.copy(m.CS);e[l]=g}_.filter(e,function(p,n){if(!/^[A-Z][A-Z0-9]*$/.test(n)){l=e.KEY=e.KEY||{};if(!(n in l)){l[n]=p}return false}if(!p){return false}});if(!!e&&typeof e=="object"){if(m.renderId){for(var k in h){c(m,k,h,true,d)}for(var k in e){c(m,k,e,false,d)}}m.CS=e}else{if(m.renderId){for(var k in h){c(m,k,h,true,d)}}m.CS={}}})},setCustomBehavior:function(c,d){return this.each(function(e){if(typeof c=="string"){if(e.keys[c]){e.CB[c]=d||{}}}else{e.CB=c||{}}if(e.CB.KEY){_.merge(e.CB,e.CB.KEY,"all");delete e.CB.KEY}e.clearCache()})},adjustDock:function(c){return this.each(function(d){if(!d.renderId){return}if("dock" in d.properties&&d.properties.dock&&d.properties.dock!="none"&&d.renderId){var e=d.getRootNode();if(e.clientHeight){if(c){e.style.width=0;e.style.height=0;d._resize_h=d._resize_w=-1}xui.UI.$dock(d,true,true)}}if(d.$onDock){var e=d.boxing().getContainer(true);if(e&&e.onSize&&e.get(0)){e.onSize()}}})}},Initialize:function(){var d=this.prototype;_.arr.each("getSubNode,getSubNodes,getDomId,getRootNode,getRoot,getContainer".split(","),function(f){if(!d[f]){d[f]=function(){var g=this.get(0);return g?g[f].apply(g,arguments):null}}d[f].$original$="xui.UI";d[f].$type$="instance";d[f].$name$=f});var c=this,e={};_.each(xui.UI.$ps,function(f,g){e[g]={ini:"auto",action:function(n){var l=this,q=l.properties,h=false,m;l.getRoot()[g]?l.getRoot()[g](n):xui.Dom._setPxStyle(l.getRootNode(),g,n);if(g=="width"||g=="height"){if(!l.box._onresize&&l.onResize){l.boxing().onResize(l,g=="width"?n:null,g=="height"?n:null)}}else{if(l.onMove){l.boxing().onMove(l,g=="left"?n:null,g=="top"?n:null,g=="right"?n:null,g=="bottom"?n:null)}}if(q.dock!="none"){m={$type:q.dock,$dockid:_.arr.indexOf(["width","height","fill","cover"],q.dock)!=-1?l.$xid:null};switch(q.dock){case"middle":if(g!="height"&&g!="top"){return}m.top=m.height=1;break;case"center":if(g!="width"&&g!="left"){return}m.left=m.width=1;break;case"top":if(g!="height"&&g!="top"){return}m.width=m.height=1;break;case"bottom":if(g!="height"&&g!="bottom"){return}m.width=m.height=1;break;case"left":if(g!="width"&&g!="left"){return}m.width=m.height=1;break;case"right":if(g!="width"&&g!="right"){return}m.width=m.height=1;break;case"width":if("width"==g){return}m.width=1;break;case"height":if("height"==g){return}m.height=1;break;case"fill":case"cover":if(g=="width"&&g=="height"){return}m.width=m.height=1;break}var k=xui.UIProfile.getFromDom(l.$dockParent);if(k&&k.properties.conDockFlexFill){k.boxing().adjustDock(true)}else{_.tryF(l.$dockFun,[m],l)}}}}});_.merge(e,{renderer:{ini:null},zIndex:{ini:1,action:function(f){this.getRoot().css("zIndex",f)}},tabindex:{ini:1,action:function(h){var g=this,f=new RegExp("^"+g.key+"[-\\w]*:"+g.serialId+":");g.getRoot().query("*",function(k){return k.id&&f.test(k.id)&&k.getAttribute("tabIndex")}).attr("tabIndex",h)}},position:{ini:"absolute",listbox:["","static","relative","absolute"],action:function(f){this.getRoot().css("position",f)}},visibility:{listbox:["","visible","hidden"],action:function(f){this.getRoot().css("visibility",f);if(this.$resizer){if(f=="hidden"){this.$resizer.hide()}else{this.$resizer.show()}}xui.setNodeData(this.getRootNode(),"_setVisibility",1)}},display:{listbox:["","none","block","inline","inline-block"],action:function(f){if(f=="inline-block"){this.getRoot().setInlineBlock()}else{this.getRoot().css("display",f)}}},selectable:{ini:false,action:function(f){this.getRoot().setSelectable(!!f)}}});c.setDataModel(e);xui.UI.$cache_css+=xui.UI.buildCSSText({".xui-css-viewport, .xui-css-viewport body":{height:"100%",border:"0 none",margin:"0",padding:"0"},".xui-ui-draggable":{},".xui-inline-block":{display:xui.$inlineBlock,zoom:xui.browser.ie?1:null},".xui-ui-btn, .xui-ui-btni, .xui-ui-btnc":{height:"22px","line-height":"22px",background:xui.UI.$bg("button.gif","no-repeat",true)},".xui-ui-btn":{$order:1,"white-space":"nowrap","vertical-align":"top",overflow:"hidden","background-position":"right top","padding-right":"4px","font-size":"12px"},".xui-ui-btn *":{cursor:"pointer"},".xui-ui-btnc button, .xui-ui-btnc a":{display:xui.$inlineBlock,zoom:xui.browser.ie?1:null,background:"transparent",border:0,margin:0,padding:0},".xui-ui-btnc a":{padding:"0 4px"},".xui-ui-btnc a, .xui-ui-btnc span, .xui-ui-btnc button":{"line-height":"22px"},".xui-ui-btni":{$order:1,"background-position":"left -60px","padding-left":"4px","vertical-align":"top",overflow:"hidden"},".xui-ui-btnc":{$order:1,"background-position":"left -30px","background-repeat":"repeat-x","vertical-align":"top"},".xui-ui-btn-mouseover, .xui-ui-btn-focus":{$order:2,"background-position":"right -90px"},".xui-ui-btn-mouseover .xui-ui-btni, .xui-ui-btn-focus .xui-ui-btni":{$order:2,"background-position":"left -150px"},".xui-ui-btn-mouseover .xui-ui-btnc, .xui-ui-btn-focus .xui-ui-btnc":{$order:2,"background-position":"left -120px"},".xui-ui-btn-mousedown, .xui-ui-btn-checked":{$order:3,"background-position":"right -180px"},".xui-ui-btn-mousedown .xui-ui-btni, .xui-ui-btn-checked .xui-ui-btni":{$order:3,"background-position":"left -240px"},".xui-ui-btn-mousedown .xui-ui-btnc, .xui-ui-btn-checked .xui-ui-btnc":{$order:3,"background-position":"left -210px"},".xui-ui-image":{"vertical-align":"middle",width:"16px",height:"16px","background-repeat":"no-repeat"},".xui-ui-icon":{"vertical-align":"middle",width:"16px",height:"16px","background-repeat":"no-repeat","background-position":"center",margin:"0 2px"},".xui-uicmd-close, .xui-uicmd-info, .xui-uicmd-opt, .xui-uicmd-pop, .xui-uicmd-land, .xui-uicmd-refresh, .xui-uicmd-toggle, .xui-uicmd-toggle2, .xui-uicmd-min, .xui-uicmd-max,.xui-uicmd-restore,.xui-uicmd-pin, .xui-uicmd-check, .xui-uicmd-radio, .xui-uicmd-add, .xui-uicmd-remove":{"background-image":xui.UI.$bg("icons.gif","",true),"background-repeat":"no-repeat","background-position":"left top",width:"16px",height:"16px","margin-right":"2px",cursor:"default","vertical-align":"middle"},".xui-uicmd-info":{$order:1,"background-position":"-320px 0"},".xui-uicmd-info-mouseover":{$order:2,"background-position":"-320px  -20px"},".xui-uicmd-info-mousedown":{$order:3,"background-position":"-320px  -40px"},".xui-uicmd-opt":{$order:1,"background-position":"0 0"},".xui-uicmd-opt-mouseover":{$order:2,"background-position":"0 -20px"},".xui-uicmd-opt-mousedown":{$order:3,"background-position":"0 -40px"},".xui-uicmd-pop, .xui-uicmd-land":{$order:1,"background-position":"-40px 0"},".xui-uicmd-pop-mouseover, .xui-uicmd-land-mouseover":{$order:2,"background-position":"-40px -20px"},".xui-uicmd-pop-mousedown, .xui-uicmd-land-mousedown":{$order:3,"background-position":"-40px -40px"},".xui-uicmd-refresh":{$order:1,"background-position":"-280px 0"},".xui-uicmd-refresh-mouseover":{$order:2,"background-position":"-280px -20px"},".xui-uicmd-refresh-mousedown":{$order:3,"background-position":"-280px -40px"},".xui-uicmd-pin":{$order:1,"background-position":"-80px 0"},".xui-uicmd-pin-mouseover":{$order:2,"background-position":"-80px -20px"},".xui-uicmd-pin-mousedown":{$order:3,"background-position":"-80px -40px"},".xui-uicmd-pin-checked, .xui-uicmd-pin-checked-mouseover, .xui-uicmd-pin-checked-mousedown":{$order:4,"background-position":"-80px -40px"},".xui-uicmd-min":{$order:1,"background-position":"-120px 0"},".xui-uicmd-min-mouseover":{$order:2,"background-position":" -120px -20px"},".xui-uicmd-min-mousedown":{$order:3,"background-position":"-120px -40px"},".xui-uicmd-restore":{$order:1,"background-position":"-160px 0"},".xui-uicmd-restore-mouseover":{$order:2,"background-position":"-160px -20px"},".xui-uicmd-restore-mousedown":{$order:3,"background-position":"-160px -40px"},".xui-uicmd-max":{$order:1,"background-position":"-200px 0"},".xui-uicmd-max-mouseover":{$order:2,"background-position":"-200px -20px"},".xui-uicmd-max-mousedown":{$order:3,"background-position":"-200px -40px"},".xui-uicmd-close":{$order:1,"background-position":"-240px 0"},".xui-uicmd-close-mouseover":{$order:2,"background-position":"-240px -20px"},".xui-uicmd-close-mousedown":{$order:3,"background-position":"-240px -40px"},".xui-uicmd-check":{$order:1,margin:"0 4px 0 2px","background-position":"-20px -70px"},".xui-uicmd-check-mouseover":{$order:2,"background-position":"-20px -90px"},".xui-uicmd-check-mousedown":{$order:3,"background-position":"-20px -110px"},".xui-uicmd-check-checked":{$order:4,"background-position":"0 -70px"},".xui-uicmd-check-checked-mouseover":{$order:5,"background-position":"0 -90px"},".xui-uicmd-check-checked-mousedown":{$order:6,"background-position":"0 -110px"},".xui-uicmd-radio":{$order:1,margin:"0 4px 0 2px","background-position":"-60px -70px"},".xui-uicmd-radio-mouseover":{$order:2,"background-position":"-60px -90px"},".xui-uicmd-radio-mousedown":{$order:3,"background-position":"-60px -110px"},".xui-uicmd-radio-checked":{$order:4,"background-position":"-40px -70px"},".xui-uicmd-radio-checked-mouseover":{$order:5,"background-position":"-40px -90px"},".xui-uicmd-radio-checked-mousedown":{$order:6,"background-position":"-40px -110px"},".xui-uicmd-add":{$order:1,"background-position":"-56px -222px"},".xui-uicmd-add-mouseover":{$order:2,"background-position":"-56px -222px"},".xui-uicmd-add-mousedown":{$order:3,"background-position":"-56px -222px"},".xui-uicmd-remove":{$order:1,"background-position":"-72px -222px"},".xui-uicmd-remove-mouseover":{$order:1,"background-position":"-72px -222px"},".xui-uicmd-remove-mousedown":{$order:1,"background-position":"-72px -222px"},".xui-uicmd-toggle":{$order:1,"background-position":"-160px -70px"},".xui-uicmd-toggle-mouseover":{$order:2,"background-position":"-160px -90px"},".xui-uicmd-toggle-mousedown":{$order:3,"background-position":"-160px -110px"},".xui-uicmd-toggle-checked":{$order:4,"background-position":"-180px -70px"},".xui-uicmd-toggle-checked-mouseover":{$order:5,"background-position":"-180px -90px"},".xui-uicmd-toggle-checked-mousedown":{$order:6,"background-position":"-180px -110px"},".xui-uicmd-toggle2":{$order:1,"background-position":"-200px -70px"},".xui-uicmd-toggle2-mouseover":{$order:2,"background-position":"-200px -90px"},".xui-uicmd-toggle2-mousedown":{$order:3,"background-position":"-200px -110px"},".xui-uicmd-toggle2-checked":{$order:4,"background-position":"-220px -70px"},".xui-uicmd-toggle2-checked-mouseover":{$order:5,"background-position":"-220px -90px"},".xui-uicmd-toggle2-checked-mousedown":{$order:6,"background-position":"-220px -110px"},".xui-uicmd-none, .xui-display-none":{display:"none"},".xui-uicmd-empty":{$order:1000,width:"16px",height:"16px","margin-right":"2px",cursor:"default","vertical-align":"middle",background:"none"},".xui-uitembg":{"background-color":"#FFF",padding:"1px"},".xui-uitembg-mouseover":{$order:2,padding:"0px","border-radius":"3px",border:"solid 1px #FAD200"},".xui-uitembg-mousedown":{$order:3,padding:"0px","border-radius":"3px",border:"solid 1px #F5D22D"},".xui-uitembg-checked":{$order:4,padding:"0px","border-radius":"3px",border:"solid 1px #AAD2FA",color:"#000"},".xui-uibarbg":{"background-color":"#CCE4FC"},".xui-uibarbg-mouseover, .xui-uibarbg2-mouseover":{$order:2,"background-color":"#FAD200"},".xui-uibarbg-mousedown, .xui-uibarbg2-mousedown":{$order:3,"background-color":"#F5D22D"},".xui-uibarbg-checked,.xui-uibarbg2-checked":{$order:4,"background-color":"#AAD2FA",color:"#000"},".xui-bginput":{background:"#fff"},".xui-uitd":{"background-color":"#F9F9FB"},".xui-uitd-mouseover":{$order:2,"background-color":"#d9e8fb"},".xui-uitd-checked, .xui-uitd-checked .xui-node":{$order:3,"background-color":"#316AC5",color:"#fff"},".xui-uitd-alt":{$order:1,"background-color":"#FDF8D2"},".xui-uith":{$order:1,color:"#333333","background-color":"#E8EEF7"},".xui-uibar-top, .xui-uibar-bottom, .xui-uibar-top-s, .xui-uibar-bottom-s":{position:"relative","vertical-align":"baseline","font-size":0,"line-height":0},".xui-uibar-top td, .xui-uibar-top-s td, .xui-uibar-bottom td, .xui-uibar-bottom-s td":{$order:1,"background-image":xui.UI.$bg("bar_vertical.gif","",true),"background-repeat":"no-repeat","background-position":"left top"},".xui-uibar-top, .xui-uibar-top .xui-uibar-t":{height:"29px"},".xui-uibar-top .xui-uibar-tdl":{$order:1,"padding-left":"4px",height:"100%","background-position":"0 0"},".xui-uibar-top .xui-uibar-tdm":{$order:1,"background-position":"0 -30px","background-repeat":"repeat-x"},".xui-uibar-top .xui-uibar-tdr":{$order:1,"padding-left":"4px","background-position":"right -60px"},".xui-uibar-top-focus .xui-uibar-tdl":{$order:2,"padding-left":"4px",height:"100%","background-position":"left -90px"},".xui-uibar-top-focus .xui-uibar-tdm":{$order:2,"background-position":"left -120px","background-repeat":"repeat-x"},".xui-uibar-top-focus .xui-uibar-tdr":{$order:2,"padding-left":"4px","background-position":"right -150px"},".xui-uibar-top .xui-uibar-cmdl":{overflow:"hidden",position:"absolute",left:0,top:"6px",width:"92%",height:"22px","padding-left":"8px","white-space":"nowrap"},".xui-uibar-top .xui-uibar-cmdr":{position:"absolute",top:"6px",right:"8px","text-align":"right"},".xui-uicon-main":{position:"relative","padding-left":"4px","font-size":0,"line-height":0,"z-index":1,overflow:"visible","background-image":xui.UI.$bg("bar_horizontal.gif","",true),"background-repeat":"repeat-y","background-position":"-595px top"},".xui-uicon-maini":{"padding-right":"4px","font-size":0,"line-height":0,"background-image":xui.UI.$bg("container_right.gif","",true),"background-repeat":"repeat-y","background-position":"right top"},".xui-uibar-bottom, .xui-uibar-bottom .xui-uibar-t":{height:"12px"},".xui-uibar-bottom .xui-uibar-tdl":{$order:1,"padding-left":"4px",height:"100%","background-position":"left -189px"},".xui-uibar-bottom .xui-uibar-tdm":{$order:1,"background-position":"left -211px","background-repeat":"repeat-x"},".xui-uibar-bottom .xui-uibar-tdr":{$order:1,"padding-left":"4px","background-position":"right -233px"},".xui-uibar-top-s, .xui-uibar-top-s .xui-uibar-t":{$order:3,height:"7px"},".xui-uibar-top-s .xui-uibar-tdl":{$order:3,height:"100%","padding-left":"4px","background-position":"left -2`61px"},".xui-uibar-top-s .xui-uibar-tdm":{$order:3,"background-position":"left -283px","background-repeat":"repeat-x"},".xui-uibar-top-s .xui-uibar-tdr":{$order:3,"padding-left":"4px","background-position":"right -305px"},".xui-uibar-top-s .xui-uibar-cmdl":{$order:3,display:"none"},".xui-uibar-top-s .xui-uibar-cmdr":{$order:3,display:"none"},".xui-uibar-bottom-s, .xui-uibar-bottom-s .xui-uibar-t":{$order:3,height:"6px"},".xui-uibar-bottom-s .xui-uibar-tdl":{$order:3,height:"100%","padding-left":"4px","background-position":"left -327px"},".xui-uibar-bottom-s .xui-uibar-tdm":{$order:3,"background-position":"left -349px","background-repeat":"repeat-x"},".xui-uibar-bottom-s .xui-uibar-tdr":{$order:3,"padding-left":"4px","background-position":"right -371px"}})+xui.UI.buildCSSText({".xui-ui-unselectable":{$order:0,"-moz-user-select":xui.browser.gek?"-moz-none":null,"-khtml-user-select":xui.browser.kde?"none":null,"-webkit-user-select":xui.browser.kde?"none":null,"-o-user-select":xui.browser.opr?"none":null,"-ms-user-select":(xui.browser.ie||xui.browser.newie)?"none":null,"user-select":"none"},".xui-ui-selectable":{$order:1,"-moz-user-select":xui.browser.gek?"text":null,"-khtml-user-select":xui.browser.kde?"text":null,"-webkit-user-select":xui.browser.kde?"text":null,"-o-user-select":xui.browser.opr?"text":null,"-ms-user-select":(xui.browser.ie||xui.browser.newie)?"text":null,"user-select":"text"},".xui-ui-ctrl":{cursor:"default","font-family":"arial,helvetica,clean,sans-serif","font-style":"normal","font-weight":"normal","font-size":"12px","vertical-align":"middle"},".xui-uiw-shell":{background:"transparent",display:xui.$inlineBlock,zoom:xui.browser.ie6?1:null,border:0,padding:0,margin:0},".xui-uiw-frame":{$order:1,display:"block",position:"relative",border:0,padding:0,margin:0,width:"100%",height:"100%","-moz-box-flex":"1"},".xui-uiw-border":{$order:2,display:"block",position:"absolute",border:0,padding:0,margin:0,left:0,top:0,width:"100%",height:"100%"}})+xui.UI.buildCSSText({".xui-uibg-base":{"background-color":"#fff"},".xui-uibg-content":{"background-color":"#fff"},".xui-uibg-bar":{"background-color":"#aad2fa"},".xui-uiborder-linkbottombar":{"border-bottom":"solid 1px #FAD600"},".xui-uibg-bar-mouseover":{"background-color":"#C8E1FA"},".xui-hiddenborder":{border:"solid 1px #FFFFFF"},".xui-hiddenborder-mouseover":{border:"solid 1px #aad2fa"},".xui-hiddenborder-mousedown,.xui-hiddenborder-checed":{border:"solid 1px #648cb4"},".xui-uiborder-flat":{border:"solid 1px #648cb4"},".xui-uiborder-l":{"border-left-style":"solid","border-left-width":"1px","border-left-color":"#c8e1fa"},".xui-uiborder-t":{"border-top-style":"solid","border-top-width":"1px","border-top-color":"#c8e1fa"},".xui-uiborder-r":{"border-right-style":"solid","border-right-width":"1px","border-right-color":"#648cb4"},".xui-uiborder-b":{"border-bottom-style":"solid","border-bottom-width":"1px","border-bottom-color":"#648cb4"},".xui-uiborder-r2":{"border-right-style":"solid","border-right-width":"1px","border-right-color":"#A2BBD9"},".xui-uiborder-b2":{"border-bottom-style":"solid","border-bottom-width":"1px","border-bottom-color":"#A2BBD9"},".xui-uiborder-tb":{"border-style":"solid","border-width":"1px 0 1px 0 ","border-top-color":"#c8e1fa","border-bottom-color":"#648cb4"},".xui-uiborder-lr":{"border-style":"solid","border-width":"0 1px 0 1px","border-left-color":"#c8e1fa","border-right-color":"#648cb4"},".xui-uiborder-lt":{"border-style":"solid","border-width":"1px 0 0 1px","border-left-color":"#c8e1fa","border-top-color":"#c8e1fa"},".xui-uiborder-rb":{"border-style":"solid","border-width":"0 1px 1px 0","border-right-color":"#648cb4","border-bottom-color":"#648cb4"},".xui-uiborder-rb2":{"border-style":"solid","border-width":"0 1px 1px 0","border-right-color":"#A2BBD9","border-bottom-color":"#A2BBD9"},".xui-uiborder-outset":{$order:8,border:"solid 1px","border-color":"#c8e1fa #648cb4 #648cb4 #c8e1fa"},".xui-uiborder-inset":{$order:9,border:"solid 1px","border-color":"#648cb4 #c8e1fa #c8e1fa #648cb4"},".xui-uiborder-none":{$order:10,border:"none"}});xui.UI.$cache_css2+=xui.UI.buildCSSText({".xui-css-noscroll, .xui-css-noscroll body":{overflow:"hidden","overflow-x":"hidden","overflow-y":"hidden"},".xui-css-noscrollx, .xui-css-noscroll body":{"overflow-x":"hidden"},".xui-css-noscrolly, .xui-css-noscroll body":{"overflow-y":"hidden"},".xui-css-dockparent":{overflow:"hidden"},".xui-ui-dirty":{$order:1,"background-image":xui.UI.$bg("icons.gif","",true),"background-repeat":"no-repeat","background-position":"-390px -290px"},"input[readonly], textarea[readonly], .xui-ui-readonly, .xui-ui-inputreadonly, .xui-ui-itemreadonly, .xui-ui-readonly, .xui-ui-itemreadonly *, .xui-ui-readonly *":{$order:2,color:"#808080"},".xui-ui-itemreadonly input, .xui-ui-readonly textarea, .xui-ui-itemreadonly textarea":{$order:3,color:"#909090"},"input:disabled, button:disabled, a:disabled,  .xui-ui-inputdisabled, .xui-ui-itemdisabled, .xui-ui-disabled *, .xui-ui-itemdisabled *":{$order:2,cursor:"not-allowed",color:"#808080"},"input:disabled, button:disabled, a:disabled,  .xui-ui-inputdisabled, .xui-ui-itemdisabled, .xui-ui-disabled input, .xui-ui-itemdisabled input, .xui-ui-disabled textarea, .xui-ui-itemdisabled textarea":{$order:3,"background-color":"#eee"},".xui-ui-invalid, .xui-ui-invalid *":{$order:1,"background-color":"#FFEBCD"},".xui-item-row":{display:"block","white-space":"nowrap"},".xui-ui-busy":{"background-image":"url("+xui.ini.img_busy+")","background-repeat":"no-repeat","background-position":"center center"},".xui-uicmd-toggle-busy":{$order:7,"background-image":"url("+xui.ini.img_busy+")","background-repeat":"no-repeat","background-position":"center center"},".xui-uicmd-toggle2-busy":{$order:7,"background-image":"url("+xui.ini.img_busy+")","background-repeat":"no-repeat","background-position":"center center"},".xui-busy":{"background-image":"url(data:image/gif;base64,R0lGODlhEAAQAOMAAAQCBHx+fLy+vOTm5ERCRMTGxISGhAQGBISChMTCxOzq7FRSVMzKzP7+/gAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh+QQJCQANACwAAAAAEAAQAAAESrDJSau9OOvNe1VFonCFIBRcIiQJp7BjNySDxRjMNAQBUk+FAwCAaiR6gURhsUgYhgCEZIDgDRYEwqIALTZmNay2UTB4KwKmwBIBACH5BAkJAA8ALAAAAAAQABAAgwQCBHx+fLy+vERCRKSmpOTi5BQWFNTW1KyurIyKjMTCxERGRPTy9BwaHLSytP7+/gRE8MlJq7046827n47RIJwBAEZ5phsikg9TMNZBHBMj7PR0DEDco7ATFA6JhA04IEh0AgUjEQgomcLY7EG1PmzZClJpiQAAIfkECQkADQAsAAAAABAAEAAABEewyUmrtcywWxn4BTcZH4CIUlGGaFMYbOsuSywuBLHIuC4LNEFrkBjIBoEAwmhRFBKKRDKQuBQEgsIAoWRWEoJEleitRKGWCAAh+QQJCQAPACwAAAAAEAAQAIMEAgR8fny8vrxEQkSkpqTk4uQUFhTU1tSsrqyMiozEwsRERkT08vQcGhy0srT+/v4ERfDJ6UxDM2sDgHkHcWgT5x1DOpKIhRDpQJAaqtK1iJNHkqy7RyIQSAQlw+IR5APiGAXGkiGoSoOFqqBwpAoU1yA0vJxEAAAh+QQJCQANACwAAAAAEAAQAAAES7DJWdYqMzdmWFsEsTRDMkwMoFbhMgQBcjaGCiCCJQhwkEgFG2YyQMRmjYJhmCkhNVBFoqCAQgu7nzWTECS0W4k0UQ2bz+i0en2OAAAh+QQJCQAPACwAAAAAEAAQAIMEAgR8fny8vrxEQkSkpqTk4uQUFhTU1tSsrqyMiozEwsRERkT08vQcGhy0srT+/v4ERfDJeVI6M79DcApB8jAFQy3DUIEJI7zmQ6RDZx3FKxTSQWMTl0AR23Q0o5LEYWggkEgDAGCAaqRUawbRfGq/4LB4TC5DIwAh+QQJCQANACwAAAAAEAAQAAAER7DJqUpSM7eRRkuCUGjSgAQIJyQJ+QXwxWLkAKeuxnm5VCyLVk+yIBAWQ6IRmRQABclJwcCIMg4AwGhoyAIQyYJ3O5ySo9EIACH5BAkJAA8ALAAAAAAQABAAgwQCBHx+fLy+vERCRKSmpOTi5BQWFNTW1KyurIyKjMTCxERGRPTy9BwaHLSytP7+/gRG8MlJ62SFWcuE19tUeEIRXp4Cng+2hkeSHKyUBEFSP3e+x7Od5ECg1Q6LwcB4IigHBETD4NgcngcDAGCAFR9a7g5hMCAsEQA7)","background-repeat":"no-repeat","background-position":"center center"},".xui-required":{color:"#ff0000"},".xui-err":{"background-image":"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAQAAAC1+jfqAAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAAAEgAAABIAEbJaz4AAAAJdnBBZwAAABAAAAAQAFzGrcMAAADdSURBVCjPfdGxTsJQGIbhpw20GgN1IZQBDQnGxvu/FEU3IjEBB5SKUsGkdTiCYeGb/pw803uixum1iMJ1KZdp40dpYQWNqBERuXItRY1YrPJspmm0wNAYlZkvdPR1jTVmtJAZgUhliaWFQs9IqYwxkKhUUnf64NuTD6kBMTK8mKgkigNZaGQBJGqfVh6PyFotCWC/NxMbiUL+/xhjJ9Y5kEriVk9HbBdAKZI7A+8ebLQVhigDmNvqKg7k3kZbamceOpSmbvSkXq1xIfSfKh2lPlf/pWa7Tx3A6c86vV+v4FNOkQDWwAAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxMC0wMi0xMVQxMTo1MDowOC0wNjowMNYQZfsAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMDYtMDUtMDVUMTM6MjI6NDAtMDU6MDC/5P4aAAAAAElFTkSuQmCC)","background-repeat":"no-repeat","background-position":"center center"}})},$End:function(){var d={},c=this.$Keys;_.filter(this.getAppearance(),function(p,n){var k=n.split(/\s*,\s*/),g;for(var f=k.length-1;f>=0;f--){g=k[f].match(/[A-Z][A-Z0-9]*/g);if(g&&g.length){for(var h=0,e=g.length;h<e;h++){if(!c[g[h]]){k.splice(f,1);break}}}}if(k.length){d[k.join(", ")]=p}});this.setAppearance(d);xui.UI.$cache_css+=this.buildCSSText(this.$Appearances)},Static:{$cache_css:"",$cache_css2:"",$css_tag_dirty:"xui-ui-dirty",$css_tag_invalid:"xui-ui-invalid",$tag_left:"{",$tag_right:"}",$tag_subId:"_serialId",$x01:/\x01/img,$x01r:/ \x01 /img,$tag_special:"\x01",$ID:"\x01id\x01",$DOMID:"\x01domid\x01",$CLS:"\x01cls\x01",$MODULECLS:"\x01modulecls\x01",$childTag:"<!--\x03{id}\x04-->",$onSize:function(d,f){var c=d.getRootNode().style;if(f.width||f.height){xui.UI.$tryResize(d,c.width,c.height)}c=null},$ps:{left:1,top:1,width:1,height:1,right:1,bottom:1},objectProp:{},$toDom:function(g,m,k){if(k===false){return _.str.toDom(m)}var d=xui.Dom.getEmptyDiv().get(0),h=[];d.style.position="relative";d.innerHTML=m;this.$addEventsHanlder(g,d);for(var f=0,e=d.childNodes,c=e.length;f<c;f++){xui.$registerNode(e[f]);h[h.length]=e[f].$xid}d=null;return xui(h,false)},$evtsindesign:{onload:1,onerror:1,onscroll:1,onunload:1,onsize:1,onmousedown:1,onmouseup:1},_handleEventConf:function(d,c){var e=this},$addEventsHanlder:function(g,f,w){var c=xui.$cache.UIKeyMapEvents,n=xui.Event._eventHandler,r=this.$evtsindesign,y=xui.Event.$eventhandler,e=_.toArr(f.getElementsByTagName("*")),q,h,p,m,d,x,u;if(w){e.push(f)}if(h=e.length){for(q=0;q<h;q++){if((f=e[q]).nodeType!=1){continue}if(d=f.id){if(x=c[d]||c[d.substr(0,d.indexOf(":"))]){u=xui.$registerNode(f);u=u.eHandlers||(u.eHandlers={});for(p in x){if(g.$inDesign&&!r[p]){continue}u[p]=x[p];if(m=n[p]){u[m]=f[m]=x[p];if(xui.browser.isTouch&&m=="onmousedown"){xui.setNodeData(f,["eHandlers","onxuitouchdown"],y);if(f.addEventListener){f.addEventListener("xuitouchdown",y,false)}else{if(f.attachEvent){f.attachEvent("xuitouchdown",y)}}}}}}}}}e.length=0;f=x=null},setDftProp:function(c){this.__resetDftProp=c;return this},getFromDom:function(c){if(c=xui.UIProfile.getFromDom(c)){return c.boxing()}},_ensureValues:function(d){var e=[],l=0,g=0,m,h=this.KEY,f=xui.$cache.profileMap,c=xui.getNodeData;if(d["xui.absBox"]){d=d._nodes}for(;m=d[l++];){if((m.box&&m.box[h])||((m=f[c(m.renderId?m.renderId:m,["element","id"])])&&m.box&&m.box[h])){e[g++]=m}}return e.length<=1?e:this._unique(e)},__gc:function(){var e=this,d=e.$key,c=xui.$cache;_.breakO([c.template[d],c.reclaimId[d],e._cache,e._idCache,e.$DataModel,e.$Templates,e.$Behaviors,e],2);delete xui.absBox.$type[d.replace("xui.UI.","")];delete xui.absBox.$type[d];_.filter(xui.$cache.UIKeyMapEvents,function(g,f){return !(f==d||f.indexOf(d+"-")==0)});Class.__gc(d)},_pickSerialId:function(){var c=xui.$cache.reclaimId[this.$key];if(c&&c[0]){return c.pop()}return this._ctrlId.next()},$bg:function(e,c,d){return function(f){var g=xui.ini.path+"appearance/default/"+(typeof d=="string"?d:d?"Public":(g=f.split("."))[g.length-1])+"/"+e;return"url("+g+") "+(c||"")}},$ieBg:function(d,c){return function(e){var f=xui.ini.path+"appearance/default/"+(typeof c=="string"?c:c?"Public":(f=e.split("."))[f.length-1])+"/"+d;return'progid:DXImageTransform.Microsoft.AlphaImageLoader(src="'+f+'",sizingMethod="crop")'}},$doTemplate:function(c,C,e,F,g,d,f){var p=arguments.callee,k,h,q,w=xui.UI.$x01,x=" \x01 ",u="",A=_.isArr(e),B=C[F||""],m=!g,g=g||[];F=f||F;if(A){if(typeof B!="function"){B=p}for(var z=0;h=e[z++];){if(false===B(c,C,h,F,g,z)){break}}}else{if(h=e.object){g[g.length]=h.toHtml()}else{if(typeof B=="function"){h=B(c,C,e,F,g);if(h){F=h}}else{F=F?F+".":"";var E=B[0],D=B[1];for(var z=0,y=E.length;z<y;z++){if(q=D[z]){if(q in e){h=e[q];if(C[k=F+q]&&h){p(c,C,h,k,g)}else{g[g.length]=(h===undefined||h===null||h===NaN)?u:typeof h=="string"?h.replace(w,x):h}}}else{g[g.length]=(E[z]===undefined||E[z]===null||E[z]===NaN)?u:E[z]}}}}}if(m){return g.join("")}},$buildTemplate:function(k,K,P,q,d){if(K&&(K.tagName+"").toLowerCase()=="text"){d[d.length]=K.text;return}var y=arguments.callee,x=k.behavior?P?k.behavior[P]:k.behavior:null,h=k.properties,N=y.map1||(y.map1={tagName:1,text:1}),L=y.map2||(y.map2={image:1,input:1,br:1,meta:1,hr:1,abbr:1,embed:1}),I=y.map3||(y.map3={input:1,textarea:1,pre:1,code:1}),E=y.r2||(y.r2=/[a-z]/),D=y.r3||(y.r3=/^(on|before|after)/),A=y.r7||(y.r7=/([^{}]*)\{([\w]+)\}([^{}]*)/g),m=false,p=xui.UI,w,z,J,n,e;if(!K){K=k.template}e=P?k.keys[P]:k.key;if(!K.tagName){K.tagName="span"}if(K.id!==null){K.id=P?e+":"+p.$ID+":"+p.$tag_left+p.$tag_subId+p.$tag_right:p.$DOMID}else{delete K.id}if(K.className!==null){J=K.className||"";if(!K._NativeElement){w=p.$CLS+(P?"-"+P.toLowerCase():"");n=K.tagName.charAt(0)!="{"?K.tagName.toLowerCase():K.tagName;K["class"]="xui-node xui-node-"+n+" "+w+" "+J+" "+(e==k.key?("xui-ui-ctrl "+((xui.browser.ie&&xui.browser.ver<10)?"":"{_selectable} ")):"")}else{K["class"]=J+" "+(e==k.key?((xui.browser.ie&&xui.browser.ver<10)?"":"{_selectable} "):"")}K["class"]+=""+p.$tag_special+(P||"KEY")+"_CT"+p.$tag_special+" "+p.$tag_special+(P||"KEY")+"_CC"+p.$tag_special+" "+p.$MODULECLS+" xui-custom"}delete K.className;K.style=(K.style?(K.style+";"):"")+p.$tag_special+(P||"KEY")+"_CS"+p.$tag_special;var H=[],G={},g=K.tagName.charAt(0)!="{"?K.tagName.toLowerCase():K.tagName,r=K.text,c=xui.absObj.$specialChars;for(var F in K){if(!K[F]){continue}if(!c[F.charAt(0)]&&!N[F]){z=K[F];if(!E.test(F)){if(typeof z=="object"){if(!z.$order){z.$order=0}z.$key=F;H[H.length]=z}}else{G[F]=z}}}_.arr.stableSort(H,function(l,u){l=l.$order||0;u=u.$order||0;return l>u?1:l==u?0:-1});if(!d){m=true;d=[]}d[d.length]="<"+g+" ";for(var F in G){if(G[F]){d[d.length]=F+'="'+G[F]+'" '}}if(K.className!==null){K.className=J}delete K["class"];d[d.length]=p.$tag_special+(P||"KEY")+"_CA"+p.$tag_special;d[d.length]=">";if(!L[g]&&r){d[d.length]=r}for(var F=0,C=H.length;F<C;){z=H[F++];y(k,z,z.$key,q,d)}if(!L[g]){d[d.length]="</"+g+">"}if(m){var O=q[0],M=q[1],B=d.join(""),f=false;B.replace(A,function(u,l,R,Q){if(l){O[O.length]=l}M[O.length]=O[O.length]=R;if(Q){O[O.length]=Q}f=true;return""});if(!f){O[0]=B}}},_rpt:function(d,m){var k=arguments.callee,n=d.host,h=(n&&n["xui.Module"]&&n.customStyle&&!_.isEmpty(n.customStyle))?(" xui-module-"+n.$xid):null,l=xui.UI,p=l.$tag_special,e=function(u,r,q){r="";for(q in u){r+=(q+'="'+u[q]+'" ')}return r},c=k._r||(k._r=new RegExp(p+"([0-9A-Z_]+)_C([CTA])"+p+"|"+p+"([\\w_\\-\\.]*)"+p,"img")),g={id:d.serialId,cls:d.getClass("KEY"),domid:d.$domId,modulecls:h},f={A:d.CA,C:d.CC,T:d._CT};return m.replace(c,function(r,q,w,u){return g[u]||(f[w]?(w=="A"?e(f[w][q]):(f[w][q]||"")):"")}).replace(l.$x01r,"\x01")},_build:function(d,n){var r,y,e,w=xui.UI,x=[[],[]],z=this,q=z.KEY,c=xui.$cache.template,l=d._hash="b:"+(d.template._subid||"")+";!"+(d._exhash||"");if(typeof d.theme=="string"){var p=d._CT={},f=d.key.replace(/\./g,"-").toLowerCase().replace("xui-ui","xui")+"-";_.each(d.keys,function(m,h){if(h.charAt(0)!="$"){p[h]=f+d.theme+"-"+h.toLowerCase()}})}if(!(r=_.get(c,[q,l]))){w.$buildTemplate(d,null,null,x);_.set(c,[q,l,""],x);if(y=d.template.$submap){for(var k in y){if(typeof(e=y[k])!="function"){var x=[[],[]];for(var g in e){if(typeof e[g]=="object"){w.$buildTemplate(d,e[g],g,x)}}e=x}_.set(c,[q,l,k],e)}}r=_.get(c,[q,l])}if(!r){return""}return z._rpt(d,w.$doTemplate(d,r,n))},_setDefaultBehavior:function(l){var c=this,g=arguments.callee,k=g._m||(g._m={"":1,KEY:1,$key:1}),h=g._f1||(g._f1=function(f,p,q){var n=function(z,E,r){var H,x=xui.use(r).id(),G,F=z.getSubId(x),w=z.properties,u,D,C;if(w.disabled||w.readonly){return}G=z.SubSerialIdMapItem&&z.SubSerialIdMapItem[F];if(G&&G.disabled){return}if(G&&G.readonly){return}switch(typeof f){case"string":u=z.getSubNode(f,F)._get();break;case"function":D=[f];break;case"object":u=[];D=[];for(var y,B=0,A=f.length;B<A;B++){y=f[B];if(typeof y=="string"){u.push.apply(u,z.getSubNode(y,F)._get())}else{D.push(y)}}}if(u&&u.length){u=xui(u);C=z.boxing();if(q==1){if(p=="mouseover"){if(z.$beforeHover&&false==z.$beforeHover(z,G,E,r,"mouseover")){return}if(w.disableHoverEffect){return}if(z.beforeHoverEffect&&false===C.beforeHoverEffect(z,G,E,r,"mouseover")){return}}if(p=="mousedown"){if(z.$beforeClick&&false==z.$beforeClick(z,G,E,r,"mousedown")){return}if(w.disableClickEffect){return}if(z.beforeClickEffect&&false===C.beforeClickEffect(z,G,E,r,"mousedown")){return}}u.tagClass("-"+p)}else{if(p=="mouseup"){if(z.$beforeClick&&false==z.$beforeClick(z,G,E,r,"mouseup")){return}if(w.disableClickEffect){return}if(z.beforeClickEffect&&false===C.beforeClickEffect(z,G,E,r,"mouseup")){return}u.tagClass("-mousedown",false)}else{if(z.$beforeHover&&false==z.$beforeHover(z,G,E,r,"mouseout")){return}if(w.disableHoverEffect){return}if(z.beforeHoverEffect&&false===C.beforeHoverEffect(z,G,E,r,"mouseout")){return}u.tagClass("(-mouseover|-mousedown)",false)}}}if(D&&D.length){_.arr.each(D,function(I){_.tryF(I,[z],z)});D.length=0}};return n}),d={},e;if(!xui.SC.get("xui.absContainer")){Class("xui.absContainer","xui.absObj",{Instance:{addPanel:function(n,q,r){var u=_.clone(xui.UI.Panel.$DataStruct,true);_.merge(u,n,"with");_.merge(u,{dock:"fill",tag:n.tag||n.id},"all");var p=new xui.UI.Panel(u),f=[];this.append(p,r&&r.id);_.arr.each(q,function(w){f.push(w[0])});p.append(xui.UI.pack(f,false));return this},removePanel:function(){this.destroy(true)},getPanelPara:function(){return _.clone(this.get(0).properties,true)},dumpContainer:function(f){return this.each(function(u){var w=u.box.$DataModel,z=w.valueSeparator||";",r=u.properties,A="items" in r,y,q,x,n;if(!A){if(n=u.boxing().getContainer()){n.html("",true)}}else{_.arr.each(r.items,function(p){q=p.id;if(!f||f===true){y=1}else{x=_.isArr(f)?f:(f+"").split(z);y=_.arr.indexOf(x,q)!=-1}if(y){if(n=u.boxing().getContainer(q)){n.html("",true)}}})}})},getPanelChildren:function(){return this.get(0).children},getFormValues:function(p,f,q){var n={};this.getFormElements(f).each(function(w){var x=w.properties,r=w.boxing(),u=r.getUIValue();if(!p||(u+" ")!==(r.getValue()+" ")){if(q&&r.getCaption){n[x.name||w.alias]={value:u,caption:r.getCaption()}}else{n[x.name||w.alias]=u}}});return n},setFormValues:function(f,n){if(!_.isEmpty(f)){this.getFormElements(n).each(function(r){if("value" in r.properties&&(r.properties.name||r.alias) in f){var q=f[r.properties.name||r.alias],p=_.isHash(q);r.boxing().setValue((p&&("value" in q))?q.value:q,true,"module");if(typeof(r.boxing().setCaption)=="function"&&p&&"caption" in q){r.boxing().setCaption(q.caption,null,true,"module")}}})}return this},getFormElements:function(r,w){var n=this.getChildren(r,false),p=xui.absValue.pack(n);if(w){var f=[],q,u;p.each(function(x,y){q=x.boxing();if((q.getUIValue()+" ")!==(q.getValue()+" ")){f.push(x)}});return xui.absValue.pack(f)}return p},isDirtied:function(q){var n=this.getFormElements(q).get();for(var r=0,f=n.length;r<f;r++){var u=n[r],p;if(u.box["xui.absValue"]){p=u.boxing();if((p.getUIValue()+" ")!==(p.getValue()+" ")){return true}}}return false},checkValid:function(p,n){var q=this.get(0),f=true;this.getFormElements(n).each(function(r){if(!r.boxing().checkValid()){if(!p){if(!r.beforeInputAlert||false!==r.boxing().prf.beforeInputAlert(q,r,"invalid")){xui.alert("$inline.invalid",xui.getRes("$inline.invalid")+(r.properties.labelCaption?(" : "+r.properties.labelCaption):""),function(){if(r&&r.renderId){r.boxing().activate()}})}return f=false}f=false}});return f},checkRequired:function(p,n){var f=true;this.getFormElements(n).each(function(r,q){if(r.properties.required&&(!(q=r.boxing().getUIValue()))&&q!==0){if(!p){if(!r.beforeInputAlert||false!==r.boxing().prf.beforeInputAlert(profile,r,"required")){xui.alert("$inline.required",xui.getRes("$inline.required")+(r.properties.labelCaption?(" : "+r.properties.labelCaption):""),function(){if(r&&r.renderId){r.boxing().activate()}})}return f=false}f=false}});return f},formReset:function(f){return this.each(function(q){var r=q.properties,n=q.boxing().getFormElements();if(q.beforeFormReset&&false===q.boxing().beforeFormReset(q,n,f)){return}n.each(function(w,u){if((u=w.properties.$UIValue)!==w.properties.value){w.boxing().setValue(u,true)}});if(q.afterFormReset){q.boxing().afterFormReset(q,n,f)}})},formSubmit:function(q,n){var u=this;if(!q&&!u.checkValid()){return}var y=u.get(0),z=y.properties,x,w=u.getFormValues(n),r;if(y.beforeFormSubmit&&false===y.boxing().beforeFormSubmit(y,w,n)){return}if(!q&&!u.checkRequired()){return}if(z.formTarget=="Alert"){w=_.stringify(w);if(xui.Coder&&xui.Coder.formatText){w=xui.Coder.formatText(w)}alert(w)}else{if(/^\s*\{[^}]+\}\s*$/.test(z.formTarget)){x=xui.adjustVar(z.formTarget);x(w)}else{if(/^((\s*function\s*([\w$]+\s*)?\(\s*([\w$\s,]*)\s*\)\s*)(\{([^\{\}]*)\}))\s*$/.test(z.formTarget)){if(x=_.unserialize(z.formTarget)){x(w)}}else{if(xui.APICaller&&_.arr.indexOf(["_blank","_self","_parent","_top"],z.formTarget)==-1){r=xui.APICaller.getFromName(z.formTarget)}if(r){r.setQueryArgs(w);r.invoke()}else{xui.Dom.submit(z.formAction,w,z.formMethod,z.formTarget,z.formEnctype)}}}}u.getFormElements().updateValue();if(y.afterFormSubmit){y.boxing().afterFormSubmit(y,w,n)}},_e1:function(n,p,q,r,f){},_e2:function(n,f,p,q){},_e3:function(n,p,f,q){},_e4:function(n,r,u,f,q,p){},_e5:function(f,n,p){},_e6:function(p,f,n){},_e7:function(p,f,n){},_e8:function(n,p,f){}},Static:{$abstract:true,DataModel:{dragKey:"",dropKeys:"",overflow:{ini:xui.browser.deviceType=="touchOnly"?"auto":undefined,combobox:["","visible","hidden","scroll","auto","overflow-x:auto;overflow-y:auto"],action:function(f){var n=this;_.arr.each(n.box.$Behaviors.PanelKeys,function(p){var q=n.getSubNode(p,true);if(f){if(f.indexOf(":")!=-1){_.arr.each(f.split(/\s*;\s*/g),function(u){var r=u.split(/\s*:\s*/g);if(r.length>1){q.css(_.str.trim(r[0]),_.str.trim(r[1]||""))}});return}}q.css("overflow",f||"")})}},panelBgClr:{type:"color",ini:"",action:function(f){var n=this;_.arr.each(n.box.$Behaviors.PanelKeys,function(p){n.getSubNode(p,true).css("background-color",f)})}},panelBgImg:{format:"image",ini:"",action:function(f){var n=this;_.arr.each(n.box.$Behaviors.PanelKeys,function(p){n.getSubNode(p,true).css("background-image",f?("url("+xui.adjustRes(f||"")+")"):"")})}},panelBgImgPos:{ini:"",combobox:["","top left","top center","top right","center left","center center","center right","bottom left","bottom center","bottom right","0% 0%","-0px -0px"],action:function(f){var n=this;_.arr.each(n.box.$Behaviors.PanelKeys,function(p){n.getSubNode(p,true).css("background-position",f)})}},panelBgImgRepeat:{ini:"",combobox:["","repeat","repeat-x","repeat-y","no-repeat"],action:function(f){var n=this;_.arr.each(n.box.$Behaviors.PanelKeys,function(p){n.getSubNode(p,true).css("background-repeat",f)})}},panelBgImgAttachment:{ini:"",combobox:["","scroll","fixed"],action:function(f){var n=this;_.arr.each(n.box.$Behaviors.PanelKeys,function(p){n.getSubNode(p,true).css("background-attachment",f)})}},conDockPadding:{ini:{left:0,top:0,right:0,bottom:0},action:function(){this.boxing().adjustDock(true)}},conDockSpacing:{ini:{width:0,height:0},action:function(){this.boxing().adjustDock(true)}},conDockFlexFill:{ini:"",combobox:["none","width","height","both"],action:function(){this.boxing().adjustDock(true)}},conDockStretch:{ini:"",combobox:["fixed","forward","rearward","stretch","0.25","0.33","0.5","0.25,0.5,0.25"],action:function(){this.boxing().adjustDock(true)}},formMethod:{ini:"get",listbox:["get","post"]},formTarget:{ini:"Alert",combobox:["Alert","_blank","_self","_parent","_top","[framename]","[APICaller]","function(d){xui.log(d)}"]},formAction:"",formEnctype:{ini:"application/x-www-form-urlencoded",listbox:["application/x-www-form-urlencoded","multipart/form-data","text/plain"]}}}})}var m=xui.absContainer.prototype;d.beforeInputAlert=m._e6;d.beforeFormReset=d.afterFormReset=m._e7;d.beforeFormSubmit=d.afterFormSubmit=m._e8;if(l.HoverEffected){_.each(l.HoverEffected,function(n,f){e=k[f]?l:(l[f]||(l[f]={}));if(!n){e.afterMouseover=e.afterMouseout=null}else{e.afterMouseover=h(n,"mouseover",1);e.afterMouseout=h(n,"mouseout",2)}});d.beforeHoverEffect=m._e1}if(l.ClickEffected){_.each(l.ClickEffected,function(n,f){e=k[f]?l:(l[f]||(l[f]={}));if(!n){e.afterMousedown=e.afterMouseup=null}else{e.afterMousedown=h(n,"mousedown",1);e.afterMouseup=h(n,"mouseup",2)}});d.beforeClickEffect=m._e1}if(l.HotKeyAllowed){_.merge(l,{beforeKeydown:function(f,n,p){if(f.onHotKeydown){return false!==f.boxing().onHotKeydown(f,xui.Event.getKey(n),n,p)}},beforeKeypress:function(f,n,p){if(f.onHotKeypress){return false!==f.boxing().onHotKeypress(f,xui.Event.getKey(n),n,p)}},beforeKeyup:function(f,n,p){if(f.onHotKeyup){return false!==f.boxing().onHotKeyup(f,xui.Event.getKey(n),n,p)}}});d.onHotKeydown=d.onHotKeypress=d.onHotKeyup=m._e2}if(l.NavKeys){_.each(l.NavKeys,function(n,q){var f=arguments.callee,p,y=f.m1||(f.m1={KEY:1,$key:1});if(y[q]){return}var w=f.m2||(f.m2={input:1,textarea:1}),u=f.m3||(f.m3={tab:1,enter:1,up:1,down:1,left:1,right:1}),r=f.m4||(f.m4={tab:1,up:1,down:1,left:1,right:1}),x=l[q]||(l[q]={});var x=l[q]||(l[q]={});if(null===n){x.afterKeydown=null}else{x.afterKeydown=function(F,J,A){var G=xui.Event.getKey(J),L=G.key,B=G.ctrlKey,D=G.shiftKey,I=G.altKey,K=false,z=F._smartnav;if(z){var E=xui.use(A).get(0);if(w[G=E.tagName.toLowerCase()]){if(L&&G=="input"&&E.type.toLowerCase()!="text"&&E.type.toLowerCase()!="password"){K=true}else{if(u[L]){var C=xui.use(A).caret(),H=xui.use(A).get(0).value;switch(L){case"up":if(!/[\n\r]/.test(H.substr(0,C[0]))){K=true}break;case"left":if(!D&&(B||(C[0]===0&&(C[1]!==H.length||C[1]===0)))){K=true}break;case"down":if(!/[\n\r]/.test(H.substr(C[1],H.length))){K=true}break;case"right":if(!D&&(B||(C[1]===H.length&&(C[0]!==0||C[1]===0)))){K=true}break;case"enter":if(G=="input"||I){K=true}break;case"tab":K=true;break}}}}else{if(r[L]){K=true}}E=null}else{K=L==="tab"}if(K){if(F.beforeNextFocus&&false===F.boxing().beforeNextFocus(F,J,G.shiftKey,A)){return false}if(z){if(L!="tab"){xui.use(A).nextFocus(("up"==L||"left"==L)?false:true)}}}}}});d.beforeNextFocus=m._e3}if((e=l.DroppableKeys)&&e.length){_.arr.each(e,function(f){c._droppable(f)});e=c.prototype;_.arr.each("addPanel,removePanel,dumpContainer,getPanelPara,getPanelChildren,getDropKeys,setDropKeys,getFormValues,setFormValues,getFormElements,isDirtied,checkValid,checkRequired,formReset,formSubmit".split(","),function(f){if(!e[f]){e[f]=m[f]}});c.$DataModel.dropKeys=c.$DataStruct.dropKeys="";d.onDragEnter=d.onDragLeave=d.beforeDrop=d.onDrop=d.afterDrop=d.onDropTest=d.onDropMarkShow=d.onDropMarkClear=m._e4}if((e=l.DraggableKeys)&&e.length){_.arr.each(e,function(f){c._draggable(f)});e=c.prototype;_.arr.each("getDragKey,setDragKey".split(","),function(f){if(!e[f]){e[f]=m[f]}});c.$DataModel.dragKey=c.$DataStruct.dragKey="";d.onGetDragData=d.onStartDrag=d.onDragStop=m._e5}if((e=l.NoDraggableKeys)&&e.length){c.NoDraggableKeys=e}if((e=l.NoDroppableKeys)&&e.length){c.NoDroppableKeys=e}if((e=l.PanelKeys)&&e.length){e=c.prototype;_.arr.each("overflow,panelBgClr,panelBgImg,panelBgImgPos,panelBgImgRepeat,panelBgImgAttachment,conDockPadding,conDockSpacing,conDockFlexFill,conDockStretch,formMethod,formTarget,formAction,formEnctype".split(","),function(q){var p="get"+_.str.initial(q),n;if(!e[p]){e[p]=m[p]}p="set"+_.str.initial(q);if(!e[p]){e[p]=m[p]}n=xui.absContainer.$DataModel[q];c.$DataStruct[q]=_.isSet(n.ini)?_.copy(n.ini):"";c.$DataModel[q]=_.copy(n)});_.merge(d,xui.absContainer.$EventHandlers);c["xui.absContainer"]=true}c.setEventHandlers(d)},addTemplateKeys:function(c){var d=this,e=d.KEY,g=arguments.callee,f=g._reg||(g._reg=/\./g);_.arr.each(c,function(h){d.$cssKeys[h]=(d.$Keys[h]=h=="KEY"?e:e+"-"+h).replace(f,"-").toLowerCase().replace("xui-ui","xui")});return d},$getCSSValue:function(d,g){var f=xui.$CSSCACHE,e=d+"->"+g;if(e in f){return f[e]}var k=xui.Dom.getEmptyDiv().get(0),h;xui.Dom._setClass(k,d);h=f[e]=parseInt(xui.Dom.getStyle(k,g),10)||0;xui.Dom._setClass(k,"");return h},setAppearance:function(c){_.merge(this.$Appearances,c,"all");return this},getAppearance:function(){return this.$Appearances},setTemplate:function(f,q){if(f){var p=this,m=p.$tagName||(p.$tagName={}),l=arguments.callee,c=l.r2||(l.r2=/[a-z]/),k=xui.absObj.$specialChars,g=["KEY"],h=l._fun||(l._fun=function(x,u,r){var y,w;for(w in x){if(!k[w.charAt(0)]){if(!c.test(w)){u[u.length]=w;y=x[w];if(typeof y=="object"){r[w]=y.tagName||"";arguments.callee(y,u,r)}}}}}),n;m.KEY=f.tagName||"";h(f,g,m);p.addTemplateKeys(g);n=p.$Templates;if(typeof q=="string"){f._subid=q;n[q]=f}else{n._=f}if(n=f.$submap){for(var e in n){for(var d in n[e]){l.call(p,n[e],d)}}}}return this},getTemplate:function(c){return this.$Templates[c||"_"]},setBehavior:function(d){if(d){var p=this,l=xui.$cache.UIKeyMapEvents,e=p.$key,A=xui.absObj.$specialChars,c=xui.Event.$eventhandler,g=xui.Event._eventMap,B=arguments.callee,z=B.r1||(B.r1=/[a-z]/),x=B.r2||(B.r2=/^(on|before|after)/),n=p.$Behaviors,r,y,w,u,q,h,f;p._setDefaultBehavior(d);if(d.KEY){_.merge(d,d.KEY,"all");delete d.KEY}for(y in d){q=d[y];if(!A[y.charAt(0)]){if(!z.test(y)){r=n[y]||(n[y]={});for(w in q){h=q[w];if(!A[w.charAt(0)]){if(h){r[w]=h}else{delete r[w]}}}}else{if(x.test(y)){if(q){n[y]=q}else{delete n[y]}}else{n[y]=q}}}}_.filter(l,function(m,k){return !(k==e||k.indexOf(e+"-")==0)});for(y in n){q=n[y];if(!A[y.charAt(0)]){if(!z.test(y)){for(w in q){if(!A[w.charAt(0)]&&q[w]){u=e+"-"+y;(l[u]||(l[u]={}))["on"+g[w]]=c}}}else{if(x.test(y)&&q){u=e;(l[u]||(l[u]={}))["on"+g[y]]=c}}}}}return p},getBehavior:function(){return this.$Behaviors},$applyCSS:function(){var f=xui.UI,e=f.$cache_css,d=f.$cache_css2;if(!f.$cssNo){f.$cssNo=1;var c=xui.browser;xui("body").addClass((c.ie?("xui-css-ie xui-css-ie"+c.ver+" "):c.gek?("xui-css-gek xui-css-gek"+c.ver+" "):c.kde?("xui-css-kde xui-css-kde"+c.ver+" "):c.opr?("xui-css-opr xui-css-opr"+c.ver+" "):"")+(c.isSafari?"xui-css-safari ":c.isChrome?"xui-css-chrome ":"")+(c.isMac?"xui-css-mac":c.isLinux?"xui-css-linux ":""));xui("html").addClass(c.isStrict?"xui-css-base xui-css-strict xui-css-viewport":"xui-css-base xui-css-viewport")}if(e){xui.CSS.addStyleSheet(e,"xui.UI-CSS"+(f.$cssNo++));xui.UI.$cache_css=""}if(d){xui.CSS.addStyleSheet(d,"xui.UI-CSS"+(f.$cssNo++),true);xui.UI.$cache_css2=""}},buildCSSText:function(p){var B=this,x=arguments.callee,f=x._r1||(x._r1=/(^|\s|,)([0-9A-Z_]+)/g),q=[],c=[],u=xui.browser,k=u.ie6,d=u.ie,w=u.gek,y=B.$cssKeys,A,z,e;for(var n in p){if(e=p[n]){A=n.replace(f,function(l,h,r){return h+"."+(y[r]||r)}).toLowerCase();e.$order=parseInt(e.$order,10)||0;e.$=A;q[q.length]=e}}_.arr.stableSort(q,function(h,l){h=h.$order||0;l=l.$order||0;return h>l?1:h==l?0:-1});for(var n=0,g=q.length;n<g;){e=q[n++];c[c.length]=e.$+"{";if(A=e.$before){c[c.length]=A}if(A=e.$text){c[c.length]=A}for(var m in e){if(m.charAt(0)=="$"){continue}if((z=e[m])||e[m]===0){switch(typeof z){case"string":case"number":c[c.length]=m+":"+z+";";break;case"function":c[c.length]=m+":"+z(B.KEY)+";";break;default:_.arr.each(z,function(h){if(h){c[c.length]=m+":"+h+";"}})}}}if(z=e.$after){c[c.length]=z}c[c.length]="}"}return c.join("")},_droppable:function(f){var d=this,e=xui.Event.$eventhandler2,l=d.$Behaviors,c=f=="KEY"?l:(l[f]||(l[f]={})),h=xui.$cache.UIKeyMapEvents,k=f=="KEY"?d.KEY:(d.KEY+"-"+f),g=h[k]||(h[k]={});_.merge(c,{beforeMouseover:function(p,w,m){if(p.properties.disabled||p.properties.readonly){return}if(p.behavior.NoDroppableKeys){var q=p.getKey(xui.Event.getSrc(w).id||"").split("-")[1];if(q&&_.arr.indexOf(p.behavior.NoDroppableKeys,q)!=-1){return}}var y=m,A=xui.DragDrop,n=A.getProfile(),z=n.dragKey,r=n.dragData,C,u,B,x;if(!z||!r||!(new RegExp("\\b"+z+"\\b")).test(p.box.getDropKeys(p,y))){return}u=p.boxing();if(u.getItemByDom){C=u.getItemByDom(m)}x=[p,w,y,z,r,C];if((B=p.onDropTest)&&(false===u.onDropTest.apply(u,x))){return}if((B=p.box._onDropTest)&&(false===B.apply(p.host||p,x))){return}A.setDropElement(m);if(p.onDropMarkShow&&(false===u.onDropMarkShow.apply(u,x))){}else{if((B=p.box._onDropMarkShow)&&(false===B.apply(p.host||p,x))){}else{_.resetRun("setDropFace",A.setDropFace,0,[y],A)}}if(B=p.box._onDragEnter){B.apply(p.host||p,x)}if(p.onDragEnter){u.onDragEnter.apply(u,x)}},beforeMouseout:function(p,u,m){if(p.properties.disabled||p.properties.readonly){return}var y=xui.DragDrop,n=y.getProfile(),x=n.dragKey,q=n.dragData,z,r,w;if(n.dropElement==m){r=p.boxing();if(r.getItemByDom){z=r.getItemByDom(m)}w=[p,u,m,x,q,z];if(p.onDropMarkClear&&(false===r.onDropMarkClear.apply(r,w))){}else{if((t=p.box._onDropMarkClear)&&(false===t.apply(p.host||p,w))){}else{_.resetRun("setDropFace",y.setDropFace,0,[null],xui.DragDrop)}}if(t=p.box._onDragLeave){t.apply(p.host||p,w)}if(p.onDragLeave){r.onDragLeave.apply(r,w)}y.setDropElement(null)}},beforeDrop:function(p,u,m){var y=xui.DragDrop,n=y.getProfile(),x=n.dragKey,q=n.dragData,A,z,w,r=p.boxing();if(r.getItemByDom){A=r.getItemByDom(m)}w=[p,u,m,x,q,A];if(p.onDropMarkClear&&(false===r.onDropMarkClear.apply(r,w))){}else{if((z=p.box._onDropMarkClear)&&(false===z.apply(p.host||p,w))){}}if(p.beforeDrop&&(false===r.beforeDrop.apply(r,w))){return}if(p.onDrop&&(false===r.onDrop.apply(r,w))){}else{if(p.box._onDrop){p.box._onDrop.apply(p.host||p,w)}}if(p.afterDrop){r.afterDrop.apply(r,w)}}},"all");_.merge(g,{onmouseover:e,onmouseout:e,ondrop:e,afterDrop:e,beforeDrop:e});return d},_draggable:function(f){var d=this,e=xui.Event.$eventhandler2,l=d.$Behaviors,c=f=="KEY"?l:(l[f]||(l[f]={})),h=xui.$cache.UIKeyMapEvents,k=f=="KEY"?d.KEY:(d.KEY+"-"+f),g=h[k]||(h[k]={});_.merge(c,{beforeMousedown:function(p,u,m){if(xui.Event.getBtn(u)!="left"){return}if(p.properties.disabled){return}if(!p.properties.dragKey){return}if(p.behavior.NoDraggableKeys){var q=p.getKey(xui.Event.getSrc(u).id||"").split("-")[1];if(q&&_.arr.indexOf(p.behavior.NoDraggableKeys,q)!=-1){return}}var x=xui.Event.getPos(u),r=p.boxing(),w=[p,u,m],y;if(p.onStartDrag&&(false===r.onStartDrag.apply(r,w))){}else{if((y=p.box._onStartDrag)&&(false===y.apply(p.host||p,w))){}else{var n=p.box;xui.use(m).startDrag(u,{dragType:"icon",targetLeft:x.left+12,targetTop:x.top+12,dragCursor:"pointer",dragDefer:2,dragKey:n.getDragKey(p,m),dragData:n.getDragData(p,u,m)})}}},beforeDragbegin:function(m,n,p){xui.use(p).onMouseout(true,{$force:true}).onMouseup(true)},beforeDragstop:function(n,p,q){var m;if(n.onDragStop){n.boxing().onDragStop(n.e,q)}if(m=n.box._onDragStop){m.apply(n.host||n,arguments)}}},"all");_.merge(g,{onmousedown:e,ondragbegin:e});return d},adjustData:function(g,k,e,f){if(!e){e={}}var h=g.box,c=h.$DataModel,d,l;for(d in k){if(d.charAt(0)=="$"){continue}if(k.hasOwnProperty(d)&&!e.hasOwnProperty(d)){e[d]=typeof(l=k[d])=="string"?d=="html"?xui.adjustRes(l,0,1):xui.adjustRes(l,true):l}}if("hidden" in k){e._itemDisplay=k.hidden?"display:none;":""}if("disabled" in c){e.disabled=(_.isSet(e.disabled)&&e.disabled)?"xui-ui-itemdisabled":""}if("readonly" in c){e.readonly=(_.isSet(e.readonly)&&e.readonly)?"xui-ui-itemreadonly":""}e.imageDisplay=(e.imageClass||e.image)?"":"display:none";if(e.image){e.backgroundImage="background-image:url("+e.image+");"}if(e.imagePos){e.backgroundPosition="background-position:"+e.imagePos+";"}else{if(e.image){e.backgroundPosition="background-position:center;"}}if(e.imageRepeat){e.backgroundRepeat="background-repeat:"+e.imageRepeat+";"}else{if(e.image){e.backgroundRepeat="background-repeat:no-repeat;"}}if(!e.image&&h.IMGNODE){e.image=xui.ini.img_bg}if((typeof(l=e.renderer)=="function")||(typeof(l=k.renderer)=="function")){e.caption=xui.adjustRes(l.call(g,k,e))}return e},cacheData:function(c,d){_.set(xui.$cache,["UIDATA",c],d);return this},getCachedData:function(c){var d=_.get(xui.$cache,["UIDATA",c]);if(typeof d=="function"){d=d()}return d},Behaviors:{HotKeyAllowed:true,onContextmenu:function(c,d,f){if(c.onContextmenu){return c.boxing().onContextmenu(c,d,f)!==false}}},DataModel:{autoTips:true,className:{ini:"",action:function(c,d){if(d){this.getRoot().removeClass(d)}this.getRoot().addClass(c)}},disableClickEffect:false,disableHoverEffect:false,disableTips:false,disabled:{ini:false,action:function(c){var d=this.getRoot();if(c){d.addClass("xui-ui-disabled")}else{d.removeClass("xui-ui-disabled")}}},defaultFocus:false,hoverPop:{ini:"",action:function(d,f){var g=this,c=g.boxing(),h=g.properties,e;if(!g.destroyed&&g.host){if(f&&(e=g.host[f])&&(e=e.get(0))&&e.renderId&&!e.destroyed){c.hoverPop(e,null)}if(d&&(e=g.host[d])&&(e=e.get(0))&&e.renderId&&!e.destroyed){c.hoverPop(e,h.hoverPopType,function(){e.properties.tagVar.hoverFrom=arguments},function(){delete e.properties.tagVar.hoverFrom},e.getRoot().parent(),d)}}}},hoverPopType:{ini:"outer",dftWidth:180,listbox:["outer","inner","outerleft-outertop","left-outertop","center-outertop","right-outertop","outerright-outertop","outerleft-top","left-top","center-top","right-top","outerright-top","outerleft-middle","left-middle","center-middle","right-middle","outerright-middle","outerleft-bottom","left-bottom","center-bottom","right-bottom","outerright-bottom","outerleft-outerbottom","left-outerbottom","center-outerbottom","right-outerbottom","outerright-outerbottom"]},locked:{ini:false,action:function(){if(this.$inDesign){this.boxing().refresh(true)}}},dock:{ini:"none",listbox:["none","top","bottom","left","right","center","middle","origin","width","height","fill","cover"],action:function(c){xui.UI.$dock(this,true,true)}},dockIgnore:{ini:false,action:function(d){var c=this;if(c.properties.dock!="none"){xui.UI.$dock(c,true,true)}}},dockFloat:{ini:false,action:function(d){var c=this;if(c.properties.dock!="none"){xui.UI.$dock(c,true,true)}}},dockOrder:{ini:1,action:function(d){var c=this;if(c.properties.dock!="none"){xui.UI.$dock(c,true,true)}}},showEffects:"",hideEffects:"",dockMargin:{ini:{left:0,top:0,right:0,bottom:0},action:function(d){var c=this;if(c.properties.dock!="none"){xui.UI.$dock(c,true,true)}}},dockMinW:0,dockMinH:0,dockMaxW:0,dockMaxH:0,dockIgnoreFlexFill:{ini:false,action:function(d){var c=this;if(c.properties.dock!="none"){xui.UI.$dock(c,true,true)}}},dockStretch:{ini:"",combobox:["fixed","forward","rearward","stretch","0.25","0.33","0.5"],set:function(d){var e=this,c=e.properties;c.dockStretch=d;if(c.dock=="fill"||c.dock=="cover"||c.dock=="width"||c.dock=="height"){if(d!="forward"&&d!="rearward"&&d!="stretch"){c.dockStretch="stretch"}}if(e.rendered&&c.dock!="none"){xui.UI.$dock(e,true,true)}}},tips:{ini:"",action:function(c){var d=xui.Tips;if(d&&d._showed){if(xui.UIProfile.getFromDom(d._markId)==this){d.setTips(c,true)}}}},rotate:{ini:0,action:function(d){var c=this.getRoot(),e=this.boxing();d=parseInt(d,10)||0;d=d%360;if(d<0){d=d+360}if(this.box["xui.svg"]){e.setAttr("KEY",{transform:"r"+d},false)}else{c.rotate(d)}}},animConf:{hidden:true,ini:{}},activeAnim:{ini:"",action:function(d){var h=this,g=h.getRootNode(),k=xui.getNodeData(g,"_inthread"),f=xui.getNodeData(g,"_animationreset");if(k&&xui.Thread.isAlive(k)){xui.Thread(k).abort("force");xui.setNodeData(g,"_inthread",null)}if(typeof f=="function"){f();xui.setNodeData(g,"_animationreset",null)}if(d){var c=this.properties.animConf,e=c[d];if(!e){e=xui.Dom.$preDefinedAnims[d]}if(e&&e.params){h.getRoot().animate(e.params,e.onStart,e.onEnd,e.duration||200,null,e.type||"linear",null,e.unit,e.returned,e.times).start()}}}}},EventHandlers:{beforeRender:function(c){},onRender:function(c){},onLayout:function(c){},onResize:function(e,d,c){},onMove:function(e,g,f,d,c){},onDock:function(c,d){},beforePropertyChanged:function(d,c,e,f){},afterPropertyChanged:function(d,c,e,f){},beforeAppend:function(c,d){},afterAppend:function(c,d){},beforeRemove:function(e,f,d,c){},afterRemove:function(e,f,d,c){},onDestroy:function(c){},beforeDestroy:function(c){},afterDestroy:function(c){},onShowTips:function(c,d,e){},onContextmenu:function(c,f,g,d){}},RenderTrigger:function(){var f=this,c=f.boxing(),g=f.properties,d;if(f.box._onresize){if(!f._syncResize&&!f.box._syncResize){var e=f.getRootNode().style,d;if((d=e.visibility)!="hidden"){f._$visibility=d;e.visibility="hidden"}e=null}xui.UI.$tryResize(f,g.width,g.height)}if(g.disabled){c.setDisabled(true,true)}if(g.rotate){c.setRotate(g.rotate,true)}if(!f.$inDesign&&g.hoverPop){_.asyRun(function(){c.setHoverPop(g.hoverPop,true)})}if(g.activeAnim){_.asyRun(function(){c.setActiveAnim(g.activeAnim,true)})}if(f.behavior.PanelKeys){if(d=g.dataBinder){c.setDataBinder(d,true)}}f._inValid=1},$doResize:function(g,c,f,l,d){if(l||((c||f)&&(g._resize_w!=c||g._resize_h!=f))){if(!g.getRootNode()){return false}g._resize_w=c;g._resize_h=f;_.tryF(g.box._onresize,[g,c,f,l,d],g.box);if(g.onResize){g.boxing().onResize(g,c,f)}}if("_$visibility" in g){var k=g.getRootNode(),e=k.style;if(e.visibility!="visible"&&!xui.getNodeData(k,"_setVisibility")){e.visibility=g._$visibility}k=e=null;_.clearTimeout(g._$rs_timer);delete g._$rs_timer;delete g._$rs_args;delete g._$visibility}},$tryResize:function(l,c,k,m,f){var g=l.box,e=g._onresize;if(e&&(m||c||k)){c=((c===""||c=="auto")?"auto":parseInt(c,10))||null;k=((k===""||k=="auto")?"auto":parseInt(k,10))||null;if("_$visibility" in l){var d=l._$rs_args;if(!d){d=l._$rs_args=[l,null,null];l._$rs_timer=_.asyRun(function(){if(!l.box){return}if(l&&l._$rs_args){xui.UI.$doResize.apply(null,l._$rs_args)}})}d[1]=c;d[2]=k;d[3]=m;d[4]=f}else{xui.UI.$doResize(l,c,k,m,f)}}},LayoutTrigger:function(){var d=this,c=d.boxing(),f=d.properties;if(f.dock&&f.dock!="none"){if(!d.$laidout){d.$laidout=1;var e=d.getRootNode().style;switch(f.dock){case"top":case"bottom":case"width":e.width=0;break;case"left":case"right":case"height":e.height=0;break;default:e.width=e.height=0}}xui.UI.$dock(this,false,true)}},$dock_args:["top","bottom","left","right","center","middle","width","height"],$dock_map:{middle:1,center:1},$dock:function(k,e,y){var F=k.getRoot(),z=k.box["xui.svg"],d=k.boxing(),G=-1,E=-1,C=-1,B=-1,A=xui((F.get(0)&&F.get(0).parentNode)||k.$dockParent),u=function(J,M){var N,R,O,Q,P;if(M){N=xui.win.$getEvent("onSize","dock")}else{if(J&&J.get(0)){N=J.$getEvent("onSize","dock")}}if(N&&N.dockall&&N.dockall.length){for(var L=0,K=N.dockall.length,S;L<K;L++){S=N.dockall[L].$dockType;switch(S){case"fill":case"cover":Q=P=1;break;case"top":case"bottom":case"width":Q=1;break;case"left":case"right":case"height":P=1;break}}}if(Q&&P){O="xui-css-noscroll"}else{if(Q){O="xui-css-noscrollx"}else{if(P){O="xui-css-noscrolly"}}}if(M){xui("html").removeClass(/^xui-css-noscroll(x|y)?$/);R=xui("body").get(0);if(R){R.scroll=""}if(O){if(Q){xui.win.scrollLeft(0)}if(P){xui.win.scrollTop(0)}xui("html").addClass(O);if(Q&&P&&R){R.scroll="no"}}}else{J.removeClass(/^xui-css-noscroll(x|y)?$/);if(O){if(Q){J.scrollLeft(0)}if(P){J.scrollTop(0)}J.addClass(O)}}};if(!A.get(0)){return}var h=k.properties,x=h.dockMargin,m="auto",D=h.dock||"none",w=xui.Event.getId(A.get(0)),H=function(f,p){f=parseInt(f.properties.dockOrder,10)||0;p=parseInt(p.properties.dockOrder,10)||0;return f>p?1:f==p?0:-1},l,r="$inMatrix",I,q,n,g=function(f){return xui.browser.ie6?f-f%2:f};if(z){var c=d._getBBox();h.left=c.x;h.top=c.y;h.width=c.width;h.height=c.height}if(A.get(0)===document.body||A.get(0)===document||A.get(0)===window){w="!document";n=true}if(w&&(w==xui.Dom._ghostDivId||_.str.startWith(w,xui.Dom._emptyDivId))){return}if(k.$dockParent!=w||k.$dockType!=D||e){k.$dockParent=w;k.$dockType=D;G=k.unLink("$dockall");E=k.unLink("$dock");C=k.unLink("$dock1");B=k.unLink("$dock2");switch(D){case"middle":l={right:h.right=="auto"?m:(h.right||""),bottom:m,left:h.left=="auto"?m:(h.left||""),width:h.width||"",height:h.height||""};break;case"center":l={right:m,bottom:h.bottom=="auto"?m:(h.bottom||""),top:h.top=="auto"?m:(h.top||""),width:h.width||"",height:h.height||""};break;case"origin":l={right:m,bottom:m,width:h.width||"",height:h.height||""};break;case"top":l={left:x.left,right:x.right,bottom:m,height:h.height||""};break;case"bottom":l={left:x.left,right:x.right,top:m,height:h.height||""};break;case"left":l={right:m,width:h.width||""};break;case"right":l={left:m,width:h.width||""};break;case"width":l={bottom:m,height:h.height||"",top:h.top||""};break;case"height":l={right:m,width:h.width||"",left:h.left||""};break;case"fill":case"cover":l={right:m,bottom:m};break;case"none":l={left:h.left,top:h.top,width:h.width||"",height:h.height||""};break}if(F.get(0)){if(z){d._setBBox(l)}else{F.cssRegion(l,true)}}if(n){A=xui.win;if(!xui.$cache._resizeTime){xui.$cache._resizeTime=1}}if(D!="none"){I=A.$getEvent("onSize","dock");if(!I){I=function(Z){var T=arguments.callee,aa=xui.UI.$dock_map,V=xui.UI.$dock_args,ac=T.rePos,ah=T.pid,at=T.pid=="!window"||T.pid=="!document",aj=at?0:xui.UIProfile.getFromDom(ah),ai=aj&&aj.properties,ab=(ai&&("conDockSpacing" in ai))?ai.conDockSpacing:{width:0,height:0},U=(ai&&("conDockPadding" in ai))?ai.conDockPadding:{left:0,top:0,right:0,bottom:0},M=(ai&&("conDockFlexFill" in ai))?ai.conDockFlexFill:"",L=(ai&&("conDockStretch" in ai))?ai.conDockStretch.split(/[,;\s]+/):[],N=M=="width"||M=="both",R=M=="height"||M=="both",ae=at?xui.win:xui(ah);if(!ae.get(0)){return}var am=(at?xui.win:ae).get(0).style,K,aq,ap,an,W,f,p,J;var ag=at?xui("body").get(0).style:am,Y=ag.overflow,Q=ag.overflowX,O=ag.overflowY;if(am){am.overflow=am.overflowX=am.overflowY="hidden"}p=(am&&parseInt(am.width,10))||ae.width()||0;J=(am&&parseInt(am.height,10))||ae.height()||0;if(am){am.overflow=Y;am.overflowX=Q;am.overflowY=O}if(Z.$dockid||!at||((_()-xui.$cache._resizeTime)>50)){K={left:U.left,top:U.top,right:U.right,bottom:U.bottom,width:p,height:J};K.preX=K.oX=K.left;K.preY=K.oY=K.top;K.ww=K.width-K.left-K.right+ab.width;K.hh=K.height-K.top-K.bottom+ab.height;K.leftHolder=K.topHolder=K.rightHolder=K.bottomHolder=0;if(N||R){var au=0,ar=0,P=0,ak=0,al,ao=0,S=function(ay,ax,av,aw){if(aw=ay["dockMin"+ax]){av=Math.max(aw,av)}if(aw=ay["dockMax"+ax]){av=Math.min(aw,av)}return av};for(ap=0;W=V[ap++];){f=T[W];if(f.length){for(aq=0;an=f[aq++];){if(!(an.properties.dockIgnore||an.properties.dockIgnoreFlexFill)){var ae=an.getRoot();if(N&&(W=="left"||W=="right"||W=="width")){au++;al=S(an.properties,"W",parseFloat(an.properties.width)||ae.width());ar+=al;if(an.properties.dock!="fill"){ao=Math.max(ao,S(an.properties,"H",parseFloat(an.properties.height)||ae.height()))}}if(R&&(W=="top"||W=="bottom"||W=="height")){P++;ak+=S(an.properties,"H",parseFloat(an.properties.height)||ae.height())}}}}}if(ak&&ao){ak+=ao}if(au>=1&&ar&&K.width){var X=K.width-U.left-U.right-(au-1)*ab.width;for(ap=0;W=V[ap++];){f=T[W];if(f.length){for(aq=0;an=f[aq++];){if(!an.properties.dockIgnore&&an.properties.dockIgnoreFlexFill){var ae=an.getRoot();if(W=="left"||W=="right"||W=="width"){X-=S(an.properties,"W",parseFloat(an.properties.width)||ae.width());ad-=ab.width}}}for(aq=0;an=f[aq++];){if(!(an.properties.dockIgnore||an.properties.dockIgnoreFlexFill)){var ae=an.getRoot();if(W=="left"||W=="right"||W=="width"){ae.width(S(an.properties,"W",Math.min(1,(parseFloat(an.properties.width)||ae.width())/ar)*X))}}}}}}if(P>=1&&ak&&K.height){var ad=K.height-U.top-U.bottom-(P-1)*ab.height;for(ap=0;W=V[ap++];){f=T[W];if(f.length){for(aq=0;an=f[aq++];){if(!an.properties.dockIgnore&&an.properties.dockIgnoreFlexFill){var ae=an.getRoot();if(W=="top"||W=="bottom"||W=="height"){ad-=S(an.properties,"H",parseFloat(an.properties.height)||ae.height());ad-=ab.height}}}for(aq=0;an=f[aq++];){if(!(an.properties.dockIgnore||an.properties.dockIgnoreFlexFill)){var ae=an.getRoot();if(W=="top"||W=="bottom"||W=="height"){ae.height(S(an.properties,"H",Math.min(1,(parseFloat(an.properties.height)||ae.height())/ak)*ad))}}}}}}if(aj&&N){aj._conDockFlexFillW=1}if(aj&&R){aj._conDockFlexFillH=1}}if(M!="both"){for(ap=0;W=V[ap++];){f=T[W];if(f.length){for(aq=0;an=f[aq++];){if(!(an.properties.dockIgnore||an.properties.dockIgnoreFlexFill)){var ae=an.getRoot();if(aj&&aj._conDockFlexFillW&&!N&&(W=="left"||W=="right"||W=="width")){ae.width(an.properties.width)}if(aj&&aj._conDockFlexFillH&&!R&&(W=="top"||W=="bottom"||W=="height")){ae.height(an.properties.height)}}}}}if(aj&&!N){delete aj._conDockFlexFillW}if(aj&&!R){delete aj._conDockFlexFillH}}for(ap=0;W=V[ap++];){K.preX=K.oX;K.preY=K.top;f=T[W];var af=0;if(f.length){delete K.$prevLeft;if(!aa[W]){Z.width=Z.height=1}for(aq=0;an=f[aq++];){if(!an.properties.dockIgnore){ac(an,af++,K,W,Z.$dockid,at||Z.width,at||Z.height,ab.width,ab.height,L)}}}}if(K.later){_.each(K.later,function(ax){var av;try{if(ax.isSVG){ax.ins._setBBox(ax)}else{ax.node.cssRegion(ax,true)}if(av=xui.UIProfile.getFromDom(ax.node.get(0))){delete ax.node;if(!av.box._onresize&&av.onResize&&(ax.width!==null||ax.height!==null)){av.boxing().onResize(av,ax.width,ax.height)}if(av.onDock){av.boxing().onDock(av,ax)}if(av.$onDock){av.$onDock(av,ax)}}}catch(aw){_.asyRun(function(){if(!ax.node){return}ax.width+=1;ax.height+=1;if(ax.isSVG){ax.ins._setBBox(ax)}else{ax.node.cssRegion(ax)}ax.width-=1;ax.height-=1;if(ax.isSVG){ax.ins._setBBox(ax)}else{ax.node.cssRegion(ax,true)}if(av=xui.UIProfile.getFromDom(ax.node.get(0))){delete ax.node;if(!av.box._onresize&&av.onResize&&(ax.width!==null||ax.height!==null)){av.boxing().onResize(av,ax.width,ax.height)}if(av.onDock){av.boxing().onDock(av,ax)}if(av.$onDock){av.$onDock(av,ax)}}})}})}for(ap=0;W=V[ap++];){f=T[W];if(f.length){for(aq=0;an=f[aq++];){if(!an.properties.dockIgnore){if(!K.later||!K.later[an.$xid]){if(an.onDock){an.boxing().onDock(an)}if(an.$onDock){an.$onDock(an)}}}}}}if(at){xui.$cache._resizeTime=_()}}T=ac=ae=am=null};I.pid=w;_.arr.each(xui.UI.$dock_args,function(f){I[f]=[]});I.dockall=[];I.rePos=function(P,ac,L,al,af,ak,ap,S,V,N){var ad=false;if(af&&P.$xid!=af){ad=true}var W=P.properties,ag=W.dockFloat,Q=W.dockMargin,Z=W.dockStretch,aa,U,M,Y,f,ae=0,am=0,ab=P.getRoot(),aj=P.boxing(),ao=P.getRootNode().style,O,R,an,p,T,J,ai=parseInt(W._dockBorderWidth,10)||0,ah=parseInt(W._dockBorderHeight,10)||0,aq={},K=P.box["xui.svg"],X;if(K){X=aj._getBBox();W.left=X.x;W.top=X.y;W.width=X.width;W.height=X.height}if(ao.display=="none"){return}switch(al){case"middle":case"center":aa=U=0;break;default:Z=Z||((al=="width"||al=="height")?"":N[ac%N.length])||"stretch";if(al=="width"||al=="height"){if(Z!="stretch"&&Z!="forward"&&Z!="rearward"){Z="stretch"}}switch(Z){case"stretch":aa=1;U=1;M=0;break;case"forward":aa=1;U=0;M=0;break;case"rearward":aa=0;U=1;M=0;break;case"fixed":M=1;break;default:M=1;Y=Math.min(1,Math.max(0,parseFloat(Z)))}}f=W.dock=="cover";switch(al){case"middle":if(K){aj.setTop(Math.max(0,(L.height-X.height)/2))}else{ab.top(Math.max(0,(L.height-ab.height())/2))}break;case"center":if(K){aj.setLeft(Math.max(0,(L.width-X.width)/2))}else{ab.left(Math.max(0,(L.width-ab.width())/2))}break;case"top":if(!ad){if(M){T=(Y?parseInt(L.ww*Y,10):g(K?X.width:parseFloat(W.width)))+(L.$prevLeft||0);delete L.$prevLeft;if(W.dockMinW){T=g((W.dockMinW<=T)?(T):(L.$prevLeft=T-W.dockMinW,W.dockMinW))}if(W.dockMaxW){T=g((W.dockMaxW<=T)?(L.$prevLeft=T-W.dockMaxW,W.dockMaxW):(T))}ae=T-Q.left-Q.right;if((L.preX+T-L.oX)>L.ww){L.top+=L.topHolder;L.topHolder=0;L.preX=L.oX}ae-=S;O=L.preX;R=L.top+Q.top;if(parseFloat(ao.left)!=O){aq.left=O}if(parseFloat(ao.top)!=R){aq.top=R}if(parseFloat(ao.width)!=ae){aq.width=ae=g(ae)}if(!_.isEmpty(aq)){if(K){aj._setBBox(aq)}else{ab.cssRegion(aq,true)}}L.preX+=T;L.topHolder=Math.max(L.topHolder,(K?X.height:ab.offsetHeight())+Q.top+Q.bottom+V)}else{if(L.topHolder){L.top+=L.topHolder;L.topHolder=0;L.preX=L.oX}O=aa?((ag?0:L.left)+Q.left):parseFloat(W.left);an=U?((ag?0:L.right)+Q.right):(L.width-parseFloat(W.width)-parseFloat(W.left));R=(ag?0:L.top)+Q.top;T=L.width-O-an-ai+(L.$prevLeft||0);delete L.$prevLeft;if(W.dockMinW){T=g((W.dockMinW<=T)?(T):(L.$prevLeft=T-W.dockMinW,W.dockMinW))}if(W.dockMaxW){T=g((W.dockMaxW<=T)?(L.$prevLeft=T-W.dockMaxW,W.dockMaxW):(T))}if(parseFloat(ao.left)!=O){aq.left=O}if(parseFloat(ao.top)!=R){aq.top=R}if(parseFloat(ao.width)!=T){aq.width=g(T)}if(!_.isEmpty(aq)){if(K){aj._setBBox(aq)}else{ab.cssRegion(aq,true)}}if(!ag){L.top+=(K?X.height:ab.offsetHeight())+Q.top+Q.bottom+V}}}break;case"bottom":if(!ad){if(M){T=(Y?parseInt(L.ww*Y,10):g(K?X.width:parseFloat(W.width)))+(L.$prevLeft||0);delete L.$prevLeft;if(W.dockMinW){T=g((W.dockMinW<=T)?(T):(L.$prevLeft=T-W.dockMinW,W.dockMinW))}if(W.dockMaxW){T=g((W.dockMaxW<=T)?(L.$prevLeft=T-W.dockMaxW,W.dockMaxW):(T))}ae=T-Q.left-Q.right;if((L.preX+T-L.oX)>L.ww){L.bottom+=L.bottomHolder;L.bottomHolder=0;L.preX=L.oX}ae-=S;O=L.preX;p=L.bottom+Q.bottom;if(parseFloat(ao.left)!=O){aq.left=O}if(parseFloat(ao.bottom)!=p){aq.bottom=p}if(parseFloat(ao.width)!=ae){aq.width=ae=g(ae)}if(!_.isEmpty(aq)){if(K){aj._setBBox(aq)}else{ab.cssRegion(aq,true)}}L.preX+=T;L.bottomHolder=Math.max(L.bottomHolder,(K?X.height:ab.offsetHeight())+Q.top+Q.bottom+V)}else{if(L.bottomHolder){L.bottom+=L.bottomHolder;L.bottomHolder=0;L.preX=L.oX}O=aa?((ag?0:L.left)+Q.left):parseFloat(W.left);an=U?((ag?0:L.right)+Q.right):(L.width-parseFloat(W.width)-parseFloat(W.left));p=(ag?0:L.bottom)+Q.bottom;T=L.width-O-an-ai+(L.$prevLeft||0);delete L.$prevLeft;if(W.dockMinW){T=g((W.dockMinW<=T)?(T):(L.$prevLeft=T-W.dockMinW,W.dockMinW))}if(W.dockMaxW){T=g((W.dockMaxW<=T)?(L.$prevLeft=T-W.dockMaxW,W.dockMaxW):(T))}if(parseFloat(ao.bottom)!=p){aq.bottom=p}if(parseFloat(ao.left)!=O){aq.left=O}if(parseFloat(ao.width)!=T){aq.width=g(T)}if(!_.isEmpty(aq)){if(K){aj._setBBox(aq)}else{ab.cssRegion(aq,true)}}if(!ag){L.bottom+=(K?X.height:ab.offsetHeight())+Q.top+Q.bottom+V}}}break;case"left":if(!ad){if(L.topHolder){L.top+=L.topHolder;L.topHolder=0;L.preY=L.top}if(L.bottomHolder){L.bottom+=L.bottomHolder;L.bottomHolder=0}L.hh=L.height-L.top-L.bottom+V;if(L.hh<=0){return}if(M){T=(Y?parseInt(L.hh*Y,10):g(K?X.height:parseFloat(W.height)))+(L.$prevLeft||0);delete L.$prevLeft;if(W.dockMinH){T=g((W.dockMinH<=T)?(T):(L.$prevLeft=T-W.dockMinH,W.dockMinH))}if(W.dockMaxH){T=g((W.dockMaxH<=T)?(L.$prevLeft=T-W.dockMaxH,W.dockMaxH):(T))}am=T-Q.top-Q.bottom;if((L.preY+T+L.bottom-V)>L.height){L.left+=L.leftHolder;L.leftHolder=0;L.preY=L.top}am-=V;R=L.preY;O=L.left+Q.left;if(parseFloat(ao.left)!=O){aq.left=O}if(parseFloat(ao.top)!=R){aq.top=R}if(parseFloat(ao.height)!=am){aq.height=am=g(am)}if(!_.isEmpty(aq)){if(K){aj._setBBox(aq)}else{ab.cssRegion(aq,true)}}L.preY+=T;L.leftHolder=Math.max(L.leftHolder,(K?X.width:ab.offsetWidth())+Q.left+Q.right+S)}else{if(L.leftHolder){L.left+=L.leftHolder;L.leftHolder=0;L.preY=L.top}O=(ag?0:L.left)+Q.left;R=aa?((ag?0:L.top)+Q.top):parseFloat(W.top);p=U?((ag?0:L.bottom)+Q.bottom):(L.height-parseFloat(W.height)-parseFloat(W.top));T=L.height-R-p-ah+(L.$prevLeft||0);delete L.$prevLeft;if(W.dockMinH){T=g((W.dockMinH<=T)?(T):(L.$prevLeft=T-W.dockMinH,W.dockMinH))}if(W.dockMaxH){T=g((W.dockMaxH<=T)?(L.$prevLeft=T-W.dockMaxH,W.dockMaxH):(T))}if(parseFloat(ao.left)!=O){aq.left=O}if(parseFloat(ao.top)!=R){aq.top=R}if(parseFloat(ao.height)!=T){aq.height=g(T)}if(!_.isEmpty(aq)){if(K){aj._setBBox(aq)}else{ab.cssRegion(aq,true)}}if(!ag){L.left+=(K?X.width:ab.offsetWidth())+Q.left+Q.right+S}}}break;case"right":if(!ad){if(L.topHolder){L.top+=L.topHolder;L.topHolder=0;L.preY=L.top}if(L.bottomHolder){L.bottom+=L.bottomHolder;L.bottomHolder=0}L.hh=L.height-L.top-L.bottom+V;if(L.hh<=0){return}if(M){T=(Y?parseInt(L.hh*Y,10):g(K?X.height:parseFloat(W.height)))+(L.$prevLeft||0);delete L.$prevLeft;if(W.dockMinH){T=g((W.dockMinH<=T)?(T):(L.$prevLeft=T-W.dockMinH,W.dockMinH))}if(W.dockMaxH){T=g((W.dockMaxH<=T)?(L.$prevLeft=T-W.dockMaxH,W.dockMaxH):(T))}am=T-Q.top-Q.bottom;if((L.preY+T+L.bottom-V)>L.height){L.right+=L.rightHolder;L.rightHolder=0;L.preY=L.top}am-=V;R=L.preY;an=L.right+Q.right;if(parseFloat(ao.right)!=an){aq.right=an}if(parseFloat(ao.top)!=R){aq.top=R}if(parseFloat(ao.height)!=am){aq.height=am=g(am)}if(!_.isEmpty(aq)){if(K){aj._setBBox(aq)}else{ab.cssRegion(aq,true)}}L.preY+=T;L.rightHolder=Math.max(L.rightHolder,(K?X.width:ab.offsetWidth())+Q.left+Q.right+S)}else{if(L.rightHolder){L.right+=L.rightHolder;L.rightHolder=0;L.preY=L.top}an=(ag?0:L.right)+Q.right;R=aa?((ag?0:L.top)+Q.top):(parseFloat(W.top));p=U?((ag?0:L.bottom)+Q.bottom):(L.height-parseFloat(W.height)-parseFloat(W.top));T=L.height-R-p-ah+(L.$prevLeft||0);delete L.$prevLeft;if(W.dockMinH){T=g((W.dockMinH<=T)?(T):(L.$prevLeft=T-W.dockMinH,W.dockMinH))}if(W.dockMaxH){T=g((W.dockMaxH<=T)?(L.$prevLeft=T-W.dockMaxH,W.dockMaxH):(T))}if(parseFloat(ao.right)!=an){aq.right=an}if(parseFloat(ao.top)!=R){aq.top=R}if(parseFloat(ao.height)!=T){aq.height=g(T)}if(!_.isEmpty(aq)){if(K){aj._setBBox(aq)}else{ab.cssRegion(aq,true)}}if(!ag){L.right+=(K?X.width:ab.offsetWidth())+Q.left+Q.right+S}}}break;case"width":if(!ak){return}if(L.leftHolder){L.left+=L.leftHolder;L.leftHolder=0}if(L.rightHolder){L.right+=L.rightHolder;L.rightHolder=0}O=aa?((f?0:(ag?0:L.left))+Q.left):parseFloat(W.left);an=U?((f?0:(ag?0:L.right))+Q.right):(L.width-parseFloat(W.width)-parseFloat(W.left));R=W.dock=="width"?(parseInt(W.top,10)||0):(aa?((f?0:(ag?0:L.top))+Q.top):parseFloat(W.top));T=L.width-O-an-ai;if(W.dockMinW){T=g((W.dockMinW<=T)?(delete P.$dockMinW,T):(P.$dockMinW=1,W.dockMinW))}if(W.dockMaxW){T=g((W.dockMaxW<=T)?(P.$dockMaxW=1,W.dockMaxW):(delete P.$dockMaxW,T))}L.later=L.later||{};L.later[P.$xid]=L.later[P.$xid]||{};_.merge(L.later[P.$xid],{isSVG:K,ins:aj,node:ab,width:T,left:O,top:R},"all");break;case"height":if(!ap){return}if(L.topHolder){L.top+=L.topHolder;L.topHolder=0;L.preX=L.oX}if(L.bottomHolder){L.bottom+=L.bottomHolder;L.bottomHolder=0;L.preX=L.oX}R=aa?((f?0:(ag?0:L.top))+Q.top):parseFloat(W.top);p=U?((f?0:(ag?0:L.bottom))+Q.bottom):(L.height-parseFloat(W.height)-parseFloat(W.top));O=W.dock=="height"?(parseInt(W.left,10)||0):(aa?((f?0:(ag?0:L.left))+Q.left):parseFloat(W.left));T=L.height-R-p-ah;if(W.dockMinH){T=g((W.dockMinH<=T)?(delete P.$dockMinH,T):(P.$dockMinH=1,W.dockMinH))}if(W.dockMaxH){T=g((W.dockMaxH<=T)?(P.$dockMaxH=1,W.dockMaxH):(delete P.$dockMaxH,T))}L.later=L.later||{};L.later[P.$xid]=L.later[P.$xid]||{};_.merge(L.later[P.$xid],{isSVG:K,ins:aj,node:ab,height:T,left:O,top:R},"all");break}};A.onSize(I,"dock")}if(D=="fill"||D=="cover"){k.link(I.height,"$dock1",null,C);k.link(I.width,"$dock2",null,B);_.arr.stableSort(I.height,H);_.arr.stableSort(I.width,H)}else{if(D=="origin"){k.link(I.center,"$dock1",null,C);k.link(I.middle,"$dock2",null,B)}else{k.link(I[D],"$dock",null,E);_.arr.stableSort(I[D],H)}}k.link(I.dockall,"$dockall",null,G);xui.$cache._resizeTime=1;k.$dockFun=I}u(A,n);if(D!="none"){(k.$beforeDestroy=(k.$beforeDestroy||{}))["releaseDock"]=function(){k.unLink("$dockall");k.unLink("$dock");k.unLink("$dock1");k.unLink("$dock2");u(A,n);if(A&&A.get(0)&&(A=xui.UIProfile.getFromDom(A.id()))){_.tryF(A.clearCache,[],A)}k=fun=A=null}}else{if(k.$beforeDestroy){delete k.$beforeDestroy.releaseDock}}}if(y){A.onSize()}},_beforeSerialized:function(f){var c,e,g,l={};_.merge(l,f,"all");var k=l.properties=_.clone(f.properties,true),h=l.box.$DataStruct;switch(k.dock){case"top":case"bottom":delete delete k.top;delete k.bottom;delete k.right;break;case"left":case"right":delete k.left;delete k.right;delete k.bottom;break}for(var d in xui.UI.$ps){if((d in k)&&typeof k[d]!="number"&&k[d]!=""&&k[d]!="auto"){k[d]=isNaN(k[d]=parseFloat(k[d]))?"auto":k[d]}}if(k.items&&k.items.length){e=xui.absObj.$specialChars;k.items=_.clone(k.items,function(p,m,n){return !e[((n===1?p.id:m)+"").charAt(0)]&&p!=undefined})}if(k.tagCmds&&k.tagCmds.length){e=xui.absObj.$specialChars;k.tagCmds=_.clone(k.tagCmds,function(p,m,n){return !e[((n===1?p.id:m)+"").charAt(0)]&&p!=undefined})}for(var d in f.box._objectProp){if((d in k)&&k[d]&&(_.isHash(k[d])||_.isArr(k[d]))&&_.isEmpty(k[d])){delete k[d]}}_.arr.each(["dockMargin","conDockPadding","conDockSpacing","propBinder","tagVar","animConf"],function(n){if(e=k[n]){g=h[n];for(var m in e){if(g[m]!==e[m]){return}}delete k[n]}});if(_.isEmpty(k.resizerProp)){delete k.resizerProp}if(k.items&&(k.items.length==0||k.listKey)){delete k.items}if(k.tagCmds&&(k.tagCmds.length==0||k.listKey)){delete k.tagCmds}return l},getDropKeys:function(c,d){return c.properties.dropKeys},getDragKey:function(c,d){return c.properties.dragKey},getDragData:function(c,e,d){return{profile:c,domId:xui.use(d).id(),data:c.onGetDragData?c.boxing().onGetDragData(c,e,d):null}},_prepareData:function(e,h){var c=e.properties,l=this.$DataModel,m=arguments.callee,d=m.map||(m.map=_.toArr("left,top,bottom,right,width,height")),n=[],k=e.box,p=e.box.adjustData,q;h=h||{};if(c.id){delete c.id}if("required" in l){c._required=c.required?"xui-required":""}if("nodeName" in l&&!c.nodeName){c.nodeName="xui"}if("caption" in l&&c.caption!==null){c.caption=c.caption===undefined?e.alias:c.caption}if("html" in l&&c.html){h.html=xui.adjustRes(c.html,0,1)}if("src" in l&&c.src){h.src=xui.adjustRes(c.src,0,1)}if("$hborder" in l){h.bWidth=parseFloat(c.width)-(c.$hborder||0)*2}if("$vborder" in l){h.bHeight=parseFloat(c.height)-(c.$vborder||0)*2}for(var f=0,g;g=d[f];f++){var q=(g in h)?h[g]:c[g];if(q||q===0){if(String(parseFloat(q))==String(q)){n[n.length]=g+":"+(parseInt(q,10)||0)+"px"}else{if(q!="auto"&&q){n[n.length]=g+":"+q}}}}if(c.position){n[n.length]="position:"+c.position}if(c.visibility){n[n.length]="visibility:"+c.visibility}if("zIndex" in c){n[n.length]="z-index:"+c.zIndex}if(c.display){n[n.length]="display:"+(c.display=="inline-block"?xui.browser.gek?"-moz-inline-block;display:-moz-inline-box;display:inline-block;":"inline-block":c.display)}h._style=n.join(";");if(k.$Behaviors.PanelKeys&&!k["xui.absList"]){n=[];if(c.panelBgClr){n[n.length]="background-color:"+c.panelBgClr}if(c.panelBgImg){n[n.length]="background-image:url("+xui.adjustRes(c.panelBgImg)+")"}if(c.panelBgImgPos){n[n.length]="background-position:"+c.panelBgImgPos}if(c.panelBgImgRepeat){n[n.length]="background-repeat:"+c.panelBgImgRepeat}if(c.panelBgImgAttachment){n[n.length]="background-attachment:"+c.panelBgImgAttachment}h._panelstyle=n.join(";")}if("className" in l){h._className=c.className||""}if("readonly" in l){h.readonly=c.readonly?"xui-ui-readonly":""}if("href" in l){h.href=c.href||xui.$DEFAULTHREF}if("tabindex" in l){h.tabindex=c.tabindex||"-1"}if("items" in l){e.ItemIdMapSubSerialId={};e.SubSerialIdMapItem={};c.items=e.box._adjustItems(c.items);h.items=this._prepareItems(e,c.items)}if("selectable" in l){h._selectable=(xui.browser.ie&&xui.browser.ver<10)?"":(c.selectable?"xui-ui-selectable":"xui-ui-unselectable")}h=p(e,c,h);e.prepared=true;return h},_prepareItems:function(f,q,p,h,m){var x=[],w,c,u,e=xui.UI.$tag_subId,d,k=f.properties.tabindex,r=f.box.adjustData;for(var n=0,g=q.length;n<g;n++){if(typeof q[n]!="object"){q[n]={id:q[n]}}w=q[n];if(f.beforePrepareItem&&false===f.boxing().beforePrepareItem(f,w,p,h,m)){continue}if(!w.hasOwnProperty("caption")){w.caption=w.id}c={id:w.id};if(p){c._pid=p}d=c[e]=typeof m=="string"?m:f.pickSubId("items");if(false!==h){f.ItemIdMapSubSerialId[w.id]=d;f.SubSerialIdMapItem[d]=w}if(u=w.object){u=c.object=u["xui.absBox"]?u.get(0):u;if(u["xui.UIProfile"]){u.properties.position="relative"}w.$xid=u.$xid;u.$item=w;u.$holder=f;if(!u.host||u.host===u){u.boxing().setHost(f.host,u.alias)}if(!f.$attached){f.$attached=[]}f.$attached.push(u)}else{c._tabindex=k;r(f,w,c);if(this._prepareItem){this._prepareItem(f,c,w,p,n,g,h,m)}}x.push(c)}return x},_showTips:function(c,d,e){if(c.properties.disableTips){return}if(c.onShowTips){return c.boxing().onShowTips(c,d,e)}}}});Class("xui.absList","xui.absObj",{Instance:{activate:function(){var d=this.get(0),c=d.getSubNode("ITEM",true);if(!c.isEmpty()){c.focus()}return this},insertItems:function(h,d,p){var e,l,m,k,c,f,g,n=this._afterInsertItems;return this.each(function(u){g=u.box;l=g._adjustItems(h);m=u.properties.items;k=_.arr.subIndexOf(m,"id",d);if(u.renderId){f=g._prepareItems(u,l,d);c=u._buildItems("items",f);if(u.$attached){for(var r=0,q;q=u.$attached[r++];){if(q._render){q._render(true)}}delete u.$attached}if(k==-1){e=u.getSubNode(g._ITEMSKEY||u.keys.ITEMS||u.keys.KEY);if(p){e.prepend(c)}else{e.append(c)}}else{e=u.getSubNodeByItemId(g._ITEMKEY||"ITEM",d);if(p){e.addPrev(c)}else{e.addNext(c)}}}if(k==-1){_.arr.insertAny(m,l,p?0:-1)}else{_.arr.insertAny(m,l,p?k:k+1)}if(n){u.boxing()._afterInsertItems(u,f,d,p)}})},removeItems:function(d,f){var g,e,c=this._afterRemoveItems;remove=function(m,h,q,p,l,n){var k=arguments.callee;if(!l){l=xui()}_.filter(h,function(x){var w,r;if(n||(r=(_.arr.indexOf(q,x.id)!=-1))){if(m.renderId){if(w=m.ItemIdMapSubSerialId[x.id]){p.push(_.copy(m.SubSerialIdMapItem[w]));delete m.SubSerialIdMapItem[w];delete m.ItemIdMapSubSerialId[x.id];m.reclaimSubId(w,"items");if(!n){if(!(g=m.getSubNode(m.keys[f]?f:(m.box._ITEMKEY||"ITEM"),w)).isEmpty()){l.merge(g)}if(x.$xid){l.get().push(xui.getObject(x.$xid).getRootNode())}}}}}if(x.sub){k(m,x.sub,q,p,l,n||r)}if(r){for(var u in x){x[u]=null}return false}});l.remove()};return this.each(function(h){var l=h.properties,k=[];d=_.isHash(d)?[d.id+""]:_.isArr(d)?d:(d+"").split(l.valueSeparator);_.arr.each(d,function(n,m){d[m]=""+(_.isHash(n)?n.id:n)});remove(h,l.items,d,k);if(e=l.$UIvalue){if((e=(""+e).split(l.valueSeparator)).length>1){_.filter(e,function(m){return _.arr.indexOf(d,m)==-1});l.$UIvalue=e.join(l.valueSeparator)}else{if(_.arr.indexOf(d,l.$UIvalue)!=-1){l.$UIvalue=null}}}if(c&&h.renderId){h.boxing()._afterRemoveItems(h,k)}})},clearItems:function(){return this.each(function(c){if(c.SubSerialIdMapItem){if(c.renderId){c.getSubNode(c.keys[c.box._ITEMKEY||"ITEM"],true).remove()}_.each(c.SubSerialIdMapItem,function(e,d){c.reclaimSubId(d,"items")});c.SubSerialIdMapItem={};c.ItemIdMapSubSerialId={}}c.properties.items.length=0;c.properties.$UIvalue=null})},updateItem:function(n,g){n=_.isHash(n)?n.id:(n+"");var r=this,f=r.get(0),k=f.box,u=f.properties.items,y=f.queryItems(u,function(B){return typeof B=="object"?B.id===n:B==n},true,true,true),l,z,w,d,x,p,q;if(!_.isHash(g)){g={caption:g+""}}if(y&&y.length){y=y[0];if(typeof y[0]!="object"){z=y[2][y[1]]={id:y[0]}}else{z=y[0]}if(_.isSet(g.id)){g.id+=""}if(g.id&&n!==g.id){l=g.id;var c=f.ItemIdMapSubSerialId,m;if(!c[l]){if(m=c[n]){c[l]=m;delete c[n];f.SubSerialIdMapItem[m].id=l}else{z.id=l}}}delete g.id;if(_.isEmpty(g)){return r}x=f.getSubNodeByItemId("ITEM",l||n);if(!x.isEmpty()){if("sub" in g){delete z._created;delete z._checked;delete z._inited;if(z.sub){var h=[];_.arr.each(z.sub,function(B){h.push(B.id)});r.removeItems(h)}}else{if(z.sub){p=f.getSubNodeByItemId("SUB",l||n)}}_.merge(z,g,"all");w=_.get(f,["ItemIdMapSubSerialId",l||n]);d=k._prepareItems(f,[z],z._pid,false,w);x.replace(f._buildItems(arguments[2]||"items",d),false);if(p&&!p.isEmpty()){if(!(q=f.getSubNodeByItemId("SUB",l||n)).isEmpty()){q.replace(p)}}if(typeof r.setUIValue=="function"){var A=f.properties.$UIvalue||"",d=(""+A).split(f.properties.valueSeparator);if(d.length&&_.arr.indexOf(d,n)!=-1){if(l){_.arr.removeValue(d,n);d.push(z.id);r.setUIValue(d.join(f.properties.valueSeparator),true,null,"update")}else{r._setCtrlValue(A)}}}}else{_.merge(z,g,"all")}if(k.$Behaviors.PanelKeys){var e={};if(g.hasOwnProperty("panelBgClr")){e["background-color"]=g.panelBgClr}if(g.hasOwnProperty("panelBgImg")){e["background-image"]=g.panelBgImg?("url("+xui.adjustRes(g.panelBgImg)+")"):""}if(g.hasOwnProperty("panelBgImgPos")){e["position-color"]=g.panelBgImgPos}if(g.hasOwnProperty("panelBgImgRepeat")){e["background-repeat"]=g.panelBgImgRepeat}if(g.hasOwnProperty("panelBgImgAttachment")){e["background-attachment"]=g.panelBgImgAttachment}if(g.hasOwnProperty("overflow")){var m=g.overflow;if(m){if(m.indexOf(":")!=-1){_.arr.each(m.split(/\s*;\s*/g),function(C){var B=C.split(/\s*:\s*/g);if(B.length>1){e[_.str.trim(B[0])]=_.str.trim(B[1]||"")}})}}e.overflow=m||""}if(!_.isEmpty(e)){_.arr.each(k.$Behaviors.PanelKeys,function(B){panel=f.getSubNode(B,l||n).css(e)})}}}return r},hideItems:function(c){return this.each(function(d){_.arr.each(_.isHash(c)?c.id:_.isArr(c)?c:(c+"").split(d.properties.valueSeparator),function(e){if(!(e=d.getSubNodeByItemId("ITEM",e)).isEmpty()){e.css("display","none")}})})},showItems:function(c){return this.each(function(d){_.arr.each(_.isHash(c)?c.id:_.isArr(c)?c:(c+"").split(d.properties.valueSeparator),function(e){if(!(e=d.getSubNodeByItemId("ITEM",e)).isEmpty()){e.css("display","")}})})},getItems:function(f,e){e=e||this.get(0).properties.items;if(f=="data"){return _.clone(e,true)}else{if(f=="min"){var d=_.clone(e,true),c;_.arr.each(d,function(h,g){d[g]=h.id});return d}else{return e}}},selectItem:function(c){return this.fireItemClickEvent(_.isHash(c)?c.id:(c+""))},fireItemClickEvent:function(c){c=_.isHash(c)?c.id:(c+"");this.getSubNodeByItemId(this.constructor._focusNodeKey,c).onClick();return this},editItem:function(k){k=_.isHash(k)?subId.id:(k+"");var e=this.get(0),p,c;if(e&&e.renderId&&!e.destroyed){if(p=e.getItemByItemId(k)){c=e.getSubNodeByItemId("ITEMCAPTION",k);if(c.isEmpty()){c=e.getSubNodeByItemId("CAPTION",k)}if(!c.isEmpty()){var d=c.parent(),h=c.offset(null,d.get(0)),q=c.cssSize(),l=d.offset(),n=d.cssSize();var f;if(e.beforeIniEditor){f=e.boxing().beforeIniEditor(e,p,c);if(f===false){return}}if(!f||!f["xui.UI"]){var f=new xui.UI.ComboInput({type:"input"});f.setWidth(Math.max(n.width-h.left,40)).setHeight(Math.max(n.height,20)).setResizer(true).setValue(p.caption||"");if(e.onBeginEdit){e.boxing().onBeginEdit(e,p,f)}var m=function(){_.resetRun("absList_editor_reset",function(){if(f&&!f.isDestroyed()){f.getRoot().setBlurTrigger("absList_editor_blur",null);f.destroy();f=null}})};f.beforeUIValueSet(function(y,w,u,x,r){if(false!==(e.beforeEditApply&&e.boxing().beforeEditApply(e,p,u,f,r))){e.boxing().updateItem(p.id,{caption:u});if(e.onEndEdit){e.boxing().onEndEdit(e,p,f)}m()}}).onCancel(function(){m()});xui("body").append(f);var g=f.getRoot();g.popToTop({left:h.left+l.left,top:l.top});g.setBlurTrigger("absList_editor_blur",function(){m()});f.activate()}}}}return this},getSelectedItem:function(){var f=this.getUIValue(true),e=this.get(0),c=[],d;if(_.isArr(f)){if(f.length){_.arr.each(f,function(g){if(d=e.getItemByItemId(g)){c.push(d)}});return c}}else{if(f){return e.getItemByItemId(f)}}}},Initialize:function(){var c=this.prototype;_.arr.each(_.toArr("getItemByItemId,getItemByDom,getSubIdByItemId,getSubNodeByItemId"),function(d){c[d]=function(){var e=this.get(0);return e[d].apply(e,arguments)};Class._fun(c[d],d,c.KEY,null,"instance")})},Static:{_focusNodeKey:"ITEM",$abstract:true,_ensureValues:xui.UI._ensureValues,DataModel:{listKey:{set:function(d){var e=this,c=e.box.getCachedData(d);if(c){e.boxing().setItems(_.clone(c))}else{e.boxing().setItems(e.properties.items)}e.properties.listKey=d}},items:{ini:[],set:function(p){var c=this,l=c.boxing(),m=c.properties.items,d,e,n;if(typeof l.setValue=="function"){n=c.properties.value;if(n&&p&&p.length){var g=_.arr.indexOf(p,n);if(g===-1){g=_.arr.subIndexOf(p,"id",c.properties.value)}if(g===-1){n=p?p[0]?p[0].id?p[0].id:p[0]:"":""}}}if(m&&m.length){if(c.children&&c.children.length){d=[];_.arr.each(c.children,function(r){d.push(e=[r[0].serialize(false,true),null,null]);if(e[1]=r[1]){var u=_.arr.indexOf(m,r[1]);if(u===-1){u=_.arr.subIndexOf(m,"id",r[1])}if(u!==-1){e[2]=u}}});l.removeChildren(true,true)}l.clearItems()}l.insertItems(p?_.copy(p):null);if(p&&p.length&&d){var f={},h={},k=p.length;_.arr.each(p,function(u,r){f[u.id||u]=r;h[r]=u.id||u});_.arr.each(d,function(r){var w,u;if(_.isSet(r[1])){if(f[r[1]]){u=xui.create(r[0]);l.append(u,r[1]);if(c.$panelRestore){c.$panelRestore(u.get(0))}w=1}else{if(h[r[2]]){u=xui.create(r[0]);l.append(u,h[r[2]]);if(c.$panelRestore){c.$panelRestore(u.get(0))}w=1}}}if(!w){u=xui.create(r[0]);l.append(u,n);if(c.$panelRestore){c.$panelRestore(u.get(0))}}})}if(_.isSet(n)){l.setValue(n,true,"items")}if(c.renderId){var q=c.getRootNode().style;xui.UI.$tryResize(c,q.width,q.height,true);q=null}}},valueSeparator:";"},RenderTrigger:function(){this.destroyTrigger=function(){_.each(this.SubSerialIdMapItem,function(c){_.breakO(c)});this.properties.items.length=0}},EventHandlers:{beforePrepareItem:function(d,e,c){},beforeIniEditor:function(c,d,e){},onBeginEdit:function(d,e,c){},beforeEditApply:function(f,g,d,e,c){},onEndEdit:function(d,e,c){}},getDropKeys:function(c,e){var d=c.getItemByDom(e);return(d&&d.dropKeys)||c.properties.dropKeys},getDragKey:function(c,e){var d=c.getItemByDom(e);return(d&&d.dragKey)||c.properties.dragKey},_adjustItems:function(d){if(!_.isSet(d)){d=[]}if(!_.isArr(d)){d=[d]}var e=_.copy(d),c;_.arr.each(e,function(g,f){if(!_.isHash(g)){e[f]={id:g+""}}else{e[f]=_.copy(g);e[f].id=_.isSet(e[f].id)?(e[f].id+""):_.id()}});return e},_showTips:function(e,g,l){if(e.properties.disableTips){return}if(e.onShowTips){return e.boxing().onShowTips(e,g,l)}if(!xui.Tips){return}var d=e.properties,k=g.id,c=e.getSubId(k),h=e.SubSerialIdMapItem,f=h&&h[c];if(f&&("tips" in f)){if(f.tips){xui.Tips.show(l,f)}else{xui.Tips.hide()}return false}else{if(e.properties.autoTips&&f&&"caption" in f){if(f.caption){xui.Tips.show(l,{tips:f.caption})}else{xui.Tips.hide()}return false}else{return true}}}}});Class("xui.absValue","xui.absObj",{Instance:{_getCtrlValue:function(){return this.get(0).properties.$UIvalue},_setCtrlValue:function(c){return this},_setDirtyMark:function(c){return this.each(function(g){if(!g.renderId){return}var f=g.properties,e=f.value!==f.$UIvalue,k=g.getSubNode(c||"KEY"),h=xui.UI.$css_tag_dirty;if(g._dirtyFlag!==e){if(f.dirtyMark&&f.showDirtyMark){if(g.beforeDirtyMark&&false===g.boxing().beforeDirtyMark(g,e)){}else{if(e){k.addClass(h)}else{k.removeClass(h)}}}g._dirtyFlag=e}})},getValue:function(e){var d=this.get(0),f=d.properties,c=f.value;if(d.box.$valuemode=="multi"){if(e){if(_.isStr(c)){c=c.split(f.valueSeparator)}}}if(d.box.$DataModel.selMode&&(f.selMode=="multi"||f.selMode=="multibycheckbox")&&e){if(_.isStr(c)){c=c.split(f.valueSeparator)}if(c&&_.isArr(c)&&c.length>1){c.sort()}}return c},getUIValue:function(f){var e=this.get(0),g=e.properties;if(!e.renderId){return g&&g.value}var d=this._getCtrlValue(),c;if(!e.box._checkValid||false!==e.box._checkValid(e,d)){g.$UIvalue=d}c=g.$UIvalue;if(e.box.$valuemode=="multi"){if(f){if(_.isStr(c)){c=c.split(g.valueSeparator)}}}if(e.box.$DataModel.selMode&&(g.selMode=="multi"||g.selMode=="multibycheckbox")&&f){if(_.isStr(c)){c=c.split(g.valueSeparator)}if(c&&_.isArr(c)&&c.length>1){c.sort()}}return c},resetValue:function(d){var c=this;c.each(function(e){var f,g=e.properties;if(typeof(f=e.box._ensureValue)=="function"){d=f.call(e.box,e,d)}if(g.value!==d||g.$UIvalue!==d){if(e.box._beforeResetValue){e.box._beforeResetValue(e)}if(typeof(f=e.$onValueSet)=="function"){f=f.call(e,g.value,d);if(_.isSet(f)){d=f}}e.boxing()._setCtrlValue(g.value=d);g.$UIvalue=d}e._inValid=1});c._setDirtyMark();return c},setUIValue:function(g,f,e,c){var d=this;this.each(function(k){var p=k.properties,m,n=p.$UIvalue,l=k.boxing();if(f||(n!==g)){if((k.box._checkValid&&false===k.box._checkValid(k,g))||(k.beforeUIValueSet&&false===(m=l.beforeUIValueSet(k,n,g,f,c)))){return}if(m!==undefined&&typeof m!=="boolean"){g=m}if(k.box&&(typeof(m=k.box._ensureValue)=="function")){g=m.call(k.box,k,g)}if(typeof(m=k.$onUIValueSet)=="function"){m=m.call(k,g,f,c);if(_.isSet(m)){g=m}}var h;if(k.renderId&&!e){h=1;l._setCtrlValue(g)}p.$UIvalue=g;if(k.renderId&&!e){l._setDirtyMark()}if(k.afterUIValueSet){l.afterUIValueSet(k,n,g,f,c)}if(k.onChange){l.onChange(k,n,g,f,c)}if(!p.dirtyMark){l.setValue(g,false,"uiv",h||e)}}});return this},updateValue:function(){return this.each(function(d){var e=d.properties;if(e.value!==e.$UIvalue){var c=d.boxing();if(c.checkValid()){c.setValue(c.getUIValue(),true,"update");c._setDirtyMark()}}})},isDirtied:function(){var c=false;this.each(function(d){var e=d.properties;c=(e.value+" ")!==(e.$UIvalue+" ");if(c){return false}});return c},checkValid:function(f){var g,e,d=true,c=_.isSet(f);this.each(function(h){g=h.properties;e=true;if(h.box._checkValid2){d=(e=h.box._checkValid2(h))&&d}if(e&&h.box._checkValid){d=h.box._checkValid(h,c?f:g.$UIvalue)&&d}if(!c&&h.renderId){h.boxing()._setDirtyMark()}});return d}},Static:{$abstract:true,DataModel:{readonly:{ini:false,action:function(c){var d=this.getRoot();if(c){d.addClass("xui-ui-readonly")}else{d.removeClass("xui-ui-readonly")}}},required:{ini:false,action:function(c){if(this.keys.LABEL){var d=this.getSubNode("LABEL");if(c){d.addClass("xui-required")}else{d.removeClass("xui-required")}}}},value:{ini:null,set:function(k,f,m,d){var g=this,e=g.properties,c,l=e.value,h=g.boxing();if(g.box._checkValid&&g.box._checkValid(g,k)===false){return}if(g.beforeValueSet&&false===(c=h.beforeValueSet(g,l,k,f,m))){return}if(c!==undefined){k=c}if(typeof(c=g.box._ensureValue)=="function"){k=c.call(g.box,g,k)}if(typeof(c=g.$onValueSet)=="function"){c=c.call(g,l,k,f,m);if(_.isSet(c)){k=c}}if(g.renderId&&!d){h._setCtrlValue(k)}e.value=e.$UIvalue=k;if(!g._inValid){g._inValid=1}if(g.renderId){h._setDirtyMark()}if(g.afterValueSet){h.afterValueSet(g,l,k,f,m)}if(g.onValueChange){h.onValueChange(g,l,k,f,m)}}},dirtyMark:true,showDirtyMark:true},_ensureValues:xui.UI._ensureValues,_ensureValue:function(c,d){if(c.box.$DataModel.selMode&&(c.properties.selMode=="multi"||c.properties.selMode=="multibycheckbox")){if(!_.isArr(d)){d=(d?(""+d):"").split(c.properties.valueSeparator)}d.sort();return d.join(c.properties.valueSeparator)}else{return _.isArr(d)?d[0]:d}},EventHandlers:{beforeValueSet:function(e,d,g,f,c){},afterValueSet:function(e,d,g,f,c){},onValueChange:function(e,d,g,f,c){},beforeUIValueSet:function(e,d,g,f,c){},afterUIValueSet:function(e,d,g,f,c){},onChange:function(e,d,g,f,c){},beforeDirtyMark:function(d,c){}},RenderTrigger:function(){var d=this,c=d.boxing(),f=d.properties,e;if(!d.behavior.PanelKeys){if(e=f.dataBinder){c.setDataBinder(e,true)}if(e=f.dataField){c.setDataField(e)}}if(f.value!==undefined){if(typeof(e=d.box._ensureValue)=="function"){f.value=e.call(d.box,d,f.value);if(f.$UIvalue){f.$UIvalue=e.call(d.box,d,f.$UIvalue)}}if(!f.$UIvalue){f.$UIvalue=f.value}c._setCtrlValue(f.$UIvalue,true)}}}});new function(){var c="xui.UI";Class(c+".Widget",c,{Static:{Appearances:{KEY:{"font-size":xui.browser.ie?0:null,"line-height":xui.browser.ie?0:null}},Templates:{className:"xui-uiw-shell {_className}",style:"{_style}",FRAME:{className:"xui-uiw-frame ",BORDER:{style:"width:{bWidth}px;height:{bHeight}px;",className:"xui-uiw-border"}}},Behaviors:{onSize:xui.UI.$onSize},DataModel:{width:100,height:100,$hborder:0,$vborder:0},RenderTrigger:function(){var d=this,e=d.properties,f=d.boxing();if(d.renderId){if((!d.$noB)&&e.border&&f._border){f._border()}}if((!d.$noR)&&e.resizer&&f.setResizer){f.setResizer(e.resizer,true)}if((!d.$noS)&&e.shadow&&f._shadow){f._shadow()}},_onresize:function(g,d,n){var p=g.properties,e=g.getSubNode("BORDER"),m,k=d,h=n,f=Math.max(0,(p.$b_lw||0)-(p.$hborder||0)),l=Math.max(0,(p.$b_tw||0)-(p.$vborder||0));if(k&&"auto"!==k){k-=Math.max((p.$hborder||0)*2,(p.$b_lw||0)+(p.$b_rw||0));if(xui.browser.ie6){k=(parseInt(k/2,10))*2}}if(h&&"auto"!==h){h-=Math.max((p.$vborder||0)*2,(p.$b_lw||0)+(p.$b_rw||0));if(xui.browser.ie6){h=(parseInt(h/2,10))*2}if(xui.browser.ie6&&null===d){e.ieRemedy()}}m={left:f,top:l,width:k,height:h};e.cssRegion(m);if((g.$border||g.$shadow||g.$resizer)&&xui.browser.ie){e.ieRemedy()}return m}}});Class(c+".Link",c,{Static:{Appearances:{KEY:{"font-size":xui.browser.ie?"12px":null,"line-height":xui.browser.ie?"14px":null,cursor:"pointer"}},Templates:{tagName:"a",className:"{_className}",style:"{_style}",href:"{href}",target:"{target}",tabindex:"{tabindex}",text:"{caption}"},Behaviors:{HoverEffected:{KEY:"KEY"},ClickEffected:{KEY:"KEY"},onClick:function(f,h,k){var g;if(!f.properties.disabled&&f.onClick){g=f.boxing().onClick(f,h,k)}var d=xui.use(k).attr("href");return typeof g=="boolean"?g:(d.indexOf("javascript:")===0||d.indexOf("#")===0)?false:true}},DataModel:{caption:{ini:undefined,action:function(d){d=(_.isSet(d)?d:"")+"";this.getRoot().html(xui.adjustRes(d,true))}},href:{ini:xui.$DEFAULTHREF,action:function(d){this.getRoot().attr("href",d)}},target:{action:function(d){this.getRoot().attr("target",d)}}},EventHandlers:{onClick:function(d,f){}}}});Class(c+".SLabel",c,{Static:{Templates:{className:"{_className}",style:"{_style};text-align:{hAlign}",text:"{caption}"},Appearances:{KEY:{"padding-right":"6px"}},DataModel:{selectable:true,caption:{ini:undefined,action:function(d){d=(_.isSet(d)?d:"")+"";this.getRoot().html(xui.adjustRes(d,true))}},hAlign:{ini:"right",listbox:["left","center","right"],action:function(d){this.getRoot().css("textAlign",d)}}},Behaviors:{HoverEffected:{KEY:"KEY"},onClick:function(d,g,h){var f=d.properties;if(f.disabled){return false}if(d.onClick){return d.boxing().onClick(d,g,h)}}},EventHandlers:{onClick:function(d,f,g){}}}});Class(c+".SButton",c,{Instance:{activate:function(){this.getSubNode("FOCUS").focus();return this}},Static:{Templates:{className:"xui-ui-unselectable {_clsName} {_className}",style:"{_style}",BTN:{className:"xui-ui-btn",BTNI:{className:"xui-ui-btni",BTNC:{className:"xui-ui-btnc",FOCUS:{tabindex:"{tabindex}",style:"{_align}",ICON:{$order:1,className:"xui-ui-icon {imageClass}",style:"{backgroundImage} {backgroundPosition} {backgroundRepeat} {imageDisplay}"},CAPTION:{$order:2,text:"{caption}"}}}}}},Appearances:{BTN:{overflow:"hidden"},"KEY-auto BTN, KEY-auto BTNI, KEY-auto BTNC, KEY-auto FOCUS":{$order:1,display:xui.$inlineBlock},"BTN,BTNI,BTNC":{display:"block"},"KEY FOCUS":{cursor:"pointer","font-size":"12px","text-align":"center",display:"block"},CAPTION:{"vertical-align":xui.browser.ie6?"baseline":"middle",display:"inline"}},Behaviors:{HoverEffected:{BTN:["BTN"]},ClickEffected:{BTN:["BTN"]},NavKeys:{FOCUS:1},onClick:function(d,g,h){var f=d.properties;if(f.disabled){return false}d.getSubNode("FOCUS").focus();if(d.onClick){return d.boxing().onClick(d,g,h)}},onKeydown:function(f,h,k){var g=xui.Event.getKey(h),d=g.key;if(d==" "||d=="enter"){f.getSubNode("BTN").afterMousedown();f.__fakeclick=1}},onKeyup:function(f,h,k){var g=xui.Event.getKey(h),d=g.key;if(d==" "||d=="enter"){f.getSubNode("BTN").afterMouseup();if(f.__fakeclick){xui.use(k).onClick()}}delete f.__fakeclick}},DataModel:{image:{format:"image",action:function(d){this.getSubNode("ICON").css("display",d?"":"none").css("backgroundImage",d?("url("+xui.adjustRes(d)+")"):"")}},imagePos:{action:function(d){this.getSubNode("ICON").css("backgroundPosition",d)}},caption:{ini:undefined,action:function(d){d=(_.isSet(d)?d:"")+"";this.getSubNode("CAPTION").html(xui.adjustRes(d,true))}},hAlign:{ini:"center",listbox:["left","center","right"],action:function(d){this.getSubNode("FOCUS").css("textAlign",d)}},width:{ini:"auto",action:function(d){if(d=="auto"){this.getRoot().width("auto").tagClass("-auto")}else{this.getRoot().width(d).tagClass("-auto",false)}}},height:{readonly:true}},EventHandlers:{onClick:function(d,f,g){}},_prepareData:function(d,e){e=arguments.callee.upper.call(this,d,e);e._align="text-align:"+e.hAlign+";";e._clsName=parseInt(e.width,10)?"":d.getClass("KEY","-auto");return e}}});Class(c+".SCheckBox",[c,"xui.absValue"],{Instance:{activate:function(){this.getSubNode("FOCUS").focus();return this},_setCtrlValue:function(d){return this.each(function(e){e.getSubNode("MARK").tagClass("-checked",!!d)})},_setDirtyMark:function(){return arguments.callee.upper.apply(this,["CAPTION"])}},Static:{Templates:{className:"{_clsName} {_className}",style:"{_style}",FOCUS:{tabindex:"{tabindex}",MARK:{$order:0,className:"xui-uicmd-check"},ICON:{$order:1,className:"xui-ui-icon {imageClass}",style:"{backgroundImage} {backgroundPosition} {backgroundRepeat} {imageDisplay}"},CAPTION:{$order:2,text:"{caption}"}}},Appearances:{KEY:{overflow:"visible"},FOCUS:{cursor:"default","vertical-align":"middle",padding:"2px 0","font-size":"12px","line-height":"22px"},CAPTION:{"vertical-align":xui.browser.ie6?"baseline":"middle"}},Behaviors:{HoverEffected:{KEY:"MARK"},ClickEffected:{KEY:"MARK"},NavKeys:{FOCUS:1},onClick:function(f,h,k){var g=f.properties,d=f.boxing();if(g.disabled){return false}if(g.readonly){return false}d.setUIValue(!g.$UIvalue,null,null,"click");if(f.onChecked){d.onChecked(f,h,g.$UIvalue)}f.getSubNode("FOCUS").focus()},FOCUS:{onKeydown:function(f,g,h){var d=xui.Event.getKey(g).key;if(d==" "||d=="enter"){f.getRoot().onClick(true);return false}}}},DataModel:{value:false,image:{format:"image",action:function(d){this.getSubNode("ICON").css("display",d?"":"none").css("backgroundImage",d?("url("+xui.adjustRes(d)+")"):"")}},imagePos:{action:function(d){this.getSubNode("ICON").css("backgroundPosition",d)}},caption:{ini:undefined,action:function(d){d=(_.isSet(d)?d:"")+"";this.getSubNode("CAPTION").html(xui.adjustRes(d,true))}}},EventHandlers:{onChecked:function(d,g,f){}},_ensureValue:function(d,e){return !!e}}});Class(c+".Element",c,{Static:{_objectProp:{attributes:1},Templates:{_NativeElement:true,tagName:"{nodeName}",className:"xui-wrapper {_className}",style:"{_style};",tabindex:"{tabindex}",text:"{html}"+xui.UI.$childTag},DataModel:{width:"100",height:"22",nodeName:{ini:"xui",action:function(d){this.boxing().refresh()}},selectable:true,html:{html:1,action:function(d){this.getRoot().html(xui.adjustRes(d,0,1))}},attributes:{ini:{},action:function(e,f){var d=this.getRoot();if(!_.isEmpty(f)){_.each(f,function(h,g){d.attr(g,null)})}if(!_.isEmpty(e)){_.each(e,function(h,g){d.attr(g,h)})}}},tabindex:-1},Appearances:{KEY:{"line-height":"auto"}},Behaviors:{HoverEffected:{KEY:"KEY"},onClick:function(d,g,h){var f=d.properties;if(f.disabled){return false}if(d.onClick){return d.boxing().onClick(d,g,h)}}},EventHandlers:{onClick:function(d,g,f){}},RenderTrigger:function(){var e=this.properties.attributes;if(!_.isEmpty(e)){var d=this.getRoot();_.each(e,function(g,f){d.attr(f,g)})}}}});Class(c+".HTMLButton",c+".Element",{Instance:{activate:function(){this.getRoot().focus();return this}},Static:{Templates:{_NativeElement:true,tagName:"button",className:"xui-wrapper {_className}",style:"{_style};",tabindex:"{tabindex}",text:"{html}"+xui.UI.$childTag},DataModel:{nodeName:null,tabindex:1,disabled:{ini:false,action:function(e){var f=this.getRoot(),d="xui-ui-disabled";if(e){this.getRoot().addClass(d)}else{this.getRoot().removeClass(d)}f.attr("disabled",e?"1":null)}}},Behaviors:{HoverEffected:{KEY:"KEY"}},Appearances:{KEY:{"line-height":"auto",cursor:"pointer"}}}});Class(c+".Span",c,{Static:{Templates:{className:"{_className}",style:"{_style};{_overflow};",tabindex:"{tabindex}",text:"{html}"+xui.UI.$childTag},DataModel:{width:"16",height:"16",selectable:true,html:{html:1,action:function(d){this.getRoot().html(xui.adjustRes(d,0,1))}},overflow:{ini:xui.browser.deviceType=="touchOnly"?"auto":undefined,combobox:["","visible","hidden","scroll","auto","overflow-x:auto;overflow-y:auto"],action:function(d){var e=this.getContainer();if(d){if(d.indexOf(":")!=-1){_.arr.each(d.split(/\s*;\s*/g),function(g){var f=g.split(/\s*:\s*/g);if(f.length>1){e.css(_.str.trim(f[0]),_.str.trim(f[1]||""))}});return}}e.css("overflow",d||"")}},tabindex:-1},Appearances:{KEY:{"line-height":"auto"}},Behaviors:{HoverEffected:{KEY:"KEY"},onClick:function(d,g,h){var f=d.properties;if(f.disabled){return false}if(d.onClick){return d.boxing().onClick(d,g,h)}}},EventHandlers:{onClick:function(d,g,f){}},_prepareData:function(d,e){e=arguments.callee.upper.call(this,d,e);if(_.isStr(e.overflow)){e._overflow=e.overflow.indexOf(":")!=-1?(e.overflow):(e.overflow?("overflow:"+e.overflow):"")}return e}}});Class(c+".CSSBox",c+".Span",{Instance:{adjustDock:null,draggable:null,busy:null,free:null},Static:{$initRootHidden:true,_objectProp:{normalStatus:1,hoverStatus:1,activeStatus:1,focusStatus:1},Templates:{style:"padding:6px;left:"+xui.Dom.HIDE_VALUE+";top:"+xui.Dom.HIDE_VALUE+";width:150px;height:60px;visibility:hidden;display:none;position:absolute;z-index:0;",className:"{_className}",text:"{_html}"},DataModel:{className:{ini:null,action:function(){this.box._refreshCSS(this)}},normalStatus:{ini:{},action:function(d){this.box._refreshCSS(this)}},hoverStatus:{ini:{},action:function(d){this.box._refreshCSS(this)}},activeStatus:{ini:{},action:function(d){this.box._refreshCSS(this)}},focusStatus:{ini:{},action:function(d){this.box._refreshCSS(this)}},showEffects:null,hideEffects:null,position:null,display:null,visibility:null,zIndex:null,left:null,top:null,width:null,height:null,right:null,bottom:null,rotate:null,activeAnim:null,hoverPop:null,hoverPopType:null,dock:null,dockStretch:null,renderer:null,display:null,html:null,selectable:null,overflow:null,tabindex:null,autoTips:null,disableClickEffect:null,disableHoverEffect:null,disableTips:null,disabled:null,defaultFocus:null,dockStretch:null,dockIgnore:null,dockOrder:null,dockMargin:null,dockFloat:null,dockMinW:null,dockMinH:null,dockMaxW:null,dockMaxH:null,tips:null},$adjustProp:function(g,h){var d=(!h&&g.properties.className)||("xui-css-"+g.$xid),e,f=1,k={};g.box.getAll().each(function(l){if(l!==g){k[l.properties.className]=1}});while(k[d]){d=d+(f++)}g.properties.className=d},RenderTrigger:function(){var d=this;if(!d.$inDesign){xui("body").prepend(d.getRoot())}},_prepareData:function(d,e){e=arguments.callee.upper.call(this,d,e);e._html="Text<style type='text/css'>"+this._getCon(d)+"</style>";return e},_getCon:function(h){var m=h.properties,e="",d=m.className,l=m.normalStatus,k=m.hoverStatus,g=m.activeStatus,f=m.focusStatus;if(l&&!_.isEmpty(l)){e+="."+d+"{"+xui.Dom.$adjustCss(l,true)+"}\n"}if(k&&!_.isEmpty(k)){e+="."+d+":hover{"+xui.Dom.$adjustCss(k,true)+"}\n"}if(g&&!_.isEmpty(g)){e+="."+d+":active{"+xui.Dom.$adjustCss(g,true)+"}"}if(f&&!_.isEmpty(f)){e+="."+d+":focus{"+xui.Dom.$adjustCss(f,true)+"}"}return e},_refreshCSS:function(e){var d=this;_.resetRun(e.key+":"+e.$xid,function(){if(e.destroyed){return}var h=e.properties,f=e.getRootNode(),g=d._getCon(e);xui.Dom._setClass(f,h.className);if(g){xui.CSS._appendSS(f,g)}})},EventHandlers:{onContextmenu:null,onClick:null,onDock:null,onLayout:null,onMove:null,onRender:null,onResize:null,onShowTips:null,beforeHoverEffect:null,beforeAppend:null,afterAppend:null,beforeRender:null,afterRender:null,beforeRemove:null,afterRemove:null,onHotKeydown:null,onHotKeypress:null,onHotKeyup:null}}});Class(c+".Div",c,{Static:{Appearances:{KEY:{outline:xui.browser.gek?"none":null,zoom:(xui.browser.ie&&xui.browser.ver<9)?"1":null,"line-height":"normal",background:xui.browser.ie?"url("+xui.ini.img_bg+") no-repeat left top":null}},Templates:{tagName:"div",className:"xui-nooutline {_className}",style:"{_style};{_panelstyle};{_overflow};",tabindex:"{tabindex}",text:"{html}"+xui.UI.$childTag},DataModel:{iframeAutoLoad:{ini:"",action:function(){this.box._applyAutoLoad(this)}},ajaxAutoLoad:{ini:"",action:function(){this.box._applyAutoLoad(this)}},width:"100",height:"100",selectable:true,html:{html:1,action:function(d){this.getRoot().html(xui.adjustRes(d,0,1))}},overflow:{ini:xui.browser.deviceType=="touchOnly"?"auto":undefined,combobox:["","visible","hidden","scroll","auto","overflow-x:auto;overflow-y:auto"],action:function(d){var e=this.getContainer();if(d){if(d.indexOf(":")!=-1){_.arr.each(d.split(/\s*;\s*/g),function(g){var f=g.split(/\s*:\s*/g);if(f.length>1){e.css(_.str.trim(f[0]),_.str.trim(f[1]||""))}});return}}e.css("overflow",d||"")}},tabindex:-1},RenderTrigger:function(){var d=this;if(d.box.KEY=="xui.UI.Div"){if(d.properties.iframeAutoLoad||d.properties.ajaxAutoLoad){d.box._applyAutoLoad(this)}}},Behaviors:{HoverEffected:{KEY:"KEY"},onClick:function(d,g,h){var f=d.properties;if(f.disabled){return false}if(d.onClick){return d.boxing().onClick(d,g,h)}}},EventHandlers:{onClick:function(d,g,f){}},_prepareData:function(d,e){e=arguments.callee.upper.call(this,d,e);if(_.isStr(e.overflow)){e._overflow=e.overflow.indexOf(":")!=-1?(e.overflow):(e.overflow?("overflow:"+e.overflow):"")}return e},_applyAutoLoad:function(h){var d=h.properties,m=h.boxing();if(d.iframeAutoLoad){m.getContainer().css("overflow","hidden");var p=typeof d.iframeAutoLoad=="string"?{url:d.iframeAutoLoad}:_.clone(d.iframeAutoLoad,true),f="biframe_"+_(),n=xui.browser.ie&&xui.browser.ver<9,k=document.createElement(n?"<iframe name='"+f+"'>":"iframe");p.url=xui.adjustRes(p.url,false,true);k.id=k.name=f;if(_.isHash(d.iframeAutoLoad)){d.iframeAutoLoad.frameName=f}d._frameName=f;if(!p.query){p.query={}}p.query._rand=_();k.frameBorder="0";k.marginWidth="0";k.marginHeight="0";k.vspace="0";k.hspace="0";k.allowTransparency="true";k.width="100%";k.height="100%";m.getContainer().html("",false);m.append(k);if((p.method||"").toLowerCase()=="post"){xui.Dom.submit(p.url,p.query,"post",f,p.enctype)}else{k.src=p.url}}else{if(d.ajaxAutoLoad){var l=typeof d.ajaxAutoLoad=="string"?{url:d.ajaxAutoLoad}:_.clone(d.ajaxAutoLoad,true),q={rspType:"text"};if(!l.query){l.query={}}l.query._rand=_();_.merge(q,l.options);m.busy();var g=m.getContainer();xui.Ajax(xui.adjustRes(l.url,false,true),l.query,function(e){g.html(e,true,true);m.free()},function(e){g.html("<div>"+e+"</div>",true,false);m.free()},null,q).start()}}}}});Class(c+".Pane",c+".Div",{Static:{Behaviors:{DroppableKeys:["KEY"],PanelKeys:["KEY"]},Appearances:{KEY:{"line-height":"auto"}},RenderTrigger:function(){var d=this;if(d.box.KEY=="xui.UI.Pane"){if(d.properties.iframeAutoLoad||d.properties.ajaxAutoLoad){d.box._applyAutoLoad(d)}}},DataModel:{rotate:null}}});Class(c+".MoudluePlaceHolder",c+".Div",{Instance:{destroy:function(d,e){var f=this.get(0);if(!f){return}(f.$afterDestroy=(f.$afterDestroy||{}))["destroyAttachedModule"]=function(){if(!this._replaced&&this._module){this._module.destroy()}};return arguments.callee.upper.apply(this,[d,e])},adjustDock:null,draggable:null,busy:null,free:null,setProperties:function(e,f){var d=this.get(0);if(!d._properties){d._properties={}}if(!e){d._properties={}}else{if(typeof e=="string"){d._properties[e]=f}else{_.merge(d._properties,e,"all")}}return this},getProperties:function(e){var d=this.get(0);if(!d._properties){d._properties={}}return e?d._properties[e]:d._properties},setEvents:function(e,f){var d=this.get(0);if(!d._events){d._events={}}if(!e){d._events={}}else{if(typeof e=="string"){d._events[e]=f}else{_.merge(d._events,e,"all")}}return this},getEvents:function(e){var d=this.get(0);if(!d._events){d._events={}}return e?this._events[e]:this._events},replaceWithModule:function(h){var e=this,l=e.get(0),d,g,k,f;if(!l||l.destroyed||l._replaced||!l.getRootNode()){return}l._replaced=1;if(l.$beforeReplaced){l.$beforeReplaced.call(h)}if(l.host||l.alias){h.setHost(l.host,l.alias)}if(g=l._events){h.setEvents(g)}if(g=l._properties){h.setProperties(g)}if(l.moduleClass&&l.moduleXid){if(d=xui.Module.getInstance(l.moduleClass,l.moduleXid)){d.AddComponents(h)}}if(k=l.parent){f=l.childrenId;h.show(function(){if(l.$afterReplaced){l.$afterReplaced.call(h)}l.alias=null;l._module=null;if(l.box){l.boxing().destroy()}},k,f)}else{if(l.rendered&&(k=l.getRoot().parent())&&!k.isEmpty()){h.show(function(){if(l.$afterReplaced){l.$afterReplaced.call(h)}l.alias=null;l._module=null;if(l.box){l.boxing().destroy()}},k)}}if(l.$afterReplaced){l.$afterReplaced.call(h)}l.alias=null;l._module=null;e.destroy()}},Static:{Templates:{tagName:"div",style:"left:0px;top:0px;width:0px;height:0px;visibility:hidden;display:none;position:absolute;z-index:0;"},DataModel:{showEffects:null,hideEffects:null,activeAnim:null,hoverPop:null,hoverPopType:null,dock:null,dockStretch:null,renderer:null,html:null,disableClickEffect:null,disableHoverEffect:null,disableTips:null,disabled:null,defaultFocus:null,dockStretch:null,dockIgnore:null,dockOrder:null,dockMargin:null,dockFloat:null,dockMinW:null,dockMinH:null,dockMaxW:null,dockMaxH:null,tips:null},EventHandlers:{onContextmenu:null,onDock:null,onLayout:null,onMove:null,onRender:null,onResize:null,onShowTips:null,beforeAppend:null,afterAppend:null,beforeRender:null,afterRender:null,beforeRemove:null,afterRemove:null,onHotKeydown:null,onHotKeypress:null,onHotKeyup:null},RenderTrigger:function(){var d=this;if(d&&!d._replaced&&d._module){d.boxing().replaceWithModule(d._module)}}}})};Class("xui.UI.Image","xui.UI",{Initialize:function(){var c=this;c._adjustItems=xui.absList._adjustItems;c.prototype._prepareItems=function(d){return d}},Instance:{getRate:function(){return parseFloat(this.get(0)._rate)||1}},Static:{IMGNODE:1,Templates:{tagName:"img",style:"cursor:{cursor};{_style}",className:"{_className}",border:"0",src:xui.ini.img_bg,alt:"{alt}"},Behaviors:{HoverEffected:{KEY:"KEY"},ClickEffected:{KEY:"KEY"},DraggableKeys:["KEY"],onError:function(c,d,f){c.boxing().onError(c)},onLoad:function(f,h,k){var c=xui.use(k).get(0),g=c.src;if(g!=xui.ini.img_bg2){var d=new Image();d.onload=function(){if(!f||f.isDestroyed){return}var l=f.properties,e=f.box._adjust(f,_.isFinite(l.width)?l.width:d.width,_.isFinite(l.height)?l.height:d.height);if(f.$afterLoad){f.$afterLoad.apply(f.host,[f,g,e[0],e[1]])}f.boxing().afterLoad(f,g,e[0],e[1]);if(l.dock!="none"){f.boxing().adjustDock()}d.onload=null};d.src=g;xui.Dom.fixPng(c)}},onClick:function(c,f,g){var d=c.properties;if(d.disabled){return false}if(c.onClick){return c.boxing().onClick(c,f,g)}},onDblclick:function(c,f,g){var d=c.properties;if(d.disabled){return false}if(c.onDblclick){c.boxing().onDblclick(c,f,g)}}},RenderTrigger:function(){var d=this,f=d.properties,c=f.src,e=f.activeItem;if(e&&-1!=_.arr.subIndexOf(f.items,"id",e)){d.boxing().setActiveItem(e,true)}else{if(c){d.boxing().setSrc(c,c!=xui.ini.img_bg)}}},EventHandlers:{onClick:function(c,d,f){},onDblclick:function(c,d,f){},onError:function(c){},beforeLoad:function(c){},afterLoad:function(e,f,d,c){}},_adjust:function(g,f,c){var l=g.properties,k=g.getRootNode();f=parseInt(f,10)||0;c=parseInt(c,10)||0;k.style.width=k.style.height="";if(f>0&&c>0){var e=l.maxWidth/f,d=l.maxHeight/c,h=e<d?e:d;if(h>=1){h=1}g._rate=h;return[k.width=f*h,k.height=c*h]}return[0,0]},DataModel:{maxWidth:{ini:800,action:function(c){var d=this.getRootNode(),e=this.properties;this.box._adjust(this,_.isFinite(e.width)?e.width:d.width,_.isFinite(e.height)?e.height:d.height)}},maxHeight:{ini:600,action:function(c){var d=this.getRootNode(),e=this.properties;this.box._adjust(this,_.isFinite(e.width)?e.width:d.width,_.isFinite(e.height)?e.height:d.height)}},width:{ini:"auto",action:function(c){var e=this.getRootNode(),f=this.properties,d=new Image();d.src=e.src;this.box._adjust(this,_.isFinite(c)?parseInt(c,10):d.width,_.isFinite(f.height)?f.height:d.height)}},height:{ini:"auto",action:function(c){var e=this.getRootNode(),f=this.properties,d=new Image();d.src=e.src;this.box._adjust(this,_.isFinite(f.width)?f.width:d.width,_.isFinite(c)?parseInt(c,10):d.height)}},src:{format:"image",ini:xui.ini.img_bg,linkage:["activeItem"],action:function(d){var c=this;if(false!==c.boxing().beforeLoad(this)){_.asyRun(function(){c.getRoot().attr({width:"0",height:"0",src:xui.adjustRes(d)})})}if(!c.$inner){c.properties.activeItem=""}}},alt:{ini:"",action:function(c){this.getRoot().attr("alt",c)}},items:{ini:[]},activeItem:{ini:"",linkage:["src","alt","tips"],action:function(e){var d=this.properties.items,g=_.arr.subIndexOf(d,"id",""+e),h,f=this.boxing(),l,k,c;if((g!=-1)&&(h=d[g])){l=h.image||xui.ini.img_bg;k=h.alt||"";c=h.tips||""}this.$inner=1;f.setSrc(l||xui.ini.img_bg,true);delete this.$inner;f.setAlt(k||"");f.setTips(c||"")}},cursor:{ini:"auto",combobox:["","default","text","pointer","move","crosshair","wait","help","e-resize","ne-resize","nw-resize","n-resize","se-resize","sw-resize","s-resize","w-resize"],action:function(c){this.getRoot().css("cursor",c)}}}}});Class("xui.UI.Flash","xui.UI",{Instance:{refreshFlash:function(){var d="",c=this.constructor;return this.each(function(e){_.resetRun(e.domId,function(){c._clearMemory(e);if(e.properties.src){c._drawSWF(e)}})})},getFlash:function(){return this.constructor._getSWF(this.get(0))}},Static:{Appearances:{KEY:{"font-size":xui.browser.ie?0:null,"line-height":xui.browser.ie?0:null,overflow:"hidden"},BOX:{position:"absolute",left:0,top:0,"z-index":1},COVER:{position:"absolute",left:"-1px",top:"-1px",width:0,height:0,"z-index":4}},Templates:{tagName:"div",className:"{_className}",style:"{_style}",BOX:{tagName:"div"},COVER:{tagName:"div",style:"background-image:url("+xui.ini.img_bg+");"}},Behaviors:{onSize:xui.UI.$onSize},DataModel:{selectable:true,width:500,height:300,cover:false,src:{format:"flash",ini:"",action:function(c){this.boxing().refreshFlash()}},parameters:{ini:{},action:function(c){this.boxing().refreshFlash()}},flashvars:{ini:{},action:function(c){this.boxing().refreshFlash()}}},RenderTrigger:function(){(this.$beforeDestroy=(this.$beforeDestroy||{}))["flashClearMem"]=function(){if(this.box){this.box._clearMemory(this)}};this.boxing().refreshFlash()},getFlashVersion:function(){if(xui.browser.ie){try{var c=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6");try{c.AllowScriptAccess="always"}catch(d){return"6,0,0"}}catch(d){}finally{try{return new ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version").replace(/\D+/g,",").match(/^,?(.+),?$/)[1]}catch(d){}}}else{try{if(navigator.mimeTypes["application/x-shockwave-flash"].enabledPlugin){return(navigator.plugins["Shockwave Flash 2.0"]||navigator.plugins["Shockwave Flash"]).description.replace(/\D+/g,",").match(/^,?(.+),?$/)[1]}}catch(d){}}return"0,0,0"},_getSWF:function(c){var d=_.isStr(c)?c:(this._idtag+c.serialId);return(xui.browser.ie?window[d]:((document.embeds&&document.embeds[d])||window.document[d]))||document.getElementById(d)},_clearMemory:function(f){var g=this._idtag+f.serialId;var d=_.fun(),e=f.box._getSWF(f);if(e){e.style.display="none";if(xui.browser.ie){for(var c in e){if(typeof e[c]=="function"){e[c]=d}}if(window[g]){window[g]=undefined}}else{if(document.embeds&&document.embeds[g]){document.embeds[g]=undefined}if(window.document[g]){window.document[g]=undefined}}e=d=null}},_drawSWF:function(g){var f=this;var l=g.properties,e=g.serialId,k=xui.adjustRes(l.src),h=l.parameters,d=_.copy(l.flashvars),c="";d.DOMId=g.box._idtag+g.serialId;d.chartWidth=l.width;d.chartHeight=l.height;if(navigator.plugins&&navigator.mimeTypes&&navigator.mimeTypes.length){c+='<embed type="application/x-shockwave-flash" src="'+k+"?"+_.urlEncode(h)+'" ';c+='width="'+l.width+'" height="'+l.height+'" ';c+='id="'+d.DOMId+'" name="'+d.DOMId+'" ';c+='wmode="opaque" ';c+='flashvars="'+_.urlEncode(d)+'" ';c+="/>"}else{c+='<object id="'+d.DOMId+'" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" ';c+='width="'+l.width+'" height="'+l.height+'">';c+='<param name="movie" value="'+k+"?"+_.urlEncode(h)+'" />';c+='<param name="wmode" value="opaque" />';c+='<param name="flashvars" value="'+_.urlEncode(d)+'" />';c+="</object>"}g.getSubNode("BOX").html(c,false)},_onresize:function(f,e,c){var d=f.getSubNode("BOX").cssSize(),g=f.properties;if((e&&d.width!=e)||(c&&d.height!=c)){if(e){g.width=e}if(c){g.height=c}d={width:e,height:c};f.getSubNode("BOX").cssSize(d,true);if(f.$inDesign||g.cover){f.getSubNode("COVER").cssSize(d,true)}f.boxing().refreshFlash()}}}});Class("xui.UI.Audio","xui.UI",{Instance:{play:function(){var c=this.getSubNode("H5"),d=c.get(0);if(d){d.play()}},pause:function(){var c=this.getSubNode("H5"),d=c.get(0);if(d){d.pause()}},load:function(){var c=this.getSubNode("H5"),d=c.get(0);if(d){d.load()}},canPlayType:function(e){var c=this.getSubNode("H5"),d=c.get(0);if(d){return d.canPlayType(e)}}},Static:{Appearances:{KEY:{"font-size":xui.browser.ie?0:null,"line-height":xui.browser.ie?0:null,overflow:"hidden"},H5:{position:"absolute",left:0,top:0,"z-index":1}},Templates:{tagName:"div",className:"{_className}",style:"{_style}",H5:{tagName:"audio"}},Behaviors:{HotKeyAllowed:false,onSize:xui.UI.$onSize},DataModel:{selectable:true,width:200,height:50,src:{ini:"",action:function(c){this.getSubNode("H5").attr("src",c||null)}},controls:{ini:true,action:function(c){this.getSubNode("H5").attr("controls",c||null)}},preload:{ini:false,action:function(c){this.getSubNode("H5").attr("preload",c||null)}},loop:{ini:false,action:function(c){this.getSubNode("H5").attr("loop",c||null)}},muted:{ini:false,action:function(c){this.getSubNode("H5").attr("muted",c||null)}},volume:{ini:1,action:function(c){this.getSubNode("H5").attr("volume",c)}},autoplay:{ini:false,action:function(c){this.getSubNode("H5").attr("autoplay",c||null)}}},RenderTrigger:function(){var f=this,d=f.getSubNode("H5"),g=f.properties,c=function(){if(f.onMediaEvent){f.boxing().onMediaEvent(f,event,arguments)}},e;"loadstart progress durationchange seeked seeking timeupdate playing canplay canplaythrough volumechange ratechange loadedmetadata loadeddata play pause ended".split(" ").forEach(function(k,h){if(d&&d.get(0)){d.get(0).addEventListener(k,c,false)}});(f.$beforeDestroy=(f.$beforeDestroy||{}))["detachEvents"]=function(){"loadstart progress durationchange seeked seeking timeupdate playing canplay canplaythrough volumechange ratechange loadedmetadata loadeddata play pause ended".split(" ").forEach(function(k,h){if(d&&d.get(0)){d.get(0).removeEventListener(k,c,false)}})};if(e=g.src){d.attr("src",e)}if(e=g.controls){d.attr("controls",e)}if(e=g.preload){d.attr("preload",e)}if(e=g.loop){d.attr("loop",e)}if(e=g.muted){d.attr("muted",e)}if(e=g.autoplay){d.attr("autoplay",e)}if((e=g.volume)!==1){d.attr("volume",e)}},EventHandlers:{onMediaEvent:function(d,c,e){}},_onresize:function(g,f,c){var d=g.getSubNode("H5"),e=d.cssSize(),h=g.properties;if((f&&e.width!=f)||(c&&e.height!=c)){if(f){h.width=f}if(c){h.height=c}e={width:f,height:c};d.cssSize(e,true)}}}});Class("xui.UI.Video","xui.UI.Audio",{Instance:{},Static:{Templates:{tagName:"div",className:"{_className}",style:"{_style}",H5:{tagName:"video",width:"{width}",height:"{height}"}},DataModel:{width:400,height:300,poster:{format:"image",ini:"",action:function(c){this.getSubNode("H5").attr("poster",c||null)}}},RenderTrigger:function(){var e=this,c=e.getSubNode("H5"),f=e.properties,d;if(d=f.poster){c.attr("poster",d)}},_onresize:function(g,f,c){var d=g.getSubNode("H5"),e=d.cssSize(),h=g.properties;if((f&&e.width!=f)||(c&&e.height!=c)){if(f){h.width=f}if(c){h.height=c}if(f){d.attr("width",f)}if(c){d.attr("height",c)}}}}});Class("xui.UI.Border","xui.UI",{Instance:{_attachTo:function(h,f){var e=this,d=e.get(0),g;h.append(e);d.$edgeId=xui(h).id();d.$tieId=f;d.$attached=true;if(g=d.properties){if(d.properties.borderActive){var c="tag",k=d.domId;if(xui(f).get(0)){xui(f).afterMouseover(function(n,m){if(n.properties.disabled){return}var l=xui.$cache.profileMap[k];_.tryF(l.behavior.TAG.afterMouseover,[l,m,l.getRootNode()],this)},c).afterMouseout(function(n,m){if(n.properties.disabled){return}var l=xui.$cache.profileMap[k];_.tryF(l.behavior.TAG.afterMouseout,[l,m,l.getRootNode()],this)},c).afterMousedown(function(n,m){if(n.properties.disabled){return}var l=xui.$cache.profileMap[k];_.tryF(l.behavior.TAG.afterMousedown,[l,m,l.getRootNode()],this)},c).afterMouseup(function(n,m){if(n.properties.disabled){return}var l=xui.$cache.profileMap[k];_.tryF(l.behavior.TAG.afterMouseup,[l,m,l.getRootNode()],this)},c)}}}return h},_detach:function(){var f=this,e=f.get(0),h,g,d=null,c="tag";delete e.$attached;if(h=e.$tieId){if(h=xui.Dom.byId(h)){xui(h).afterMouseover(d,c).afterMouseout(d,c).afterMousedown(d,c).afterMouseup(d,c)}}return f}},Initialize:function(){_.each({addBorder:function(d){var e=xui([this.get(0)]),c=arguments[1]||e.id();return new xui.UI.Border(d)._attachTo(e,c)},$getBorder:function(){var d=this.id(),c;_.arr.each(xui.UI.Border._cache,function(e){if(e.$edgeId==d){c=e;return false}});return c&&c.boxing()},removeBorder:function(){var c=this.id();_.arr.each(xui.UI.Border._cache,function(d){if(d.$edgeId==c){d.boxing()._detach().destroy(true)}});return this}},function(d,c){xui.Dom.plugIn(c,d)});_.each({_border:function(d,c){return this.each(function(m){var h=m.properties,l=m.getSubNode(h._customBorder||"BORDER"),f;if(!d){d={}}if(h._customBorder){f=(d._bkey=m.getClass("KEY"))}else{f="xui-border"}var g="setting-"+f,e;e="borderLeftWidth";h.$b_lw=xui.UI.$getCSSValue(g,e);e="borderRightWidth";h.$b_rw=xui.UI.$getCSSValue(g,e);e="borderTopWidth";h.$b_tw=xui.UI.$getCSSValue(g,e);e="borderBottomWidth";h.$b_bw=xui.UI.$getCSSValue(g,e);if(c!==false){if(l.$getBorder()){return}m.$border=l.addBorder(d);m.clearCache().boxing().reLayout()}})},_unBorder:function(){return this.each(function(e){var d=e.getSubNode("BORDER"),c=e.properties;if(!d.$getBorder()){return}d.removeBorder();delete e.$border;delete c.$b_lw;delete c.$b_rw;delete c.$b_tw;delete c.$b_bw;e.clearCache().boxing().reLayout()})}},function(d,c){xui.UI.Widget.plugIn(c,d)});xui.UI.Widget.setDataModel({border:{ini:false,action:function(d){var c=this.boxing();if(d){c._border()}else{c._unBorder()}}}})},Static:{Templates:{tagName:"div",TAG:{},T:{className:"{cls_t}"},RT:{className:"{cls_rt}",$order:1},R:{className:"{cls_r}"},RB:{className:"{cls_rb}",$order:1},B:{className:"{cls_b}"},LB:{className:"{cls_lb}",$order:1},L:{className:"{cls_l}"},LT:{className:"{cls_lt}",$order:1}},Appearances:{KEY:{width:0,height:0,display:xui.browser.ie6?"inline":null,"font-size":0,"line-height":0},"TAG,T, RT, R, RB, B, LB, L, LT":{position:"absolute",display:"block","font-size":0,"line-height":0},".setting-xui-border":{"border-style":"solid","border-top-width":"1px","border-bottom-width":"1px","border-left-width":"1px","border-right-width":"1px"},T:{width:"100%",left:0,top:"-1px",height:"3px","background-image":xui.UI.$bg("vertical.gif",""),"background-repeat":"repeat-x","background-position":"left top"},B:{width:"100%",left:0,bottom:"-1px",height:"3px","background-image":xui.UI.$bg("vertical.gif",""),"background-repeat":"repeat-x","background-position":"left bottom"},L:{height:"100%",top:0,left:"-1px",width:"3px","background-image":xui.UI.$bg("horizontal.gif",""),"background-repeat":"repeat-y","background-position":"left top"},R:{height:"100%",top:0,right:"-1px",width:"3px","background-image":xui.UI.$bg("horizontal.gif",""),"background-repeat":"repeat-y","background-position":"right top"},LT:{top:"-1px",left:"-1px",width:"3px",height:"3px","background-image":xui.UI.$bg("corner.gif",""),"background-repeat":"no-repeat","background-position":"left top"},RT:{top:"-1px",right:"-1px",width:"3px",height:"3px","background-image":xui.UI.$bg("corner.gif",""),"background-repeat":"no-repeat","background-position":"right top"},RB:{right:"-1px",bottom:"-1px",width:"3px",height:"3px","background-image":xui.UI.$bg("corner.gif",""),"background-repeat":"no-repeat","background-position":"right bottom"},LB:{left:"-1px",bottom:"-1px",width:"3px",height:"3px","background-image":xui.UI.$bg("corner.gif",""),"background-repeat":"no-repeat","background-position":"left bottom"}},Behaviors:{HoverEffected:{TAG:"KEY"},ClickEffected:{TAG:"KEY"}},DataModel:{_bkey:"",borderActive:false},_prepareData:function(c){var e=arguments.callee.upper.call(this,c),d=c.properties._bkey;e.cls_t=d?d+"-b-t":"";e.cls_rt=d?d+"-b-rt":"";e.cls_r=d?d+"-b-r":"";e.cls_rb=d?d+"-b-rb":"";e.cls_b=d?d+"-b-b":"";e.cls_lb=d?d+"-b-lb":"";e.cls_l=d?d+"-b-l":"";e.cls_lt=d?d+"-b-lt":"";return e}}});Class("xui.UI.Shadow","xui.UI",{Instance:{_attachTo:function(d){d=d.reBoxing();var c=this;c.get(0)._target=d.get(0);d.append(c);return d}},Initialize:function(){_.each({addShadow:function(c){return new xui.UI.Shadow(c)._attachTo(xui([this.get(0)]))},$getShadow:function(){var d=this.get(0),c;_.arr.each(xui.UI.Shadow._cache,function(e){if(e._target==d){c=e;return false}});return c&&c.boxing()},removeShadow:function(){var c=this.get();_.arr.each(xui.UI.Shadow._cache,function(d){if(d&&d.renderId&&d._target){if(_.arr.indexOf(c,xui(d._target).get(0))!=-1){d.boxing().destroy(true)}}});return this}},function(d,c){xui.Dom.plugIn(c,d)});_.each({_shadow:function(c){return this.each(function(h){var g=h.properties,f=h.getSubNode(g._customShadow||"BORDER"),e;if(xui.Dom.css3Support("boxShadow")){e=parseInt(g._shadowSize*3/4,10);f.css("boxShadow",e+"px "+e+"px "+e+"px #9f9f9f");if(h.box._shadowRB){h.getSubNode(h.box._shadowRB).css("background-color","#9f9f9f")}}else{if(f.$getShadow()){return}h.$shadow=f.addShadow({shadowSize:g._shadowSize})}})},_unShadow:function(){return this.each(function(d){var c=d.getSubNode("BORDER");if(xui.Dom.css3Support("boxShadow")){c.css("boxShadow","");if(d.box._shadowRB){d.getSubNode(d.box._shadowRB).css("background-color","transparent")}}else{if(!c.$getShadow()){return}c.removeShadow();delete d.$shadow}})}},function(d,c){xui.UI.Widget.plugIn(c,d)});xui.UI.Widget.setDataModel({shadow:{ini:false,action:function(d){var c=this.boxing();if(d){c._shadow()}else{c._unShadow()}}},_shadowSize:this.SIZE})},Static:{SIZE:(xui.browser.ie&&xui.browser.ver<=8)?8:4,Templates:{tagName:"div",R:{tagName:"div",style:"top:{shadowOffset}px;width:{shadowSize}px;right:-{pos}px;"},RB:{tagName:"div",style:"height:{rbsize}px;width:{rbsize}px;right:-{pos}px;bottom:-{pos}px;"},B:{tagName:"div",style:"left:{shadowOffset}px;height:{shadowSize}px;bottom:-{pos}px;"}},Appearances:{KEY:{width:0,height:0,display:xui.browser.ie6?"inline":null,"font-size":xui.browser.ie6?0:null,"line-height":xui.browser.ie6?0:null},"B, RB, R":{position:"absolute",display:"block","font-size":xui.browser.ie?0:null,"line-height":xui.browser.ie?0:null,"z-index":"-1"},B:{left:0,width:"100%",background:xui.browser.ie6?"":xui.UI.$bg("bottom.png","repeat-x left bottom"),_filter:xui.UI.$ieBg("bottom.png")},RB:{background:xui.browser.ie6?"":xui.UI.$bg("right_bottom.png","left top"),_filter:xui.UI.$ieBg("right_bottom.png")},R:{top:0,height:"100%",background:xui.browser.ie6?"":xui.UI.$bg("right.png","repeat-y right top"),_filter:xui.UI.$ieBg("right.png")}},DataModel:{shadowSize:{ini:8,action:function(e){var d=this,c=d.properties.shadowOffset;d.getSubNode("R").cssRegion({width:e,top:c,right:-e-c});d.getSubNode("RB").cssRegion({width:e,height:e,right:-e-c+1,bottom:-e-c+1});d.getSubNode("B").cssRegion({height:e,left:c,bottom:-e-c})}},shadowOffset:{ini:0,action:function(c){this.boxing().setShadowSize(this.properties.shadowSize,true)}}},_prepareData:function(d){var c=arguments.callee.upper.call(this,d);c.pos=(parseInt(c.shadowSize,10)||0)+(parseInt(c.shadowOffset,10)||0);c.rbsize=c.shadowSize+4;return c},LayoutTrigger:function(){if(xui.browser.ie){this.getRoot().ieRemedy()}}}});Class("xui.UI.Resizer","xui.UI",{Instance:{_attachTo:function(f,e){var d=this,c=d.get(0);c._target=xui(f);c._parent=e||xui("body");c._parent.append(d);c.$resizeId=xui(f).id();return d},show:function(){var c=this;c.each(function(d){d.getRoot().css("display","")});if(xui.browser.ie){c.reBoxing().ieRemedy()}return c},hide:function(){var c=this;c.reBoxing().css("display","none");return c}},Initialize:function(){this.addTemplateKeys(["HANDLER","HIDDEN","MOVE","CONF1","CONF2","ROTATE","L","R","T","B","LT","RT","LB","RB","REGION"]);_.each({addResizer:function(e,d,c){var g=xui([this.get(0)]);e=e||{};_.merge(e,{_attached:true});var f=new xui.UI.Resizer(e)._attachTo(g,g);if(d){f.onUpdate(d)}if(c){f.onChange(c)}return f},removeResizer:function(){var c=this.id();_.arr.each(xui.UI.Resizer._cache,function(d){if(d&&d.$resizeId==c){d.boxing().destroy(true)}});return this},$getResizer:function(){var d=this.id(),c;_.arr.each(xui.UI.Resizer._cache,function(e){if(e&&e.$resizeId==d){c=e;return false}});return c&&c.boxing()}},function(d,c){xui.Dom.plugIn(c,d)});_.each({_resizer:function(d,c){return this.each(function(g){var e=g.getSubNode("BORDER"),f=g.properties;if(e.$getResizer()){return}c=c||{};var h=function(z,x,C,m){var p=arguments.callee.profile,n=p.getRoot(),A=p.boxing(),k=p.properties,u=p.box["xui.svg"],B;if(C){var y=null,r=null,q=null,B=null;if(B=C.width){n.widthBy(B);k.width=y=u?A.getWidth():n.width()}if(B=C.height){n.heightBy(B);k.height=r=u?A.getHeight():n.height()}xui.UI.$tryResize(p,y,r,true);if(!p.box._onresize&&p.onResize&&(y!==null||r!==null)){A.onResize(p,y,r)}}if(m){if((B=m.left)&&!(k.left=="auto"&&parseInt(k.right,10)>=0)){n.leftBy(B);k.left=u?A.getLeft():n.left()}if((B=m.top)&&!(k.top=="auto"&&parseInt(k.bottom,10)>=0)){n.topBy(B);k.top=u?A.getTop():n.top()}if(p.onMove&&(q!==null||B!==null)){A.onMove(p,q,B,null,null)}}return false};h.profile=g;g.$resizer=e.addResizer(c,h);g.$resizer.get(0).$parentUIProfile=g;if(f.visibility=="hidden"){g.$resizer.hide()}})},_unResizer:function(){return this.each(function(d){var c=d.getSubNode("BORDER");if(!c.$getResizer()){return}c.removeResizer();delete d.$resizer})}},function(d,c){xui.UI.Widget.plugIn(c,d)});xui.UI.Widget.setDataModel({resizer:{ini:false,action:function(e){var d=this.boxing();if(e){var f=this.properties,c={};_.each("minHeight,minWidth,maxHeight,maxWidth".split(","),function(g){if(g in f){c[g]=f[g]}});if(f.resizerProp&&!_.isEmpty(f.resizerProp)){_.merge(c,f.resizerProp,"all")}if(f.tagVar.resizerProp){_.merge(c,f.tagVar.resizerProp,"all")}d._resizer(e,c)}else{d._unResizer()}}},resizerProp:{ini:{}}})},Static:{Templates:{tagName:"div",className:"{_disabled}",style:"{_style};"},Appearances:{KEY:{position:"absolute",margin:"0 -1px -1px 0",visibility:"visible","font-size":0,"line-height":0,background:(xui.browser.ie&&!xui.browser.newie)?("url("+xui.ini.path+"bg.gif)"):"","z-index":60,cursor:"move"},"KEY.disabled":{background:"url(\"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' version='1.1' preserveAspectRatio='none' viewBox='0 0 200 200'><rect x='0' y='0' width='200' height='200' stroke='black' fill='transparent' stroke-width='1'></rect><path d='M200 0 L0 200 ' stroke='black' stroke-width='1'/><path d='M0 0 L200 200 ' stroke='black' stroke-width='1'/></svg>\")","background-repeat":"no-repeat","background-position":"center center","background-size":"100% 100%, auto","background-color":"#bbb",opacity:"0.3"},"KEY.disabled.active":{"background-color":"#eee"},"KEY.disabled div":{display:"none"},MOVE:{position:"absolute",display:"block","z-index":100,visibility:"visible","background-image":xui.UI.$bg("icons.gif","",true),"background-repeat":"no-repeat","background-position":"-17px -244px","font-size":0,"line-height":0},"CONF1, CONF2, ROTATE":{position:"absolute",display:"block","z-index":100,visibility:"visible","background-image":xui.UI.$bg("icons.gif","",true),"background-repeat":"no-repeat","font-size":0,"line-height":0,cursor:"pointer"},CONF2:{$order:2,"background-position":"-90px -272px"},CONF1:{$order:3,"background-position":"-112px -284px"},ROTATE:{$order:4,cursor:"crosshair","background-position":"-160px -280px"},HANDLER:{$order:0,position:"absolute",display:"block",border:"solid 1px","background-color":"#fff","z-index":100,visibility:"visible","font-size":0,"line-height":0},T:{$order:1,left:"50%",cursor:"n-resize"},RT:{$order:1,cursor:"ne-resize","z-index":110},R:{$order:1,top:"50%",cursor:"e-resize"},RB:{$order:1,cursor:"se-resize","z-index":110},B:{$order:1,left:"50%",cursor:"s-resize"},LB:{$order:1,cursor:"sw-resize","z-index":110},L:{$order:1,top:"50%",cursor:"w-resize"},LT:{$order:1,cursor:"nw-resize","z-index":110},HIDDEN:{$order:10,"background-color":"transparent","border-width":0}},Behaviors:{beforeMousedown:function(c,d,f){c.box._onMousedown(c,d,f,"move")},onDragbegin:function(c,d,f){c.box._onDragbegin(c,d,f,"move")},onDrag:function(c,d,f){c.box._onDrag(c,d,f,"move")},onDragstop:function(c,d,f){c.box._onDragstop(c,d,f,"move")},onDblclick:function(c,d,f){if(c.onDblclick){c.boxing().onDblclick(c,d,f)}},CONF1:{onMouseover:function(c,d,f){if(c.properties.disabled){return false}if(c.onConfig){return c.boxing().onConfig(c,d,f,"left","mouseover")}return false},onMousedown:function(c,d,f){if(c.properties.disabled){return false}if(c.onConfig){return c.boxing().onConfig(c,d,f,"left","mousedown")}return false},onClick:function(c,d,f){if(c.properties.disabled){return false}if(c.onConfig){return c.boxing().onConfig(c,d,f,"left","click")}return false}},CONF2:{onMouseover:function(c,d,f){if(c.properties.disabled){return false}if(c.onConfig){return c.boxing().onConfig(c,d,f,"right","mouseover")}return false},onMousedown:function(c,d,f){if(c.properties.disabled){return false}if(c.onConfig){return c.boxing().onConfig(c,d,f,"right","mousedown")}return false},onClick:function(c,d,f){if(c.properties.disabled){return false}if(c.onConfig){return c.boxing().onConfig(c,d,f,"right","click")}return false}},ROTATE:{beforeMousedown:function(c,d,f){c.box._onMousedown(c,d,f,"rotate");return false},onDragbegin:function(c,d,f){c.box._onDragbegin(c,d,f,"rotate")},onDrag:function(c,d,f){c.box._onDrag(c,d,f,"rotate")},onDragstop:function(c,d,f){c.box._onDragstop(c,d,f,"rotate")}},LT:{beforeMousedown:function(c,d,f){c.box._onMousedown(c,d,f,"nw");return false},onDragbegin:function(c,d,f){c.box._onDragbegin(c,d,f,"nw")},onDrag:function(c,d,f){c.box._onDrag(c,d,f,"nw")},onDragstop:function(c,d,f){c.box._onDragstop(c,d,f,"nw")}},RT:{beforeMousedown:function(c,d,f){c.box._onMousedown(c,d,f,"ne");return false},onDragbegin:function(c,d,f){c.box._onDragbegin(c,d,f,"ne")},onDrag:function(c,d,f){c.box._onDrag(c,d,f,"ne")},onDragstop:function(c,d,f){c.box._onDragstop(c,d,f,"ne")}},LB:{beforeMousedown:function(c,d,f){c.box._onMousedown(c,d,f,"sw");return false},onDragbegin:function(c,d,f){c.box._onDragbegin(c,d,f,"sw")},onDrag:function(c,d,f){c.box._onDrag(c,d,f,"sw")},onDragstop:function(c,d,f){c.box._onDragstop(c,d,f,"sw")}},RB:{beforeMousedown:function(c,d,f){c.box._onMousedown(c,d,f,"se");return false},onDragbegin:function(c,d,f){c.box._onDragbegin(c,d,f,"se")},onDrag:function(c,d,f){c.box._onDrag(c,d,f,"se")},onDragstop:function(c,d,f){c.box._onDragstop(c,d,f,"se")}},L:{beforeMousedown:function(c,d,f){c.box._onMousedown(c,d,f,"w");return false},onDragbegin:function(c,d,f){c.box._onDragbegin(c,d,f,"w")},onDrag:function(c,d,f){c.box._onDrag(c,d,f,"w")},onDragstop:function(c,d,f){c.box._onDragstop(c,d,f,"w")}},T:{beforeMousedown:function(c,d,f){c.box._onMousedown(c,d,f,"n");return false},onDragbegin:function(c,d,f){c.box._onDragbegin(c,d,f,"n")},onDrag:function(c,d,f){c.box._onDrag(c,d,f,"n")},onDragstop:function(c,d,f){c.box._onDragstop(c,d,f,"n")}},R:{beforeMousedown:function(c,d,f){c.box._onMousedown(c,d,f,"e");return false},onDragbegin:function(c,d,f){c.box._onDragbegin(c,d,f,"e")},onDrag:function(c,d,f){c.box._onDrag(c,d,f,"e")},onDragstop:function(c,d,f){c.box._onDragstop(c,d,f,"e")}},B:{beforeMousedown:function(c,d,f){c.box._onMousedown(c,d,f,"s");return false},onDragbegin:function(c,d,f){c.box._onDragbegin(c,d,f,"s")},onDrag:function(c,d,f){c.box._onDrag(c,d,f,"s")},onDragstop:function(c,d,f){c.box._onDragstop(c,d,f,"s")}}},DataModel:{_attached:false,forceVisible:false,forceMovable:"",singleDir:false,vertical:true,horizontal:true,minHeight:12,minWidth:12,maxHeight:5000,maxWidth:5000,handlerSize:4,handlerOffset:0,disabled:{ini:false,action:function(c){if(c){this.getRoot().addClass("disabled")}else{this.getRoot().removeClass("disabled")}}},leftConfigBtn:{ini:false,action:function(c){this.getSubNode("CONF1").css("display",c?"":"none")}},rightConfigBtn:{ini:false,action:function(c){this.getSubNode("CONF2").css("display",c?"":"none")}},rotatable:{ini:false,action:function(c){if(c&&xui.browser.ie&&xui.browser.ver<=8){c=false}this.getSubNode("ROTATE").css("display",c?"":"none")}},left:100,top:100,height:100,width:100,position:"absolute",display:"block"},EventHandlers:{onDblclick:function(c,d,f){},onUpdate:function(f,g,e,c,d){},onChange:function(d,c){},onConfig:function(d,f,g,h,c){}},_dynamicTemplate:function(e){var h=e.properties,p,g,l,f=e._exhash="$_attached:"+h._attached+";forceVisible:"+h.forceVisible+";singleDir:"+h.singleDir+";vertical:"+h.vertical+";horizontal:"+h.horizontal+";forceMovable:"+h.forceMovable+";";var c=arguments.callee.map||(arguments.callee.map={MOVE:{tagName:"div",style:"top:50%;left:50%;margin-left:-6px;margin-top:-6px;width:13px;height:13px;"},CONF1:{tagName:"div",style:"top:0px;left:-16px;width:16px;height:16px;{_leftCofigBtn};"},CONF2:{tagName:"div",style:"top:0px;left:auto;right:-16px;width:16px;height:16px;{_rightCofigBtn};"},ROTATE:{tagName:"div",style:"top:-18px;left:50%;margin-left:-8px;width:16px;height:16px;{_rotateBtn};"},T:{tagName:"div",style:"top:-{extend}px;margin-left:-{extend}px;width:{handlerSize}px;height:{handlerSize}px;"},RT:{tagName:"div",style:"top:-{extend}px;right:-{extend}px;width:{handlerSize}px;height:{handlerSize}px;"},R:{tagName:"div",style:"right:-{extend}px;margin-top:-{extend}px;width:{handlerSize}px;height:{handlerSize}px;"},RB:{tagName:"div",style:"bottom:-{extend}px;right:-{extend}px;width:{handlerSize}px;height:{handlerSize}px;"},B:{tagName:"div",style:"bottom:-{extend}px;margin-left:-{extend}px;width:{handlerSize}px;height:{handlerSize}px;"},LB:{tagName:"div",style:"bottom:-{extend}px;left:-{extend}px;width:{handlerSize}px;height:{handlerSize}px;"},L:{tagName:"div",style:"left:-{extend}px;margin-top:-{extend}px;width:{handlerSize}px;height:{handlerSize}px;"},LT:{tagName:"div",style:"left:-{extend}px;top:-{extend}px;width:{handlerSize}px;height:{handlerSize}px;"},cover:{T:{tagName:"div",style:"width:100%;left:0;top:-{extend}px;height:{handlerSize}px;"},RT:{tagName:"div",style:"top:-{extend}px;right:-{extend}px;width:{handlerSize}px;height:{handlerSize}px;"},R:{tagName:"div",style:"height:100%;top:0;right:-{extend}px;width:{handlerSize}px;"},RB:{tagName:"div",style:"right:-{extend}px;bottom:-{extend}px;width:{handlerSize}px;height:{handlerSize}px;"},B:{tagName:"div",style:"width:100%;left:0;bottom:-{extend}px;height:{handlerSize}px;"},LB:{tagName:"div",style:"left:-{extend}px;bottom:-{extend}px;width:{handlerSize}px;height:{handlerSize}px;"},L:{tagName:"div",style:"height:100%;top:0;left:-{extend}px;width:{handlerSize}px;"},LT:{tagName:"div",style:"top:-{extend}px;left:-{extend}px;width:{handlerSize}px;height:{handlerSize}px;"}}});var k=e.box.getTemplate(f);if(!k){var m,d;k=_.clone(e.box.getTemplate());m=h._cover?c.cover:c;if(h._move){k.MOVE=c.MOVE}k.CONF1=c.CONF1;k.CONF2=c.CONF2;k.ROTATE=c.ROTATE;if(h.vertical){if(!h.singleDir){k.T=m.T}k.B=m.B}if(h.horizontal){if(!h.singleDir){k.L=m.L}k.R=m.R;if(h.vertical){if(!h.singleDir){k.LB=m.LB;k.RT=m.RT;k.LT=m.LT}k.RB=m.RB}}d=e.getClass("KEY","-handler")+" ";if(m=k.T){m.className=d}if(m=k.RT){m.className=d}if(m=k.R){m.className=d}if(m=k.RB){m.className=d}if(m=k.B){m.className=d}if(m=k.LB){m.className=d}if(m=k.L){m.className=d}if(m=k.LT){m.className=d}if(!h._visible){d=e.getClass("KEY","-hidden")+" ";if(m=k.T){m.className+=d}if(m=k.RT){m.className+=d}if(m=k.R){m.className+=d}if(m=k.RB){m.className+=d}if(m=k.B){m.className+=d}if(m=k.LB){m.className+=d}if(m=k.L){m.className+=d}if(m=k.LT){m.className+=d}}e.box.setTemplate(k,f)}e.template=k},_prepareData:function(d){var c=d.properties;c._visible=true;c._cover=false;c._move=true;if(c._attached){c._visible=false;c._cover=true;c._move=false;c.position="static";c.display="inline";c.left=c.top=c.width=c.height=0}if(c.forceVisible){c._visible=true;c._cover=false}if(typeof c.forceMovable=="boolean"){c._move=c.forceMovable}c.extend=(parseInt(c.handlerSize,10)||0)/2+(parseInt(c.handlerOffset,10)||0);c._leftCofigBtn=c.leftConfigBtn?"":"display:none";c._rightCofigBtn=c.rightConfigBtn?"":"display:none";var e=c.rotatable;if(e&&xui.browser.ie&&xui.browser.ver<=8){e=false}c._rotateBtn=e?"":"display:none";c._disabled=c.disabled?"disabled":"";return arguments.callee.upper.call(this,d)},RenderTrigger:function(){var c=this;xui.setNodeData(c.renderId,"zIndexIgnore",1);c.box._tryCursors(c)},_onUpdate:function(g,h,f,c,d){if(h){if(f){h.widthBy(f.width,true).heightBy(f.height,true)}if(c){var e=h.get(0).style;if(e.left=="auto"&&(parseInt(e.right,10)>=0)){}else{h.leftBy(c.left)}if(e.top=="auto"&&(parseInt(e.bottom,10)>=0)){}else{h.topBy(c.top)}}if(_.isDefined(d)){h.rotate(d)}}},_switchAxis:function(c,d,k){var h=(d+360)%360,m=["n","ne","e","se","s","sw","w","nw"],l=Math.round(h/45),f=_.arr.indexOf(m,c),e=f+l,g=m[e%8];if(k&&e%2==1){if(h<l*45){g=m[(e-1)%8]}else{g=m[(e+1)%8]}}return g},_tryCursors:function(d){var c=(d.getRoot().rotate()+360)%360,e=this._switchAxis,g={T:"n",RT:"ne",R:"e",RB:"se",B:"s",LB:"sw",L:"w",LT:"nw"},h;_.each(g,function(f,l){if((h=d.getSubNode(l)).get(0)){h.css("cursor",e(f,c)+"-resize")}})},_getDDParas:function(e,c,d){switch(c){case"move":return{move:true};case"rotate":return{rotate:true};case"nw":return{left:true,top:true};case"ne":return{right:true,top:true};case"sw":return{left:true,bottom:true};case"se":return{right:true,bottom:true};case"w":return{left:true};case"n":return{top:true};case"e":return{right:true};case"s":return{bottom:true}}},_onMousedown:function(f,h,k,d){if(f.properties.disabled){return false}var c=this._getDDParas(0,d);if(xui.Event.getBtn(h)!="left"){return}var g=f.$parentUIProfile;if(g&&g["xui.UIProfile"]&&g.beforeResizerDrag&&false===_.tryF(g.beforeResizerDrag,[g,f,c],g.boxing())){return}var l=xui.Event.getPos(h);xui.use(k).startDrag(h,{dragDefer:2,targetReposition:false,dragType:"blank",dragCursor:true,targetLeft:l.left,targetTop:l.top})},_onDragbegin:function(k,p,c,l){var f=k.properties,d=f.rotatable,g=k.properties._attached?k._target:xui([k.renderId]),u=g.width(),n=g.height(),r=g.offset(),m;if(d){m=g.rotate();if(g.get(0).getBoundingClientRect){var q=g.get(0).getBoundingClientRect();k.o_center={x:(q.right+q.left)/2,y:(q.bottom+q.top)/2}}else{k.o_center={x:r.left+u/2,y:r.top+u/2}}}if(k.properties._attached){k.proxy=xui.Dom.getEmptyDiv();k.proxy.html(" ",false).css({border:"1px dashed",visibility:"visible",position:"absolute"}).offset(r).width(u).height(n).css("zIndex",xui.Dom.TOP_ZINDEX+20);if(m){k.proxy.rotate(m)}}else{k.proxy=g}k.o_w2=k.o_w=u;k.o_h2=k.o_h=n;k.o_pos=k.proxy.cssPos();k.o_size={width:u,height:n};k.o_rotate=m;if(k.regions){k.o_regions=[];k.regions.each(function(e){k.o_regions.push(xui(e).cssSize())})}k.$onDrag=true},_onDrag:function(g,ad,A,B){var U=this._getDDParas(g.o_rotate,B);g.oos=g.oos||{};var p=xui.DragDrop.getProfile(),T=g.properties,f=g.o_rotate,C=g.o_size,n=g.o_pos,G=p.offset,d=G.x,c=G.y,R,P,S,ab,ac,af={};if(d===0&&c===0){return}if(f&&!(U.move||U.rotate)){var Q=function(e){return(e+360)%360},z=Math.pow(Math.pow(d,2)+Math.pow(c,2),0.5),I=Q(Math.atan2(d,-c)*180/Math.PI),O=f+90-I,K=(Q(I-f)<180)?1:-1,J=(Q(I-f)<90||Q(I-f)>270)?-1:1;d=z*Math.abs(Math.cos(O*Math.PI/180))*K;c=z*Math.abs(Math.sin(O*Math.PI/180))*J}if(d==g.oos.width&&c==g.oos.height){return}g.oos={width:d,height:c};if(U.left){S=g.o_w-d;R=n.left+d;if(S<T.minWidth){S=T.minWidth;R=g.o_w+n.left-S}else{if(S>T.maxWidth){S=T.maxWidth;R=g.o_w+n.left-S}}_.merge(af,{width:S,left:R})}else{if(U.right){S=g.o_w+d;if(S<T.minWidth){S=T.minWidth}else{if(S>T.maxWidth){S=T.maxWidth}}_.merge(af,{width:S})}}if(U.top){ab=g.o_h-c;P=n.top+c;if(ab<T.minHeight){ab=T.minHeight;P=g.o_h+n.top-ab}else{if(ab>T.maxHeight){ab=T.maxHeight;P=g.o_h+n.top-ab}}_.merge(af,{height:ab,top:P})}else{if(U.bottom){ab=g.o_h+c;if(ab<T.minHeight){ab=T.minHeight}else{if(ab>T.maxHeight){ab=T.maxHeight}}_.merge(af,{height:ab})}}if(f&&!(U.move||U.rotate)){delete af.left;delete af.top;var M=Math.abs(Math.cos(f*Math.PI/180)),u=Math.abs(Math.sin(f*Math.PI/180)),Y=n.left+C.width/2,X=n.top+C.height/2,V=C.width*M+C.height*u,ag=C.width*u+C.height*M,ae=Y-V/2,W=X-ag/2,l=(af.left||n.left)+(af.width||C.width)/2,k=(af.top||n.top)+(af.height||C.height)/2,D=(af.width||C.width)*M+(af.height||C.height)*u,L=(af.width||C.width)*u+(af.height||C.height)*M,H=l-D/2,E=k-L/2,F=(D-V)/2,N=(L-ag)/2,aa=l-Y,Z=k-X;af.left=n.left-aa;af.top=n.top-Z;var q=this._switchAxis(B,f,true);switch(q){case"e":if(f<90){af.top-=((af.height||C.height)*M-L/2)-(C.height*M-ag/2)}else{if(f>90&&(f<180)){af.top-=((af.width||C.width)*u-L/2)-(C.width*u-ag/2)}else{if(f>180&&(f<270)){af.top+=((af.width||C.width)*u-L/2)-(C.width*u-ag/2)}else{af.top+=((af.height||C.height)*M-L/2)-(C.height*M-ag/2)}}}af.left+=F;break;case"s":if(f<90){af.left-=((af.height||C.height)*u-D/2)-(C.height*u-V/2)}else{if(f>90&&(f<180)){af.left-=((af.width||C.width)*M-D/2)-(C.width*M-V/2)}else{if(f>180&&(f<270)){af.left+=((af.width||C.width)*M-D/2)-(C.width*M-V/2)}else{af.left+=((af.height||C.height)*u-D/2)-(C.height*u-V/2)}}}af.top+=N;break;case"w":if(f<90){af.top+=((af.height||C.height)*M-L/2)-(C.height*M-ag/2)}else{if(f>90&&(f<180)){af.top+=((af.width||C.width)*u-L/2)-(C.width*u-ag/2)}else{if(f>180&&(f<270)){af.top-=((af.width||C.width)*u-L/2)-(C.width*u-ag/2)}else{af.top-=((af.height||C.height)*M-L/2)-(C.height*M-ag/2)}}}af.left-=F;break;case"n":if(f<90){af.left+=((af.height||C.height)*u-D/2)-(C.height*u-V/2)}else{if(f>90&&(f<180)){af.left+=((af.width||C.width)*M-D/2)-(C.width*M-V/2)}else{if(f>180&&(f<270)){af.left-=((af.width||C.width)*M-D/2)-(C.width*M-V/2)}else{af.left-=((af.height||C.height)*u-D/2)-(C.height*u-V/2)}}}af.top-=N;break}}if(U.left||U.right){if(g.regions&&"width" in af&&af.width!==C.width){var m=af.width-C.width;g.regions.each(function(h,e){xui(h).width(g.o_regions[e].width+m)})}}if(U.top||U.bottom){if(g.regions&&"height" in af&&af.height!==C.height){var r=af.height-C.height;g.regions.each(function(h,e){xui(h).height(g.o_regions[e].height+r)})}}if(U.move){R=n.left+d;P=n.top+c;_.merge(af,{top:P,left:R})}if(U.rotate){ac=(180-Math.atan2(p.x-g.o_center.x,p.y-g.o_center.y)*180/Math.PI);if(ac<0){ac+=360}_.merge(af,{rotate:ac})}if(!_.isEmpty(af)){_.each(af,function(h,e){af[e]=h+"px"});g.proxy.css(af);if(g.onChange){g.boxing().onChange(g,g.proxy)}}},_onDragstop:function(h,q,c,k){var m,g,u,l,n,p=h.o_size,d=h.o_pos,f=h.proxy,r=this._getDDParas(h.o_rotate,k);if(!r.move&&!r.rotate){m=f.cssSize();u={width:m.width-p.width,height:m.height-p.height};if(u.width===0&&u.height===0){u=null}}g=f.cssPos();l={left:g.left-d.left,top:g.top-d.top};if(l.left===0&&l.top===0){l=null}if(r.rotate){n=f.rotate()}if(h.onUpdate&&false===h.boxing().onUpdate(h,h._target,u,l,n)){}else{h.box._onUpdate(h,h._target,u,l,n)}if(h.properties._attached){if(xui.browser.ie6){h._target.ieRemedy()}h.proxy.html("",false).css({visibility:"hidden",border:"none",zIndex:"0",width:"0",height:"0",rotate:0})}h.$onDrag=false;delete h.o_rotate;h.box._tryCursors(h)}}});Class("xui.UI.Block","xui.UI.Widget",{Initialize:function(){var c=this,d=c.getTemplate();_.merge(d.FRAME.BORDER,{className:"xui-uiw-border {clsBorderType1}",PANEL:{tagName:"div",className:"{clsBorderType2} xui-uibg-bar",style:"{_panelstyle};{background};{_overflow};",text:"{html}"+xui.UI.$childTag}},"all");c.setTemplate(d);d=c.getAppearance();_.merge(d,{PANEL:{position:"relative",overflow:"auto"}});c.setAppearance(d)},Static:{Behaviors:{DroppableKeys:["PANEL"],PanelKeys:["PANEL"],PANEL:{onClick:function(c,f,g){var d=c.properties;if(d.disabled){return false}if(c.onClickPanel){return c.boxing().onClickPanel(c,f,g)}}}},EventHandlers:{onClickPanel:function(c,d,f){}},DataModel:{disabled:null,tips:null,rotate:null,iframeAutoLoad:{ini:"",action:function(){xui.UI.Div._applyAutoLoad(this)}},ajaxAutoLoad:{ini:"",action:function(){xui.UI.Div._applyAutoLoad(this)}},selectable:true,html:{html:1,action:function(c){this.getSubNode("PANEL").html(xui.adjustRes(c,0,1))}},borderType:{ini:"outset",listbox:["none","flat","inset","outset","groove","ridge"],action:function(n){var m=this,e=m.properties,k=m.getSubNode("BORDER"),g=m.getSubNode("PANEL"),f=/^xui-uiborder-/,c="xui-uiborder-flat",h="xui-uiborder-inset",d="xui-uiborder-outset",l=m.getRoot();k.removeClass(f);g.removeClass(f);switch(n){case"flat":k.addClass(c);break;case"inset":k.addClass(h);break;case"outset":k.addClass(d);break;case"groove":k.addClass(h);g.addClass(d);break;case"ridge":k.addClass(d);g.addClass(h);break}m.box._setB(m);xui.UI.$tryResize(m,l.get(0).style.width,l.get(0).style.height,true)}},background:{format:"color",ini:"",action:function(c){this.getSubNode("PANEL").css("background",c)}},width:100,height:100},Appearances:{KEY:{"line-height":"auto"}},RenderTrigger:function(){var c=this;if(c.box.KEY=="xui.UI.Block"){if(c.properties.iframeAutoLoad||c.properties.ajaxAutoLoad){xui.UI.Div._applyAutoLoad(this)}}},_setB:function(d){var e=d.properties,c=e.borderType;e.$hborder=e.$vborder=e.$iborder=0;if(c=="flat"||c=="inset"||c=="outset"){e.$hborder=e.$vborder=1;e.$iborder=0}else{if(c=="groove"||c=="ridge"){e.$hborder=e.$vborder=e.$iborder=1}}},LayoutTrigger:function(){var c=this.properties.borderType;if(c!="none"){this.boxing().setBorderType(c,true)}},_prepareData:function(c){var d=arguments.callee.upper.call(this,c);d.background=d.background?"background:"+d.background:"";if(_.isStr(d.overflow)){d._overflow=d.overflow.indexOf(":")!=-1?(d.overflow):(d.overflow?("overflow:"+d.overflow):"")}return d},_onresize:function(g,f,d){var e=arguments.callee.upper.apply(this,arguments),h=g.properties,c=(h.$iborder||0)*2;if(e.width){e.width-=c}if(e.height&&"auto"!==e.height){e.height-=c}g.getSubNode("PANEL").cssSize(e,true)}}});Class("xui.UI.Label","xui.UI.Widget",{Instance:{_shadowText:function(c){return this.each(function(d){d.getSubNode("SHADOW").css("display","block")})},_unShadowText:function(c){return this.each(function(d){d.getSubNode("SHADOW").css("display","none")})}},Initialize:function(){var c=this.getTemplate();_.merge(c.FRAME.BORDER,{SHADOW:{$order:1,style:"display:none;",SICON:{$order:0,className:"xui-ui-icon {imageClass}",style:"{backgroundImage} {backgroundPosition} {backgroundRepeat} {imageDisplay}"},SCAPTION:{text:"{caption}",style:"color:#cdcdcd;",$order:1}},BOX:{$order:2,ICON:{$order:0,className:"xui-ui-icon {imageClass}",style:"{backgroundImage} {backgroundPosition} {backgroundRepeat} {imageDisplay}"},CAPTION:{text:"{caption}",$order:1}}},"all");this.setTemplate(c)},Static:{Appearances:{KEY:{"font-size":"12px","line-height":"14px"},BOX:{position:"absolute"},SHADOW:{position:"absolute",top:"4px"}},DataModel:{selectable:true,caption:{ini:undefined,action:function(f){var e=this,g=e.properties,c=e.boxing(),d=e.keys;f=(_.isSet(f)?f:"")+"";e.getSubNodes(["CAPTION","SCAPTION"]).html(xui.adjustRes(f,true));if(g.hAlign!="left"){c.setHAlign(g.hAlign,true)}if(g.vAlign!="top"){c.setVAlign(g.vAlign,true)}}},image:{format:"image",action:function(e){var d=this,c=d.keys;d.getSubNodes(["ICON","SICON"]).css("display",e?"":"none").css("backgroundImage",e?("url("+xui.adjustRes(e||"")+")"):"")}},imagePos:{action:function(e){var d=this,c=d.keys;d.getSubNodes(["ICON","SICON"]).css("backgroundPosition",e)}},shadowText:{ini:false,action:function(d){var c=this.boxing();d=String(d).toLowerCase()!="false";if(d){c._shadowText(d)}else{c._unShadowText()}}},hAlign:{ini:"right",listbox:["left","center","right"],action:function(g){var f=this,l=f.getSubNode("BOX"),k=f.getSubNode("SHADOW"),h=f.properties,e=function(){switch(g){case"left":l.css({left:0,right:"auto",marginLeft:"auto"});k.css({left:h._textSshadowSize+"px",right:"auto",marginLeft:"auto"});break;case"right":l.css({left:"auto",right:h._textSshadowSize+"px",marginLeft:"auto"});k.css({left:"auto",right:0,marginLeft:"auto"});break;case"center":l.css({left:"50%",right:"auto",marginLeft:-1*l.get(0).offsetWidth/2+"px"});k.css({left:"50%",right:"auto",marginLeft:-1*l.get(0).offsetWidth/2+h._textSshadowSize+"px"});break}};if(l.get(0).offsetWidth){e()}else{_.asyRun(e)}}},vAlign:{ini:"top",listbox:["top","middle","bottom"],action:function(g){var f=this,l=f.getSubNode("BOX"),k=f.getSubNode("SHADOW"),h=f.properties,e=function(){switch(g){case"top":l.css({top:0,bottom:"auto",marginTop:"auto"});k.css({top:h._textSshadowSize+"px",bottom:"auto",marginTop:"auto"});break;case"bottom":l.css({top:"auto",bottom:h._textSshadowSize+"px",marginTop:"auto"});k.css({top:"auto",bottom:0,marginTop:"auto"});break;case"middle":l.css({top:"50%",bottom:"auto",marginTop:-1*l.get(0).offsetHeight/2+"px"});k.css({top:"50%",bottom:"auto",marginTop:-1*l.get(0).offsetHeight/2+h._textSshadowSize+"px"});break}};if(l.get(0).offsetHeight){e()}else{_.asyRun(e)}}},fontSize:{action:function(d){var c=this;c.getSubNodes(["CAPTION","SCAPTION"]).css("fontSize",d)}},fontWeight:{action:function(d){var c=this;c.getSubNodes(["CAPTION","SCAPTION"]).css("fontWeight",d)}},width:120,height:20,_textSshadowSize:4},Behaviors:{onClick:function(c,f,g){var d=c.properties;if(d.disabled){return false}if(c.onClick){return c.boxing().onClick(c,f,g)}}},EventHandlers:{onClick:function(c,d,f){}},RenderTrigger:function(){var c=this.properties,d=this.boxing();if(c.fontSize){d.setFontSize(c.fontSize,true)}if(c.fontWeight){d.setFontWeight(c.fontWeight,true)}if(c.shadowText){d.setShadowText(true,true)}},LayoutTrigger:function(){var d=this.properties,e=this.boxing(),c=d.shadowText;if(d.hAlign!="left"||c){e.setHAlign(d.hAlign,true)}if(d.vAlign!="top"||c){e.setVAlign(d.vAlign,true)}}}});Class("xui.UI.ProgressBar",["xui.UI.Widget","xui.absValue"],{Instance:{_setCtrlValue:function(c){return this.each(function(e){var d=e.properties.type,f=e.getSubNode("FILL");if(d=="horizontal"){f.width(c+"%")}else{f.top((100-c)+"%").height(c+"%")}e.getSubNode("CAP").text(e.properties.captionTpl.replace(/\{value\}|\*/g,c))})}},Initialize:function(){var c=this,d=c.getTemplate();_.merge(d.FRAME.BORDER,{className:"xui-uiborder-flat xui-uibg-base",FILL:{tagName:"div",style:"{fillBG}",text:"{html}"+xui.UI.$childTag},INN:{$order:2,tagName:"div",CAP:{tagName:"div"}}},"all");c.setTemplate(d);d=c.getAppearance();_.merge(d,{BORDER:{"font-size":0,"line-height":0,overflow:"hidden"},INN:{display:"table",position:"absolute",left:0,top:0,width:"100%",height:"100%"},CAP:{"text-align":"center"},FILL:{position:"relative",width:0,height:0,left:0,top:0,"background-image":xui.UI.$bg("bar.gif",""),"background-repeat":"repeat-x","background-position":"left top","background-color":"#96E115"}});c.setAppearance(d)},Static:{DataModel:{value:0,width:300,height:22,captionTpl:{ini:"* %",action:function(){this.boxing()._setCtrlValue(this.properties.$UIvalue)}},type:{listbox:["vertical","horizontal"],ini:"horizontal",action:function(d){var c=this.properties.width,e=this.properties.height;this.properties.height=c;this.properties.width=e;this.boxing().refresh()}},fillBG:{ini:"",format:"color",action:function(c){this.getSubNode("FILL").css("background",c)}},$hborder:1,$vborder:1},_prepareData:function(c){var d=arguments.callee.upper.call(this,c);d.fillBG=d.fillBG?"background:"+d.fillBG:"";return d},_ensureValue:function(c,d){return parseInt(d,10)||0},_onresize:function(h,g,c){var e=arguments.callee.upper.apply(this,arguments),d,f=h.properties.type,k=h.getSubNodes(["INN","CAP","FILL"]);if(f=="horizontal"){if(e.height){d=e.height+"px";k.css({height:d,"line-height":d})}}else{if(e.width){k.css({width:e.width+"px"})}if(e.height){k.css({"line-height":e.height+"px"})}}}}});Class("xui.UI.Button",["xui.UI.Widget","xui.absValue"],{Instance:{activate:function(){this.getSubNode("FOCUS").focus();return this},_setCtrlValue:function(c){if(_.isNull(c)||!_.isDefined(c)){c=false}return this.each(function(f){var e=f.properties;if(e.type!="status"){return}f.getSubNode("BORDER").tagClass("-checked",c);if(e.border){var d=f.getSubNode("BORDER").$getBorder();if(d){d.get(0).getRoot().tagClass("-checked",c)}}})},_setDirtyMark:function(){return arguments.callee.upper.apply(this,["FOCUS"])},resetValue:function(e){this.each(function(f){if(f.properties.type=="drop"){f.boxing().setCaption("",true)}});var c=arguments.callee.upper,d=c.apply(this,_.toArr(arguments));c=null;return d},setUIValue:function(f,e){this.each(function(g){var h=g.properties;if(h.$UIvalue!==f&&h.type=="drop"){g.boxing().setCaption("",true)}});var c=arguments.callee.upper,d=c.apply(this,_.toArr(arguments));c=null;return d}},Initialize:function(){this.addTemplateKeys(["DROP"]);var c=this.getTemplate();_.merge(c.FRAME,{FOCUS:{$order:2,className:"xui-ui-unselectable",tabindex:"{tabindex}",TB:{cellpadding:"0",cellspacing:"0",width:"100%",height:"100%",border:"0",tagName:"table",TR:{tagName:"tr",TDL:{tagName:"td"},TD:{$order:1,align:"{hAlign}",valign:"{vAlign}",tagName:"td",width:"100%",height:"100%",BOX:{ICON:{$order:1,className:"xui-ui-icon {imageClass}",style:"{backgroundImage} {backgroundPosition} {backgroundRepeat} {imageDisplay}"},CAPTION:{$order:2,text:"{caption}"}}},TDR:{$order:2,tagName:"td",className:"{dropCls}",TDRI:{}}}}}},"all");this.setTemplate(c)},Static:{Appearances:{KEY:{"font-size":"12px","line-height":"14px",cursor:"pointer"},BORDER:{"font-size":0,"line-height":0,"background-color":"#D2D7DF"},"BORDER-mouseover":{$order:2,"background-color":"#F7D928"},"BORDER-mousedown, BORDER-checked":{$order:2,"background-color":"#F9E56A"},DROP:{$order:10,"background-image":xui.UI.$bg("drop.gif","","Button"),"background-repeat":"no-repeat","background-position":"left bottom","padding-left":"16px"},"DROP-mouseover":{$order:11,"background-position":"-16px bottom"},"DROP-mousedown":{$order:12,"background-position":"right bottom"},"TDR,TDL":{"padding-left":"6px"},".setting-xui-button":{"border-top-width":"1px","border-bottom-width":"1px","border-left-width":"1px","border-right-width":"1px"},"KEY-b-t":{top:"-1px",height:"10px","background-image":xui.UI.$bg("vertical.gif","","Button"),"background-repeat":"repeat-x","background-position":"left top"},"KEY-b-b":{bottom:"-1px",height:"10px","background-image":xui.UI.$bg("vertical.gif","","Button"),"background-repeat":"repeat-x","background-position":"left bottom"},"BORDER-mouseover KEY-b-t, BORDER-mouseover KEY-b-b":{$order:1,"background-image":xui.UI.$bg("vertical_mouseover.gif","","Button")},"BORDER-checked KEY-b-t, BORDER-checked KEY-b-b, BORDER-mousedown KEY-b-t, BORDER-mousedown KEY-b-b":{$order:2,"background-image":xui.UI.$bg("vertical_mousedown.gif","","Button")},"KEY-b-l":{left:"-1px",width:"4px","background-image":xui.UI.$bg("horizontal.gif","","Button"),"background-repeat":"repeat-y","background-position":"left top"},"KEY-b-r":{right:"-1px",width:"4px","background-image":xui.UI.$bg("horizontal.gif","","Button"),"background-repeat":"repeat-y","background-position":"right top"},"BORDER-mouseover KEY-b-l, BORDER-mouseover KEY-b-r":{$order:1,"background-image":xui.UI.$bg("horizontal_mouseover.gif","","Button")},"BORDER-checked KEY-b-l, BORDER-checked KEY-b-r, BORDER-mousedown KEY-b-l, BORDER-mousedown KEY-b-r":{$order:2,"background-image":xui.UI.$bg("horizontal_mousedown.gif","","Button")},"KEY-b-lt":{top:"-1px",left:"-1px",width:"4px",height:"10px","background-image":xui.UI.$bg("corner.gif","","Button"),"background-repeat":"no-repeat","background-position":"left top"},"KEY-b-rt":{top:"-1px",right:"-1px",width:"4px",height:"10px","background-image":xui.UI.$bg("corner.gif","","Button"),"background-repeat":"no-repeat","background-position":"right top"},"KEY-b-rb":{right:"-1px",bottom:"-1px",width:"4px",height:"10px","background-image":xui.UI.$bg("corner.gif","","Button"),"background-repeat":"no-repeat","background-position":"right bottom"},"KEY-b-lb":{left:"-1px",bottom:"-1px",width:"4px",height:"10px","background-image":xui.UI.$bg("corner.gif","","Button"),"background-repeat":"no-repeat","background-position":"left bottom"},"BORDER-mouseover KEY-b-lt, BORDER-mouseover KEY-b-rt, BORDER-mouseover KEY-b-rb, BORDER-mouseover KEY-b-lb":{$order:1,"background-image":xui.UI.$bg("corner_mouseover.gif","","Button")},"BORDER-checked KEY-b-lt, BORDER-checked KEY-b-rt, BORDER-checked KEY-b-rb, BORDER-checked KEY-b-lb, BORDER-mousedown KEY-b-lt, BORDER-mousedown KEY-b-rt, BORDER-mousedown KEY-b-rb, BORDER-mousedown KEY-b-lb":{$order:2,"background-image":xui.UI.$bg("corner_mousedown.gif","","Button")},FOCUS:{overflow:"hidden",display:"block",left:0,top:0,"z-index":"20",width:"100%",height:"100%",position:"absolute","outline-offset":"-1px","-moz-outline-offset":(xui.browser.gek&&xui.browser.ver<3)?"-1px !important":null},BOX:{display:"inline","white-space":"nowrap"},CAPTION:{cursor:"pointer","vertical-align":xui.browser.ie6?"baseline":"middle",display:"inline","font-size":"12px","line-height":"14px"}},Behaviors:{HoverEffected:{KEY:["BORDER"]},ClickEffected:{KEY:["BORDER"]},NavKeys:{FOCUS:1},onClick:function(d,g,h){var f=d.properties;if(f.disabled){return false}d.getSubNode("FOCUS").focus();var c=d.boxing();if(f.type=="status"){if(f.readonly){return false}c.setUIValue(!f.$UIvalue,null,null,"click");if(d.onChecked){c.onChecked(d,g,f.$UIvalue)}}if(d.onClick){return c.onClick(d,g,h,f.$UIvalue)}},onKeydown:function(d,g,h){var f=xui.Event.getKey(g),c=f.key;if(c==" "||c=="enter"){d.getSubNode("KEY").afterMousedown();d.__fakeclick=1}},onKeyup:function(d,g,h){var f=xui.Event.getKey(g),c=f.key;if(c==" "||c=="enter"){d.getSubNode("KEY").afterMouseup();if(d.__fakeclick){xui.use(h).onClick()}}delete d.__fakeclick},TDR:{onMousedown:function(c,d,f){if(c.properties.type!="drop"){return}xui.use(f).addClass(c.getClass("DROP","-mousedown"));return false},onMouseup:function(c,d,f){if(c.properties.type!="drop"){return}xui.use(f).removeClass(c.getClass("DROP","-mousedown"));return false},onMouseover:function(c,d,f){if(c.properties.type!="drop"){return}xui.use(f).addClass(c.getClass("DROP","-mouseover"))},onMouseout:function(c,d,f){if(c.properties.type!="drop"){return}xui.use(f).removeClass(c.getClass("DROP","-mouseover")).removeClass(c.getClass("DROP","-mousedown"))},onClick:function(c,d,f){if(c.properties.type!="drop"){return}c.boxing().onClickDrop(c,d,f);return false}}},DataModel:{caption:{ini:undefined,action:function(c){c=(_.isSet(c)?c:"")+"";this.getSubNode("CAPTION").html(xui.adjustRes(c,true))}},image:{format:"image",action:function(c){this.getSubNode("ICON").css("display",c?"":"none").css("backgroundImage",c?("url("+xui.adjustRes(c)+")"):"")}},imagePos:{action:function(c){this.getSubNode("ICON").css("backgroundPosition",c)}},hAlign:{ini:"center",listbox:["left","center","right"],action:function(c){this.getSubNode("TD").attr("align",c)}},vAlign:{ini:"middle",listbox:["top","middle","bottom"],action:function(c){this.getSubNode("TD").attr("valign",c)}},value:false,type:{ini:"normal",listbox:["normal","status","drop"],action:function(g){var e=this,c=e.getRoot(),f=e.getSubNode("TDR"),d=e.getClass("DROP");if(g=="drop"){f.addClass(d)}else{f.removeClass(d)}e.box._onresize(e)}},width:120,height:22,_customBorder:"BORDER",border:true},_ensureValue:function(c,d){if(c.properties.type=="status"){return !!d}else{return d}},_prepareData:function(c){var d=arguments.callee.upper.call(this,c);d.dropCls=d.type=="drop"?c.getClass("DROP"):"";return d},RenderTrigger:function(){var c=this,d=c.properties,e=c.boxing();if(d.type=="status"&&d.value){e.setValue(true,true,"render")}},EventHandlers:{onClick:function(c,f,g,d){},onClickDrop:function(c,d,f){},onChecked:function(c,f,d){}}}});Class("xui.UI.CheckBox","xui.UI.Button",{Instance:{_setCtrlValue:function(c){return this.each(function(d){d.getSubNode("MARK").tagClass("-checked",!!c)})},_setDirtyMark:function(){return arguments.callee.upper.apply(this,["CAPTION"])}},Initialize:function(){var c=this.getTemplate();_.merge(c.FRAME.FOCUS.TB.TR.TD.BOX,{MARK:{$order:0,className:"xui-uicmd-check"}},"all");this.setTemplate(c)},Static:{Appearances:{KEY:{"font-size":"12px","line-height":"14px",border:0,cursor:"pointer"},BORDER:{},FOCUS:{overflow:"hidden",display:"block",position:"absolute",left:0,top:0,"z-index":"200",width:"100%",height:"100%","outline-offset":"-1px","-moz-outline-offset":(xui.browser.gek&&xui.browser.ver<3)?"-1px !important":null},BOX:{display:xui.$inlineBlock,zoom:xui.browser.ie6?1:null,"font-size":"12px","line-height":"14px",overflow:"hidden","vertical-align":"middle","white-space":"nowrap"},TD:{background:"transparent"},TDR:{background:"transparent"},TDL:{background:"transparent"},CAPTION:{display:"inline","white-space":"normal","vertical-align":xui.browser.ie6?"baseline":"middle",cursor:"pointer",zoom:xui.browser.ie?0:null}},Behaviors:{HoverEffected:{KEY:"MARK"},ClickEffected:{KEY:"MARK"},onClick:function(d,g,h){var f=d.properties,c=d.boxing();if(f.disabled||f.readonly){return false}c.setUIValue(!f.$UIvalue,null,null,"click");if(d.onChecked){c.onChecked(d,f.$UIvalue)}d.getSubNode("FOCUS").focus()},FOCUS:{onKeydown:function(d,f,g){var c=xui.Event.getKey(f).key;if(c==" "||c=="enter"){d.getRoot().onClick(true);return false}}}},DataModel:{type:null,value:false,hAlign:"left",_customBorder:false,border:false},EventHandlers:{onClick:null},_ensureValue:function(c,d){return !!d}}});Class("xui.UI.Slider",["xui.UI","xui.absValue"],{Instance:{_setCtrlValue:function(c){return this.each(function(k){var m=k.properties,h=m.steps,g=function(n){return k.getSubNode(n)},f=g("IND1"),e=g("IND2"),d=k.box._v2a(k,c),l=m.type=="vertical"?"top":"left";f[l](d[0]+"%");if(m.isRange){e[l](d[1]+"%")}})},_setDirtyMark:function(){return arguments.callee.upper.apply(this,["BOX"])}},Static:{Templates:{style:"{_style}",className:"{_className}",LABEL:{className:"{_required}",style:"{labelShow};width:{labelSize}px;{labelHAlign}",text:"{labelCaption}"},BOX:{tagName:"div",className:"{_cls}",BG:{tagName:"div"},RULER:{$order:1,tagName:"div",RULERLEFT:{},RULERRIGHT:{}},IND:{$order:2,IND1:{style:"{_showD}",tabindex:"{tabindex}"},IND2:{style:"{_showD2}",tabindex:"{tabindex}"}},DECREASE:{style:"{_showDes}",tabindex:"{tabindex}"},INCREASE:{style:"{_showIns}",tabindex:"{tabindex}"}}},Appearances:{"IND, BT, RULER, RULERLEFT, RULERRIGHT, IND1, IND2, DECREASE, INCREASE":{"font-size":0,"line-height":0,position:"absolute"},LABEL:{"z-index":1,top:0,left:0,position:"absolute","padding-top":"4px","font-size":"12px"},BOX:{position:"absolute",left:0,top:0,width:"100%",height:"100%"},"BOX-h DECREASE, BOX-h INCREASE":{top:"50%",width:"17px",height:"17px","margin-top":"-8px"},"BOX-v DECREASE, BOX-v INCREASE, BOX-h DECREASE, BOX-h INCREASE, BOX-h IND1,BOX-h IND2, BOX-v IND1,BOX-v IND2":{"background-image":xui.UI.$bg("icons.gif","",true),"background-repeat":"no-repeat"},"BOX-h DECREASE":{$order:1,left:0,"background-position":"-80px -70px"},"BOX-h INCREASE":{$order:1,right:0,"background-position":"-100px -70px"},"BOX-h DECREASE-mouseover":{$order:2,"background-position":"-80px -90px"},"BOX-h DECREASE-mousedown":{$order:3,"background-position":"-80px -110px"},"BOX-h INCREASE-mouseover":{$order:2,"background-position":"-100px -90px"},"BOX-h INCREASE-mousedown":{$order:3,"background-position":"-100px -110px"},"BOX-h BG":{top:"50%"},"BOX-h IND, BOX-h RULER":{"z-index":1,top:"50%",height:"6px","margin-top":"-3px"},"BOX-h RULER, BOX-h RULERLEFT, BOX-h RULERRIGHT":{"background-image":xui.UI.$bg("bar_vertical.gif","",true),"background-repeat":"repeat-x"},"BOX-h RULER":{$order:2,"background-position":"left -482px"},"BOX-h RULERLEFT, BOX-h RULERRIGHT":{"z-index":1,height:"6px",width:"5px"},"BOX-h RULERLEFT":{$order:2,"background-position":"left -474px",left:"-4px",top:0},"BOX-h RULERRIGHT":{$order:2,"background-position":"left -490px",right:"-4px",top:0},"BOX-h IND1,BOX-h IND2":{$order:1,"z-index":2,"background-position":"-21px -282px",height:"18px",width:"8px",left:0,top:0,cursor:"e-resize","margin-top":"-6px"},"BOX-h IND1-mouseover,BOX-h IND2-mouseover":{$order:2,"background-position":"-31px -282px"},"BOX-h IND1-mousedown,BOX-h IND2-mousedown":{$order:3,"background-position":"-41px -282px"},"BOX-v DECREASE, BOX-v INCREASE":{$order:10,left:"50%",width:"17px",height:"17px","margin-left":"-8px"},"BOX-v DECREASE":{$order:10,top:0,"background-position":"-120px -70px"},"BOX-v INCREASE":{$order:10,bottom:0,"background-position":"-140px -70px"},"BOX-v DECREASE-mouseover":{$order:11,"background-position":"-120px -90px"},"BOX-v DECREASE-mousedown":{$order:12,"background-position":"-120px -110px"},".xui-ui-disabled INCREASE, .xui-ui-disabled DECREASE":{$order:15,display:"none"},"BOX-v INCREASE-mouseover":{$order:11,"background-position":"-140px -90px"},"BOX-v INCREASE-mousedown":{$order:12,"background-position":"-140px -110px"},"BOX-v BG":{$order:10,left:"50%"},"BOX-v IND, BOX-v RULER":{$order:10,"z-index":1,left:"50%",width:"6px","margin-left":"-3px"},"BOX-v RULER, BOX-v RULERLEFT, BOX-v RULERRIGHT":{"background-image":xui.UI.$bg("bar_horizontal.gif","",true),"background-repeat":"repeat-y"},"BOX-v RULER":{$order:10,"background-position":"-482px top"},"BOX-v RULERLEFT, BOX-v RULERRIGHT":{$order:10,"z-index":1,width:"6px",height:"5px"},"BOX-v RULERLEFT":{$order:12,"background-position":"-490px top",top:"-4px",left:0},"BOX-v RULERRIGHT":{$order:12,"background-position":"-474px top",bottom:"-4px",left:0},"BOX-v IND1,BOX-v IND2":{$order:10,"z-index":2,"background-position":"left -272px",width:"18px",height:"8px",left:0,top:0,cursor:"n-resize","margin-left":"-6px"},"BOX-v IND1-mouseover,BOX-v IND2-mouseover":{$order:11,"background-position":"left -282px"},"BOX-v IND1-mousedown,BOX-v IND2-mousedown":{$order:12,"background-position":"left -292px"}},Behaviors:{HoverEffected:{IND1:"IND1",IND2:"IND2",DECREASE:"DECREASE",INCREASE:"INCREASE"},ClickEffected:{IND1:"IND1",IND2:"IND2",DECREASE:"DECREASE",INCREASE:"INCREASE"},onSize:xui.UI.$onSize,IND:{onClick:function(f,n,c){var d=f.properties;if(d.disabled||d.readonly){return false}var y=xui.use(c).offset(),x=xui.Event.getPos(n),k=f.box._v2a(f,f.properties.$UIvalue),h,g,r=d.type=="vertical",q=r?"top":"left",m=r?"offsetTop":"offsetLeft",l=r?"offsetHeight":"offsetWidth",w=x[q]-y[q],u=(w/xui.use(c).get(0)[l])*100;if(!d.isRange){k[0]=u}else{h=f.getSubNode("IND1")[m](),g=f.getSubNode("IND2")[m]();if(Math.abs(h-w)<Math.abs(g-w)){k[0]=u}else{k[1]=u}}f.boxing().setUIValue(f.box._adjustValue(f,k),null,null,"click")}},IND1:{onKeydown:function(f,h,k){var g=f.properties;if(g.disabled||g.readonly){return}var d=g.type=="vertical",c=xui.Event.getKey(h).key;if(c==(d?"up":"left")){f.box._auto(f,false)}if(c==(d?"down":"right")){f.box._auto(f,true)}},onKeyout:function(c){xui.Thread.abort(c.$xid+":auto")},onKeyup:function(c){xui.Thread.abort(c.$xid+":auto")},beforeMousedown:function(d,k,m){if(xui.Event.getBtn(k)!="left"){return}var h=d.properties;if(h.disabled||h.readonly){return}var c=h.type=="vertical",l=c?"offsetTop":"offsetLeft",g=c?"offsetHeight":"offsetWidth",f=d.box;xui.use(m).startDrag(k,{widthIncrement:h.steps?d._size/h.steps:null,dragType:"none",targetReposition:true,horizontalOnly:c?true:null,verticalOnly:c?null:true,maxLeftOffset:xui.use(m).get(0)[l],maxRightOffset:xui.use(m).parent().get(0)[g]-xui.use(m).get(0)[l],dragCursor:"default"});xui.use(m).css("zIndex",10).focus();d.getSubNode("IND2").css("zIndex",5)},beforeDragbegin:function(d,f,g){var c=d.properties.type=="vertical";xui(g)[c?"top":"left"](d.__x=xui.use(g).get(0)[c?"offsetTop":"offsetLeft"])},onDrag:function(f,g,k){var h=xui.DragDrop.getProfile().offset,d=f.properties.type=="vertical",c=f.box._v2a(f,f.properties.$UIvalue);c[0]=((f.__x+h[d?"y":"x"])/xui.use(k).parent().get(0)[d?"offsetHeight":"offsetWidth"])*100;f.boxing().setUIValue(f.box._adjustValue(f,c),null,null,"drag")},onDragstop:function(c,d,f){xui(f).onMouseout(true,{$force:true}).onMouseup(true)},onClick:function(){return false}},IND2:{onKeydown:function(f,h,k){var g=f.properties;if(g.disabled||g.readonly){return}var d=g.type=="vertical",c=xui.Event.getKey(h).key;if(c==(d?"up":"left")){f.box._auto(f,false)}if(c==(d?"down":"right")){f.box._auto(f,true)}},onKeyout:function(c){xui.Thread.abort(c.$xid+":auto")},onKeyup:function(c){xui.Thread.abort(c.$xid+":auto")},beforeMousedown:function(d,k,m){if(xui.Event.getBtn(k)!="left"){return}var h=d.properties;if(h.disabled||h.readonly){return}var c=h.type=="vertical",l=c?"offsetTop":"offsetLeft",g=c?"offsetHeight":"offsetWidth",f=d.box;xui.use(m).startDrag(k,{widthIncrement:h.steps?d._size/h.steps:null,dragType:"none",targetReposition:true,horizontalOnly:c?true:null,verticalOnly:c?null:true,maxLeftOffset:xui.use(m).get(0)[l],maxRightOffset:xui.use(m).parent().get(0)[g]-xui.use(m).get(0)[l],dragCursor:"default"});xui.use(m).css("zIndex",10).focus();d.getSubNode("IND1").css("zIndex",5)},beforeDragbegin:function(d,f,g){var c=d.properties.type=="vertical";xui(g)[c?"top":"left"](d.__x=xui.use(g).get(0)[c?"offsetTop":"offsetLeft"])},onDrag:function(f,g,k){var h=xui.DragDrop.getProfile().offset,d=f.properties.type=="vertical",c=f.box._v2a(f,f.properties.$UIvalue);c[1]=((f.__x+h[d?"y":"x"])/xui.use(k).parent().get(0)[d?"offsetHeight":"offsetWidth"])*100;f.boxing().setUIValue(f.box._adjustValue(f,c),null,null,"drag2")},onDragstop:function(c,d,f){xui(f).onMouseout(true,{$force:true}).onMouseup(true)},onClick:function(){return false}},RULERRIGHT:{onClick:function(g,k,l){var h=g.properties;if(h.disabled||h.readonly){return false}var f=g.boxing(),m=g.box,d=m._v2a(g,h.$UIvalue);if(!h.isRange){d[0]=100}else{d[1]=100}f.setUIValue(g.box._adjustValue(g,d),null,null,"click2")}},DECREASE:{onMousedown:function(c){if(c.properties.disabled||c.properties.readonly){return}c.box._auto(c,false)},onMouseout:function(c){if(c.properties.disabled||c.properties.readonly){return}xui.Thread.abort(c.$xid+":auto")},onMouseup:function(c){if(c.properties.disabled||c.properties.readonly){return}xui.Thread.abort(c.$xid+":auto")}},INCREASE:{onMousedown:function(c){if(c.properties.disabled||c.properties.readonly){return}c.box._auto(c,true)},onMouseout:function(c){if(c.properties.disabled||c.properties.readonly){return}xui.Thread.abort(c.$xid+":auto")},onMouseup:function(c){if(c.properties.disabled||c.properties.readonly){return}xui.Thread.abort(c.$xid+":auto")}},LABEL:{onClick:function(c,d,f){if(c.properties.disabled){return false}if(c.onLabelClick){c.boxing().onLabelClick(c,d,f)}},onDblClick:function(c,d,f){if(c.properties.disabled){return false}if(c.onLabelDblClick){c.boxing().onLabelDblClick(c,d,f)}},onMousedown:function(c,d,f){if(xui.Event.getBtn(d)!="left"){return}if(c.properties.disabled){return false}if(c.onLabelActive){c.boxing().onLabelActive(c,d,f)}}}},DataModel:{position:"absolute",width:{ini:200},height:{ini:50},steps:0,value:"0:0",type:{listbox:["vertical","horizontal"],ini:"horizontal",action:function(c){this.boxing().refresh()}},isRange:{ini:true,action:function(c){this.boxing().refresh()}},showIncreaseHandle:{ini:true,action:function(c){this.boxing().refresh()}},showDecreaseHandle:{ini:true,action:function(c){this.boxing().refresh()}},labelSize:{ini:0,action:function(c){this.getSubNode("LABEL").css({display:c?"":"none",width:(c||0)+"px"});xui.UI.$doResize(this,this.properties.width,this.properties.height,true)}},labelPos:{ini:"left",listbox:["left","top","right","bottom"],action:function(c){xui.UI.$doResize(this,this.properties.width,this.properties.height,true)}},labelGap:{ini:4,action:function(c){xui.UI.$doResize(this,this.properties.width,this.properties.height,true)}},labelCaption:{ini:"",action:function(c){c=(_.isSet(c)?c:"")+"";this.getSubNode("LABEL").html(xui.adjustRes(c,true))}},labelHAlign:{ini:"right",listbox:["","left","center","right"],action:function(c){this.getSubNode("LABEL").css("textAlign",c)}}},EventHandlers:{onLabelClick:function(c,d,f){},onLabelDblClick:function(c,d,f){},onLabelActive:function(c,d,f){}},_prepareData:function(c){var f=arguments.callee.upper.call(this,c),e="display:none";f._showDes=f.showDecreaseHandle?"":e,f._showIns=f.showIncreaseHandle?"":e,f._showD2=f.isRange?"":e;f._cls=c.getClass("BOX",f.type=="vertical"?"-v":"-h");f.labelHAlign=f.labelHAlign?("text-align:"+f.labelHAlign):"";f.labelShow=f.labelSize?"":("display:none");if(f.labelCaption){f.labelCaption=xui.adjustRes(f.labelCaption,true)}return f},_adjustValue:function(d,e){var f=d.properties,c=[];c[0]=parseFloat(e[0])||0;c[1]=parseFloat(e[1])||0;if(f.steps){e=100/f.steps;c[0]=Math.ceil(c[0]/e);if(f.isRange){c[1]=Math.ceil(c[1]/e)}}return f.isRange?c.join(":"):(c[0]+"")},_ensureValue:function(d,m){var c=d.properties,l=String(m).split(":"),f=0,h=c.steps?c.steps:100,k=[],g=function(n){return parseFloat(n)||0},e=function(n){return Math.min(h,Math.max(f,n))};k[0]=g(l[0]);if(c.isRange){k[1]=g(l[1]);if(k[0]>k[1]){l=k[1];k[1]=k[0];k[0]=l}}k[0]=e(k[0]);if(c.isRange){k[1]=e(k[1])}return c.isRange?k.join(":"):(k[0]+"")},_v2a:function(f,d){var c=f.properties.steps,e;d=typeof d=="string"?d.split(":"):d;d[0]=parseFloat(d[0])||0;d[1]=parseFloat(d[1])||0;if(c){d[0]=d[0]*100/c}if(c){d[1]=d[1]*100/c}if(d[0]>d[1]){e=d[0];d[1]=d[0];d[0]=e}return d},_auto:function(g,k){var c=g.$xid+":auto";if(xui.Thread.isAlive(c)){return}var d=g.properties,m,f=(d.steps?100/d.steps:1)*(k?1:-1),e={delay:300},h=g.box._v2a(g,d.$UIvalue),l=function(){h[0]+=f;if(d.isRange){h[1]+=f}g.boxing().setUIValue(g.box._adjustValue(g,h),null,null,"auto");e.delay*=0.8};e.task=l;xui.Thread(c,[e],500,null,l,null,true).start()},_onresize:function(d,C,y){var A=d.properties,g=A.type,D=function(f){return d.getSubNode(f)},u=D("RULER"),l=D("IND"),E=D("RULERLEFT"),B=D("BOX"),h=d.getSubNode("LABEL"),k=A.labelSize||0,F=A.labelGap||0,z=A.labelPos||"left",x,c,G,e;B.cssRegion({left:x=z=="left"?k:0,top:c=z=="top"?k:0,width:G=C===null?null:Math.max(0,(C-((z=="left"||z=="right")?k:0))),height:e=y===null?null:Math.max(0,(y-((z=="top"||z=="bottom")?k:0)))});if(k){h.cssRegion({left:C===null?null:Math.max(0,z=="right"?(C-k+F):0),top:y===null?null:Math.max(0,z=="bottom"?(y-k+F):0),width:C===null?null:Math.max(0,((z=="left"||z=="right")?(k-F):C)),height:y===null?null:Math.max(0,((z=="top"||z=="bottom")?(k-F):y))})}if(g=="vertical"){var r=E.height(),q=A.showDecreaseHandle?D("DECREASE").height():0,n=A.showIncreaseHandle?D("INCREASE").height():0,m=D("IND1").height();if(e){u.top(q+r).height(e-q-n-2*r);l.top(q).height(d._size=e-q-n-m)}}else{var r=E.width(),q=A.showDecreaseHandle?D("DECREASE").width():0,n=A.showIncreaseHandle?D("INCREASE").width():0,m=D("IND1").width();if(G){u.left(q+r).width(G-q-n-2*r);l.left(q).width(d._size=G-q-n-m)}}}}});Class("xui.UI.Input",["xui.UI.Widget","xui.absValue"],{Instance:{_setTB:function(e){var d=this.get(0),g=d.properties,h,c;if(!d.host||!g.tipsBinder){return}var f=d.tips;c=d.tips=d.tips||g.tips||"";h=xui.getObject(g.tipsBinder)||((h=d.host[g.tipsBinder])&&h.get(0));if(h&&(h.key=="xui.UI.Span"||h.key=="xui.UI.Div"||h.key=="xui.UI.SLabel")){if(h.renderId){h.getRootNode().innerHTML=c.charAt(0)=="$"?xui.wrapRes(c):c;h.getRoot().css("color",e==1?"gray":e==2?"red":"#000")}}if(f!==d.tips&&xui.Tips&&xui.Tips.getTips()){xui.Tips.setTips(d.tips)}},activate:function(c){var d=this.get(0);if(d&&d.renderId){var f=d.getSubNode("INPUT").get(0);if(f){try{f.focus();if(!xui.browser.isTouch){try{if(f.tagName.toLowerCase()=="input"||!/[\n\r]/.test(f.value)){f.select()}else{xui(f).caret(0,0)}}catch(g){}}}catch(g){}delete d._justFocus}}return this},_setCtrlValue:function(c){if(_.isNull(c)||!_.isDefined(c)){c=""}return this.each(function(d){if(d.$Mask&&!c){c=d.$Mask}d.$_inner=1;d.getSubNode("INPUT").attr("value",c+"");delete d.$_inner})},_getCtrlValue:function(){var d=this.getSubNode("INPUT"),c=(d&&!d.isEmpty())?this.getSubNode("INPUT").attr("value"):"";if(c.indexOf("\r")!=-1){c=c.replace(/(\r\n|\r)/g,"\n")}if(this.get(0).$Mask&&this.get(0).$Mask==c){c=""}return c},_setDirtyMark:function(){return this.each(function(e){var l=e.properties,c=e.getSubNode("INPUT"),p=e.box,h=e.boxing(),k=xui.UI.$css_tag_dirty,n=xui.UI.$css_tag_invalid,m=l.value!==l.$UIvalue;var g=e.tips;if(e._inValid==2){e.tips=l.tipsErr||l.tips}else{if(e._inValid==1){e.tips=l.tips}else{e.tips=l.tipsOK||l.tips}}if(g!==e.tips&&xui.Tips&&xui.Tips.getTips()){xui.Tips.setTips(e.tips)}if(e._dirtyFlag!==m){if(l.dirtyMark&&l.showDirtyMark){if(e.beforeDirtyMark&&false===h.beforeDirtyMark(e,m)){}else{if(e._dirtyFlag=m){c.addClass(k)}else{c.removeClass(k)}}}e._dirtyFlag=m}if(e.beforeFormatMark&&false===h.beforeFormatMark(e,e._inValid==2)){}else{var f=e.getSubNode("ERROR");if(e._inValid==2){c.addClass(n);f.css("display","block")}else{c.removeClass(n);f.css("display","none")}}h._setTB(e._inValid)})}},Initialize:function(){var c=this.getTemplate();_.merge(c.FRAME.BORDER,{style:"",LABEL:{className:"{_required}",style:"{labelShow};width:{labelSize}px;{labelHAlign}",text:"{labelCaption}"},BOX:{WRAP:{tagName:"div",INPUT:{tagName:"input",type:"{_type}",maxlength:"{maxlength}",tabindex:"{tabindex}",placeholder:"{placeholder}",style:"{_css};{hAlign};"}}}},"all");c.FRAME.ERROR={};this.setTemplate(c)},Static:{_syncResize:true,_maskMap:{"~":"[+-]","1":"[0-9]",a:"[A-Za-z]",u:"[A-Z]",l:"[a-z]","*":"[A-Za-z0-9]"},_maskSpace:"_",Appearances:{KEY:{"font-family":'"Verdana", "Helvetica", "sans-serif"',position:"relative"},BORDER:{"line-height":"0px","font-size":"0px"},LABEL:{"z-index":1,top:0,left:0,position:"absolute","padding-top":"4px","font-size":"12px"},WRAP:{left:0,position:"absolute",overflow:(xui.browser.gek&&xui.browser.ver<3)?"auto":"hidden"},BOX:{left:0,top:0,position:"absolute","background-image":xui.UI.$bg("inputbg.gif","","Input"),"background-repeat":"repeat-x","background-color":"#fff",border:"solid 1px #B5B8C8","z-index":10},"BOX-focus, BOX-mouseover":{"border-color":"#7EADD9"},INPUT:{"padding-top":"2px","padding-left":"2px","padding-right":"2px","background-color":"transparent","background-image":xui.browser.ie?"url(.)":null,border:0,margin:0,"margin-top":xui.browser.ie?"-1px":null,"font-size":"12px",position:"relative",width:"102px",overflow:"auto","overflow-y":"auto","overflow-x":"hidden",resize:"none"},ERROR:{width:"9px",height:"9px",position:"absolute",right:"2px",top:"2px",display:"none","font-size":0,"background-image":xui.UI.$bg("icons.gif","",true),"background-repeat":"no-repeat","background-position":"left -244px","z-index":"50"},".setting-xui-input":{"border-style":"solid","border-top-width":"1px","border-bottom-width":"1px","border-left-width":"1px","border-right-width":"1px"},"KEY-b-t":{height:"2px",top:"-1px","background-image":xui.UI.$bg("vertical.gif","","Input"),"background-repeat":"repeat-x","background-position":"left top"},"KEY-b-b":{height:"2px",bottom:"-1px","background-image":xui.UI.$bg("vertical.gif","","Input"),"background-repeat":"repeat-x","background-position":"left bottom"},"BOX-focus KEY-b-t, BOX-focus KEY-b-b, BOX-mouseover KEY-b-t, BOX-mouseover KEY-b-b":{$order:1,"background-image":xui.UI.$bg("vertical_mouseover.gif","","Input")},"KEY-b-l":{width:"2px",left:"-1px","background-image":xui.UI.$bg("horizontal.gif","","Input"),"background-repeat":"repeat-y","background-position":"left top"},"KEY-b-r":{width:"2px",right:"-1px","background-image":xui.UI.$bg("horizontal.gif","","Input"),"background-repeat":"repeat-y","background-position":"right top"},"BOX-focus KEY-b-l, BOX-focus KEY-b-r, BOX-mouseover KEY-b-l, BOX-mouseover KEY-b-r":{$order:1,"background-image":xui.UI.$bg("horizontal_mouseover.gif","","Input")},"KEY-b-lt":{width:"2px",height:"2px",left:"-1px",top:"-1px","background-image":xui.UI.$bg("corner.gif","","Input"),"background-repeat":"no-repeat","background-position":"left top"},"KEY-b-rt":{width:"2px",height:"2px",right:"-1px",top:"-1px","background-image":xui.UI.$bg("corner.gif","","Input"),"background-repeat":"no-repeat","background-position":"right top"},"KEY-b-rb":{width:"2px",height:"2px",right:"-1px",bottom:"-1px","background-image":xui.UI.$bg("corner.gif","","Input"),"background-repeat":"no-repeat","background-position":"right bottom"},"KEY-b-lb":{width:"2px",height:"2px",left:"-1px",bottom:"-1px","background-image":xui.UI.$bg("corner.gif","","Input"),"background-repeat":"no-repeat","background-position":"left bottom"},"BOX-focus KEY-b-lt, BOX-focus KEY-b-rt, BOX-focus KEY-b-rb, BOX-focus KEY-b-lb, BOX-mouseover KEY-b-lt, BOX-mouseover KEY-b-rt, BOX-mouseover KEY-b-rb, BOX-mouseover KEY-b-lb":{$order:1,"background-image":xui.UI.$bg("corner_mouseover.gif","","Input")}},Behaviors:{HoverEffected:{BOX:["BOX"]},NavKeys:{INPUT:1},LABEL:{onClick:function(c,d,f){if(c.properties.disabled){return false}if(c.onLabelClick){c.boxing().onLabelClick(c,d,f)}},onDblClick:function(c,d,f){if(c.properties.disabled){return false}if(c.onLabelDblClick){c.boxing().onLabelDblClick(c,d,f)}},onMousedown:function(c,d,f){if(xui.Event.getBtn(d)!="left"){return}if(c.properties.disabled){return false}if(c.onLabelActive){c.boxing().onLabelActive(c,d,f)}}},INPUT:{onChange:function(f,k,m){if(f.$_onedit||f.$_inner||f.destroyed||!f.box){return}var h=f.properties,d=f.box,l=f._inValid,c=f.boxing(),g=xui.use(m).get(0).value;if(f.$Mask&&f.$Mask==g){g=""}c.setUIValue(g,null,null,"onchange");if(h.$UIvalue!==g){c._setCtrlValue(h.$UIvalue)}if(l!==f._inValid){if(f.renderId){c._setDirtyMark()}}d._asyCheck(f)},onKeydown:function(h,n,q){var l=h.properties,d=h.box,c=l.multiLines,f=xui.Event,g=f.getKey(n);if(l.disabled||l.readonly){return}if(g.key=="enter"&&(!c||g.altKey)){xui.use(q).onChange()}d._asyCheck(h);if(l.mask){if(g.key.length>1){h.$ignore=true}else{delete h.$ignore}switch(g.key){case"backspace":d._changeMask(h,xui.use(q).get(0),"",false);return false;case"delete":d._changeMask(h,xui.use(q).get(0),"");return false}}},onKeypress:function(g,l,c){var f=g.properties,n=g.box,r=g.box,d=r._maskMap,h=xui.Event.getKey(l),q,m=xui.use(c).caret();if(g.beforeKeypress&&false===g.boxing().beforeKeypress(g,m,h,l,c)){return false}q=g.CF.beforeKeypress||g.$beforeKeypress;if(q&&false===q(g,m,h,l,c)){return false}n._asyCheck(g);if(f.mask){if(g.$ignore){delete g.$ignore;return true}if(h.ctrlKey||h.altKey){return true}r._changeMask(g,xui.use(c).get(0),h.key,true);return false}},onKeyup:function(d,h,k){var g=d.properties,c=d.box;if(xui.Event.getKey(h).key=="esc"){d.boxing()._setCtrlValue(g.$UIvalue);if(d.onCancel){d.boxing().onCancel(d)}}if(g.dynCheck){var f=xui.use(k).get(0).value;d.box._checkValid(d,f);d.boxing()._setDirtyMark()}c._asyCheck(d)},onMousedown:function(c,d,f){c._mousedownmark=1;_.asyRun(function(){if(c){delete c._mousedownmark}})},onMouseup:function(c,f,g){if(c.properties.selectOnFocus&&c._justFocus){var d=xui.use(g).get(0);if(!d.readOnly&&d.select){c.$mouseupDelayFun=_.asyRun(function(){delete c.$mouseupDelayFun;if(!xui.browser.isTouch){if(d.tagName.toLowerCase()=="input"||!/[\n\r]/.test(d.value)){d.select()}}})}delete c._justFocus}if(c._activedonmousedown){delete c._activedonmousedown;var d=xui.use(g).get(0);if(d.tagName.toLowerCase()=="input"||!/[\n\r]/.test(d.value)){d.select()}}},onFocus:function(d,k,l){var h=d.properties,c=d.box;if(h.disabled||h.readonly){return false}if(d.onFocus){d.boxing().onFocus(d)}d.getSubNode("BORDER").tagClass("-focus");var f=xui.use(l).get(0);if(h.mask){var g=f.value;if(!g){d.$focusDelayFun=_.asyRun(function(){if(!d.box){return}delete d.$focusDelayFun;d.$_inner=true;f.value=d.$Mask;delete d.$_inner;c._setCaret(d,f)})}}if(h.selectOnFocus&&!f.readOnly&&f.select){if(xui.browser.kde){d.$focusDelayFun2=_.asyRun(function(){delete d.$focusDelayFun2;if(!xui.browser.isTouch){if(f.tagName.toLowerCase()=="input"||!/[\n\r]/.test(f.value)){f.select()}}})}else{if(!xui.browser.isTouch){if(f.tagName.toLowerCase()=="input"||!/[\n\r]/.test(f.value)){f.select()}}}if(d._mousedownmark){d._justFocus=1}}d.boxing()._setTB(3);c._asyCheck(d)},onBlur:function(d,h,k){_.resetRun(d.$xid+":asycheck");if(d.$focusDelayFun){_.clearTimeout(d.$focusDelayFun)}if(d.$focusDelayFun2){_.clearTimeout(d.$focusDelayFun2)}if(d.$focusDelayFun2){_.clearTimeout(d.$mouseupDelayFun)}var g=d.properties,c=d.box;if(g.disabled||g.readonly){return false}if(d.onBlur){d.boxing().onBlur(d)}if(d.destroyed){return false}d.getSubNode("BORDER").tagClass("-focus",false);var f=xui.use(k).get(0).value;if(d.$Mask&&d.$Mask==f){f=""}if(g.$UIvalue==f){d.box._checkValid(d,f)}d.boxing()._setDirtyMark();c._asyCheck(d,false)}}},DataModel:{selectable:true,border:false,tipsErr:"",tipsOK:"",dynCheck:false,selectOnFocus:true,placeholder:{ini:"",action:function(c){this.getSubNode("INPUT").attr("placeholder",c)}},labelSize:{ini:0,action:function(c){this.getSubNode("LABEL").css({display:c?"":"none",width:(c||0)+"px"});xui.UI.$doResize(this,this.properties.width,this.properties.height,true)}},labelPos:{ini:"left",listbox:["left","top","right","bottom"],action:function(c){xui.UI.$doResize(this,this.properties.width,this.properties.height,true)}},labelGap:{ini:4,action:function(c){xui.UI.$doResize(this,this.properties.width,this.properties.height,true)}},labelCaption:{ini:"",action:function(c){c=(_.isSet(c)?c:"")+"";this.getSubNode("LABEL").html(xui.adjustRes(c,true))}},labelHAlign:{ini:"right",listbox:["","left","center","right"],action:function(c){this.getSubNode("LABEL").css("textAlign",c)}},valueFormat:{helpinput:[{caption:"required",id:"[^.*]"},{caption:"email",id:"^[\\w\\.=-]+@[\\w\\.-]+\\.[\\w\\.-]{2,4}$"},{caption:"charOnly",id:"^[a-zA-Z]*$"},{caption:"words",id:"^[\\w ]*$"},{caption:"integer",id:"^-?\\d\\d*$"},{caption:"positiveInteger",id:"^\\d\\d*$"},{caption:"number",id:"^-?(\\d\\d*\\.\\d*$)|(^-?\\d\\d*$)|(^-?\\.\\d\\d*$)"},{caption:"filepath",id:"([\\/]?[\\w_]+)+\\.\\w{1,9}$"},{caption:"URL",id:"^(http|https|ftp)\\:\\/\\/[\\w\\-\\_\\.]+[\\w\\-\\_](:[\\w]*)?\\/?([\\w\\-\\._\\?\\,\\'\\/\\\\\\+&amp;%\\$#\\=~])*$"},{caption:"color",id:"^\\#[0-9A-Fa-f]{6}$"},{caption:"HH:MM",id:"^(([0-1][0-9])|([2][0-3])):([0-5][0-9])$"},{caption:"HH:MM:SS",id:"^(([0-1][0-9])|([2][0-3])):([0-5][0-9])\\:([0-5][0-9])$"},{caption:"YYYY-MM-DD",id:"^([0-9]{4})\\-(([0][0-9])|([1][0-2]))\\-([0-3][0-9])$"},{caption:"DD/MM/YYYY",id:"^(([0-2][0-9])|([3][0-1]))/(([0][0-9])|([1][0-2]))/([0-9]{4})$"}]},mask:{action:function(e){var d=this,c=d.box;if(e){d.$MaskFormat=function(l,k){var g=l._maskMap,h=[],n=/[A-Za-z0-9]/;_.arr.each(k.split(""),function(p,m){h.push(g[p]||(n.test(p)?"":"\\")+p)});return"^"+h.join("")+"$"}(c,e);d.$Mask=function(n,k){var g=n._maskMap,h=[],l=n._maskSpace;_.arr.each(k.split(""),function(p,m){h.push(g[p]?l:p)});return h.join("")}(c,e);var f=d.properties.$UIvalue;f=_.isSet(f)?(f+""):"";d.boxing()._setCtrlValue(f+d.$Mask.slice(f.length))}else{delete d.$MaskFormat;delete d.$Mask}}},value:"",width:120,height:22,disabled:{ini:false,action:function(d){var e=this.getSubNode("INPUT"),c="xui-ui-disabled";if(d){this.getRoot().addClass(c)}else{this.getRoot().removeClass(c)}if((""+e.get(0).type).toLowerCase()!="button"){if(!d&&this.properties.readonly){d=true}e.attr("readonly",d)}}},hAlign:{ini:"",listbox:["","left","center","right"],action:function(c){this.getSubNode("INPUT").css("textAlign",c)}},readonly:{ini:false,action:function(d){var e=this.getSubNode("INPUT"),c="xui-ui-readonly";if(d){this.getRoot().addClass(c)}else{this.getRoot().removeClass(c)}if((""+e.get(0).type).toLowerCase()!="button"){if(!d&&this.properties.disabled){d=true}e.attr("readonly",d)}}},type:{ini:"text",listbox:["text","password"],set:function(c){var d=this;d.properties.type=c;if(d.renderId){d.boxing().refresh(true)}}},maxlength:{ini:-1,action:function(c){this.getSubNode("INPUT").attr("maxlength",c)}},multiLines:{ini:false,action:function(c){this.boxing().refresh()}},tipsBinder:{ini:"",set:function(c){if(c["xui.UIProfile"]){c=c.$xid}if(c["xui.UI"]&&(c=c.get(0))){c=c.$xid}this.properties.tipsBinder=c+""}}},EventHandlers:{onFocus:function(c){},onBlur:function(c){},onCancel:function(c){},beforeFormatCheck:function(c,d){},beforeFormatMark:function(c,d){},beforeKeypress:function(d,h,c,f,g){},onLabelClick:function(c,d,f){},onLabelDblClick:function(c,d,f){},onLabelActive:function(c,d,f){}},_prepareData:function(c){var e=arguments.callee.upper.call(this,c);e._type=e.type||"";if(e.maxlength<0){e.maxlength=""}if(xui.browser.kde){e._css="resize:none;"}e.hAlign=e.hAlign?("text-align:"+e.hAlign):"";e.labelHAlign=e.labelHAlign?("text-align:"+e.labelHAlign):"";e.labelShow=e.labelSize?"":("display:none");if(e.labelCaption){e.labelCaption=xui.adjustRes(e.labelCaption,true)}return e},_dynamicTemplate:function(f){var d=f.properties,c,g=f._exhash="$multiLines:"+d.multiLines,e=f.box.getTemplate(g);d.$UIvalue=d.value;if(!e){e=_.clone(f.box.getTemplate());if(d.multiLines){c=e.FRAME.BORDER.BOX.WRAP.INPUT;c.tagName="textarea";delete c.type}f.box.setTemplate(e,g)}f.template=e},_ensureValue:function(c,d){return""+(_.isSet(d)?d:"")},RenderTrigger:function(){var d=this,g=d.properties;_.asyRun(function(){if(d.box){d.boxing()._setTB(1)}});d.getSubNode("WRAP").$firfox2();if(g.readonly){d.boxing().setReadonly(true,true)}if(g.tipsBinder){d.boxing().setTipsBinder(g.tipsBinder,true)}var k=xui.browser.ie,h=d.getSubNode("INPUT").get(0),c=d.box,e=function(f){if(k&&("propertyName" in f)&&f.propertyName!="value"){return}c._asyCheck(d,false)};if(k&&h.attachEvent){h.attachEvent("onpropertychange",e);h.attachEvent("ondrop",e);d.$ondestory=function(){var f=this.getSubNode("INPUT").get(0);if(f){f.detachEvent("onpropertychange",e);f.detachEvent("ondrop",e)}f=e=null}}else{h.addEventListener("input",e,false);h.addEventListener("drop",e,false);if(xui.browser.gek){h.addEventListener("dragdrop",e,false)}d.$ondestory=function(){var f=this.getSubNode("INPUT").get(0);if(f){f.removeEventListener("input",e,false);f.removeEventListener("drop",e,false);if(xui.browser.gek){f.removeEventListener("dragdrop",e,false)}}f=e=null}}h=null},LayoutTrigger:function(){var c=this.properties;if(c.mask){this.boxing().setMask(c.mask,true)}},_changeMask:function(f,h,k,u,d){if(false!==d){var C=this,r=f.properties,B=C._maskMap,w=C._maskSpace,c=r.mask,e=f.$Mask,l=xui(h),m=l.caret();if(u===false&&m[0]==m[1]&&m[0]>0){l.caret(m[0]-1,m[0])}if(u===undefined&&m[0]==m[1]){l.caret(m[0],m[0]+1)}if(u===true){if(e.charAt(m[0])!=w){var y=m[0]+e.substr(m[0],e.length).indexOf(w);l.caret(y,Math.max(m[1],y))}}var m=l.caret(),x=h.value,q=r.mask.charAt(m[0]),g=C._maskMap[q],z,n;if(g&&k&&k.length==1){if(q=="l"){k=k.toLowerCase()}else{if(q=="u"){k=k.toUpperCase()}}}if(g&&new RegExp("^"+g+"$").test(k)||k==""){n=x;if(m[0]!=m[1]){n=n.substr(0,m[0])+e.substr(m[0],m[1]-m[0])+n.substr(m[1],n.length-m[1])}if(k){n=n.substr(0,m[0])+k+n.substr(m[0]+1,n.length-m[0]-1)}var A=[];_.arr.each(c.split(""),function(D,p){A.push((new RegExp("^"+(B[D]?B[D]:"\\"+D)+"$").test(n.charAt(p)))?n.charAt(p):e.charAt(p))});if(u===true){k=e.substr(m[0]+1,x.length-m[0]-1);z=k.indexOf(w);z=m[0]+(z==-1?0:z)+1}else{z=m[0]}if(xui.browser.opr){if(u===undefined){_.arr.insertAny(A,w,z)}if(u===false){_.arr.insertAny(A,w,z++)}}x=A.join("");h.value=x;f.boxing().setUIValue(x==e?"":x,null,null,"mask");C._setCaret(f,h,z)}}else{var C=this,r=f.properties,B=C._maskMap,c=r.mask,e=f.$Mask,n=h.value,A=[];_.arr.each(c.split(""),function(D,p){A.push((new RegExp("^"+(B[D]?B[D]:"\\"+D)+"$").test(n.charAt(p)))?n.charAt(p):e.charAt(p))});x=A.join("");h.value=x;f.boxing().setUIValue(x==e?"":x,null,null,"mask")}},_setCaret:function(c,d,e){if(c.properties.mask){if(typeof e!="number"){e=d.value.indexOf(this._maskSpace)}xui(d).caret(e,e)}},_checkValid2:function(c){if(!c.renderId){return true}return this._checkValid(c,c.getSubNode("INPUT").get(0).value)},_checkValid:function(e,f){var g=e.properties,d=(g.mask&&e.$MaskFormat),c=g.valueFormat||e.$valueFormat;if((e.beforeFormatCheck&&(e.boxing().beforeFormatCheck(e,f)===false))||(((f&&f.length)&&e.$Mask!==f)&&(d&&typeof d=="string"&&!(new RegExp(d)).test((f===0?"0":f)||"")))||(c&&typeof c=="string"&&!(new RegExp(c)).test((f===0?"0":f)||""))){e._inValid=2;return false}e._inValid=3;return true},_asyCheck:function(d,c){if(d.destroyed){return}if(!d.properties.dynCheck&&!d.properties.mask){return}_.resetRun(d.$xid+":asycheck",function(){if(!d.renderId){return}var f=d.getSubNode("INPUT"),g=f.get(0);if(!g){return}if(d.properties.mask){if(g.value.length!=d.$Mask.length){d.box._changeMask(d,g,"",true,c)}}if(d.properties.dynCheck){var e=g.value;if(d.$Mask&&d.$Mask==e){e=""}d.boxing().setUIValue(e,false,true,null,"asycheck")}})},_onresize:function(f,w,q){var A=1,d=1,k=xui.UI.$getCSSValue("xui-input-input","paddingTop"),c=xui.UI.$getCSSValue("xui-input-input","paddingLeft"),x=xui.UI.$getCSSValue("xui-input-input","paddingRight");var n=f.properties,u=f.getSubNode("BOX"),l=f.getSubNode("LABEL"),m=n.labelSize||0,y=n.labelGap||0,r=n.labelPos||"left",e=f.getSubNode("INPUT"),z=w,g=q,h=Math.max(0,(n.$b_lw||0)-A),p=Math.max(0,(n.$b_tw||0)-d);if(null!==z){z-=Math.max(A*2,(n.$b_lw||0)+(n.$b_rw||0));if(xui.browser.ie6){z=(parseInt(z/2,10))*2}}if(null!==g){g-=Math.max(d*2,(n.$b_lw||0)+(n.$b_rw||0));if(xui.browser.ie6){g=(parseInt(g/2,10))*2}if(xui.browser.ie6&&null===w){u.ieRemedy()}}u.cssRegion({left:h+(r=="left"?m:0),top:p+(r=="top"?m:0),width:z===null?null:Math.max(0,(z-((r=="left"||r=="right")?m:0))),height:g===null?null:Math.max(0,(g-((r=="top"||r=="bottom")?m:0)))});if(m){l.cssRegion({left:z===null?null:Math.max(0,r=="right"?(z-m+y):0),top:q===null?null:Math.max(0,r=="bottom"?(q-m+y):0),width:z===null?null:Math.max(0,((r=="left"||r=="right")?(m-y):z)),height:q===null?null:Math.max(0,((r=="top"||r=="bottom")?(m-y):q))})}if(z||g){e.cssSize({width:z?Math.max(0,(z-c-x-((r=="left"||r=="right")?m:0))):null,height:g?Math.max(0,(g-k-((r=="top"||r=="bottom")?m:0))):null})}if((f.$border||f.$shadow||f.$resizer)&&xui.browser.ie){u.ieRemedy()}}}});Class("xui.UI.HiddenInput",["xui.UI","xui.absValue"],{Instance:{activate:function(){return this},_setCtrlValue:function(c){if(_.isNull(c)||!_.isDefined(c)){c=""}return this.each(function(d){d.getSubNode("KEY").attr("value",c+"")})},_getCtrlValue:function(){var c=this.getSubNode("KEY");if(v.indexOf("\r")!=-1){v=v.replace(/(\r\n|\r)/g,"\n")}return v}},Static:{$initRootHidden:true,Templates:{className:"xui-display-none",style:"display:none",tagName:"input",type:"hidden"},DataModel:{locked:null,required:null,dataBinder:null,dataField:null,display:null,visibility:null,position:null,left:null,top:null,right:null,bottom:null,width:null,height:null,rotate:null,showEffects:null,hideEffects:null,activeAnim:null,tabindex:null,zIndex:null,defaultFocus:null,hoverPop:null,hoverPopType:null,disabled:null,readonly:null,disableClickEffect:null,disableHoverEffect:null,dock:null,dockOrder:null,dockMargin:null,dockMinW:null,dockMinH:null,dockMaxW:null,dockMaxH:null,dockFloat:null,dockIgnore:null,dirtyMark:null,showDirtyMark:null,selectable:null,autoTips:null,tips:null,disableTips:null,renderer:null,className:null},EventHandlers:{beforeDirtyMark:null,onContextmenu:null,onDock:null,onLayout:null,onMove:null,onRender:null,onResize:null,onShowTips:null,beforeAppend:null,afterAppend:null,beforeRender:null,afterRender:null,beforeRemove:null,afterRemove:null,onHotKeydown:null,onHotKeypress:null,onHotKeyup:null},_ensureValue:function(c,d){return""+(_.isSet(d)?d:"")}}});Class("xui.UI.RichEditor",["xui.UI","xui.absValue"],{Initialize:function(){this.addTemplateKeys(["TOOLBARBTN"])},Instance:{getEditorWin:function(){return this.get(0).$win},getEditorDoc:function(){return this.get(0).$doc},getEditorBody:function(){var c=this.get(0).$doc;return c&&(c.body||c.documentElement)},_setCtrlValue:function(c){if(!_.isSet(c)){c=""}return this.each(function(f){var g=window["/"];if(g&&g.indexOf(":/")!=-1){c=c.replace(/{\/}/g,g)}var e=xui.adjustRes(c,0,1);if(!f.$inDesign){var h=f.$doc,d=h&&(h.body||h.documentElement);if(d){d.innerHTML=e;return}}f.getSubNode("EDITOR").html(e)})},_getCtrlValue:function(){var e=this.get(0);if(!e.$inDesign){var g=e.$doc,c=g&&(g.body||g.documentElement);if(c){var d=c.innerHTML,f=window["/"];if(f&&f.indexOf(":/")!=-1){d=d.replace(new RegExp(f,"g"),"{/}")}return d}else{return""}}else{return e.getSubNode("EDITOR").html()}},_setDirtyMark:function(){return arguments.callee.upper.apply(this,["MARK"])}},Static:{Templates:{tagName:"div",style:"{_style}",className:"{_className} xui-ui-selectable",LABEL:{className:"{_required}",style:"{labelShow};width:{labelSize}px;{labelHAlign}",text:"{labelCaption}"},BOX:{EDITOR:{tagName:"div"},MARK:{},POOL:{}}},DataModel:{selectable:true,value:{ini:"",html:1},width:400,height:300,frameTemplate:{ini:'<html style="-webkit-overflow-scrolling: touch;padding:0;margin:0;"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"><style type="text/css">body{height: 100%;-webkit-overflow-scrolling: touch;border:0;padding:0;margin:6px;cursor:text;background:#fff;color:#000;font-family:sans-serif,Arial,Verdana,"Trebuchet MS";font-style:normal;font-weight:normal;font-size:12px;line-height:1.6}div, p{margin:0;padding:0;} body, p, div{word-wrap: break-word;} img, input, textarea{cursor:default;}</style></head><body scroll="auto" spellcheck="false"></body></html>',action:function(){this.boxing().refresh()}},frameStyle:"",cmdList:{ini:"font1;font2;align;list;font4;font3;insert;clear;html",action:function(c){var d=this;if(!d.properties.disabled&&!d.properties.readonly){d.box._iniToolBar(d)}}},cmdFilter:{ini:""},disabled:{ini:false,action:function(c){var c=this.properties.disabled||this.properties.readonly,d=this.$doc;if(d){if(d.body.contentEditable!=undefined&&xui.browser.ie){d.body.contentEditable=c?"false":"true"}else{d.designMode=c?"off":"on"}this.box._iniToolBar(this,!c)}}},readonly:{ini:false,action:function(c){this.boxing().setDisabled(c)}},labelSize:{ini:0,action:function(c){this.getSubNode("LABEL").css({display:c?"":"none",width:(c||0)+"px"});xui.UI.$doResize(this,this.properties.width,this.properties.height,true)}},labelPos:{ini:"left",listbox:["left","top","right","bottom"],action:function(c){xui.UI.$doResize(this,this.properties.width,this.properties.height,true)}},labelGap:{ini:4,action:function(c){xui.UI.$doResize(this,this.properties.width,this.properties.height,true)}},labelCaption:{ini:"",action:function(c){c=(_.isSet(c)?c:"")+"";this.getSubNode("LABEL").html(xui.adjustRes(c,true))}},labelHAlign:{ini:"right",listbox:["","left","center","right"],action:function(c){this.getSubNode("LABEL").css("textAlign",c)}}},Appearances:{KEY:{overflow:"hidden"},BOX:{left:0,top:0,width:"100%",position:"absolute",overflow:"hidden"},POOL:{position:"absolute",display:"none"},MARK:{position:"absolute",width:"12px",height:"12px"},TOOLBARBTN:{background:xui.UI.$bg("toolbar.gif","no-repeat")},LABEL:{"z-index":1,top:0,left:0,position:"absolute","padding-top":"4px","font-size":"12px"},EDITOR:{position:"absolute",display:"block",left:0,top:0,width:"100%",height:"100%",padding:0,margin:0,border:"1px solid #648CB4","background-color":"#fff","z-index":"0"}},Behaviors:{onSize:xui.UI.$onSize,LABEL:{onClick:function(c,d,f){if(c.properties.disabled){return false}if(c.onLabelClick){c.boxing().onLabelClick(c,d,f)}},onDblClick:function(c,d,f){if(c.properties.disabled){return false}if(c.onLabelDblClick){c.boxing().onLabelDblClick(c,d,f)}},onMousedown:function(c,d,f){if(xui.Event.getBtn(d)!="left"){return}if(c.properties.disabled){return false}if(c.onLabelActive){c.boxing().onLabelActive(c,d,f)}}}},EventHandlers:{onInnerEvent:function(d,c,f,g){},onUpdateToolbar:function(c,d,e){},onReady:function(c){},onLabelClick:function(c,d,f){},onLabelDblClick:function(c,d,f){},onLabelActive:function(c,d,f){}},$cmds:{font1:[{id:"bold",command:"Bold",statusButton:true,imagePos:"-36px 0"},{id:"italic",command:"Italic",statusButton:true,imagePos:"-108px 0"},{id:"underline",command:"Underline",statusButton:true,imagePos:"-324px 0"},{id:"strikethrough",command:"strikeThrough",statusButton:true,imagePos:"-252px 0"}],font2:[{id:"subscript",command:"subscript",statusButton:true,imagePos:"-270px 0"},{id:"superscript",command:"superscript",statusButton:true,imagePos:"-288px 0"}],font3:[{id:"forecolor",command:"custom",imagePos:"0 0"},{id:"bgcolor",command:"custom",imagePos:"-18px 0"}],font4:[{id:"fontsize",command:"custom",caption:"$editor.fontsize",dropButton:true},{id:"fontname",command:"custom",caption:"$editor.fontname",dropButton:true},{id:"formatblock",command:"custom",caption:"$editor.formatblock",dropButton:true}],align:[{id:"left",command:"justifyleft",imagePos:"-144px 0"},{id:"center",command:"justifycenter",imagePos:"-54px 0"},{id:"right",command:"justifyright",imagePos:"-216px 0"},{id:"justify",command:"justifyfull",imagePos:"-126px 0"}],list:[{id:"indent",command:"indent",imagePos:"-90px 0"},{id:"outdent",command:"outdent",imagePos:"-180px 0"},{id:"ol",command:"insertorderedlist",imagePos:"-162px 0"},{id:"ul",command:"insertunorderedlist",imagePos:"-306px 0"}],insert:[{id:"hr",command:"insertHorizontalRule",imagePos:"-72px 0"},{id:"insertimage",command:"custom",imagePos:"-342px 0"},{id:"createlink",command:"custom",imagePos:"-360px 0"},{id:"unlink",command:"unlink",imagePos:"-378px 0"}],clear:[{id:"removeformat",command:"removeformat",imagePos:"-198px 0"}],html:[{id:"html",command:"custom",imagePos:"-234px 0"}]},_prepareData:function(c){var e=arguments.callee.upper.call(this,c);e.labelHAlign=e.labelHAlign?("text-align:"+e.labelHAlign):"";e.labelShow=e.labelSize?"":("display:none");if(e.labelCaption){e.labelCaption=xui.adjustRes(e.labelCaption,true)}return e},_updateToolbar:function(f,k,r){var e=xui.$cache.profileMap[f],n;if(!e){return}if(e.properties.disabled||e.properties.readonly){return}if(e&&(n=e.$toolbar)){var p=e.$doc,l=k?false:p.queryCommandState("bold"),h=k?false:p.queryCommandState("italic"),d=k?false:p.queryCommandState("underline"),c=k?false:p.queryCommandState("strikethrough"),m=k?false:p.queryCommandState("subscript"),q=k?false:p.queryCommandState("superscript"),g=n.boxing();g.updateItem("bold",{value:l});g.updateItem("italic",{value:h});g.updateItem("underline",{value:d});g.updateItem("strikethrough",{value:c});g.updateItem("subscript",{value:m});g.updateItem("superscript",{value:q});if(e.onUpdateToolbar){e.boxing().onUpdateToolbar(e,r,p)}p=null}},RenderTrigger:function(){var q=this;if(!q.properties.disabled&&!q.properties.readonly){q.box._iniToolBar(q)}if(!q.$inDesign){var p=q.getSubNode("EDITOR").get(0),g=q.$domId,u=q.properties.frameTemplate,x=q.properties.frameStyle,r=p.id;if(x){u=u.replace(/<\s*\/\s*head\s*>/,"<style>"+(x||"")+"</style></head>")}if(!q.$once){q.$once=true;try{var k=q.$ifr=document.createElement("IFRAME")}catch(y){var k=q.$ifr=document.createElement("<iframe name='"+r+"' id='"+r+"'></iframe>")}var n=this,c=q._eventOutput=function(B){if(n&&(n.properties.disabled||n.properties.readonly)){return}if(n.onInnerEvent){return n.boxing().onInnerEvent(n,B.type,xui.Event.getSrc(B),B)}},w=q._event=function(D){if(n&&(n.properties.disabled||n.properties.readonly)){return}if(D.type!=="mouseover"&&D.type!=="mouseout"){_.resetRun("RichEditor:"+g,function(){if(!n.box){return}xui.UI.RichEditor._updateToolbar(g,false,D.type)},100);if(D.type=="mousedown"){if(xui.browser.applewebkit&&D.target.tagName=="IMG"){var C=q.$win.getSelection(),B=q.$doc.createRange();B.selectNode(D.target);C.removeAllRanges();C.addRange(B)}xui.doc.onMousedown(true)}}if(n.onInnerEvent){return n.boxing().onInnerEvent(n,D.type,xui.Event.getSrc(D),D)}},l=q._event2=function(B){if(n&&(n.properties.disabled||n.properties.readonly)){return}if(n.onInnerEvent){_.resetRun(n.$xid+":frmInnerAsyEvent",function(){if(n&&!n.destroyed){n.boxing().onInnerEvent(n,B.type,xui.Event.getSrc(B),B)}})}},d=function(B){if(!n){return}if(n.properties.disabled||n.properties.readonly){return}n.box._onchange(n)},h=function(C){if(!n){return}if(n.properties.disabled||n.properties.readonly){return}_.resetRun("RichEditor:"+g,function(){if(!n.box){return}xui.UI.RichEditor._updateToolbar(g,true,"blur")},100);if(n._onchangethread){clearInterval(n._onchangethread);n._onchangethread=null;if(n&&n.box){n.box._checkc(n)}}var B=n.boxing()._getCtrlValue();n.boxing().setUIValue(B,null,null,"blur")},m=function(C){if(n){var B=n.boxing();_.asyRun(function(){if(!n.box){return}B.refresh()})}},A,f,z=function(){_.setTimeout(function(){if(!frames[r]){return}if(!frames[r].document){return}if(q.$win!=frames[r].window){f=q.$win=frames[r].window;A=q.$doc=f.document;A.open();A.write(u);A.close();try{A.execCommand("styleWithCSS",0,false)}catch(D){try{A.execCommand("useCSS",0,true)}catch(D){}}var B=q.properties.disabled||q.properties.readonly;if(A.body.contentEditable!=undefined&&xui.browser.ie){A.body.contentEditable=B?"false":"true"}else{A.designMode=B?"off":"on"}if(B){q.box._iniToolBar(q,false)}f._gekfix=m;if(xui.browser.ie&&A.attachEvent){A.attachEvent("unload",m);if(!B){A.attachEvent("onmousedown",w);A.attachEvent("ondblclick",w);A.attachEvent("onclick",w);A.attachEvent("oncontextmenu",c);A.attachEvent("onkeyup",w);A.attachEvent("onkeydown",w);A.attachEvent("onmouseover",w);A.attachEvent("onmouseout",w);A.attachEvent("onmousemove",l);f.attachEvent("onfocus",d);f.attachEvent("onblur",h);(q.$beforeDestroy=(q.$beforeDestroy||{}))["ifmClearMem"]=function(){var J=this.$win,I=this.$doc,G=this._event,F=this._event2;if(this._onchangethread){clearInterval(this._onchangethread);this._onchangethread=null}try{var E=I.designMode;I.designMode="off";I.designMode="on";I.designMode=E}catch(H){}J._gekfix=undefined;try{I.detachEvent("unload",J._gekfix)}catch(H){}if(!this.properties.disabled&&!this.properties.readonly){I.detachEvent("onmousedown",G);I.detachEvent("ondblclick",G);I.detachEvent("onclick",G);I.detachEvent("oncontextmenu",c);I.detachEvent("onkeyup",G);I.detachEvent("onkeydown",G);I.detachEvent("onmouseover",G);I.detachEvent("onmouseout",G);I.detachEvent("onmousemove",F);J.detachEvent("onfocus",d);J.detachEvent("onblur",h)}J=I=G=F=null}}}else{var C=q;if(xui.browser.opr||!f.addEventListener){C.$repeatT=xui.Thread.repeat(function(){if(!frames[r]){return false}else{if(!C.$win.document||!C.$win.document.defaultView){C.boxing().refresh()}}},99)}else{f.addEventListener("unload",m,false)}if(!B){A.addEventListener("mousedown",w,false);A.addEventListener("dblclick",w,false);A.addEventListener("click",w,false);A.addEventListener("contextmenu",c,false);A.addEventListener("keyup",w,false);A.addEventListener("mouseover",w,false);A.addEventListener("mouseout",w,false);A.addEventListener("mousemove",l,false);if(xui.browser.gek||!f.addEventListener){A.addEventListener("focus",d,false);A.addEventListener("blur",h,false);A.addEventListener("keypress",w,false)}else{f.addEventListener("focus",d,false);f.addEventListener("blur",h,false);A.addEventListener("keydown",w,false)}}(q.$beforeDestroy=(q.$beforeDestroy||{}))["ifmClearMem"]=function(){var I=this.$win,H=this.$doc,J=this.$ifr,F=this._event,E=this._event2;if(xui.browser.opr){if(C.$repeatT){C.$repeatT.abort()}}if(J.detachEvent){J.detachEvent("onload",z)}else{J.onload=null}try{I.removeEventListener("unload",I._gekfix,false)}catch(G){}I._gekfix=undefined;delete frames[this.$frameId];if(!this.properties.disabled&&!this.properties.readonly&&H.removeEventListener){H.removeEventListener("mousedown",F,false);H.removeEventListener("dblclick",F,false);H.removeEventListener("click",F,false);H.removeEventListener("contextmenu",c,false);H.removeEventListener("keyup",F,false);H.removeEventListener("mouseover",F,false);H.removeEventListener("mouseout",F,false);H.removeEventListener("mousemove",E,false);if(xui.browser.gek||!I.removeEventListener){H.removeEventListener("focus",d,false);H.removeEventListener("blur",h,false);H.removeEventListener("keypress",F,false)}else{I.removeEventListener("focus",d,false);I.removeEventListener("blur",h,false);H.removeEventListener("keydown",F,false)}}C=m=F=E=I=H=null}}q.boxing()._setCtrlValue(q.properties.$UIvalue||"");k.style.visibility="";k.style.overflow="auto";if(q.onReady){q.boxing().onReady(q)}}})};q.$frameId=r;k.id=k.name=r;k.className=p.className;k.src="about:blank";k.frameBorder=0;k.border=0;k.scrolling="yes";k.marginWidth=0;k.marginHeight=0;k.tabIndex=-1;k.allowTransparency="allowtransparency";k.style.visibility="hidden";xui.$cache.domPurgeData[k.$xid=p.$xid].element=k;p.parentNode.replaceChild(k,p);if(k.attachEvent){k.attachEvent("onload",z)}else{k.onload=z}}}else{q.boxing()._setCtrlValue(q.properties.value||"")}},_checkc:function(e){if(e&&e.$doc){var f=e.$doc,c=f&&(f.body||f.documentElement);if(!e.__oldv){e.__oldv=c.innerHTML}if(c.innerHTML!=e.__oldv){var d=e.__oldv;e.__oldv=c.innerHTML;e.boxing().onChange(e,d,c.innerHTML)}}},_onchange:function(c){if(c.onChange){if(c._onchangethread){clearInterval(c._onchangethread);c._onchangethread=null}c._onchangethread=setInterval(function(){if(c&&c.box){c.box._checkc(c)}},500)}},_clearPool:function(c){c.getSubNode("POOL").empty();c.$colorPicker=c.$fontsizeList=c.$fontnameList=c.$formatblockList=c.$htmlEditor=null},_iniToolBar:function(d,k){var r=d,n=r.properties,l=(n.cmdFilter||"").split(/[\s,;]+/),u;if(r.$toolbar){r.$toolbar.boxing().destroy(true);delete r._$tb;delete r.$toolbar}if(k!==false){var q,p,c,g=[],m=r.getClass("TOOLBARBTN"),f=n.cmdList.split(/[\s,;]+/),e={};_.arr.each(f,function(h){if((c=r.box.$cmds[h])&&!e[h]){e[h]=1;_.filter(c,function(w){if(_.arr.indexOf(l,w.id)!==-1){return false}if(w.imagePos){w.imageClass=m}w.tips=xui.wrapRes("editor."+w.id)});g.push({id:h,sub:c})}});r.getSubNode("BOX").prepend(q=new xui.UI.ToolBar({selectable:false,handler:false,items:g,disabled:n.disabled||n.readonly}));q.render(true);d.$_tbH=u=q.getRoot().height();if(xui.browser.ie){q.getSubNode("BOX").query("*").attr("unselectable","on")}q=r._$tb=q.get(0);q.onClick=r.box._toolbarclick;p=r._$composed={};p[q.$xid]=q;r.$toolbar=q;q.$hostage=r}xui.UI.$tryResize(d,n.width,n.height,true);return u},_toolbarclick:function(d,D,l,B,k){var g=d.$hostage;if(!g.$doc){return}var n=g.properties,h;g.$win.focus();if(D.command=="custom"){var A=D.id,w,f,y,u,C;switch(A){case"forecolor":case"bgcolor":if(!g.$colorPicker){h=true;g.$colorPicker=(new xui.UI.ColorPicker({selectable:false,barDisplay:false})).render(true)}w=g.$colorPicker;break;case"fontsize":case"fontname":case"formatblock":if(g.$lang!=xui.getLang()){g.box._clearPool(g)}g.$lang=xui.getLang();if(A=="fontsize"){if(!g.$fontsizeList){u=xui.getRes("editor.fontsizeList");u=u.split(";");C=[];var q;_.arr.each(u,function(e){e=e.split(",");q=e[0]=="..."?"1":e[0];C.push({id:e[0],caption:'<font size="'+e[0]+'" '+xui.$IEUNSELECTABLE()+">"+e[1]+"</font>"})});h=true;g.$fontsizeList=(new xui.UI.List({selectable:false,height:"auto",items:C,width:150})).render(true)}w=g.$fontsizeList}else{if(A=="fontname"){if(!g.$fontnameList){u=xui.getRes("editor.fontnameList");u=u.split(";");C=[];var q;_.arr.each(u,function(e){q=e=="..."?"":e;C.push({id:e,caption:'<span style="font-family:'+e+'" '+xui.$IEUNSELECTABLE()+">"+e+"</span>"})});h=true;g.$fontnameList=(new xui.UI.List({selectable:false,height:"auto",items:C})).render(true)}w=g.$fontnameList}else{if(A=="formatblock"){if(!g.$formatblockList){u=xui.getRes("editor.formatblockList");u=u.split(";");C=[];var q;_.arr.each(u,function(e){e=e.split(",");q=e[0]=="..."?"span":e[0];C.push({id:e[0],caption:"<"+q+' style="display:inline;padding:0;margin:0" '+xui.$IEUNSELECTABLE()+">"+e[1]+"</"+q+">"})});h=true;g.$formatblockList=(new xui.UI.List({selectable:false,height:"auto",items:C})).render(true)}w=g.$formatblockList}}}break;case"html":if(!g.$htmlEditor){h=true;g.$htmlEditor=new xui.UI.Input({multiLines:true,width:400,height:300,resizer:true})}w=g.$htmlEditor;break}if(w){f=function(){w.beforeUIValueSet(null);g.getSubNode("POOL").append(w.getRoot());y.setBlurTrigger(g.$xid);xui.Event.keyboardHook("esc");_.asyRun(function(){if(!g||!g.$win){return}g.$win.focus()})};w.setValue("",true,"clear");y=w.reBoxing();if(g.$htmlEditor==w){var z=g.getRoot(),m=g.getSubNode("EDITOR");w.setLeft(m.left()).setTop(m.top()).setWidth(m.offsetWidth()).setHeight(m.offsetHeight());w.setZIndex(10);z.append(y)}else{y.popToTop(k)}if(h&&xui.browser.ie){w.getSubNode("BOX").query("*").attr("unselectable","on")}_.tryF(w.activate,[],w);y.setBlurTrigger(g.$xid,function(){if(w==g.$htmlEditor){var e=w._getCtrlValue()}w.setUIValue(e,null,null,"blur");f()});xui.Event.keyboardHook("esc",0,0,0,function(){f()},null,null,d.domId)}switch(A){case"forecolor":case"bgcolor":w.beforeUIValueSet(function(G,H,e){f();var F=g.$doc;if(A=="bgcolor"&&xui.browser.gek){F.execCommand("useCSS",0,false);F.execCommand("hilitecolor",false,"#"+e);F.execCommand("useCSS",0,true)}else{if(A=="bgcolor"){A=xui.browser.opr?"hilitecolor":"backcolor"}F.execCommand(A,false,xui.browser.kde?("#"+e):e)}F=null;return false});break;case"fontsize":case"fontname":case"formatblock":w.beforeUIValueSet(function(I,K,F){f();if(xui.browser.ie&&(F=="..."||A=="formatblock")){var G=g.$doc.selection,e=G?G.createRange():null;if(e&&e.parentElement().ownerDocument!=g.$doc){e=G=null}}var H=function(N,L){var P=g.$doc;if(e){g.$win.focus();if(N=="formatblock"&&L){var O=e.parentElement(),M;if(O.ownerDocument==P){if(/^\s*</.test(e.htmlText)){e.collapse(true);O=e.parentElement();if(O.tagName=="BODY"){M=O.innerHTML;O.innerHTML="<"+L+">"+M+"</"+L+">"}else{M=O.outerHTML;M=M.replace(/\<[\w]+/,"<"+L).replace(/[\w]+\>$/,L+">");O.outerHTML=M}}else{e.pasteHTML("<"+L+">"+e.htmlText+"</"+L+">")}}O=null}e.select();G=e=null}P.execCommand(N,false,L);P=null};if(F=="..."){var J=xui.getRes("editor."+A);xui.UI.Dialog.prompt(J,J,"",function(L){if(L){H(A,L)}},function(){if(xui.browser.ie){if(e){g.$win.focus();e.select()}G=e=null}})}else{H(A,F)}});break;case"insertimage":case"createlink":var x=xui.getRes("editor."+A),c=xui.getRes("editor."+A+"2");if(xui.browser.ie){var E=g.$doc.selection,r=E?E.createRange():null;if(r&&r.parentElement().ownerDocument!=g.$doc){r=E=null}}xui.UI.Dialog.prompt(x,c,"http://",function(e){if(xui.browser.ie){if(r){g.$win.focus();r.select()}E=r=null}if(e){var F=g.$doc;F.execCommand(A,false,xui.adjustRes(e,0,1));F=null}},function(){if(xui.browser.ie){if(r){g.$win.focus();r.select()}E=r=null}});break;case"html":var p=g.boxing().getUIValue();if(xui.Coder){p=xui.Coder.formatText(p,"html")}w.setValue(p,true,"editor");w.beforeUIValueSet(function(F,G,e){f();g.boxing().setUIValue(e,null,null,"html")});break}}else{g.$doc.execCommand(D.command,false,D.commandArgs);if(D.id=="removeformat"){xui.UI.RichEditor._updateToolbar(g.$domId,true,"none")}}},_ensureValue:function(c,d){var e=xui.$getGhostDiv();e.innerHTML=(_.isSet(d)?d:"")+"";d=e.innerHTML;e.innerHTML="";return d},_onresize:function(h,c,u){if(c||u){if(!u){u=h.properties.height}var y={},w=0,x=h.properties,d=h.getSubNode("BOX"),r=h.getSubNode("LABEL"),l=x.labelSize||0,g=x.labelGap||0,f=x.labelPos||"left",q,p,m,k;d.cssRegion({left:q=f=="left"?l:0,top:p=f=="top"?l:0,width:m=c===null?null:Math.max(0,(c-((f=="left"||f=="right")?l:0))),height:k=u===null?null:Math.max(0,(u-((f=="top"||f=="bottom")?l:0)))});if(l){r.cssRegion({left:c===null?null:Math.max(0,f=="right"?(c-l+g):0),top:u===null?null:Math.max(0,f=="bottom"?(u-l+g):0),width:c===null?null:Math.max(0,((f=="left"||f=="right")?(l-g):c)),height:u===null?null:Math.max(0,((f=="top"||f=="bottom")?(l-g):u))})}var e=h._$tb,n;if(e){e.getRoot().width(m);n=e.getRoot().height();if(n){h.$_tbH=n}else{n=h.$_tbH}}w=(e?(n-1):0);y.height=k-w-2;if(m){y.width=m-2}if(y.width<0){y.width=0}if(y.height<0){y.height=0}if(m||k){if(h&&h.renderId){h.getSubNode("EDITOR").top(w).cssSize(y,true);h.getSubNode("MARK").left(1).top(w+1)}}}}}});Class("xui.UI.ComboInput","xui.UI.Input",{Instance:{_adjustV:function(c){var d=this.get(0),e=d.properties;if(d.$isNumber){c=(""+c).replace(/[^\d.-]/g,"");c=_.isNumb(parseFloat(c))?_.toFixedNumber(c,e.precision):null}else{if(d.properties.type=="datepicker"||d.properties.type=="date"||d.properties.type=="datetime"){c=_.isDate(c)?c:_.isFinite(c)?new Date(parseInt(c,10)):null}else{if(typeof c=="string"&&c.indexOf("\r")!=-1){c=c.replace(/(\r\n|\r)/g,"\n")}}}return c},getValue:function(){var d=arguments.callee.upper,c=d.apply(this,_.toArr(arguments));d=null;return this._adjustV(c)},getUIValue:function(){var d=arguments.callee.upper,c=d.apply(this,_.toArr(arguments));d=null;return this._adjustV(c)},_getCtrlValue:function(){return this.get(0).properties.$UIvalue},_setCtrlValue:function(g){var e=this,f=arguments.callee,d=f._r1||(f._r1=/\</),c=f._r2||(f._r2=/\<\/?[^>]+\>/g);return this.each(function(k){if(!k.$typeOK){k.box._iniType(k)}var l=k.getSubNode("INPUT"),h=k.properties.type;g=k.$_onedit?e._toEditor(g):e.getShowValue(g);if(h!=="none"&&h!=="input"&&h!=="password"&&!k.properties.multiLines&&typeof g=="string"&&d.test(g)){g=g.replace(c,"")}if(k.$Mask&&!g){g=k.$Mask}k.$_inner=1;l.attr("value",g||"");delete k.$_inner;if(h=="colorpicker"||h=="color"){l.css({backgroundColor:g,color:xui.UI.ColorPicker.getTextColor(g)})}})},_compareValue:function(f,e){var d=this.get(0),c;if(c=d.CF.compareValue||d.$compareValue){return c(d,f,e)}return f===e},getShowValue:function(g){var e=this.get(0),h=e.properties,c,d;if(!_.isDefined(g)){g=h.$UIvalue}if(d=e.CF.getShowValue||e.$getShowValue){c=d(e,g)}else{if("listbox"==h.type){var f=(h.listKey)?xui.UI.getCachedData(h.listKey):h.items;if(f&&(d=_.arr.subIndexOf(f,"id",g))!=-1){c=f[d].caption+"";if(c&&c.length>0){c=xui.adjustRes(c)}}else{c=null}}else{c=e.$showValue}}if(!_.isSet(c)&&(e.$inputReadonly||h.inputReadonly)){c=_.isSet(h.caption)?h.caption:null}return""+(_.isSet(c)?c:_.isSet(g)?g:"")},_toEditor:function(e){var d=this.get(0),f=d.properties,c;if(c=d.CF.toEditor||d.$toEditor){return c(d,e)}return e},_fromEditor:function(e){var d=this.get(0),f=d.properties,c;if(c=d.CF.fromEditor||d.$fromEditor){return c(d,e)}return e},_cache:function(g,c){if(this.isDestroyed()){return}var f=this.get(0);var d=f.$drop,e=f.properties.cachePopWnd;if(d){if(!e){if(!d.destroyed){d.boxing().destroy(true)}delete f.$drop;if(c){f.boxing().activate()}}else{if(!f.__tryToHide){f.__tryToHide=_.asyRun(function(){if(!f.box){return}delete f.__tryToHide;if(!d.destroyed){if(xui.browser.opr){d.getRoot().css("display","none")}if(d.boxing()._clearMouseOver){d.boxing()._clearMouseOver()}f.getSubNode("POOL").append(d.getRoot())}if(c){f.boxing().activate()}})}}}delete f.$poplink;if(f.afterPopHide){this.afterPopHide(f,d,g)}return e},clearPopCache:function(){var c=this.get(0);if(c.renderId){c.getSubNode("POOL").empty()}delete c.$drop;return this},setUploadObj:function(d){var e=this.get(0),h=e.properties,g=xui(d).get(0);if(g.tagName&&g.tagName.toLowerCase()=="input"&&g.type=="file"){if(e.renderId&&(h.type=="upload"||h.type=="file")){var f=e.getSubNode("FILE").get(0);xui.setNodeData(g.$xid=f.$xid,"element",g);g.id=f.id;g.onclick=f.onclick;g.onchange=f.onchange;f.$xid=null;f.id=f.onclick=f.onchange=null;delete e.$_domid[e.keys.FILE];xui([f]).addPrev(g).remove(false);this.setUIValue(g.value||"",null,null,"setfile")}}return this},getUploadObj:function(){var d=this.get(0),g=d.properties;if(d.renderId&&(g.type=="upload"||g.type=="file")){var e=d.getSubNode("FILE").get(0);if(!e.value){return null}var f=e.cloneNode(false);f.value="";xui.setNodeData(f.$xid=e.$xid,"element",f);f.onclick=e.onclick;f.onchange=e.onchange;e.$xid=null;e.id=e.onclick=e.onchange=null;delete d.$_domid[d.keys.FILE];xui([e]).addPrev(f).remove(false);f=null;this.setUIValue(this.getValue(),null,null,"getfile");return e}},popFileSelector:function(){var d=this.get(0),f=d.properties;if(d.renderId&&(f.type=="upload"||f.type=="file")){var e=d.getSubNode("FILE").get(0);if(!!window.ActiveXObject||"ActiveXObject" in window){var c=document.createElement("div");e.appendChild(c);c.click();e.removeChild(c)}else{e.click()}}},resetValue:function(e){this.each(function(f){if(f.properties.type=="upload"||f.properties.type=="file"){f.getSubNode("FILE").attr("value","")}});var c=arguments.callee.upper,d=c.apply(this,_.toArr(arguments));c=null;return d},_drop:function(c,d){return this.each(function(g){var q=g.properties,m=q.type,p=q.cachePopWnd;if(q.disabled||q.readonly){return}if(m=="upload"||m=="file"||m=="none"||m=="input"||m=="password"||m=="spin"||m=="currency"||m=="number"){return}if(g.$poplink){return}var e,r,k=g.boxing(),h=g.getRoot(),n=h.offset(),w=h.cssSize();n.top+=h.offsetHeight();if((g.beforeComboPop&&false===k.beforeComboPop(g,n,c,d))||m=="getter"||m=="cmdbox"||m=="popbox"){return}if(g.__tryToHide){_.clearTimeout(g.__tryToHide);delete g.__tryToHide}var l;if(p){switch(m){case"timepicker":case"time":case"datepicker":case"date":case"datetime":case"colorpicker":case"color":l=m;break;default:if(q.listKey){if(typeof _.get(xui.$cache,["UIDATA",q.listKey])=="function"){g.$drop=l=null}else{l="!"+q.listKey}}else{l="$"+g.$xid}}if(l){_.filter(g.box.$drop,function(x){return !!x.renderId});g.$drop=g.box.$drop[l]}}if(!g.$drop){switch(m){case"combobox":case"listbox":case"helpinput":e=xui.create("List");e.setHost(g).setDirtyMark(false).setItems(_.copy(q.items)).setListKey(q.listKey||"");e.setWidth(q.dropListWidth>=2?q.dropListWidth:(w.width-(q.labelSize||0)-(q.borderType!="none"?2:0)));if(q.dropListHeight){e.setHeight(q.dropListHeight)}else{e.setHeight("auto")}e.afterClick(function(){if(!this.destroyed){this.boxing()._cache("",true)}else{e.destroy(true)}return false});e.beforeUIValueSet(function(B,A,z){var x=this.boxing();if(m=="combobox"){var y=B.queryItems(B.properties.items,function(C){return C.id==z},false,true);if(y.length){z=y[0].caption}}x.setUIValue(z,null,null,"pick");return x._cache("",true)});break;case"time":case"timepicker":e=xui.create("TimePicker");e.setHost(g);e.beforeClose(function(){if(!this.destroyed){this.boxing()._cache("",true)}return false});e.beforeUIValueSet(function(z,A,y){var x=this.boxing();x.setUIValue(y,null,null,"pick");return x._cache("",true)});break;case"date":case"datepicker":case"datetime":e=xui.create("DatePicker");if(m=="datetime"){e.setTimeInput(true)}e.setHost(g);e.beforeClose(function(){if(!this.destroyed){this.boxing()._cache("",true)}else{e.destroy(true)}return false});e.beforeUIValueSet(function(z,A,y){var x=this.boxing();x.setUIValue(String(y.getTime()),null,null,"pick");return x._cache("",true)});break;case"color":case"colorpicker":e=xui.create("ColorPicker");e.setHost(g);e.beforeClose(function(){if(!this.destroyed){this.boxing()._cache("",true)}else{e.destroy(true)}return false});e.beforeUIValueSet(function(z,A,y){var x=this.boxing();x.setUIValue((y=="transparent"?"":"#")+y,null,null,"pick");return x._cache("",true)});break}if(_.isHash(q.popCtrlProp)&&!_.isEmpty(q.popCtrlProp)){e.setProperties(q.popCtrlProp)}if(_.isHash(q.popCtrlEvents)&&!_.isEmpty(q.popCtrlEvents)){e.setEvents(q.popCtrlEvents)}g.$drop=e.get(0);if(l){g.box.$drop[l]=g.$drop}e.render()}e=g.$drop.boxing();e.setHost(g);switch(m){case"combobox":case"listbox":case"helpinput":case"time":case"timepicker":e.setValue(g.properties.$UIvalue,true,"pop");break;case"date":case"datepicker":case"datetime":var u=g.$drop.properties;if(u=g.properties.$UIvalue){e.setValue(new Date(parseInt(u,10)),true,"pop")}break;case"color":case"colorpicker":e.setValue(g.properties.$UIvalue.replace("#",""),true,"pop");break}g.$poplink=e.get(0);if(g.beforePopShow&&false===k.beforePopShow(g,g.$drop)){return}var f=e.reBoxing();f.popToTop(g.getSubNode("BOX"));_.tryF(e.activate,[],e);f.setBlurTrigger(g.key+":"+g.$xid,function(){k._cache("blur")});xui.Event.keyboardHookUp("esc",0,0,0,function(){g.$escclosedrop=1;_.asyRun(function(){delete g.$escclosedrop});k.activate();xui.Event.keyboardHook("esc");k._cache("esc",true)});if(g.afterPopShow){k.afterPopShow(g,g.$drop)}})},expand:function(){var c=this.get(0);if(c.renderId){c.boxing()._drop()}},collapse:function(){var c=this.get(0);if(c.renderId&&c.$poplink){c.boxing()._cache("call")}},getPopWnd:function(d){var c=this.get(0);if(c&&c.$drop&&(d||c.$poplink)){return c.$drop.boxing()}}},Initialize:function(){this.addTemplateKeys(["FILE","BTN","TOP","MID","RBTN","R1","R1T","R1B","R2","R2T","R2B"]);var c=this.getTemplate();_.merge(c.FRAME.BORDER,{SBTN:{$order:50,className:"xui-ui-unselectable",style:"{_saveDisplay}",STOP:{},SMID:{className:"{_commandCls} {btncls}"}}},"all");c.FRAME.POOL={};c.className+=" {typecls}";this.setTemplate(c);this._adjustItems=xui.absList._adjustItems;this.prototype.getItems=xui.absList.prototype.getItems},Static:{_beforeResetValue:function(c){c.properties.caption=undefined},_iniType:function(g){var h=g.properties,f=h.type,k=g.box;delete g.$beforeKeypress;delete g.$inputReadonly;delete g.$isNumber;delete g.$compareValue;delete g.$getShowValue;delete g.$toEditor;delete g.$fromEditor;delete g.$typeOK;if(f=="listbox"||f=="upload"||f=="file"||f=="cmdbox"||f=="cmd"){g.$inputReadonly=true}if(f=="upload"||f=="file"){g.$xuiFileCtrl=true}if(f!="listbox"&&f!="combobox"&&f!="helpinput"){h.items=[]}if(f=="timepicker"||f=="time"){var e={a:1,c:1,v:1,x:1};_.merge(g,{$beforeKeypress:function(m,n,l){return l.key.length!=1||/[-0-9:]/.test(l.key)||(l.ctrlKey&&!!e[l.key])},$getShowValue:function(l,c){return c?xui.UI.TimePicker._ensureValue(l,c):""},$fromEditor:function(l,c){if(c){c=xui.UI.TimePicker._ensureValue(l,c);if(c=="00:00"){c=l.properties.$UIvalue}}return c}},"all")}else{if(f=="datepicker"||f=="date"||f=="datetime"){var d=xui.Date;var e={a:1,c:1,v:1,x:1};_.merge(g,{$beforeKeypress:function(m,n,l){return l.key.length!=1||/[0-9:/\-_ ]/.test(l.key)||(l.ctrlKey&&!!e[l.key])},$compareValue:function(m,l,c){return(!l&&!c)||(String(l)==String(c))},$getShowValue:function(l,c){if(l.properties.dateEditorTpl){return c?d.format(c,l.properties.dateEditorTpl):""}else{return c?d.getText(new Date(parseInt(c,10)),l.properties.type=="datetime"?"ymdhn":"ymd"):""}},$toEditor:function(r,l){if(!l){return""}l=new Date(parseInt(l,10)||0);if(r.properties.dateEditorTpl){return d.format(l,r.properties.dateEditorTpl)}else{var c=(d.get(l,"m")+1)+"",u=d.get(l,"d")+"",q=d.get(l,"h")+"",w=d.get(l,"n")+"";return d.get(l,"y")+"-"+(c.length==1?"0":"")+c+"-"+(u.length==1?"0":"")+u+(r.properties.type=="datetime"?(" "+(q.length==1?"0":"")+q+":"+(w.length==1?"0":"")+w):"")}},$fromEditor:function(l,c){if(c){if(l.properties.dateEditorTpl){c=d.parse(c,l.properties.dateEditorTpl)}else{c=xui.Date.parse(c)}if(!c){c=l.properties.$UIvalue;if(_.isFinite(c)){c=new Date(parseInt(c,10))}}if(c){if(l.properties.type!="datetime"){c=d.getTimSpanStart(c,"d",1)}if(c.getFullYear()<l.properties.min){c.setTime(l.properties.min)}if(c.getFullYear()>l.properties.max){c.setTime(l.properties.max)}}}return c?String(c.getTime()):""}},"all")}else{if(f=="currency"){g.$isNumber=1;var e={a:1,c:1,v:1,x:1};_.merge(g,{$beforeKeypress:function(m,n,l){return l.key.length!=1||/[-0-9,. ]/.test(l.key)||(l.ctrlKey&&!!e[l.key])},$compareValue:function(m,l,c){return((l===""&&c!=="")||(c===""&&l!==""))?false:m.box._number(m,l)==m.box._number(m,c)},$getShowValue:function(m,l){var c=m.properties;if(_.isSet(l)&&l!==""){l=_.formatNumeric(m.box._number(m,l),c.precision,c.groupingSeparator,c.decimalSeparator,c.forceFillZero);if(m.properties.currencyTpl){l=m.properties.currencyTpl.replace("*",l)}}else{l=""}return l},$toEditor:function(m,l){var c=m.properties;return(_.isSet(l)&&l!=="")?_.formatNumeric(m.box._number(m,l),c.precision,c.groupingSeparator,c.decimalSeparator,c.forceFillZero):""},$fromEditor:function(l,c){return(_.isSet(c)&&c!=="")?l.box._number(l,c):""}},"all")}else{if(f=="number"||f=="spin"){g.$isNumber=1;var e={a:1,c:1,v:1,x:1};_.merge(g,{$beforeKeypress:function(m,n,l){return l.key.length!=1||/[-0-9. ]/.test(l.key)||(l.ctrlKey&&!!e[l.key])},$compareValue:function(m,l,c){return((l===""&&c!=="")||(c===""&&l!==""))?false:m.box._number(m,l)==m.box._number(m,c)},$getShowValue:function(m,l){var c=m.properties;l=(_.isSet(l)&&l!=="")?_.formatNumeric(m.box._number(m,l),c.precision,c.groupingSeparator,c.decimalSeparator,c.forceFillZero):"";if(m.properties.numberTpl){l=m.properties.numberTpl.replace("*",l)}return l},$toEditor:function(m,l){var c=m.properties;return(_.isSet(l)&&l!=="")?_.formatNumeric(m.box._number(m,l),c.precision,c.groupingSeparator,c.decimalSeparator,c.forceFillZero):""},$fromEditor:function(l,c){return(_.isSet(c)&&c!=="")?l.box._number(l,c):""}},"all")}}}}if(h.value){h.$UIvalue=h.value=k._ensureValue(g,h.value)}g.$typeOK=true},$drop:{},Appearances:{POOL:{position:"absolute",left:0,top:0,width:0,height:0,display:"none",visibility:"hidden"},FILE:{opacity:0,filter:(xui.browser.ie&&xui.browser.ver<9)?"alpha(opacity=0)":null,"z-index":"3",border:0,height:"100%",width:"100%",position:"absolute",top:0,right:0,cursor:"pointer","font-size":"12px",overflow:"hidden"},"KEY-type-number INPUT, KEY-type-spin INPUT, KEY-type-currency INPUT":{$order:4,"text-align":"right"},"KEY-type-file INPUT, KEY-type-cmd INPUT, KEY-type-cmdbox INPUT, KEY-type-listbox INPUT":{$order:4,cursor:"pointer","text-align":"left",overflow:"hidden"},"KEY-type-file BOX, KEY-type-cmd BOX, KEY-type-cmdbox BOX, KEY-type-listbox BOX":{$order:4,"background-image":xui.UI.$bg("inputbgb.gif","","Input"),"background-repeat":"repeat-x","background-position":"left bottom","background-color":"#fff"},"RBTN,SBTN,BTN":{display:"block","z-index":"1",cursor:"pointer",width:"16px",height:"20px","font-size":0,"line-height":0,position:"absolute"},SBTN:{$order:2,"z-index":"6"},"SBTN,BTN,R1,R2":{"margin-top":"2px"},"R1, R2, BTN, SBTN, STOP, TOP, R1T, R2T, R1B, R2B, SMID,MID":{"background-image":xui.UI.$bg("bg.gif")},"SBTN, BTN":{$order:1,"background-position":"left bottom"},"R1,R2":{$order:1,display:"block","font-size":0,"line-height":0,cursor:"pointer",width:"16px",position:"absolute",height:"50%","background-position":"left bottom","margin-top":"2px"},R1:{top:0},R2:{bottom:"-2px"},"BTN-mouseover, SBTN-mouseover, R1-mouseover, R2-mouseover":{$order:2,"background-position":"-16px bottom"},"BTN-mousedown, SBTN-mousedown, R1-mousedown, R2-mousedown":{$order:3,"background-position":"-32px bottom"},"STOP, TOP, R1T, R2T":{$order:1,cursor:"pointer",width:"16px","font-size":0,"line-height":0,position:"absolute",top:"-2px",left:0,height:"4px","background-position":"left -104px"},"BTN-mouseover TOP,SBTN-mouseover STOP, R1-mouseover R1T, R2-mouseover R2T":{$order:2,"background-position":"-16px -104px"},"BTN-mousedown TOP,SBTN-mousedown STOP, R1-mousedown R1T, R2-mousedown R2T":{$order:3,"background-position":"-32px -104px"},"R1B,R2B":{cursor:"pointer",width:"16px","font-size":0,"line-height":0,position:"absolute",left:0,top:"50%","margin-top":"-4px",height:"6px","z-index":2},R1B:{$order:1,"background-position":"-14px -36px"},R2B:{$order:1,"background-position":"left -5px"},"SMID,MID":{$order:2,cursor:"pointer",width:"16px","font-size":0,"line-height":0,position:"absolute",bottom:"0",left:0,height:"16px"},SMID:{$order:3,"background-position":"-16px -16px"},"SMID-save":{$order:8,"background-position":"-32px 0"},"SMID-delete":{$order:8,"background-position":"-32px -16px"},"SMID-add":{$order:8,"background-position":"-32px -32px"},"SMID-remove":{$order:8,"background-position":"-32px -48px"},"SMID-select":{$order:8,"background-position":"left -16px"},"SMID-pop":{$order:8,"background-position":"-32px -64px"},".setting-xui-comboinput":{"border-style":"solid","border-top-width":"1px","border-bottom-width":"1px","border-left-width":"1px","border-right-width":"1px"}},_objectProp:{popCtrlProp:1,popCtrlEvents:1},Behaviors:{HoverEffected:{BOX:"BOX",BTN:"BTN",SBTN:"SBTN",R1:"R1",R2:"R2"},ClickEffected:{BTN:"BTN",SBTN:"SBTN",R1:"R1",R2:"R2"},FILE:{onClick:function(c,d,f){var g=c.properties;if(g.disabled||g.readonly){return}if(c.onFileDlgOpen){c.boxing().onFileDlgOpen(c,f)}},onChange:function(c,d,f){c.boxing().setUIValue(xui.use(f).get(0).value+"",null,null,"onchange")}},BTN:{onClick:function(c,d,f){var g=c.properties;if(g.type=="popbox"||g.type=="getter"){if(c.onClick&&false===c.boxing().onClick(c,d,f,g.$UIvalue)){return}}if(g.disabled||g.readonly){return}c.boxing()._drop(d,f);return false}},SBTN:{onClick:function(c,d,f){var g=c.properties;if(g.disabled||g.readonly){return}if(c.onCommand){c.boxing().onCommand(c,f)}}},BOX:{onClick:function(c,d,f){var g=c.properties;if(g.type=="cmdbox"||g.type=="cmd"){if(c.onClick){c.boxing().onClick(c,d,f,g.$UIvalue)}}else{if(g.inputReadonly||c.$inputReadonly){if(g.disabled||g.readonly){return}c.boxing()._drop(d,f)}}}},INPUT:{onChange:function(g,h,c){if(g.$_onedit||g.$_inner||g.destroyed||!g.box){return}var f=g._inValid,d=g.properties,k=g.box,n=g.boxing(),m=n._fromEditor(xui.use(c).get(0).value),l=d.$UIvalue;if(!n._compareValue(l,m)){if(m===null){n._setCtrlValue(l)}else{n.setUIValue(m,null,null,"onchange");if(d.$UIvalue!==m){n._setCtrlValue(d.$UIvalue)}if(f!==g._inValid){if(g.renderId){n._setDirtyMark()}}}}k._asyCheck(g)},onKeyup:function(f,k,l){var h=f.properties,c=f.box,d=xui.Event.getKey(k);if(h.disabled||h.readonly){return false}if(f.$inputReadonly||h.inputReadonly){return}if(d.key=="esc"){if(f.$escclosedrop){return}f.boxing()._setCtrlValue(h.$UIvalue);if(f.onCancel){f.boxing().onCancel(f)}}if(h.dynCheck){var g=xui.use(l).get(0).value;f.box._checkValid(f,g);f.boxing()._setDirtyMark()}c._asyCheck(f);if(d.key=="down"||d.key=="up"){if(h.type=="spin"){xui.Thread.abort(f.$xid+":spin");return false}}},onMousedown:function(c,d,f){c._mousedownmark=1;_.asyRun(function(){if(c){delete c._mousedownmark}})},onMouseup:function(c,f,g){if(c.properties.selectOnFocus&&c._stopmouseupcaret){var d=xui.use(g).get(0);if(!d.readOnly&&d.select){c.$mouseupDelayFun=_.asyRun(function(){delete c.$mouseupDelayFun;if(d.tagName.toLowerCase()=="input"||!/[\n\r]/.test(d.value)){d.select()}})}delete c._stopmouseupcaret}},onFocus:function(g,h,c){var d=g.properties,k=g.box;if(d.disabled||d.readonly){return false}if(g.onFocus){g.boxing().onFocus(g)}if(g.$inputReadonly||d.inputReadonly){return}g.getSubNode("BORDER").tagClass("-focus");var q=g.boxing(),l=d.$UIvalue,n=q._toEditor(l),f=xui.use(c).get(0),r=f.value;if(l!==n&&r!==n){g.$_onedit=true;f.value=n;delete g.$_onedit}if(d.mask){var m=f.value;if(!m){g.$focusDelayFun=_.asyRun(function(){if(!g.box){return}delete g.$focusDelayFun;g.$_onedit=true;g.boxing()._setCtrlValue(m=g.$Mask);delete g.$_onedit;k._setCaret(g,f)})}}if(d.selectOnFocus&&!f.readOnly&&f.select){if(xui.browser.kde){g.$focusDelayFun2=_.asyRun(function(){delete g.$focusDelayFun2;if(f.tagName.toLowerCase()=="input"||!/[\n\r]/.test(f.value)){f.select()}})}else{if(f.tagName.toLowerCase()=="input"||!/[\n\r]/.test(f.value)){f.select()}}if(g._mousedownmark){g._stopmouseupcaret=1}}g.boxing()._setTB(3);k._asyCheck(g)},onBlur:function(g,l,m){_.resetRun(g.$xid+":asycheck");if(g.$focusDelayFun){_.clearTimeout(g.$focusDelayFun)}if(g.$focusDelayFun2){_.clearTimeout(g.$focusDelayFun2)}if(g.$focusDelayFun2){_.clearTimeout(g.$mouseupDelayFun)}var k=g.properties;if(k.disabled||k.readonly){return false}if(g.onBlur){g.boxing().onBlur(g)}if(g.$inputReadonly||k.inputReadonly){return}var d=g.box,c=g.boxing(),h=k.$UIvalue,f=xui.use(m).get(0).value;if(g.$Mask&&g.$Mask==f){f="";h=g.$Mask}f=c._fromEditor(f);g.getSubNode("BORDER").tagClass("-focus",false);if(c._compareValue(k.$UIvalue,f)){g.box._checkValid(g,f);c._setCtrlValue(h)}c._setDirtyMark();d._asyCheck(g,false)},onKeydown:function(h,n,q){var l=h.properties;if(l.disabled||l.readonly){return}var d=h.box,c=l.multiLines,f=xui.Event,g=f.getKey(n);if(g.key=="enter"&&(!c||g.altKey)&&!l.inputReadonly&&!h.$inputReadonly){h.$_onedit=true;h.boxing().setUIValue(h.boxing()._fromEditor(xui.use(q).get(0).value),true,null,"enter");h.$_onedit=false}d._asyCheck(h);if(l.mask){if(g.key.length>1){h.$ignore=true}else{delete h.$ignore}switch(g.key){case"backspace":d._changeMask(h,xui.use(q).get(0),"",false);return false;case"delete":d._changeMask(h,xui.use(q).get(0),"");return false}}if(g.key=="down"||g.key=="up"){if(l.type=="spin"){if(!g.ctrlKey){h.box._spin(h,g.key=="up");return false}}else{if(g.ctrlKey&&l.type!="none"&&l.type!="input"&&l.type!="password"){h.boxing()._drop(n,q);return false}}}},onDblclick:function(c,d,f){c.getSubNode("BTN").onClick(true)}},R1:{onMousedown:function(c){var d=c.properties;if(d.disabled||d.readonly){return}c.box._spin(c,true)},onMouseout:function(c){xui.Thread.abort(c.$xid+":spin")},onMouseup:function(c){xui.Thread.abort(c.$xid+":spin")}},R2:{onMousedown:function(c){var d=c.properties;if(d.disabled||d.readonly){return}c.box._spin(c,false)},onMouseout:function(c){xui.Thread.abort(c.$xid+":spin")},onMouseup:function(c){xui.Thread.abort(c.$xid+":spin")}}},EventHandlers:{onFileDlgOpen:function(c,d){},onCommand:function(c,d){},beforeComboPop:function(c,g,d,f){},beforePopShow:function(c,d){},afterPopShow:function(c,d){},afterPopHide:function(d,e,c){},onClick:function(c,f,g,d){}},_posMap:{none:"",currency:"",number:"",combobox:"left top",listbox:"left top",file:"-16px top",getter:"left -31px",helpinput:"-16px -46px",cmdbox:"left -16px",popbox:"left -46px",time:"left -60px",date:"left -75px",color:"-16px -60px",timepicker:"left -60px",datepicker:"left -75px",datetime:"left -75px",colorpicker:"-16px -60px"},DataModel:{cachePopWnd:true,dateEditorTpl:"",precision:2,groupingSeparator:",",decimalSeparator:".",forceFillZero:true,popCtrlProp:{ini:{}},popCtrlEvents:{ini:{}},numberTpl:{ini:"",action:function(){this.boxing().setUIValue(this.properties.$UIvalue,true,null,"tpl")}},currencyTpl:{ini:"$ *",action:function(){this.boxing().setUIValue(this.properties.$UIvalue,true,null,"tpl")}},listKey:{set:function(d){var c=xui.UI.getCachedData(d),e=this;e.boxing().setItems(c?_.clone(c):e.properties.items);e.properties.listKey=d}},dropListWidth:0,dropListHeight:0,items:{ini:[],set:function(c){var d=this;c=d.properties.items=d.box._adjustItems(c);if(d.renderId){d.SubSerialIdMapItem={};d.ItemIdMapSubSerialId={};d.box._prepareItems(d,c);if(d.$poplink){d.$poplink.boxing().setItems(c)}else{d.boxing().clearPopCache()}}}},btnImage:{action:function(c){this.getSubNode("MID").css("backgroundImage",c?("url("+c+")"):"")}},btnImagePos:{action:function(c){this.getSubNode("MID").css("backgroundPosition",c)}},type:{ini:"combobox",listbox:_.toArr("none,input,password,combobox,listbox,file,getter,helpinput,cmd,cmdbox,popbox,date,time,datetime,color,spin,currency,number"),set:function(c){var d=this;d.properties.type=c;if(d.renderId){d.boxing().refresh(true)}}},increment:0.01,min:-Math.pow(10,15),max:Math.pow(10,15),commandBtn:{ini:"none",listbox:_.toArr("none,save,delete,add,remove,pop,select,custom"),action:function(c){this.boxing().refresh()}},disabled:{ini:false,action:function(d){var e=this.getSubNode("INPUT"),c="xui-ui-disabled";if(d){this.getRoot().addClass(c)}else{this.getRoot().removeClass(c)}if((""+e.get(0).type).toLowerCase()!="cmd"){if(!d&&(this.properties.readonly||this.$inputReadonly)){d=true}e.attr("readonly",d)}}},inputReadonly:{ini:false,action:function(d){var e=this.getSubNode("INPUT"),c="xui-ui-readonly";if(!d&&(this.properties.disabled||this.properties.readonly||this.$inputReadonly)){d=true}if(d){this.getRoot().addClass(c)}else{this.getRoot().removeClass(c)}e.attr("readonly",d).css("cursor",d?"pointer":"")}},readonly:{ini:false,action:function(d){var e=this.getSubNode("INPUT"),c="xui-ui-readonly";if(!d&&(this.properties.disabled||this.properties.inputReadonly||this.$inputReadonly)){d=true}if(d){this.getRoot().addClass(c)}else{this.getRoot().removeClass(c)}e.attr("readonly",d).css("cursor",d?"pointer":"")}},caption:{ini:null,set:function(c){var d=this.properties;d.caption=c;if(_.isSet(c)){c=c+"";d.caption=xui.adjustRes(c,false)}if(this.renderId){if(this.$inputReadonly||d.inputReadonly){this.getSubNode("INPUT").attr("value",this.boxing().getShowValue())}}},get:function(){return this.boxing().getShowValue()}}},RenderTrigger:function(){var d=this,c=d.boxing(),e=d.properties;d.box._iniType(d);if(e.readonly){c.setReadonly(true,true)}else{if(e.inputReadonly){c.setInputReadonly(true,true)}}},_spin:function(f,d){var k=f.$xid+":spin";if(xui.Thread.isAlive(k)){return}var h=f.properties,g=h.increment*(d?1:-1),e={delay:300},c=function(){if(f.destroyed){return false}var l=((+h.$UIvalue)||0)+g;l=(_.isSet(l)&&l!=="")?_.formatNumeric(f.box._number(f,l),h.precision,h.groupingSeparator,h.decimalSeparator,h.forceFillZero):"";f.boxing().setUIValue(l,null,null,"spin");e.delay*=0.9};e.task=c;xui.Thread(k,[e],500,null,c,null,true).start()},_dynamicTemplate:function(f){var d=f.properties,g=f._exhash="$multiLines:"+d.multiLines+";type:"+d.type+";",e=f.box.getTemplate(g);d.$UIvalue=d.value;if(!e){e=_.clone(f.box.getTemplate());var c=e.FRAME.BORDER;c.BOX.WRAP.INPUT.tagName="input";c.BOX.WRAP.INPUT.type="text";switch(d.type){case"none":case"input":case"number":case"currency":break;case"cmd":c.BOX.WRAP.INPUT.type="button";break;case"password":c.BOX.WRAP.INPUT.type="password";break;case"spin":c.RBTN={$order:20,className:"xui-ui-unselectable",style:"{rDisplay}",R1:{R1T:{},R1B:{}},R2:{R2T:{},R2B:{}}};break;case"upload":case"file":c.FILE={$order:20,className:"xui-ui-unselectable",tagName:"input",type:"file",hidefocus:xui.browser.ie?"hidefocus":null,size:"1"};case"listbox":case"cmdbox":c.BOX.WRAP.INPUT.type="button";default:c.BTN={$order:20,className:"xui-ui-unselectable",style:"{_popbtnDisplay}",TOP:{},MID:{style:"{_btnStyle}"}}}if(d.multiLines){switch(d.type){case"none":case"input":case"getter":case"helpinput":case"popbox":case"number":case"combobox":c.BOX.WRAP.INPUT.tagName="textarea";delete c.BOX.WRAP.INPUT.type}}f.box.setTemplate(e,g)}f.template=e},_prepareData:function(c){var d=arguments.callee.upper.call(this,c),e=c.box._posMap;if(e[d.type]){d._btnStyle=d.btnImage?("background: url("+d.btnImage+")"+(d.btnImagePos||"")):("background-position:"+(d.btnImagePos||e[d.type]))}d._type="text";d._saveDisplay=d.commandBtn!="none"?"":"display:none";d._commandCls=c.getClass("SMID","-"+d.commandBtn);d._popbtnDisplay=(d.type!="none"&&d.type!="input"&&d.type!="password")?"":"display:none";d.typecls=c.getClass("KEY","-type-"+(d.type=="colorpicker"?"color":d.type=="datepicker"?"date":d.type=="timepicker"?"time":d.type=="upload"?"file":d.type));return d},_ensureValue:function(e,g){var f=arguments.callee,l=e.properties;if(!_.isSet(g)||g===""){return""}if(e.$Mask&&e.$Mask==g){g=""}switch(e.properties.type){case"date":case"datepicker":case"datetime":var h;if(g){if(_.isDate(g)){h=g}else{if(_.isFinite(g)){h=new Date(parseInt(g,10))}else{h=xui.Date.parse(g+"")}}}return h?String(e.properties.type=="datetime"?h.getTime():xui.Date.getTimSpanStart(h,"d",1).getTime()):"";case"color":case"colorpicker":var k=xui.UI.ColorPicker._ensureValue(null,g);return(k=="transparent"?"":"#")+k;case"time":case"timepicker":return xui.UI.TimePicker._ensureValue(null,g);case"currency":case"number":case"spin":return this._number(e,g);default:return typeof g=="string"?g:(g||g===0)?String(g):""}},_number:function(c,d){var e=c.properties;d=_.toNumeric(d,e.precision,e.groupingSeparator,e.decimalSeparator,e.forceFillZero);if(_.isSet(e.max)){d=d>e.max?e.max:d}if(_.isSet(e.min)){d=d<e.min?e.min:d}return d},_onresize:function(h,C,y){var G=function(f){return f?h.getSubNode(f).get(0):null},g=G("INPUT"),F=g.type.toLowerCase()=="button",N=1,d=1,n=F?0:xui.UI.$getCSSValue("xui-comboinput-input","paddingTop"),c=F?0:xui.UI.$getCSSValue("xui-comboinput-input","paddingLeft"),J=F?0:xui.UI.$getCSSValue("xui-comboinput-input","paddingRight");var u=h.properties,A=h.getSubNode("BOX"),p=h.getSubNode("LABEL"),q=u.labelSize||0,K=u.labelGap||0,z=u.labelPos||"left",x="px",E=G(u.commandBtn!="none"?"SBTN":null),I=G(u.type=="spin"?"RBTN":(u.type=="none"||u.type=="input"||u.type=="password"||u.type=="currency"||u.type=="number"||u.type=="cmd")?null:"BTN"),M=C,k=y,D=0,B=0,m=Math.max(0,(u.$b_lw||0)-N),w=Math.max(0,(u.$b_tw||0)-d);if(null!==M){M-=Math.max(N*2,(u.$b_lw||0)+(u.$b_rw||0));D=(E?16:0);B=(I?16:0);M-=(D+B);if(xui.browser.ie6){M=(parseInt(M/2,10))*2}}if(null!==k){k-=Math.max(d*2,(u.$b_lw||0)+(u.$b_rw||0));if(xui.browser.ie6){k=(parseInt(k/2,10))*2}if(xui.browser.ie6&&null===C){A.ieRemedy()}}var e=m+(z=="left"?q:0),L=w+(z=="top"?q:0),H=M===null?null:Math.max(0,M-((z=="left"||z=="right")?q:0)),l=k===null?null:Math.max(0,k-((z=="top"||z=="bottom")?q:0)),r=k===null?null:Math.max(0,y-((z=="top"||z=="bottom")?q:0));if(null!==H&&H-c-J>0){g.style.width=Math.max(0,H-c-J)+x}if(null!==l&&l-n>0){g.style.height=Math.max(0,l-n)+x}A.cssRegion({left:e,top:L,width:H,height:l});if(q){p.cssRegion({left:M===null?null:z=="right"?(M-q+K+D+B+N*2):0,top:y===null?null:z=="bottom"?(y-q+K):0,width:M===null?null:Math.max(0,((z=="left"||z=="right")?(q-K):M)),height:y===null?null:Math.max(0,((z=="top"||z=="bottom")?(q-K):y))})}e+=(H||0)+N*2;if(I){if(r!==null){I.style.height=Math.max(0,r-2)+x}if(H!==null){I.style.left=e+x}I.style.top=L+x;if(r!==null&&u.type=="spin"){if(r/2-2>0){G("R1").style.height=(r/2-2)+x;G("R2").style.height=(r/2-2)+x}}e+=D}if(E){if(r!==null){E.style.height=Math.max(0,r-2)+x}if(H!==null){E.style.left=e+x}E.style.top=L+x}if((h.$border||h.$shadow||h.$resizer)&&xui.browser.ie){A.ieRemedy()}}}});Class("xui.UI.Group","xui.UI.Div",{Instance:{activate:function(){var c=this.get(0);c.getSubNode("HANDLE").focus();return this},resetPanelView:function(d,e){if(!_.isSet(d)){d=true}if(!_.isSet(e)){e=true}var c;return this.each(function(f){if(f.renderId){delete f.$ini;if(d){c=f.boxing();c.removeChildren(true,e)}if(f.properties.toggle){c.setToggle(false)}}})},iniPanelView:function(){return this.each(function(c){if(!c.$ini){c.$ini=true;var d=c.properties;if(c.onIniPanelView){c.boxing().onIniPanelView(c)}if(d.iframeAutoLoad||d.ajaxAutoLoad){xui.UI.Div._applyAutoLoad(c)}}})}},Static:{Behaviors:{NavKeys:{CAPTION:1},HoverEffected:{TOGGLE:"TOGGLE"},ClickEffected:{TOGGLE:"TOGGLE"},DroppableKeys:["PANEL"],PanelKeys:["PANEL"],DraggableKeys:["HANDLE"],onSize:xui.UI.$onSize,HANDLE:{onClick:function(c,d,f){if(c.properties.toggleBtn){c.box._toggle(c,!c.properties.toggle);return false}},onKeydown:function(c,d,f){if(xui.Event.getKey(d).key=="enter"){xui(f).onClick()}}},PANEL:{onClick:function(c,f,g){var d=c.properties;if(d.disabled){return false}if(c.onClickPanel){return c.boxing().onClickPanel(c,f,g)}}}},Templates:{tagName:"div",style:"{_style}",className:"{_className}",FIELDSET:{tagName:"fieldset",className:" {toggleCls}",LEGEND:{tagName:"legend",style:"{_align}",HANDLE:{tabindex:"{tabindex}",TOGGLE:{className:"xui-uicmd-toggle2 {toggleCls2}",style:"{toggleDispplay}"},ICON:{$order:1,className:"xui-ui-icon {imageClass}",style:"{backgroundImage} {backgroundPosition} {backgroundRepeat} {imageDisplay}"},CAPTION:{text:"{caption}",$order:2}}},PANEL:{$order:1,tagName:"div",style:"{panelDisplay};{_panelstyle};{_overflow};",text:"{html}"+xui.UI.$childTag}}},Appearances:{KEY:{zoom:xui.browser.ie6?"1":null},FIELDSET:{border:"1px solid #7ba3cb",position:"relative",overflow:"hidden",zoom:xui.browser.ie6?"1":null},"FIELDSET-checked":{$order:2,"padding-left":"2px","border-left":"0","border-right":"0","border-bottom":"0"},LEGEND:{"margin-left":"3px"},HANDLE:{cursor:"default",padding:"0 3px 0 6px",display:xui.$inlineBlock},PANEL:{position:"relative",overflow:"auto","line-height":"auto",background:xui.browser.ie?"url("+xui.ini.img_bg+") no-repeat left top":null},"FIELDSET-checked PANEL":{$order:4,display:"none"},CAPTION:{"vertical-align":xui.browser.ie6?"baseline":"middle","font-family":'"Verdana", "Helvetica", "sans-serif"',"font-size":"12px","line-height":"18px"}},DataModel:{rotate:null,selectable:true,caption:{ini:undefined,action:function(c){c=(_.isSet(c)?c:"")+"";this.getSubNode("CAPTION").html(xui.adjustRes(c,true))}},html:{action:function(c){this.getSubNode("PANEL").html(xui.adjustRes(c,0,1))}},toggleBtn:{ini:true,action:function(c){this.getSubNode("TOGGLE").css("display",c?"":"none")}},toggle:{ini:true,action:function(c){this.box._toggle(this,c)}},image:{format:"image",action:function(c){this.getSubNode("ICON").css("display",c?"":"none").css("backgroundImage",c?("url("+xui.adjustRes(c||"")+")"):"")}},imagePos:{action:function(c){this.getSubNode("ICON").css("backgroundPosition",c)}},hAlign:{ini:"left",listbox:["left","center","right"],action:function(c){this.getSubNode("LEGEND").css("textAlign",c)}}},LayoutTrigger:function(){var c=this,d=c.properties;if(!d.toggle){c.box._toggle(c,false,true)}else{c.boxing().iniPanelView()}},EventHandlers:{onIniPanelView:function(c){},beforeFold:function(c){},beforeExpand:function(c){},afterFold:function(c){},afterExpand:function(c){},onClickPanel:function(c,d,f){}},_prepareData:function(d){var e={};if(!d.properties.toggle){e.height="auto"}e=arguments.callee.upper.call(this,d,e);var c="display:none";e.toggleDispplay=e.toggleBtn?"":c;e.panelDisplay=e.toggleBtn&&!e.toggle?c:"";e.toggleCls=e.toggleBtn&&!e.toggle?d.getClass("FIELDSET","-checked"):"";e.toggleCls2=e.toggleBtn&&e.toggle?"xui-uicmd-toggle2-checked":"";d._toggle=!!e.toggle;e._align="text-align:"+e.hAlign+";";return e},_toggle:function(f,g,c){var k=f.properties,d=f.boxing();if(g){d.iniPanelView()}if(c||f._toggle!==!!g){f._toggle=k.toggle=!!g;if(!c){if(g){if(d.beforeExpand&&false===d.beforeExpand(f)){return}}else{if(d.beforeFold&&false===d.beforeFold(f)){return}}}f.getSubNode("PANEL").css("display",g?"":"none");if(k.toggleBtn){f.getSubNode("TOGGLE").tagClass("-checked",!!g)}f.getSubNode("FIELDSET").tagClass("-checked",!g);var e=f.getSubNode("LEGEND").height();f.getRoot().height(k.toggle?k.height:e?e:"auto");if(!c){if(g){if(d.afterExpand){d.afterExpand(f)}}else{if(d.afterFold){d.afterFold(f)}}if(k.dock&&k.dock!="none"){d.adjustDock(true)}}}},_onresize:function(e,d,c){if(e._toggle){if(c&&c!="auto"){e.getSubNode("FIELDSET").height(c);e.getSubNode("PANEL").height(c-(e.getSubNode("LEGEND").height()||18))}}else{e.getRoot().height(e.getSubNode("LEGEND").height()||"auto")}if(d&&d!="auto"){e.getSubNode("PANEL").width(d-2)}}}});Class("xui.UI.ColorPicker",["xui.UI","xui.absValue"],{Instance:{activate:function(){this.getSubNode("TOGGLE").focus();return this},_setCtrlValue:function(d,c){return this.each(function(l){if(!l.renderId){return}var r=l.box,h=l.properties;if(d&&d.toLowerCase()=="transparent"){d="transparent"}var k=l.$hex=r._to3(d),g=l.$hex.join(""),q=l.$rgb=r.hex2rgb(d),m=l.$hsv=r.rgb2hsv(q),n=function(p,f){l.getSubNode(p).get(0).firstChild.nodeValue=String(f)},e=function(f){return parseInt(f*100,10)};if(d=="transparent"){k=l.$hex=["00","00","00"];q=l.$rgb=[0,0,0];m=l.$hsv=[0,0,0]}n("R",q[0]);n("G",q[1]);n("B",q[2]);n("H",k[0]);n("E",k[1]);n("X",k[2]);if(l.$hexinhsv!=g){n("HH",m[0]);n("S",e(m[1]));n("V",e(m[2]));delete l.$hexinhsv}r._setClrName(l,g);r._updateDftTip(l);if(h.advance&&l.$hexinadv!=g){r._updateMarks(l,d,true,m[0]);delete l.$hexinadv}if(c!=false){l.getSubNode("CAPTION").html((d=="transparent"?"":"#")+d,false)}})},getColorName:function(){return this.get(0).$clrN||""}},Initialize:function(){var k=this,c=xui.UI.$ID,p=xui.UI.$CLS,q=xui.UI.$tag_special,m=k.KEY,h=k._slist,d=h.length,f,e,g=[],n=xui.$IEUNSELECTABLE();k.addTemplateKeys(["TXT","DD1","DD2","DD3","R","G","B","HH","S","V","H","E","X"]);for(f=0;f<d;f++){g.push('<span  id="'+m+"-SC:"+c+":"+h[f]+'" style="background-color:#'+h[f]+'" '+n+">"+h[f]+"</span>")}e="<div "+n+'><span class="'+p+'-txt"'+n+'>R: </span><span id="'+m+"-R:"+c+':" class="'+p+"-dd2 xui-ui-draggable xui-bginput xui-uiborder-inset "+q+"DD2_CC"+q+'" '+n+'>R</span><span style="width:8px;height:8px" '+n+' ></span><span class="'+p+'-txt"'+n+'>H: </span><span id="'+m+"-HH:"+c+':" class="'+p+"-dd2 xui-ui-draggable xui-bginput xui-uiborder-inset  "+q+"DD2_CC"+q+'" '+n+">H</span><span "+n+">\xB0</span></div><div "+n+'><span class="'+p+'-txt"'+n+'>G: </span><span id="'+m+"-G:"+c+':" class="'+p+"-dd2 xui-ui-draggable xui-bginput xui-uiborder-inset  "+q+"DD2_CC"+q+'" '+n+'>G</span><span style="width:8px;height:8px" '+n+' ></span><span class="'+p+'-txt"'+n+'>S: </span><span id="'+m+"-S:"+c+':" class="'+p+"-dd2 xui-ui-draggable xui-bginput xui-uiborder-inset  "+q+"DD2_CC"+q+'"  '+n+">S</span><span "+n+">%</span></div><div "+n+'><span class="'+p+'-txt"'+n+'>B: </span><span id="'+m+"-B:"+c+':" class="'+p+"-dd2 xui-ui-draggable xui-bginput xui-uiborder-inset  "+q+"DD2_CC"+q+'" '+n+'>B</span><span style="width:8px;height:8px" '+n+' ></span><span class="'+p+'-txt"'+n+'>V: </span><span id="'+m+"-V:"+c+':" class="'+p+"-dd2 xui-ui-draggable xui-bginput xui-uiborder-inset  "+q+"DD2_CC"+q+'" '+n+">V</span><span "+n+">%</span></div><div "+n+'><span style="width:38px"'+n+'>HEX: </span><span id="'+m+"-H:"+c+':" class="'+p+"-dd3 xui-ui-draggable xui-bginput xui-uiborder-inset  "+q+"DD3_CC"+q+'" '+n+'>H</span><span id="'+m+"-E:"+c+':" class="'+p+"-dd3 xui-ui-draggable xui-bginput xui-uiborder-inset  "+q+"DD3_CC"+q+'" '+n+""+n+'>E</span><span id="'+m+"-X:"+c+':" class="'+p+"-dd1 xui-ui-draggable xui-bginput xui-uiborder-inset  "+q+"DD1_CC"+q+'" '+n+">X</span></div>";k.setTemplate({style:"{_style};height:auto;width:{_width}px;",tagName:"div",onselectstart:"return false",BORDER:{tagName:"div",BAR:{tagName:"div",className:"{classBar}",BART:{cellpadding:"0",cellspacing:"0",width:"100%",border:"0",className:"xui-uibar-t",tagName:"table",BARTR:{tagName:"tr",BARTDL:{tagName:"td",className:"xui-uibar-tdl"},BARTDM:{$order:1,width:"100%",tagName:"td",className:"xui-uibar-tdm"},BARTDR:{$order:2,tagName:"td",className:"xui-uibar-tdr"}}},BARCMDL:{tagName:"div",className:"xui-uibar-cmdl"},BARCMDR:{tagName:"div",className:"xui-uibar-cmdr",CLOSE:{className:"xui-uicmd-close ",style:"{closeDisplay}"}}},MAIN:{$order:2,tagName:"div",className:"xui-uicon-main",MAINI:{tagName:"div",className:"xui-uibg-bar xui-uicon-maini",CON:{$order:1,tagName:"div",className:"xui-uiborder-inset",SIMPLE:{tagName:"div",TOP:{$order:1,tagName:"div",DATA:{$order:0,tagName:"div",onselectstart:"return false",text:e},TRANS:{className:"xui-ui-btn",TRANSI:{className:"xui-ui-btni",TRANSC:{className:"xui-ui-btnc",TRANSA:{tabindex:"{tabindex}",text:"{_transparent}"}}}},EXAM:{$order:3,tagName:"div",className:"xui-uiborder-outset xui-uibg-bar",EXAMI:{tagName:"div",className:"xui-uiborder-inset"}}},LIST:{$order:2,tagName:"div",text:g.join("")}},ADV:{$order:2,style:"{advDispay}",tagName:"div",ADVWHEEL:{$order:0,tagName:"div"},ADVCLR:{$order:1,tagName:"div"},ADVMARK1:{$order:3,tagName:"div"},ADVMARK2:{$order:4,tagName:"div"}}}}},TAIL:{$order:3,tagName:"div",className:"xui-uicon-main",TAILI:{tagName:"div",className:"xui-uibg-bar xui-uicon-maini",CAPTION:{text:"{caption}"},SET:{className:"xui-ui-btn",SETI:{className:"xui-ui-btni",SETC:{className:"xui-ui-btnc",SETA:{tabindex:"{tabindex}",text:"{_set}"}}}},TOGGLE:{$order:2,tabindex:"{tabindex}"}}},BBAR:{$order:4,tagName:"div",className:"xui-uibar-bottom-s",BBART:{cellpadding:"0",cellspacing:"0",width:"100%",border:"0",tagName:"table",className:"xui-uibar-t",BBARTR:{tagName:"tr",BBARTDL:{tagName:"td",className:"xui-uibar-tdl"},BBARTDM:{$order:1,width:"100%",tagName:"td",className:"xui-uibar-tdm"},BBARTDR:{$order:2,tagName:"td",className:"xui-uibar-tdr"}}}}}})},Static:{_radius:84,_square:100,_bigRadius:97,_shadowRB:"BBARTDR",DataModel:{height:{ini:"auto",readonly:true},width:{ini:"auto",readonly:true},value:{ini:"FFFFFF",format:"color"},barDisplay:{ini:true,action:function(c){if(c){this.getSubNode("BAR").replaceClass("xui-uibar-top-s","xui-uibar-top")}else{this.getSubNode("BAR").replaceClass("xui-uibar-top","xui-uibar-top-s")}}},closeBtn:{ini:true,action:function(c){this.getSubNode("CLOSE").css("display",c?"":"none")}},advance:{ini:false,action:function(c){var d=this;d.getSubNode("ADV").css("display",c?"":"none");d.getSubNode("TOGGLE").tagClass("-adv",c);d.getRoot().width(c?410:210);if(c){d.box._updateMarks(d,d.properties.$UIvalue,true,d.$hsv[0])}}}},Appearances:{KEY:{},MAINI:{padding:"4px 5px 4px 0"},CON:{height:"198px",padding:"3px",position:"relative"},DATA:{"float":"left",width:"112px",height:"86px"},"DATA span":{"float":"left"},"DATA div":{"padding-top":"3px",clear:"both"},TXT:{width:"16px"},CAPTION:{"font-size":"12px","vertical-align":xui.browser.ie6?"baseline":"middle"},EXAM:{"float":"left","margin-top":"24px",padding:"3px"},EXAMI:{height:"50px",width:"70px","white-space":"normal","text-align":"center"},"DD1, DD2, DD3":{display:"block",height:"16px",border:"1px solid #779EBF","padding-right":"2px",cursor:"e-resize","text-align":"right",background:"#F8FBFF"},DD1:{width:"16px"},DD2:{width:"24px"},DD3:{$order:2,width:"16px","border-right":"none"},TOP:{height:"92px",position:"relative"},LIST:{height:"106px",position:"relative",overflow:"hidden",margin:"0 2px","line-height":xui.browser.ie6?"0":null,clear:"both"},TAILI:{position:"relative","padding-top":"4px",height:"22px","text-align":"center"},SIMPLE:{"float":"left",width:"192px",position:"relative"},ADV:{"float":"right",width:"195px",height:"195px",position:"relative"},"ADV div":{cursor:"crosshair",position:"absolute"},ADVCLR:{background:xui.browser.ie6?null:xui.UI.$bg("bg.png","no-repeat left top"),_filter:xui.UI.$ieBg("bg.png"),height:"101px",left:"47px",top:"47px",width:"101px"},ADVWHEEL:{background:xui.browser.ie6?null:xui.UI.$bg("clr.png","no-repeat left top"),_filter:xui.UI.$ieBg("clr.png"),height:"195px",width:"195px"},"ADVMARK1, ADVMARK2":{background:xui.browser.ie6?null:xui.UI.$bg("picker.png","no-repeat left top"),_filter:xui.UI.$ieBg("picker.png"),height:"16px",margin:"-8px 0pt 0pt -8px",overflow:"hidden",width:"16px"},"LIST span":{height:"12px",width:"10px","font-size":xui.browser.ie6?"0":null,"float":"left",display:"block",overflow:"hidden","text-indent":"100px",margin:"0",cursor:"pointer",border:"1px solid #000",margin:"0 -1px -1px 0"},TRANS:{position:"absolute",top:"0",right:"0"},TRANSA:{width:"72px","text-align":"center"},SET:{position:"absolute",color:"#ff0000",display:"none",top:"0",right:"28px"},TOGGLE:{position:"absolute",right:"6px",top:"4px",display:xui.$inlineBlock,width:"15px",height:"15px",cursor:"default","background-image":xui.UI.$bg("icons.gif","",true),"background-repeat":"no-repeat","background-position":"-300px -70px",zoom:xui.browser.ie6?1:null},"TOGGLE-mouseover":{"background-position":"-300px -90px"},"TOGGLE-mousedown":{"background-position":"-300px -110px"},"TOGGLE-adv":{"background-position":"-240px -70px"},"TOGGLE-adv-mouseover":{"background-position":"-240px -90px"},"TOGGLE-adv-mousedown":{"background-position":"-240px -110px"}},Behaviors:{HoverEffected:{CLOSE:"CLOSE",SET:"SET",TRANS:"TRANS",TOGGLE:"TOGGLE"},ClickEffected:{CLOSE:"CLOSE",SET:"SET",TRANS:"TRANS",TOGGLE:"TOGGLE"},KEY:{onClick:function(){return false}},SC:{onMouseover:function(f,d,c){f.box._setTempUI(f,f.getSubId(c))},onClick:function(g,f,d){var c=g.getSubId(d);g.boxing()._setCtrlValue(g.$tempValue=c,false);g.box._vC(g);if(!g.properties.advance){g.boxing().setUIValue(c,true,null,"click")}return false},onDblclick:function(g,f,d){var c=g.getSubId(d);g.boxing()._setCtrlValue(g.$tempValue=c,false);g.box._vC(g);g.boxing().setUIValue(c,true,null,"dblclick");return false}},LIST:{onMouseout:function(f,d,c){f.box._updateDftTip(f)}},SET:{onClick:function(d,c,f){d.box._vC(d);d.boxing().setUIValue(d.$tempValue,true,null,"setbtn")}},TRANS:{onClick:function(d,c,f){d.box._vC(d);d.boxing().setUIValue(d.$tempValue="transparent",true,null,"transbtn")}},CANCEL:{onClick:function(d,c,f){d.getSubNode("CLOSE").onClick(true)}},TOGGLE:{onClick:function(d,c,f){d.boxing().setAdvance(!d.properties.advance)}},R:{beforeMousedown:function(d,c,f){d.box._dd1(d,c,f)},onDrag:function(d,c,f){d.box._dd2(d,c,f,0)},onDragstop:function(d,c,f){d.box._dd3(d,c,f,0)}},G:{beforeMousedown:function(d,c,f){d.box._dd1(d,c,f)},onDrag:function(d,c,f){d.box._dd2(d,c,f,1)},onDragstop:function(d,c,f){d.box._dd3(d,c,f,1)}},B:{beforeMousedown:function(d,c,f){d.box._dd1(d,c,f)},onDrag:function(d,c,f){d.box._dd2(d,c,f,2)},onDragstop:function(d,c,f){d.box._dd3(d,c,f,2)}},HH:{beforeMousedown:function(d,c,f){d.box._dd1(d,c,f,true)},onDrag:function(d,c,f){d.box._dd2(d,c,f,0,"hsv1")},onDragstop:function(d,c,f){d.box._dd3(d,c,f,0,true,"hsv1")}},S:{beforeMousedown:function(d,c,f){d.box._dd1(d,c,f,true)},onDrag:function(d,c,f){d.box._dd2(d,c,f,1,"hsv2")},onDragstop:function(d,c,f){d.box._dd3(d,c,f,1,true,"hsv2")}},V:{beforeMousedown:function(d,c,f){d.box._dd1(d,c,f,true)},onDrag:function(d,c,f){d.box._dd2(d,c,f,2,"hsv2")},onDragstop:function(d,c,f){d.box._dd3(d,c,f,2,true,"hsv2")}},H:{beforeMousedown:function(d,c,f){d.box._dd1(d,c,f)},onDrag:function(d,c,f){d.box._dd2(d,c,f,0,"hex")},onDragstop:function(d,c,f){d.box._dd3(d,c,f,0)}},E:{beforeMousedown:function(d,c,f){d.box._dd1(d,c,f)},onDrag:function(d,c,f){d.box._dd2(d,c,f,1,"hex")},onDragstop:function(d,c,f){d.box._dd3(d,c,f,1)}},X:{beforeMousedown:function(d,c,f){d.box._dd1(d,c,f)},onDrag:function(d,c,f){d.box._dd2(d,c,f,2,"hex")},onDragstop:function(d,c,f){d.box._dd3(d,c,f,2)}},CLOSE:{onClick:function(f,g,h){var d=f.properties,c=f.boxing();if(d.disabled||d.readonly){return}if(false===c.beforeClose(f)){return}c.destroy()}},ADVWHEEL:{beforeMousedown:function(f,d,g){var c=f.box;c._prepareAdv(f,d);c._updateClrByPos(f,d,true);f.getSubNode("ADVMARK1").startDrag(d,{dragType:"none"})}},ADVMARK1:{beforeMousedown:function(f,d,g){var c=f.box;c._prepareAdv(f,d);c._updateClrByPos(f,d,true);f.getSubNode("ADVMARK1").startDrag(d,{dragType:"none"})},onDrag:function(f,d,g){var c=f.box;c._updateClrByPos(f,d,true)},onDragstop:function(d,c,f){d.box._updateValueByPos(d,c)},onDblclick:function(d,c,f){d.box._updateValueByPos(d,c);d.box._vC(d);d.boxing().setUIValue(d.$tempValue,true,null,"advdblclick")}},ADVCLR:{beforeMousedown:function(f,d,g){var c=f.box;c._prepareAdv(f,d);c._updateClrByPos(f,d);f.getSubNode("ADVMARK2").startDrag(d,{dragType:"none"});return false}},ADVMARK2:{beforeMousedown:function(f,d,g){var c=f.box;c._prepareAdv(f,d);c._updateClrByPos(f,d);f.getSubNode("ADVMARK2").startDrag(d,{dragType:"none"});return false},onDrag:function(f,d,g){var c=f.box;c._updateClrByPos(f,d)},onDragstop:function(d,c,f){d.box._updateValueByPos(d,c)},onDblclick:function(d,c,f){d.box._updateValueByPos(d,c);d.box._vC(d);d.boxing().setUIValue(d.$tempValue,true,null,"adv2dblclick")}}},_vC:function(e){var g=e.properties,c=g.$UIvalue,f=c==e.$tempValue;e.getSubNode("SET").css("display",f?"none":"block");e.getSubNode("CAPTION").css("color",f?"#000":"#ff0000")},_prepareData:function(d){var e=arguments.callee.upper.call(this,d);var c="display:none";e.classBar=e.barDisplay?"xui-uibar-top":"xui-uibar-top-s";e.closeDisplay=e.closeBtn?"":c;e._width=e.advance?"410":"210";e.advDispay=e.advance?"":"display:none;";e._transparent=xui.wrapRes("inline.transparent");e._set=xui.wrapRes("inline.set");return e},EventHandlers:{beforeClose:function(c,d){}},RenderTrigger:function(){this.$onValueSet=this.$onUIValueSet=function(d,c){this.box._setClrName(this,c)}},_setClrName:function(e,d){var g=e,c="color.LIST.",f=xui.getRes(c+d);if(f==d){g.$clrN2=g.$clrN="#"+d}else{g.$clrN=f;g.$clrN2=xui.wrapRes(c+d)}},_slist:"FFFFFF,FFFFF0,FFFFE0,FFFF00,FFFAFA,FFFAF0,FFFACD,FFF8DC,FFF5EE,FFF0F5,FFEFD5,FFEBCD,FFE4E1,FFE4C4,FFE4B5,FFDEAD,FFDAB9,FFD700,FFC0CB,FFB6C1,FFA500,FFA07A,FF8C00,FF7F50,FF69B4,FF6347,FF4500,FF1493,FF00FF,FF00FF,FF0000,FDF5E6,FAFAD2,FAF0E6,FAEBD7,FA8072,F8F8FF,F5FFFA,F5F5F5,F5DEB3,F4A460,F0FFFF,F0FFF0,F0F8FF,F0E68C,F08080,EEE8AA,EE82EE,E9967A,E6E6FA,E1FFFF,DEB887,DDA0DD,DCDCDC,DC143C,DB7093,DAA520,DA70D6,D8BFD8,D3D3D3,D2B48C,D2691E,CD853F,CD5C5C,C71585,C0C0C0,BDB76B,BC8F8F,BA55D3,B22222,B0E0E6,B0C4DE,AFEEEE,ADFF2F,ADD8E6,A9A9A9,A52A2A,A0522D,9932CC,98FB98,9400D3,9370DB,90EE90,8FBC8F,8B4513,8B008B,8B0000,8A2BE2,87CEFA,87CEEB,808080,808000,800080,800000,7FFFAA,7FFF00,7CFC00,7B68EE,778899,708090,6B8E23,6A5ACD,696969,6495ED,5F9EA0,556B2F,4B0082,48D1CC,483D8B,4682B4,4169E1,40E0D0,3CB371,32CD32,2F4F4F,2E8B57,228B22,20B2AA,1E90FF,191970,00FFFF,00FFFF,00FF7F,00FF00,00FA9A,00CED1,00BFFF,008B8B,008080,008000,006400,0000FF,0000CD,00008B,000080,000000".split(","),_C16:"0123456789ABCDEF",_dd1:function(g,l,m,d){if(xui.Event.getBtn(l)!="left"){return}var k=g.properties,c=g.box,h=function(){var e=c.hex2rgb(g.$tempValue||k.$UIvalue);return d?c.rgb2hsv(e):e};xui.use(m).css("backgroundColor","red").startDrag(l,{dragType:"blank",targetReposition:false,widthIncrement:2,dragCursor:true});g.$temp=0;g.$start=h();g.$temp2=h()},_dd2:function(h,n,c,k,q){var l,g=xui.DragDrop.getProfile().offset,d=h.properties,f=h.$temp2,u=h.box,m=q=="hsv1"?361:q=="hsv2"?101:256,r;l=(q=="hsv2"?parseInt(h.$start[k]*100,10):parseInt(h.$start[k],10))+parseInt(g.x/2,10);l=(l%m+m)%m;if(h.$temp!=l){f[k]=h.$temp=q=="hsv2"?l/100:l;r=(q=="hsv1"||q=="hsv2")?u.hsv2rgb(f):f;r=u.rgb2hex(r);u._setTempUI(h,r);xui.use(c).text(q=="hex"?u._toFF(l):l)}},_dd3:function(g,l,c,h,k){if(g.$start[h]!==g.$temp){var d=g.properties,n=g.box,f=g.$start,m;f[h]=g.$temp;m=k?n.hsv2rgb(f):f;m=n.rgb2hex(m);if(k){g.$hexinhsv=m}g.boxing()._setCtrlValue(g.$tempValue=m,false);delete g.$hexinhsv;g.box._vC(g)}xui.use(c).css("backgroundColor","");g.$temp=g.$start=0},_setTempUI:function(l,e){var d=this,g=d.hex2rgb(e),c=l.boxing(),h=c.getSubNode("EXAMI"),f=d.rgb2hsv(g),k=xui.getRes("color.LIST."+e);h.css({backgroundColor:"#"+e,color:f[2]>0.6?"#000":"#FFF"});h.text(l.show_color=k==e?"#"+e:k)},_updateDftTip:function(e){var c=e.box,d=e.boxing().getSubNode("EXAMI");d.css({backgroundColor:"#"+e.$hex.join(""),color:e.$hsv[2]>0.6?"#000":"#FFF"});d.html(e.$clrN2||"",false)},_to3:function(c){if(!c){c="FFFFFF"}return[c.substr(0,2),c.substr(2,2),c.substr(4,2)]},_toFF:function(d){var c=this._C16;d=parseInt(d,10)||0;d=(d>255||d<0)?0:d;return c.charAt((d-d%16)/16)+c.charAt(d%16)},_to255:function(e){var d=this._C16,c=e.split("");return d.indexOf(c[0].toUpperCase())*16+d.indexOf(c[1].toUpperCase())},_webSafe:function(h,e,c){var d=arguments.callee,k=d.f||(d.f=function(f){return parseInt(f/51,10)*51});if(typeof h=="object"){e=h[1];c=h[2];h=h[0]}return[k(h),k(e),k(c)]},_updateMarks:function(d,c,k,h){var n=this,g=n.hex2rgb(c),f=n.rgb2hsv(g),e=(f[0]/360)*6.28,p=d.getSubNode("ADVCLR");if(k){var m=d.getSubNode("ADVMARK1"),l=d.getSubNode("ADVMARK2");m.cssPos({left:Math.round(Math.sin(e)*n._radius+n._bigRadius),top:Math.round(-Math.cos(e)*n._radius+n._bigRadius)});l.cssPos({left:Math.round(n._square*(f[1]-0.5)+n._bigRadius),top:Math.round(n._square*(0.5-f[2])+n._bigRadius)})}if(h!==undefined){p.css("backgroundColor","#"+n.rgb2hex(n.hsv2rgb([h,1,1])))}n._setTempUI(d,c)},_updateClrByPos:function(f,n,p){var z=this,k=xui.Event.getPos(n),r=f.$tpos,d=k.left-r.left,u=k.top-r.top,g,y,x,m,A,w,l,q,c;if(p){y=f.getSubNode("ADVMARK1");g=Math.atan2(d,-u);y.cssPos({left:Math.round(Math.sin(g)*z._radius+z._bigRadius),top:Math.round(-Math.cos(g)*z._radius+z._bigRadius)});m=Math.floor((g/Math.PI)*180);if(m<0){m+=360}l=[m,f.$hsv[1],f.$hsv[2]];q=z.hsv2rgb(l);c=z.rgb2hex(q);z._updateMarks(f,f.$t_hex=c,false,m)}else{x=f.getSubNode("ADVMARK2");A=Math.max(0,Math.min(1,(d/z._square)+0.5));w=Math.max(0,Math.min(1,0.5-(u/z._square)));x.cssPos({left:Math.round(z._square*(A-0.5)+z._bigRadius),top:Math.round(z._square*(0.5-w)+z._bigRadius)});l=[f.$hsv[0],A,w];q=z.hsv2rgb(l);c=z.rgb2hex(q);z._updateMarks(f,f.$t_hex=c)}},_updateValueByPos:function(c,d){c.$hexinadv=c.$t_hex;c.boxing()._setCtrlValue(c.$tempValue=c.$t_hex,false);delete c.$hexinadv;c.box._vC(c)},_prepareAdv:function(d,f){var c=this,g=d.getSubNode("ADVWHEEL").offset();d.$tpos={left:g.left+c._bigRadius,top:g.top+c._bigRadius}},_ensureValue:function(e,n){var l=this,h=arguments.callee,c=h.map||(h.map=(function(){var k={};_.arr.each(l._C16.split(""),function(q,p){k[q]=1});return k}())),d=h._r||(h._r=/rgb\(([^)]*)\)/);if(!n||typeof n!="string"||n=="transparent"){return"transparent"}if(d.test(n)){n=n.replace(d,"$1");n=n.split(",");n[0]=parseInt(n[0],10)||0;n[1]=parseInt(n[1],10)||0;n[2]=parseInt(n[2],10)||0;n=l.rgb2hex(n)}if(n.charAt(0)=="#"){n=n.substr(1,n.length)}var m="",f;for(var g=0;g<6;g++){f=n.charAt(g).toUpperCase();m+=(c[f]?f:"F")}return m},hsv2rgb:function(n,B,z){if(n instanceof Array){B=n[1];z=n[2];n=n[0]}var x=arguments.callee,w=x.f||(x.f=function(f){return Math.min(255,Math.round(f*256))}),c,u,y,m,l,e,d,A;if(B==0){return[z=w(z),z,z]}else{m=Math.floor((n/60)%6);l=(n/60)-m;e=z*(1-B);d=z*(1-l*B);A=z*(1-(1-l)*B);switch(m){case 0:c=z;u=A;y=e;break;case 1:c=d;u=z;y=e;break;case 2:c=e;u=z;y=A;break;case 3:c=e;u=d;y=z;break;case 4:c=A;u=e;y=z;break;case 5:c=z;u=e;y=d;break}return B==0?[z=w(z),z,z]:[w(c),w(u),w(y)]}},rgb2hsv:function(c,f,k){if(c instanceof Array){f=c[1];k=c[2];c=c[0]}c=c/255;f=f/255;k=k/255;var d=Math.min(c,f,k),l=Math.max(c,f,k),m=l-d,p=(l===0)?0:1-(d/l),n=l,e;switch(l){case d:e=0;break;case c:e=60*(f-k)/m;if(f<k){e+=360}break;case f:e=(60*(k-c)/m)+120;break;case k:e=(60*(c-f)/m)+240;break}return[Math.round(e),p,n]},rgb2hex:function(f,e,c){var d=this;if(f instanceof Array){e=f[1];c=f[2];f=f[0]}return d._toFF(f)+d._toFF(e)+d._toFF(c)},hex2rgb:function(d){var c=this;if(!d){d="FFFFFF"}if(d.charAt(0)=="#"){d=d.slice(1)}return[c._to255(d.substr(0,2)),c._to255(d.substr(2,2)),c._to255(d.substr(4,2))]},getTextColor:function(d){var c=this;d=c._ensureValue(0,d);if(d&&d.toLowerCase()=="transparent"){return"#000000"}d=c.hex2rgb(d);d=c.rgb2hsv(d);return(d&&d[2])>0.6?"#000000":"#FFFFFF"},_onresize:function(){}}});Class("xui.UI.DatePicker",["xui.UI","xui.absValue"],{Dependencies:["xui.Date"],Instance:{activate:function(){this.getSubNode("PRE").focus();return this},_setCtrlValue:function(c){return this.each(function(e){if(!e.renderId){return}var d=e.box,f=e.properties;d._to(e,c,true);if(e.keys.CAPTION){e.getSubNode("CAPTION").html(xui.Date.getText(c,"ymd",f.firstDayOfWeek),false)}})},getDateFrom:function(){return this.get(0)._realstart}},Initialize:function(){var p=this,q=xui.UI.$ID,E=xui.UI.$tag_special,c=xui.UI.$CLS,F=p.KEY;p.addTemplateKeys(["H","COL","W","TBODY","THEADER","TD"]);var m='<colgroup id="'+F+"-COL:"+q+':"  class="'+E+"COL_CS"+E+' xui-custom {comcls}"  style="'+E+"COL_CS"+E+'"><col width="2%"/><col width="14%"/><col width="14%"/><col width="14%"/><col width="14%"/><col width="14%"/><col width="14%"/><col width="14%"/></colgroup>',e='<thead ID="'+F+"-THEADER:"+q+':" class="'+E+"THEADER_CS"+E+' xui-custom {comcls}"  style="'+E+"THEADER_CS"+E+'" ><tr height="1%"><th id="'+F+"-H:"+q+':7" class="xui-node xui-uith xui-uiborder-rb xui-node-th '+c+"-h "+c+"-w "+E+"H_CC"+E+' xui-custom {comcls}" style="'+E+"H_CS"+E+'"></th>',d="</tr></thead>",h='<th id="'+F+"-H:"+q+':@" class="xui-node xui-uith xui-uiborder-rb xui-node-th '+c+"-h "+E+"H_CC"+E+' xui-custom {comcls}"  style="'+E+"H_CS"+E+'">@</th>',x='<tbody id="'+F+"-TBODY:"+q+':"  class="'+E+"TBODY_CS"+E+' xui-custom {comcls}"  style="'+E+"TBODY_CS"+E+'" >',u="</tbody>",D="<tr>",B="</tr>",g='<th id="'+F+"-W:"+q+':@"  class="xui-node xui-uith xui-uiborder-rb xui-node-th '+c+"-w "+E+"W_CC"+E+' xui-custom {comcls}"  style="'+E+"W_CS"+E+'">@</th>',f='<td id="'+F+"-TD:"+q+':@" class="xui-node xui-uitd xui-uiborder-rb xui-node-td '+c+"-td "+E+"TD_CC"+E+' xui-custom {comcls}"  style="'+E+"TD_CS"+E+'" '+xui.$IEUNSELECTABLE()+" ></td>",n,z,y,w,r,C=[],A=[];for(z=0;z<7;z++){A[A.length]=h.replace(/@/g,z)}w=r=0;for(z=0;z<48;z++){y=z%8;C[C.length]=(y==0?D:"")+(y==0?g:f).replace(/@/g,y==0?r:w)+(y==7?B:"");if(y!==0){w++}else{r++}}n=m+e+A.join("")+d+x+C.join("")+u;p.setTemplate({tagName:"div",style:"{_style};height:auto;",onselectstart:"return false",BORDER:{tagName:"div",BAR:{tagName:"div",className:"xui-uibar-top",style:"{barDisplay};",BART:{cellpadding:"0",cellspacing:"0",width:"100%",border:"0",className:"xui-uibar-t",tagName:"table",BARTR:{tagName:"tr",BARTDL:{tagName:"td",className:"xui-uibar-tdl"},BARTDM:{$order:1,width:"100%",tagName:"td",className:"xui-uibar-tdm"},BARTDR:{$order:2,tagName:"td",className:"xui-uibar-tdr"}}},BARCMDL:{tagName:"div",className:"xui-uibar-cmdl",PRE2:{$order:0,tabindex:"{tabindex}"},PRE:{$order:1,tabindex:"{tabindex}"},YEAR:{$order:2,className:"xui-ui-draggable xui-bginput xui-uiborder-inset"},YTXT:{$order:3,text:"-"},MONTH:{$order:4,className:"xui-ui-draggable xui-bginput xui-uiborder-inset"},MTXT:{$order:5,text:"-"},DAY:{$order:6,className:"xui-ui-draggable xui-bginput xui-uiborder-inset"},NEXT:{$order:7,tabindex:"{tabindex}"},NEXT2:{$order:8,tabindex:"{tabindex}"}},BARCMDR:{tagName:"div",className:"xui-uibar-cmdr",CLOSE:{className:"xui-uicmd-close ",style:"{closeDisplay}"}}},MAIN:{$order:2,tagName:"div",className:"xui-uicon-main",MAINI:{tagName:"div",className:"xui-uibg-bar xui-uicon-maini",CON:{tagName:"div",className:"xui-uiborder-inset",BODY:{tagName:"table",cellpadding:"0",cellspacing:"0",width:"100%",text:n}}}},TAIL:{$order:3,tagName:"div",className:"xui-uicon-main",TAILI:{tagName:"div",className:"xui-uibg-bar xui-uicon-maini",CAPTION:{tagName:"div",style:"{_nocap}",text:"{caption}",$order:0},TIME:{style:"{_timectrl}",tagName:"div",TPRE2:{$order:0,tabindex:"{tabindex}"},TPRE:{$order:1,tabindex:"{tabindex}"},HOUR:{$order:2,className:"xui-ui-draggable xui-bginput xui-uiborder-inset"},MTXT:{$order:3,text:":"},MINUTE:{$order:4,className:"xui-ui-draggable xui-bginput xui-uiborder-inset"},TNEXT:{$order:6,tabindex:"{tabindex}"},TNEXT2:{$order:7,tabindex:"{tabindex}"}},TODAY:{tabindex:"{tabindex}",title:"{_todaytitle}"},SET:{className:"xui-ui-btn",SETI:{className:"xui-ui-btni",SETC:{className:"xui-ui-btnc",SETA:{tabindex:"{tabindex}",text:"{_set}"}}}}}},BBAR:{$order:4,tagName:"div",className:"xui-uibar-bottom-s",BBART:{cellpadding:"0",cellspacing:"0",width:"100%",border:"0",tagName:"table",className:"xui-uibar-t",BBARTR:{tagName:"tr",BBARTDL:{tagName:"td",className:"xui-uibar-tdl"},BBARTDM:{$order:1,width:"100%",tagName:"td",className:"xui-uibar-tdm"},BBARTDR:{$order:2,tagName:"td",className:"xui-uibar-tdr"}}}}}})},Static:{_shadowRB:"BBARTDR",Appearances:{KEY:{overflow:"visible"},BORDER:{overflow:"visible",position:"relative"},BODY:{position:"relative"},BARCMDL:{top:"3px"},TAILI:{position:"relative",height:"24px"},TIME:{padding:"2px 18px"},SET:{position:"absolute",display:"none",color:"#ff0000",top:"0",right:"5px"},TODAY:{position:"absolute",top:"3px",left:"0",display:xui.$inlineBlock,width:"16px",height:"16px",cursor:"default","background-image":xui.UI.$bg("icons.gif","",true),"background-repeat":"no-repeat","background-position":"right top",_zoom:1},"TODAY-mouseover":{"background-position":"right -20px"},"TODAY-mousedown":{"background-position":"right -40px"},"PRE,PRE2,NEXT,NEXT2,TPRE,TPRE2,TNEXT,TNEXT2":{$order:0,display:xui.$inlineBlock,position:"relative",margin:"0 2px",width:"15px",height:"15px","vertical-align":"middle",cursor:"default","background-image":xui.UI.$bg("icons.gif","",true),"background-repeat":"no-repeat",_zoom:1},"PRE, TPRE":{$order:1,"background-position":"-260px -70px"},"PRE-mouseover, TPRE-mouseover":{$order:2,"background-position":"-260px -90px"},"PRE-mousedown, TPRE-mousedown":{$order:3,"background-position":"-260px -110px"},"PRE2, TPRE2":{$order:1,"background-position":"-240px -70px"},"PRE2-mouseover, TPRE2-mouseover":{$order:2,"background-position":"-240px -90px"},"PRE2-mousedown, TPRE2-mousedown":{$order:3,"background-position":"-240px -110px"},"NEXT, TNEXT":{$order:1,"background-position":"-280px -70px"},"NEXT-mouseover, TNEXT-mouseover":{$order:2,"background-position":"-280px -90px"},"NEXT-mousedown, TNEXT-mousedown":{$order:3,"background-position":"-280px -110px"},"NEXT2, TNEXT2":{$order:1,"background-position":"-300px -70px"},"NEXT2-mouseover, TNEXT2-mouseover":{$order:2,"background-position":"-300px -90px"},"NEXT2-mousedown, TNEXT2-mousedown":{$order:3,"background-position":"-300px -110px"},"YEAR,MONTH,DAY,HOUR,MINUTE":{$order:4,height:"15px","font-weight":"bold","vertical-align":"middle","padding-left":"2px",cursor:"e-resize"},YEAR:{width:"32px"},"MONTH, DAY,HOUR, MINUTE":{width:"16px"},CAPTION:{padding:"4px 0 0 0","text-align":"center","font-size":"12px","vertical-align":xui.browser.ie6?"baseline":"middle"},MAINI:{"padding-top":"4px","padding-bottom":"4px"},BODY:{overflow:"visible"},TD:{$order:1,"text-align":"center","font-size":"12px"},"TD-checked":{$order:4,"font-weight":"bold"},"W,H":{$order:3,"vertical-align":"middle","text-align":"center","font-size":"12px"}},Behaviors:{HoverEffected:{CLOSE:"CLOSE",TD:"TD",PRE:"PRE",PRE2:"PRE2",NEXT:"NEXT",NEXT2:"NEXT2",TPRE:"TPRE",TPRE2:"TPRE2",TNEXT:"TNEXT",TNEXT2:"TNEXT2",SET:"SET",TODAY:"TODAY"},ClickEffected:{CLOSE:"CLOSE",TD:"TD",PRE:"PRE",PRE2:"PRE2",NEXT:"NEXT",NEXT2:"NEXT2",TPRE:"TPRE",TPRE2:"TPRE2",TNEXT:"TNEXT",TNEXT2:"TNEXT2",SET:"SET",TODAY:"TODAY"},KEY:{onClick:function(){return false}},TD:{onClick:function(d,h,k){var g=d.properties,l=d.getSubId(k),f=d.$daymap,c=f[l];if(g.disabled||g.readonly){return false}xui.use(k).onMouseout(true,{$force:true});c=xui.Date.add(d.$tempValue,"d",xui.Date.diff(d.$tempValue,c,"d",g.firstDayOfWeek));d.box._to(d,c);if(!g.timeInput){d.boxing().setUIValue(c,null,null,"click")}},onDblclick:function(c,f,g){var d=c.properties;if(d.timeInput){xui.use(g).onMouseout(true,{$force:true});c.boxing().setUIValue(c.$tempValue,true,null,"dblclick")}}},TODAY:{onClick:function(c,d,f){xui.use(f).onMouseout(true,{$force:true});c.boxing().setUIValue(c.properties.timeInput?new Date:xui.Date.getTimSpanStart(new Date,"d",1),true,null,"today")}},SET:{onClick:function(c,d,f){xui.use(f).onMouseout(true,{$force:true});c.boxing().setUIValue(c.$tempValue,true,null,"set")}},CLOSE:{onClick:function(d,g,h){var f=d.properties,c=d.boxing();if(f.disabled||f.readonly){return}if(false===c.beforeClose(d,h)){return}c.destroy(true)}},PRE:{onClick:function(c,f,g){var d=c.properties;if(d.disabled||d.readonly){return}c.box._to(c,xui.Date.add(c.$tempValue,"m",-1))}},NEXT:{onClick:function(c,f,g){var d=c.properties;if(d.disabled||d.readonly){return}c.box._to(c,xui.Date.add(c.$tempValue,"m",1))}},PRE2:{onClick:function(c,f,g){var d=c.properties;if(d.disabled||d.readonly){return}c.box._to(c,xui.Date.add(c.$tempValue,"y",-1))}},NEXT2:{onClick:function(c,f,g){var d=c.properties;if(d.disabled||d.readonly){return}c.box._to(c,xui.Date.add(c.$tempValue,"y",1))}},TPRE:{onClick:function(c,f,g){var d=c.properties;if(d.disabled||d.readonly){return}c.box._to(c,xui.Date.add(c.$tempValue,"n",-1))}},TNEXT:{onClick:function(c,f,g){var d=c.properties;if(d.disabled||d.readonly){return}c.box._to(c,xui.Date.add(c.$tempValue,"n",1))}},TPRE2:{onClick:function(c,f,g){var d=c.properties;if(d.disabled||d.readonly){return}c.box._to(c,xui.Date.add(c.$tempValue,"h",-1))}},TNEXT2:{onClick:function(c,f,g){var d=c.properties;if(d.disabled||d.readonly){return}c.box._to(c,xui.Date.add(c.$tempValue,"h",1))}},YEAR:{beforeMousedown:function(c,d,f){return c.box._ondown(c,d,f,10)},onDrag:function(c,f,h){var d,g=xui.DragDrop.getProfile().offset;d=parseInt(c.$year,10)+parseInt(g.x/10,10);if(c.$temp!=d){c.$temp2=parseInt(g.x/10,10);c.getSubNode("YEAR").html(d,false)}},onDragstop:function(c,d,f){return c.box._onds(c,d,f,"y")}},MONTH:{beforeMousedown:function(c,d,f){return c.box._ondown(c,d,f,20)},onDrag:function(c,f,h){var d,g=xui.DragDrop.getProfile().offset;d=parseInt(c.$month,10)+(parseInt(g.x/20,10)%12);d=(d%12+12)%12;if(c.$temp!=d){c.$temp=d;c.$temp2=d-c.$month+1;c.getSubNode("MONTH").html(((d+1)<=9?"0":"")+(d+1),false)}},onDragstop:function(c,d,f){return c.box._onds(c,d,f,"m")}},DAY:{beforeMousedown:function(c,d,f){return c.box._ondown(c,d,f,10)},onDrag:function(d,h,l){var c=new Date(d.$year,d.$month,0),m=c.getDate();var g=d.properties,f,k=xui.DragDrop.getProfile().offset;f=parseInt(d.$day,10)+(parseInt(k.x/10,10)%m);f=(f%m+m)%m+1;if(d.$temp!=f){d.$temp=f;d.$temp2=f-d.$day;d.getSubNode("DAY").html((f<=9?"0":"")+f,false)}},onDragstop:function(c,d,f){return c.box._onds(c,d,f,"d")}},HOUR:{beforeMousedown:function(c,d,f){return c.box._ondown(c,d,f,20)},onDrag:function(c,d,f){return c.box._ondrag(c,20,24,"HOUR",c.$hour)},onDragstop:function(c,d,f){return c.box._onds(c,d,f,"h")}},MINUTE:{beforeMousedown:function(c,d,f){return c.box._ondown(c,d,f,10)},onDrag:function(c,d,f){return c.box._ondrag(c,10,60,"MINUTE",c.$minute)},onDragstop:function(c,d,f){return c.box._onds(c,d,f,"n")}}},DataModel:{timeInput:{ini:false,action:function(c){this.getSubNode("CAPTION").css("display",c?"none":"block");this.getSubNode("SET").css("display",c?"block":"none");this.getSubNode("TIME").css("display",c?"block":"none");this.getSubNode("TODAY").attr("title",xui.getRes(c?"inline.now":"inline.today"))}},height:{ini:"auto",readonly:true},width:{ini:210,readonly:true},value:{ini:new Date,format:"date"},closeBtn:{ini:true,action:function(c){this.getSubNode("CLOSE").css("display",c?"":"none")}},firstDayOfWeek:{ini:0,action:function(){this.boxing().refresh()}},offDays:{ini:"60",action:function(){this.boxing().refresh()}},hideWeekLabels:{ini:false,action:function(){this.boxing().refresh()}},dateInputFormat:{ini:"yyyy-mm-dd",listbox:["yyyy-mm-dd","mm-dd-yyyy","dd-mm-yyyy"],action:function(){this.boxing().refresh()}}},EventHandlers:{beforeClose:function(c,d){}},_prepareData:function(e){var f=arguments.callee.upper.call(this,e);var c="display:none";f.closeDisplay=f.closeBtn?"":c;var d="display:none;";if(e.properties.timeInput){f._todaytitle=xui.getRes("inline.now");f._nocap=d}else{f._todaytitle=xui.getRes("inline.today");f._timectrl=d}f._set=xui.wrapRes("inline.set");return f},_ensureValue:function(c,e){var f;if(e){if(_.isDate(e)){f=e}else{if(_.isFinite(e)){f=new Date(parseInt(e,10))}}}f=f||new Date;if(!c.properties.timeInput){f=xui.Date.getTimSpanStart(f,"d")}return f},RenderTrigger:function(){var e=this,g=e.properties,h=e.boxing(),d=e.box;d._setWeekLabel(e);var f={yyyy:"YEAR",mm:"MONTH",dd:"DAY"},c=g.dateInputFormat.split("-");if(f[c[0]]&&f[c[1]]&&f[c[2]]){e.getSubNode("YTXT").addPrev(e.getSubNode(f[c[0]]));e.getSubNode("MTXT").addPrev(e.getSubNode(f[c[1]]));e.getSubNode("MTXT").addNext(e.getSubNode(f[c[2]]))}},_getWeekNodes:function(c){return c.$weeks||(c.$weeks=c.getSubNode("W",true))},_getTDNodes:function(c){return c.$tds||(c.$tds=c.getSubNode("TD",true))},_getLabelNodes:function(c){return c.$days||(c.$days=c.getSubNode("TD",true))},_getHeaderNodes:function(c){return c.$header||(c.$header=c.getSubNode("H",true))},_setWeekLabel:function(e){var k=e.properties;var h=k.firstDayOfWeek,g=function(f){f=e.getSubId(f);if(f=="7"){return f}f=(parseInt(f,10)+h);return f<7?f:(f-7)};e.box._getHeaderNodes(e).each(function(l,f){l.innerHTML=xui.wrapRes("date.WEEKS."+g(l.id))});if(k.hideWeekLabels){e.getSubNode("BODY").query("TR").first().remove();e.getSubNode("COL").first().remove()}var c="xui-uitd-alt",d={};if(k.offDays){_.arr.each(k.offDays.split(""),function(f){f=parseInt(f,10);if(f>=0&&f<=6){d[f]=1}});e.box._getTDNodes(e).each(function(l,f){f=((f+h)-7*parseInt((f+h)/7,10));if(d[f]){l.className=l.className+" "+c}else{l.className=l.className.replace(c,"")}})}},_setBGV:function(g,d,c){var e=xui.Date,k=g.properties,h=g.$daymap||(g.$daymap=[]),f,l;g.box._getLabelNodes(g).each(function(n,m){l=e.add(d,"d",m);h[m]=l;f=e.get(l,"m")==c?"#":'<p class="xui-node xui-node-p xui-ui-readonly xui-custom {comcls}">#</p>';l=e.get(l,"d");n.innerHTML=f.replace("#",l)});if(!k.hideWeekLabels){g.box._getWeekNodes(g).each(function(n,m){n.innerHTML=e.get(e.add(d,"ww",m),"ww",k.firstDayOfWeek)})}},_to:function(h,g,d){var c=h.properties,l=c.firstDayOfWeek,k=xui.Date,u=h.keys,q=c.$UIvalue,n=-1,f,r,w=k.getTimSpanStart(k.getTimSpanStart(g,"m"),"ww",1,l),e=k.get(g,"m",l);h.$tempValue=g;this._setBGV(h,h._realstart=w,e);if(h.$selnode){h.$selnode.tagClass("-checked",false)}_.arr.each(h.$daymap,function(p,m){if(k.get(p,"m",l)+"-"+k.get(p,"d",l)==k.get(g,"m",l)+"-"+k.get(g,"d",l)){n=m;return false}});f=this._getTDNodes(h).get()[n];(h.$selnode=xui([f]).tagClass("-checked"));h.getSubNode("SET").css("display",(d||q.getTime()==g.getTime())?"none":"block");h.getSubNode("CAPTION").css("color",(d||q.getTime()==g.getTime())?"":"#ff0000");r=k.get(g,"y",l);if(h.$year!=r){h.$year=r;h.getSubNode("YEAR").html(r,false)}r=k.get(g,"m",l)+1;if(h.$month!=r){h.$month=r;h.getSubNode("MONTH").html((r<=9?"0":"")+r,false)}r=k.get(g||g,"d",l);if(h.$day!=r){h.$day=r;h.getSubNode("DAY").html((r<=9?"0":"")+r,false)}r=k.get(g,"h",l);if(h.$hour!=r){h.$hour=r;h.getSubNode("HOUR").html((r<=9?"0":"")+r,false)}r=k.get(g,"n",l);if(h.$minute!=r){h.$minute=r;h.getSubNode("MINUTE").html((r<=9?"0":"")+r,false)}},_ondown:function(d,f,g,c){if(xui.Event.getBtn(f)!="left"){return}xui.use(g).startDrag(f,{dragType:"blank",targetReposition:false,widthIncrement:c,dragCursor:true});d.$temp=d.$temp2=0},_ondrag:function(f,d,c,e,h){var k=f.properties,g,l=xui.DragDrop.getProfile().offset;g=parseInt(h,10)+(parseInt(l.x/d,10)%c);g=(g%c+c)%c;if(f.$temp!=g){f.$temp=g;f.$temp2=g-h;f.getSubNode(e).html((g<=9?"0":"")+g,false)}},_onds:function(f,h,k,d){if(f.$temp2){var g=f.properties,c=xui.Date.add(f.$tempValue,d,f.$temp2);f.box._to(f,c)}f.$temp=f.$temp2=0},_onresize:function(){}}});Class("xui.UI.TimePicker",["xui.UI","xui.absValue"],{Dependencies:["xui.Date"],Instance:{activate:function(){this.getSubNode("PRE").focus();return this},_setCtrlValue:function(c){return this.each(function(f){if(!f.renderId){return}var d=f.box,e=d._v2a(c);f.$hour=e[0];f.$minute=e[1];f.getSubNode("HI",true).removeClass(d._excls_c3).removeClass(d._excls_mo3);f.getSubNode("HI",e[0]).addClass(d._excls_c3);f.getSubNode("MI",true).removeClass(d._excls_c).removeClass(d._excls_mo);f.getSubNode("MI",e[1]).addClass(d._excls_c);f.getSubNode("HOUR").html(e[0],false);f.getSubNode("MINUTE").html(e[1],false);f.getSubNode("CAPTION").html(f.box._showV(f,f.box._v2a(e)),false)})}},Initialize:function(){this.addTemplateKeys(["HI","MI"]);var f,k,l,d,e,c,n,g;e=this._excls3;c=this._excls4;n=xui.UI.$ID;g='<span id="'+this.KEY+"-HI:"+n+':@" class="xui-node xui-node-span '+e+' !" '+xui.$IEUNSELECTABLE()+" >@</span>";f=[];for(k=0;k<24;k++){f[f.length]=g.replace(/@/g,k<10?("0"+k):k).replace("!",((k%6===0)?c:"")+" xui-custom {comcls}")}l=f.join("");f.length=0;e=this._excls;c=this._excls2;n=xui.UI.$ID;g='<span id="'+this.KEY+"-MI:"+n+':@" class="xui-node xui-node-span '+e+' !" '+xui.$IEUNSELECTABLE()+" >@</span>";f=[];for(k=0;k<60;k++){f[f.length]=g.replace(/@/g,k<10?("0"+k):k).replace("!",((k%5===0)?c:"")+" xui-custom {comcls}")}d=f.join("");f.length=0;this.setTemplate({tagName:"div",onselectstart:"return false",style:"{_style};height:auto;",BORDER:{tagName:"div",BAR:{tagName:"div",className:"xui-uibar-top",style:"{barDisplay};",BART:{cellpadding:"0",cellspacing:"0",width:"100%",border:"0",tagName:"table",className:"xui-uibar-t",BARTR:{tagName:"tr",BARTDL:{tagName:"td",className:"xui-uibar-tdl"},BARTDM:{$order:1,width:"100%",tagName:"td",className:"xui-uibar-tdm"},BARTDR:{$order:2,tagName:"td",className:"xui-uibar-tdr"}}},BARCMDL:{tagName:"div",className:"xui-uibar-cmdl",PRE2:{$order:0,tabindex:"{tabindex}"},PRE:{$order:1,tabindex:"{tabindex}"},HOUR:{$order:2,className:"xui-ui-draggable xui-bginput xui-uiborder-inset"},MTXT:{$order:3,text:":"},MINUTE:{$order:4,className:"xui-ui-draggable xui-bginput xui-uiborder-inset"},NEXT:{$order:6,tabindex:"{tabindex}"},NEXT2:{$order:7,tabindex:"{tabindex}"}},BARCMDR:{tagName:"div",className:"xui-uibar-cmdr",CLOSE:{className:"xui-uicmd-close ",style:"{closeDisplay}"}}},MAIN:{$order:2,tagName:"div",className:"xui-uicon-main",MAINI:{tagName:"div",className:"xui-uibg-bar xui-uicon-maini",CONH:{tagName:"div",className:"xui-uiborder-inset",text:l},CONM:{$order:2,tagName:"div",className:"xui-uiborder-inset",text:d}}},TAIL:{$order:3,tagName:"div",className:"xui-uicon-main",TAILI:{tagName:"div",className:"xui-uibg-bar xui-uicon-maini",CAPTION:{text:"{caption}"},SET:{className:"xui-ui-btn",SETI:{className:"xui-ui-btni",SETC:{className:"xui-ui-btnc",SETA:{tabindex:"{tabindex}",text:"{_set}"}}}}}},BBAR:{$order:4,tagName:"div",className:"xui-uibar-bottom-s",BBART:{cellpadding:"0",cellspacing:"0",width:"100%",border:"0",tagName:"table",className:"xui-uibar-t",BBARTR:{tagName:"tr",BBARTDL:{tagName:"td",className:"xui-uibar-tdl"},BBARTDM:{$order:1,width:"100%",tagName:"td",className:"xui-uibar-tdm"},BBARTDR:{$order:2,tagName:"td",className:"xui-uibar-tdr"}}}}}})},Static:{_shadowRB:"BBARTDR",_excls:"xuiex-timepicker xui-uitd",_excls2:"xuiex-timepicker xui-uitd xui-uitd-alt ",_excls3:"xuiex-timepicker3 xui-uitd",_excls4:"xuiex-timepicker xui-uitd xui-uitd-alt",_excls_mo:"xui-uitd-mouseover",_excls_c:"xui-uitd-checked",_excls_mo3:"xui-uitd-mouseover",_excls_c3:"xui-uitd-checked",_mover:function(e,d){var c=this,f=e.className;if(d==2){if(f.indexOf(c._excls_mo3)==-1){e.className=f+" "+c._excls_mo3}}else{if(f.indexOf(c._excls_mo)==-1){e.className=f+" "+c._excls_mo}}e=null},_mout:function(e,d){var c=this,f=e.className;if(d==2){if(f.indexOf(c._excls_mo3)!=-1){e.className=f.replace(c._excls_mo3,"")}}else{if(f.indexOf(c._excls_mo)!=-1){e.className=f.replace(c._excls_mo,"")}}e=null},Appearances:{KEY:{},MAINI:{"padding-top":"4px"},CONH:{width:"240px"},CONM:{"margin-top":"4px",width:"240px"},BARCMDL:{top:"3px"},"PRE,PRE2,NEXT,NEXT2":{position:"relative",margin:"0 2px",width:"15px",height:"15px","vertical-align":"middle",cursor:"default","background-image":xui.UI.$bg("icons.gif","",true),"background-repeat":"no-repeat",_zoom:1},PRE:{$order:1,"background-position":"-260px -70px"},"PRE-mouseover":{$order:2,"background-position":"-260px -90px"},"PRE-mousedown":{$order:3,"background-position":"-260px -110px"},NEXT:{$order:1,"background-position":"-280px -70px"},"NEXT-mouseover":{$order:2,"background-position":"-280px -90px"},"NEXT-mousedown":{$order:3,"background-position":"-280px -110px"},PRE2:{$order:1,"background-position":"-240px -70px"},"PRE2-mouseover":{$order:2,"background-position":"-240px -90px"},"PRE2-mousedown":{$order:3,"background-position":"-240px -110px"},NEXT2:{$order:1,"background-position":"-300px -70px"},"NEXT2-mouseover":{$order:2,"background-position":"-300px -90px"},"NEXT2-mousedown":{$order:3,"background-position":"-300px -110px"},"HOUR, MINUTE":{$order:3,margin:"0 2px",height:"15px",width:"16px","font-weight":"bold","vertical-align":"middle",cursor:"e-resize","padding-left":"2px"},SET:{position:"absolute",display:"none",color:"#ff0000",top:"1px",right:"5px"},TAILI:{position:"relative","padding-top":"4px",height:"20px","text-align":"center"},CAPTION:{"font-size":"12px","vertical-align":xui.browser.ie6?"baseline":"middle"},".xuiex-timepicker":{"font-size":"12px",width:"24px",height:"16px","text-align":"center"},".xuiex-timepicker3":{"font-size":"12px",width:"20px",height:"16px","text-align":"center","font-weight":"bold"}},Behaviors:{HoverEffected:{CLOSE:"CLOSE",PRE:"PRE",NEXT:"NEXT",PRE2:"PRE2",NEXT2:"NEXT2",SET:"SET"},ClickEffected:{CLOSE:"CLOSE",PRE:"PRE",NEXT:"NEXT",PRE2:"PRE2",NEXT2:"NEXT2",SET:"SET"},KEY:{onClick:function(){return false}},HOUR:{beforeMousedown:function(c,d,f){if(xui.Event.getBtn(d)!="left"){return}xui(f).startDrag(d,{dragType:"blank",targetReposition:false,widthIncrement:5,dragCursor:true});c.$temp2=0},onDrag:function(f,h,l){var g,k=xui.DragDrop.getProfile().offset,d=f.properties.$UIvalue,c=d.split(":");c[0]=(parseFloat(c[0])||0)+parseInt(k.x/10,10);c[0]=(c[0]%24+24)%24;f.$temp2=(c[0]<=9?"0":"")+c[0];if(d[0]!=f.$temp2){f.getSubNode("HOUR").html(f.$temp2,false)}},onDragstop:function(c,d,f){if(c.$temp2){c.$hour=c.$temp2;c.boxing()._setCtrlValue(c.$hour+":"+c.$minute)}c.$temp2=0;c.box._hourC(c)}},MINUTE:{beforeMousedown:function(c,d,f){if(xui.Event.getBtn(d)!="left"){return}xui(f).startDrag(d,{dragType:"blank",targetReposition:false,widthIncrement:5,dragCursor:true});c.$temp2=0},onDrag:function(f,h,l){var g,k=xui.DragDrop.getProfile().offset,d=f.properties.$UIvalue,c=d.split(":");c[0]=(parseFloat(c[0])||0)+parseInt(k.x/20,10);c[0]=(c[0]%60+60)%60;f.$temp2=(c[0]<=9?"0":"")+c[0];if(d[0]!=f.$temp2){f.getSubNode("MINUTE").html(f.$temp2,false)}},onDragstop:function(c,d,f){if(c.$temp2){c.$minute=c.$temp2;c.boxing()._setCtrlValue(c.$hour+":"+c.$minute)}c.$temp2=0;c.box._hourC(c)}},SET:{onClick:function(e){var f=e.properties,d=f.$UIvalue,c=d.split(":");c[0]=e.$hour;c[1]=e.$minute;e.boxing().setUIValue(c.join(":"),true,null,"click");if(e.box){e.box._hourC(e)}}},HI:{onMouseover:function(c,d,f){if(c.properties.disableHoverEffect){return}c.box._mover(xui.use(f).get(0),2)},onMouseout:function(c,d,f){if(c.properties.disableHoverEffect){return}c.box._mout(xui.use(f).get(0),2)},onClick:function(c,d,f){c.$hour=c.getSubId(f);c.boxing()._setCtrlValue(c.$hour+":"+c.$minute);if(c.box){c.box._hourC(c)}},onDblclick:function(c,d,f){c.$hour=c.getSubId(f);c.boxing().setUIValue(c.$hour+":"+c.$minute,true,null,"dblclick");if(c.box){c.box._hourC(c)}}},MI:{onMouseover:function(c,d,f){if(c.properties.disableHoverEffect){return}c.box._mover(xui.use(f).get(0))},onMouseout:function(c,d,f){if(c.properties.disableHoverEffect){return}c.box._mout(xui.use(f).get(0))},onClick:function(c,d,f){c.$minute=c.getSubId(f);c.boxing().setUIValue(c.$hour+":"+c.$minute,true,null,"click2");if(c.box){c.box._hourC(c)}}},PRE:{onClick:function(d,g,h){var f=d.properties;if(f.disabled||f.readonly){return}var c=d.$minute;c=(parseFloat(c)||0)-1;c=(c%60+60)%60;d.$minute=c=(c<=9?"0":"")+c;d.boxing()._setCtrlValue(d.$hour+":"+d.$minute);if(d.box){d.box._hourC(d)}}},NEXT:{onClick:function(d,g,h){var f=d.properties;if(f.disabled||f.readonly){return}var c=d.$minute;c=(parseFloat(c)||0)+1;c=(c%60+60)%60;d.$minute=c=(c<=9?"0":"")+c;d.boxing()._setCtrlValue(d.$hour+":"+d.$minute);if(d.box){d.box._hourC(d)}}},PRE2:{onClick:function(d,g,h){var f=d.properties;if(f.disabled||f.readonly){return}var c=d.$hour;c=(parseFloat(c)||0)-1;c=(c%24+24)%24;d.$hour=c=(c<=9?"0":"")+c;d.boxing()._setCtrlValue(d.$hour+":"+d.$minute);if(d.box){d.box._hourC(d)}}},NEXT2:{onClick:function(d,g,h){var f=d.properties;if(f.disabled||f.readonly){return}var c=d.$hour;c=(parseFloat(c)||0)+1;c=(c%24+24)%24;d.$hour=c=(c<=9?"0":"")+c;d.boxing()._setCtrlValue(d.$hour+":"+d.$minute);if(d.box){d.box._hourC(d)}}},CLOSE:{onClick:function(f,g,h){var d=f.properties,c=f.boxing();if(d.disabled||d.readonly){return}if(false===c.beforeClose(f,h)){return}c.destroy(true)}}},DataModel:{height:{ini:"auto",readonly:true},width:{ini:250,readonly:true},value:{ini:"00:00",format:"time"},closeBtn:{ini:true,action:function(c){this.getSubNode("CLOSE").css("display",c?"":"none")}}},EventHandlers:{beforeClose:function(c,d){}},_hourC:function(f){var h=f.properties,e=h.$UIvalue,c=e.split(":"),g=(c[0]+"")==(f.$hour+"")&&(c[1]+"")==(f.$minute+"");f.getSubNode("SET").css("display",g?"none":"block");f.getSubNode("CAPTION").css("color",g?"":"#ff0000")},_prepareData:function(d){var e=arguments.callee.upper.call(this,d);var c="display:none";e.closeDisplay=e.closeBtn?"":c;e._set=xui.wrapRes("inline.set");return e},_ensureValue:function(e,f){var d,c=[];if(f&&typeof f=="string"){d=f.split(":")}else{if(f&&typeof f=="object"&&_.isArr(f)){d=f}else{d=[]}}c[0]=parseFloat(d[0])||0;c[1]=parseFloat(d[1])||0;if(c[0]<0){c[0]=0}if(c[0]>23){c[0]=23}if(c[1]<0){c[1]=0}if(c[1]>59){c[1]=59}c[0]=(c[0]<=9?"0":"")+c[0];c[1]=(c[1]<=9?"0":"")+c[1];return c.join(":")},formatValue:function(c){return c.join(":")},_v2a:function(c){return typeof c=="string"?c.split(":"):c},_showV:function(d,c){var e=d.CF;if(typeof e.formatCaption=="function"){return e.formatCaption(c)}else{return c.join(":")}},_onresize:function(){}}});Class("xui.UI.List",["xui.UI","xui.absList","xui.absValue"],{Instance:{_setCtrlValue:function(c){return this.each(function(f){if(!f.renderId){return}var q=f.box,y=f.boxing().getUIValue(),d=f.properties,B=q._ITEMKEY||"ITEM",h=q._DIRTYKEY||"ITEM",l=function(p,C){return f.getSubNode(p,C)},r=function(k){return f.getSubIdByItemId(k)};if(d.selMode=="single"){var x=r(y);if(y!==null&&x){l(h,x).tagClass("-checked",false).tagClass("-mouseover",false)}x=r(c);if(x){l(h,x).tagClass("-checked")}if(x){var e=l(B,x);if(e){var u=f.getSubNode("ITEMS"),m=e.offset(null,u),w=m?m.top:0,z=e.offsetHeight(),n=u.scrollHeight(),A=u.scrollTop(),g=u.height();if(n>g){if(w<A||(w+z)>(A+g)){u.scrollTop(w)}}}}}else{if(d.selMode=="multi"||d.selMode=="multibycheckbox"){y=y?y.split(d.valueSeparator):[];c=c?c.split(d.valueSeparator):[];_.arr.each(y,function(k){l(h,r(k)).tagClass("-checked",false).tagClass("-mouseover",false)});_.arr.each(c,function(k){l(h,r(k)).tagClass("-checked")})}}})},_clearMouseOver:function(){var d=this.constructor,c=d._ITEMKEY||"ITEM";this.getSubNode(c,true).tagClass("-mouseover",false)},adjustSize:function(){return this.each(function(k){var e=k.getRoot(),f=k.getSubNode("ITEMS"),d=k.properties,g,c;if(e.css("display")=="none"){c=1;e.css("visibility","hidden")}if(k.properties.height!="auto"){f.height("auto");g=Math.min(d.maxHeight,f.offsetHeight());d.height=g;f.height(g)}else{f.height("auto");g=f.offsetHeight();if(g>d.maxHeight){f.height(d.maxHeight);k.getRoot().height(d.maxHeight)}}if(c){e.css("visibility","");e.css("display","none")}k.getRoot().height("auto")})},activate:function(){return xui.absList.prototype.activate.call(this)},getShowValue:function(f){var e=this.get(0),g=e.properties,c,d;if(!_.isDefined(f)){f=g.$UIvalue}if((c=_.arr.subIndexOf(g.items,"id",f))!=-1){c=g.items[c].caption;c=c.charAt(0)=="$"?xui.getRes(c.slice(1)):c}else{c=""}return c},_setDirtyMark:function(){return arguments.callee.upper.apply(this,["ITEMS"])}},Static:{_DIRTYKEY:"ITEM",Templates:{tagName:"div",style:"{_style}",className:"{_className}",LABEL:{className:"{_required}",style:"{labelShow};width:{labelSize}px;{labelHAlign}",text:"{labelCaption}"},ITEMS:{$order:10,tagName:"div",className:"xui-uibg-content {_bordertype}",text:"{items}"},$submap:{items:{ITEM:{className:"xui-uitembg {_itemRow} {itemClass} {disabled} {readonly}",style:"{itemStyle}{_itemDisplay}",tabindex:"{_tabindex}",LTAGCMDS:{$order:2,tagName:"span",text:"{ltagCmds}"},MARK:{$order:5,style:"{_cbDisplay}"},ICON:{$order:10,className:"xui-ui-icon {imageClass}",style:"{backgroundImage} {backgroundPosition} {backgroundRepeat} {imageDisplay}"},CAPTION:{text:"{caption}",$order:20},EXTRA:{text:"{ext}",$order:30},OPT:{$order:50},TAGCMDS:{$order:60,tagName:"span",text:"{rtagCmds}"}}},"items.ltagCmds":function(g,f,e,d,c){var h=arguments.callee,k=h._m||(h._m={text:".text",button:".button",image:".image"});xui.UI.$doTemplate(g,f,e,"items.tagCmds"+(k[e.type]||".button"),c)},"items.rtagCmds":function(g,f,e,d,c){var h=arguments.callee,k=h._m||(h._m={text:".text",button:".button",image:".image"});xui.UI.$doTemplate(g,f,e,"items.tagCmds"+(k[e.type]||".button"),c)},"items.tagCmds.text":{CMD:{tagName:"a",title:"{tips}",href:xui.$DEFAULTHREF,style:"{_style}{itemStyle}",className:"{itemClass}",tabindex:"{_tabindex}",text:"{caption}"}},"items.tagCmds.button":{CMD:{_NativeElement:true,tagName:"button",title:"{tips}",style:"{_style}{itemStyle}",className:"xui-uiborder-outset xui-list-cmd {itemClass}",tabindex:"{_tabindex}",text:"{caption}"}},"items.tagCmds.image":{CMD:{tagName:"image",title:"{tips}",src:"{image}",border:"0",style:"{_style}{itemStyle}",className:"{itemClass}",tabindex:"{_tabindex}",alt:"{caption}"}}}},Appearances:{KEY:{"font-size":"12px"},LABEL:{"z-index":1,top:0,left:0,position:"absolute","padding-top":"4px","font-size":"12px"},EXTRA:{display:"none"},ITEMS:{position:"relative",overflow:"auto","overflow-x":"hidden",padding:"1px"},ITEM:{display:"block",zoom:xui.browser.ie?1:null,"font-family":'"Verdana", "Helvetica", "sans-serif"',cursor:"pointer","font-size":"12px",position:"relative"},"ITEM-mouseover, ITEM-mousedown, ITEM-checked":{"background-image":xui.UI.$bg("item.gif",""),"background-repeat":"repeat-x"},"ITEM-mouseover":{$order:1,"background-position":"left -51px","background-color":"#FAD200"},"ITEM-mousedown":{$order:2,"background-position":"left -101px","background-color":"#F5D22D"},"ITEM-checked":{$order:2,"background-position":"left top","background-color":"#AAD2FA"},MARK:{$order:1,cursor:"pointer",width:"16px",height:"16px","vertical-align":"middle","background-image":xui.UI.$bg("icons.gif","",true),"background-repeat":"no-repeat","background-position":"-20px -70px"},"ITEM-checked MARK":{$order:2,"background-position":"0 -70px"},CAPTION:{"vertical-align":xui.browser.ie6?"baseline":"middle",padding:"2px"},OPT:{$order:10,position:"absolute",left:"auto",top:"auto",right:"2px",top:"2px",width:"16px",height:"16px",display:"none","background-image":xui.UI.$bg("icons.gif","",true),"background-repeat":"no-repeat","background-position":"-130px -224px"},"OPT-mouseover":{$order:20,"background-position":"-130px -244px"},"OPT-mousedown":{$order:30,"background-position":"-130px -264px"},LTAGCMDS:{"padding-left":"4px","padding-right":"4px","vertical-align":"middle"},RTAGCMDS:{"padding-left":"4px","vertical-align":"middle"},CMD:{"margin-left":"2px",padding:"0 2px","vertical-align":"middle",cursor:"pointer"}},Behaviors:{HoverEffected:{ITEM:"ITEM",OPT:"OPT",CMD:"CMD"},ClickEffected:{ITEM:"ITEM",OPT:"OPT",CMD:"CMD"},DraggableKeys:["ITEM"],DroppableKeys:["ITEM","ITEMS"],onSize:xui.UI.$onSize,ITEM:{onDblclick:function(d,g,h){var c=d.properties,f=d.getItemByDom(h);d.boxing().onDblclick(d,f,g,h)},onClick:function(d,m,c){var p=d.properties,x=d.getItemByDom(c),q=d.getSubId(c),l=d.boxing(),u=xui.Event.getKey(m);if(d.beforeClick&&false===l.beforeClick(d,x,m,c)){return false}if(p.disabled||x.disabled){return false}if(d.onClick){l.onClick(d,x,m,c)}xui.use(c).focus();switch(p.selMode){case"none":l.onItemSelected(d,x,m,c,0);break;case"multibycheckbox":if(p.readonly||x.readonly){return false}if(d.keys.MARK){if(d.getKey(xui.Event.getSrc(m).id||"")!=d.keys.MARK){l.onItemSelected(d,x,m,c,0);break}}case"multi":if(p.readonly||x.readonly){return false}var w=l.getUIValue(),k=w?w.split(p.valueSeparator):[],r=1;if(k.length&&(u.ctrlKey||u.shiftKey||p.noCtrlKey||p.$checkbox)){if(u.shiftKey){var n=p.items,g=_.arr.subIndexOf(n,"id",d.$firstV.id),f=_.arr.subIndexOf(n,"id",x.id),h;k.length=0;for(h=Math.min(g,f);h<=Math.max(g,f);h++){k.push(n[h].id)}}else{if(_.arr.indexOf(k,x.id)!=-1){_.arr.removeValue(k,x.id);r=-1}else{k.push(x.id)}}k.sort();w=k.join(p.valueSeparator);if(l.getUIValue()!==w){l.setUIValue(w,null,null,"click");if(l.get(0)&&l.getUIValue()==w){l.onItemSelected(d,x,m,c,r)}}break}case"single":if(p.readonly||x.readonly){return false}if(l.getUIValue()!==x.id){d.$firstV=x;l.setUIValue(x.id,null,null,"click");if(l.get(0)&&l.getUIValue()==x.id){l.onItemSelected(d,x,m,c,1)}}break}if(d.afterClick){l.afterClick(d,x,m,c)}},onKeydown:function(f,k,c){var p=xui.Event.getKey(k),n=p[0],d=p[2],m=xui(c),h=f.getRoot().nextFocus(true,true,false),l=f.getRoot().nextFocus(false,true,false);switch(xui.Event.getKey(k)[0]){case"tab":if(d){if(m.get(0)!=h.get(0)){h.focus();return false}}else{if(m.get(0)!=l.get(0)){l.focus();return false}}break;case"left":case"up":var g=m.nextFocus(false,true,false);if(m.get(0)==h.get(0)){l.focus()}else{m.nextFocus(false)}return false;break;case"right":case"down":var g=m.nextFocus(true,false,false);if(m.get(0)==l.get(0)){h.focus()}else{m.nextFocus()}return false;break;case"enter":m.onClick(true);break}},onContextmenu:function(c,d,f){if(c.onContextmenu){return c.boxing().onContextmenu(c,d,f,c.getItemByDom(f))!==false}},onMouseover:function(c,f,g){var d=c.getItemByDom(g);if(!c.properties.optBtn&&!d.optBtn){return}c.getSubNode("OPT",c.getSubId(g)).setInlineBlock()},onMouseout:function(c,f,g){var d=c.getItemByDom(g);if(!c.properties.optBtn&&!d.optBtn){return}c.getSubNode("OPT",c.getSubId(g)).css("display","none")}},OPT:{onClick:function(c,f,g){if(c.onShowOptions){var d=c.getItemByDom(g);if(!c.properties.optBtn&&!d.optBtn){return}c.boxing().onShowOptions(c,d,f,g)}return false},onDblclick:function(c,d,f){return false}},CMD:{onClick:function(c,f,g){var h=c.properties,d=c.getItemByDom(xui.use(g).parent().get(0));if(!d){return false}if(h.disabled||d.disabled){return false}if(c.onCmd){c.boxing().onCmd(c,d,xui.use(g).id().split("_")[1],f,g)}return false}},LABEL:{onClick:function(c,d,f){if(c.properties.disabled){return false}if(c.onLabelClick){c.boxing().onLabelClick(c,d,f)}},onDblClick:function(c,d,f){if(c.properties.disabled){return false}if(c.onLabelDblClick){c.boxing().onLabelDblClick(c,d,f)}},onMousedown:function(c,d,f){if(xui.Event.getBtn(d)!="left"){return}if(c.properties.disabled){return false}if(c.onLabelActive){c.boxing().onLabelActive(c,d,f)}}}},DataModel:{selMode:{ini:"single",listbox:["single","none","multi","multibycheckbox"],action:function(c){if(!this.box._ITEMMARKED){this.getSubNode("MARK",true).css("display",(c=="multibycheckbox")?"":"none")}}},borderType:{ini:"flat",listbox:["none","flat","inset","outset"],action:function(d){var f=this,k=f.properties,g=f.getSubNode("ITEMS"),e=/^xui-uiborder-/,h="xui-uiborder-",c=f.getRoot();g.removeClass(e);g.addClass(h+d);xui.UI.$tryResize(f,c.get(0).style.width,c.get(0).style.height,true)}},noCtrlKey:true,width:120,height:150,maxHeight:420,itemRow:{ini:false,action:function(c){var d=this.getSubNode("ITEM",true);if(c){d.addClass("xui-item-row")}else{d.removeClass("xui-item-row")}}},optBtn:false,tagCmds:{ini:[],action:function(){this.boxing().refresh()}},labelSize:{ini:0,action:function(c){this.getSubNode("LABEL").css({display:c?"":"none",width:(c||0)+"px"});xui.UI.$doResize(this,this.properties.width,this.properties.height,true)}},labelPos:{ini:"left",listbox:["left","top","right","bottom"],action:function(c){xui.UI.$doResize(this,this.properties.width,this.properties.height,true)}},labelGap:{ini:4,action:function(c){xui.UI.$doResize(this,this.properties.width,this.properties.height,true)}},labelCaption:{ini:"",action:function(c){c=(_.isSet(c)?c:"")+"";this.getSubNode("LABEL").html(xui.adjustRes(c,true))}},labelHAlign:{ini:"right",listbox:["","left","center","right"],action:function(c){this.getSubNode("LABEL").css("textAlign",c)}}},EventHandlers:{onClick:function(c,d,f,g){},onCmd:function(c,d,g,f,h){},beforeClick:function(c,d,f,g){},afterClick:function(c,d,f,g){},onDblclick:function(c,d,f,g){},onShowOptions:function(c,d,f,g){},onItemSelected:function(d,f,g,h,c){},onLabelClick:function(c,d,f){},onLabelDblClick:function(c,d,f){},onLabelActive:function(c,d,f){}},_onStartDrag:function(c,d,f,g){var g=xui.Event.getPos(d);xui.use(f).startDrag(d,{dragType:"icon",shadowFrom:f,targetLeft:g.left+12,targetTop:g.top+12,dragCursor:"pointer",dragDefer:2,dragKey:c.box.getDragKey(c,f),dragData:c.box.getDragData(c,d,f)});return false},_onDropTest:function(d,k,m,c,g,f){var l=g&&g.domId,h=xui.use(m).id();if(l){if(l==h){return false}if(_.get(xui.use(m).get(0),["previousSibling","id"])==l){return false}}},_onDrop:function(g,n,d,q,m,u){xui.DragDrop.setDragIcon("none");var l=g.getKey(xui.use(d).id()),f=m.profile,c=m.domId,h,r=xui.absObj.$specialChars,p=g.properties.$UIvalue;h=_.clone(f.getItemByDom(c),function(k,e){return !r[(e+"").charAt(0)]});f.boxing().removeItems([h.id]);if(l==g.keys.ITEM){g.boxing().insertItems([h],u.id,true)}else{g.boxing().insertItems([h])}if(h.id==p){g.boxing().setUIValue(h.id,true,null,"drop")}return false},_prepareData:function(c){var e=arguments.callee.upper.call(this,c);e._bordertype="xui-uiborder-"+e.borderType;e.labelHAlign=e.labelHAlign?("text-align:"+e.labelHAlign):"";e.labelShow=e.labelSize?"":("display:none");if(e.labelCaption){e.labelCaption=xui.adjustRes(e.labelCaption,true)}return e},_prepareItem:function(c,d){d._cbDisplay=(c.properties.selMode=="multibycheckbox")?"":"display:none;";d._itemRow=c.properties.itemRow?"xui-item-row":"";this._prepareCmds(c,d)},_prepareCmds:function(h,w,f){var e=h.properties,d=w.tagCmds||_.clone(e.tagCmds,true);if(d&&d.length){var g=xui.UI.$tag_subId,r=[],q=[],n;for(var m=0,u=d,k=u.length;m<k;m++){if(typeof u[m]=="string"){u[m]={id:u[m]}}n=u[m];if(f&&_.isFun(f)){if(!f(n)){continue}}else{if(w.tag&&w.tag.match((new RegExp("\\bno~"+n.id+"\\b")))){continue}}if("id" in n){n.id+=""}else{n.id="cmds"+h.$xid+m}if(!n.caption){n.caption=n.id}if(!("tips" in n)){n.tips=n.caption}n.id=n.id.replace(/[^0-9a-zA-Z]/g,"");if(!n.type){n.type="button"}if(n.caption){n.caption=xui.adjustRes(n.caption)}if(n.tips){n.tips=xui.adjustRes(n.tips)}if(n.image){n.image=xui.adjustRes(n.image)||xui.ini.img_bg}n._style="";if("width" in n){n._style+=n.width+(_.isFinite(n.width)&&"px")+";"}if("height" in n){n._style+=n.height+(_.isFinite(n.height)&&"px")+";"}n[g]=(w[g]?w[g]:"")+"_"+n.id;if(n.location=="left"){q.push(n)}else{r.push(n)}}w.ltagCmds=q;w.rtagCmds=r}},RenderTrigger:function(){if(this.key!="xui.UI.List"){return}var c=this.properties;xui.UI.$doResize(this,c.width,c.height)},_onresize:function(d,r,l){var n=d.properties,w=n.borderType!="none"?2:0,x=n.dock,y=n.maxHeight,z=function(f){return d.getSubNode(f)},q=z("ITEMS"),g=z("LABEL"),u=d.getRoot(),h=n.labelSize||0,A=n.labelGap||0,m=n.labelPos||"left",k,c,B,e;q.cssRegion({left:k=m=="left"?h:0,top:c=m=="top"?h:0,width:B=r===null?null:r=="auto"?r:Math.max(0,(r-((m=="left"||m=="right")?h:0)-w)),height:e=l===null?null:l=="auto"?l:Math.max(0,(l-((m=="top"||m=="bottom")?h:0)-w))});if(l=="auto"){if(x!="fill"&&x!="cover"&&x!="height"&&x!="left"&&x!="right"){if(q.height()>y){q.height(y);u.height("auto")}}}if(h){if(r=="auto"){B=q.offsetWidth()}if(l=="auto"){e=q.offsetHeight()}d.getSubNode("LABEL").cssRegion({left:r===null?null:Math.max(0,m=="right"?((r=="auto"?B:(r-h))+A):0),top:l===null?null:Math.max(0,m=="bottom"?((l=="auto"?e:(l-h))+A):0),width:r===null?null:Math.max(0,((m=="left"||m=="right")?(h-A):(r=="auto"?B:r))),height:l===null?null:Math.max(0,((m=="top"||m=="bottom")?(h-A):(l=="auto"?e:l)))})}}}});Class("xui.UI.Gallery","xui.UI.List",{Instance:{getStatus:function(d){var c=this.get(0).getItemByItemId(d);return(c&&c._status)||"ini"}},Initialize:function(){var c=this.getTemplate();c.$submap={items:{ITEM:{tabindex:"{_tabindex}",className:"xui-hiddenborder {itemClass} {disabled} {readonly}",style:"padding:{itemPadding}px;margin:{itemMargin}px;{itemStyle}",ITEMFRAME:{style:"{_itemSize};",CAPTION:{tagName:"div",style:"{capDisplay}",text:"{caption}",$order:0},CONTENT:{tagName:"div",$order:1,className:"xui-busy",style:"{_loadbg}",IBWRAP:{tagName:"div",IMAGE:{tagName:"img",src:"{image}",width:"{imgWidth}",height:"{imgHeight}",style:"{imgStyle}"}}},COMMENT:{tagName:"div",text:"{comment}",$order:2}},FLAG:{$order:20,className:"{flagClass}",style:"{flagStyle}"},EXTRA:{text:"{ext}",$order:30}}}};this.setTemplate(c)},Static:{IMGNODE:1,Appearances:{FLAG:{position:"absolute",left:"auto",top:0,right:0,width:"32px",height:"32px",display:"none"},EXTRA:{display:"none"},KEY:{overflow:"visible"},ITEMS:{position:"relative",overflow:"auto","overflow-x":"hidden",zoom:xui.browser.ie6?1:null},ITEM:{display:xui.$inlineBlock,zoom:xui.browser.ie6?1:null,position:"relative",cursor:"pointer","vertical-align":"top",margin:0,"border-radius":"4px"},"ITEM-mouseover, ITEM-mousedown, ITEM-checked":{},"ITEM-mouseover":{},"ITEM-mousedown":{},"ITEM-checked":{},ITEMFRAME:{display:xui.browser.ie?"inline-block":"block",position:"relative",overflow:"hidden",border:0,padding:0,margin:0,width:"100%",height:"100%","-moz-box-flex":"1"},IBWRAP:{"font-size":0,"line-height":0},IMAGE:{display:xui.$inlineBlock,zoom:xui.browser.ie6?1:null,visibility:"hidden","vertical-align":"middle"},CAPTION:{"text-align":"center",overflow:"hidden","white-space":"nowrap","font-weight":"bold"},CONTENT:{"text-align":"center",overflow:"hidden","white-space":"nowrap","background-repeat":"no-repeat","background-position":"center center"},COMMENT:{display:"block","font-size":"12px",margin:"2px","text-align":"center"}},Behaviors:{IMAGE:{onLoad:function(c,h,k){var g=c.properties,l=xui.use(k),f=l.get(0),d=c.getItemByDom(k);if(d.autoItemSize||g.autoItemSize){l.attr("width","");l.attr("height","")}xui(f).parent(2).removeClass("xui-busy");l.onLoad(null).onError(null).$removeEventHandler("load").$removeEventHandler("error");f.style.visibility="visible";d._status="loaded"},onError:function(c,h,k){var g=c.properties,l=xui.use(k),f=l.get(0),d=c.getItemByDom(k);xui(f).parent(2).removeClass("xui-busy").addClass("xui-err");if(d.errImg||g.errImg){xui(f).parent(2).css("backgroundImage","url("+(d.errImg||g.errImg)+")")}l.onLoad(null).onError(null).$removeEventHandler("load").$removeEventHandler("error");f.style.visibility="hidden";d._status="error"}}},DataModel:({tagCmds:null,autoItemSize:{ini:false,action:function(){this.boxing().refresh()}},loadingImg:"",errImg:"",itemMargin:{ini:6,action:function(c){if(typeof c!="object"){this.getSubNode("ITEM",true).css("margin",(""+parseFloat(c))==(""+c)?c+"px":c)}else{this.getSubNode("ITEM",true).css(c)}}},itemPadding:{ini:2,action:function(c){if(typeof c!="object"){this.getSubNode("ITEM",true).css("padding",(""+parseFloat(c))==(""+c)?c+"px":c)}else{this.getSubNode("ITEM",true).css(c)}}},itemWidth:{ini:32,action:function(c){this.getSubNode("ITEMFRAME",true).width(c)}},itemHeight:{ini:32,action:function(c){this.getSubNode("ITEMFRAME",true).height(c)}},imgWidth:{ini:16,action:function(c){this.getSubNode("IMAGE",true).width(c)}},imgHeight:{ini:16,action:function(c){this.getSubNode("IMAGE",true).height(c)}},width:200,height:200}),EventHandlers:{onCmd:null},_prepareItem:function(c,d){var e=c.properties;_.arr.each(_.toArr("itemWidth,itemHeight,imgWidth,imgHeight,itemPadding,itemMargin,autoItemSize,loadingImg,errImg"),function(f){d[f]=_.isSet(d[f])?d[f]:e[f]});d.caption=d.caption||"";if(d.caption===""){d.capDisplay="display:none;"}d.comment=d.comment||"";d._tabindex=e.tabindex;if(d.autoItemSize||e.autoItemSize){d._itemSize=""}else{d._itemSize="width:"+d.itemWidth+"px;height:"+d.itemHeight+"px;"}if(d.loadingImg||e.loadingImg){d._loadbg="background-image:url("+(d.loadingImg||e.loadingImg)+")"}}}});Class("xui.UI.IconList","xui.UI.List",{Instance:{getStatus:function(d){var c=this.get(0).getItemByItemId(d);return(c&&c._status)||"ini"}},Initialize:function(){var c=this.getTemplate();c.$submap={items:{ITEM:{tabindex:"{_tabindex}",className:"xui-busy xui-hiddenborder {itemClass} {disabled}  {readonly}",style:"padding:{itemPadding}px;margin:{itemMargin}px;{itemStyle};{_itemDisplay};{_loadbg}",IBWRAP:{tagName:"div",IMAGE:{tagName:"img",src:"{image}",width:"{itemWidth}",height:"{itemHeight}",style:"{imgStyle}"}}}}};this.setTemplate(c)},Static:{Appearances:{KEY:{overflow:"auto","overflow-x":"hidden"},ITEMS:{overflow:"auto","overflow-x":"hidden",position:"relative","line-height":"14px",zoom:xui.browser.ie6?1:null},ITEM:{display:xui.$inlineBlock,zoom:xui.browser.ie6?1:null,position:"relative",cursor:"pointer","vertical-align":"top","background-repeat":"no-repeat","background-position":"center center","border-radius":"3px"},IMAGE:{visibility:"hidden"},IBWRAP:{"font-size":0,"line-height":0},"ITEM-mouseover":{$order:1,padding:0},"ITEM-mousedown":{$order:2,padding:0},"ITEM-checked":{$order:2,padding:0},"ITEM-mouseover, ITEM-mousedown, ITEM-checked":{}},Behaviors:{IMAGE:{onLoad:function(c,h,k){var g=c.properties,l=xui.use(k),f=l.get(0),d=c.getItemByDom(k);if(d.autoItemSize||g.autoItemSize){l.attr("width","");l.attr("height","")}xui(f).parent(2).removeClass("xui-busy");l.onLoad(null).onError(null).$removeEventHandler("load").$removeEventHandler("error");f.style.visibility="visible";d._status="loaded"},onError:function(c,h,k){var g=c.properties,l=xui.use(k),f=l.get(0),d=c.getItemByDom(k);xui(f).parent(2).removeClass("xui-busy").addClass("xui-err");if(d.errImg||g.errImg){xui(f).parent(2).css("backgroundImage","url("+(d.errImg||g.errImg)+")")}l.onLoad(null).onError(null).$removeEventHandler("load").$removeEventHandler("error");f.style.visibility="hidden";d._status="error"}}},DataModel:({tagCmds:null,autoItemSize:{ini:false,action:function(){this.boxing().refresh()}},loadingImg:"",errImg:"",itemMargin:{ini:6,action:function(c){if(typeof c!="object"){this.getSubNode("ITEM",true).css("margin",(""+parseFloat(c))==(""+c)?c+"px":c)}else{this.getSubNode("ITEM",true).css(c)}}},itemPadding:{ini:2,action:function(c){if(typeof c!="object"){this.getSubNode("ITEM",true).css("padding",(""+parseFloat(c))==(""+c)?c+"px":c)}else{this.getSubNode("ITEM",true).css(c)}}},itemWidth:{ini:16,action:function(c){this.getSubNode("IMAGE",true).width(c)}},itemHeight:{ini:16,action:function(c){this.getSubNode("IMAGE",true).height(c)}},width:200,height:200}),EventHandlers:{onCmd:null},_prepareItem:function(c,d){var e=c.properties;_.arr.each(_.toArr("itemWidth,itemHeight,itemPadding,itemMargin,autoItemSize,loadingImg,errImg"),function(f){d[f]=_.isSet(d[f])?d[f]:e[f]});d._tabindex=e.tabindex;if(d.loadingImg||e.loadingImg){d._loadbg="background-image:url("+(d.loadingImg||e.loadingImg)+")"}}}});Class("xui.UI.Panel","xui.UI.Div",{Instance:{activate:function(d){var e,c=this.constructor;if(e=xui.UI._cache["$"+c.activeWndId]){e.getSubNode("TBAR").tagClass("-focus",false)}delete c.activeWndId;if(d!==false){e=this.get(0);e.getSubNode("TBAR").tagClass("-focus");e.getSubNode("CAPTION").focus();c.activeWndId=e.$xid}},resetPanelView:function(d,e){if(!_.isSet(d)){d=true}if(!_.isSet(e)){e=true}var c;return this.each(function(f){if(f.renderId){delete f.$ini;if(d){c=f.boxing();c.removeChildren(true,e)}if(f.properties.toggle){c.setToggle(false)}}})},iniPanelView:function(){return this.each(function(c){if(!c.$ini){c.$ini=true;var d=c.properties;if(c.onIniPanelView){c.boxing().onIniPanelView(c)}if(d.iframeAutoLoad||d.ajaxAutoLoad){xui.UI.Div._applyAutoLoad(c)}}})}},Static:{_shadowRB:"BBARTDR",Templates:{tagName:"div",style:"{_style}",className:"{_className}",BORDER:{tagName:"div",TBAR:{tagName:"div",className:"xui-uibar-top",BART:{cellpadding:"0",cellspacing:"0",width:"100%",height:"100%",border:"0",tagName:"table",className:"xui-uibar-t",BARTR:{tagName:"tr",BARTDL:{tagName:"td",className:"xui-uibar-tdl"},BARTDM:{$order:1,width:"100%",tagName:"td",className:"xui-uibar-tdm"},BARTDR:{$order:2,tagName:"td",className:"xui-uibar-tdr"}}},BARCMDL:{tagName:"div",className:"xui-uibar-cmdl",TOGGLE:{className:"xui-uicmd-toggle {toggleCls}",style:"{toggleDisplay}",$order:0},ICON:{$order:0,className:"xui-ui-icon {imageClass}",style:"{backgroundImage} {backgroundPosition} {backgroundRepeat} {imageDisplay}"},CAPTION:{tabindex:"{tabindex}",text:"{caption}",$order:1}},BARCMDR:{tagName:"div",className:"xui-uibar-cmdr",INFO:{className:"xui-uicmd-info",style:"{infoDisplay}",$order:1},OPT:{className:"xui-uicmd-opt",style:"{optDisplay}",$order:1},POP:{className:"xui-uicmd-pop",style:"{popDisplay}",$order:2},REFRESH:{className:"xui-uicmd-refresh",style:"{refreshDisplay}",$order:3},CLOSE:{className:"xui-uicmd-close ",style:"{closeDisplay}",$order:4}}},MAIN:{$order:2,tagName:"div",className:"xui-uicon-main",style:"{_leftp}",MAINI:{tagName:"div",className:"xui-uibg-bar xui-uicon-maini",style:"{_rightp}",PANEL:{tagName:"div",className:"{_bordertype}",style:"{panelDisplay};{_panelstyle};{_overflow};",text:"{html}"+xui.UI.$childTag}}},BBAR:{$order:3,tagName:"div",className:"xui-uibar-bottom-s",style:"{_bbarDisplay}",BBART:{cellpadding:"0",cellspacing:"0",width:"100%",border:"0",tagName:"table",className:"xui-uibar-t",BBARTR:{tagName:"tr",BBARTDL:{tagName:"td",className:"xui-uibar-tdl"},BBARTDM:{$order:1,width:"100%",tagName:"td",className:"xui-uibar-tdm"},BBARTDR:{$order:2,tagName:"td",className:"xui-uibar-tdr"}}}}}},Appearances:{KEY:{overflow:"hidden",background:"transparent"},"KEY BORDER":{zoom:xui.browser.ie6?1:null},PANEL:{position:"relative",left:0,top:0,overflow:"auto","line-height":"auto",zoom:xui.browser.ie6?1:null},CAPTION:{"font-size":"12px",cursor:"pointer",display:"inline","vertical-align":xui.browser.ie6?"baseline":"middle"}},Behaviors:{DroppableKeys:["PANEL"],PanelKeys:["PANEL"],DraggableKeys:["TBAR"],NoDraggableKeys:["INFO","OPT","CLOSE","POP","REFRESH","TOGGLE"],HoverEffected:{INFO:"INFO",OPT:"OPT",CLOSE:"CLOSE",POP:"POP",REFRESH:"REFRESH",TOGGLE:"TOGGLE"},ClickEffected:{INFO:"INFO",OPT:"OPT",CLOSE:"CLOSE",POP:"POP",REFRESH:"REFRESH",TOGGLE:"TOGGLE"},onSize:xui.UI.$onSize,INFO:{onClick:function(c,d,f){c.boxing().onShowInfo(c,d,f)}},OPT:{onClick:function(c,d,f){c.boxing().onShowOptions(c,d,f)}},REFRESH:{onClick:function(c,d,f){c.boxing().onRefresh(c)}},TOGGLE:{onClick:function(c,d,f){c.box._toggle(c,!c.properties.toggle);return false}},CAPTION:{onClick:function(c,d,f){if(!c.onClickBar||false===c.boxing().onClickBar(c,f)){return xui.Event.getKey(d).shiftKey}}},CLOSE:{onClick:function(f,g,h){var d=f.properties;if(d.disabled){return}var c=f.boxing();if(false===c.beforeClose(f)){return}c.destroy()}},POP:{onClick:function(d,g,c){var k=d.properties;if(k.disabled){return}var l=d.getRoot().offset(),p=d.getRoot().cssSize(),q={parent:null,host:null,properties:null,events:null,CS:null,CC:null,CB:null,CF:null,init:null};if(d.beforePop&&false==d.boxing().beforePop(d,q,g,c)){return false}var m=_.copy(xui.UI.Dialog.$DataStruct),n={};_.merge(m,k,"with");_.merge(m,{dock:"none",width:Math.max(p.width,200),height:Math.max(p.height,100),left:l.left,top:l.top,landBtn:true},"all");if(q.properties){_.merge(m,q.properties,"with")}if(q.events){_.merge(n,q.events,"all")}var h=new xui.UI.Dialog(m,n,q.host||d.host,q.CS||null,q.CC||null,q.CB||null,q.CF||null);if(_.isFun(q.init)&&false===q.init(h,d,q)){}else{h.show(q.parent||xui("body"));var f=[];_.arr.each(d.children,function(e){f.push(e[0])});if(f.length){h.append(xui.UI.pack(f,false))}d.boxing().removeChildren().destroy(true)}}},PANEL:{onClick:function(c,f,g){var d=c.properties;if(d.disabled){return false}if(c.onClickPanel){return c.boxing().onClickPanel(c,f,g)}}}},DataModel:{rotate:null,selectable:true,position:"absolute",zIndex:0,dock:"fill",caption:{ini:undefined,action:function(c){c=(_.isSet(c)?c:"")+"";this.getSubNode("CAPTION").html(xui.adjustRes(c,true))}},image:{format:"image",action:function(c){this.getSubNode("ICON").css("display",c?"":"none").css("backgroundImage",c?("url("+xui.adjustRes(c||"")+")"):"")}},imagePos:{action:function(c){this.getSubNode("ICON").css("backgroundPosition",c)}},html:{action:function(c){this.getSubNode("PANEL").html(xui.adjustRes(c,0,1))}},toggle:{ini:true,action:function(c){this.box._toggle(this,c)}},infoBtn:{ini:false,action:function(c){this.getSubNode("INFO").css("display",c?"":"none")}},optBtn:{ini:false,action:function(c){this.getSubNode("OPT").css("display",c?"":"none")}},toggleBtn:{ini:false,action:function(c){this.getSubNode("TOGGLE").css("display",c?"":"none")}},closeBtn:{ini:false,action:function(c){this.getSubNode("CLOSE").css("display",c?"":"none")}},refreshBtn:{ini:false,action:function(c){this.getSubNode("REFRESH").css("display",c?"":"none")}},popBtn:{ini:false,action:function(c){this.getSubNode("POP").css("display",c?"":"none")}},borderType:{ini:"inset",listbox:["none","flat","inset","outset"],action:function(d){var f=this,k=f.properties,g=f.getSubNode("PANEL"),e=/^xui-uiborder-/,h="xui-uiborder-",c=f.getRoot();g.removeClass(e);g.addClass(h+d);xui.UI.$tryResize(f,c.get(0).style.width,c.get(0).style.height,true)}},noFrame:{ini:false,action:function(d){var e=this,c=e.getRoot();e.getSubNode("BBAR").css("display",d?"none":"");e.getSubNode("MAIN").css("paddingLeft",d?"0":"");e.getSubNode("MAINI").css("paddingRight",d?"0":"").css("backgroundImage",d?"none":"");xui.UI.$tryResize(e,c.get(0).style.width,c.get(0).style.height,true)}}},EventHandlers:{onRefresh:function(c){},beforePop:function(d,c,f,g){},beforeClose:function(c){},onIniPanelView:function(c){},beforeFold:function(c){},beforeExpand:function(c){},afterFold:function(c){},afterExpand:function(c){},onShowInfo:function(c,d,f){},onShowOptions:function(c,d,f){},onClickBar:function(c,d){},onClickPanel:function(c,d,f){}},LayoutTrigger:function(e){var c=this,d=c.properties;if(!d.toggle){c.box._toggle(c,false,true)}else{c.boxing().iniPanelView()}},_prepareData:function(d){var e=arguments.callee.upper.call(this,d);var c="display:none";e.panelDisplay=e.toggle?"":c;e.toggleCls=e.toggle?"xui-uicmd-toggle-checked":"";e.toggleDisplay=e.toggleBtn?"":c;e.infoDisplay=e.infoBtn?"":c;e.optDisplay=e.optBtn?"":c;e.closeDisplay=e.closeBtn?"":c;e.popDisplay=e.popBtn?"":c;e.refreshDisplay=e.refreshBtn?"":c;e._bordertype="xui-uiborder-"+e.borderType;e._bbarDisplay=e.noFrame?c:"";e._leftp=e.noFrame?"padding-left:0;":"";e._rightp=e.noFrame?"padding-right:0;background-image:none;":"";d._toggle=!!e.toggle;return e},_toggle:function(f,g,c){var k=f.properties,d=f.boxing();if(g){d.iniPanelView()}if(c||f._toggle!==!!g){f._toggle=k.toggle=!!g;if(!c){if(g){if(d.beforeExpand&&false===d.beforeExpand(f)){return}}else{if(d.beforeFold&&false===d.beforeFold(f)){return}}}f.getSubNode("PANEL").css("display",g?"":"none");if(k.toggleBtn){f.getSubNode("TOGGLE").tagClass("-checked",!!g)}var e=f.getSubNode("BORDER").height();f.getRoot().height(k.toggle?k.height:(e||"auto"));if(!c){if(g){if(d.afterExpand){d.afterExpand(f)}}else{if(d.afterFold){d.afterFold(f)}}if(k.dock&&k.dock!="none"){d.adjustDock(true)}}}},_onresize:function(e,d,x){var w={},c=e.properties,g=c.noFrame,q=e.getRoot(),h=e.getSubNode("BORDER"),u=e.getSubNode("TBAR"),r=e.getSubNode("PANEL"),n=e.getSubNode("BBAR"),l=e.getSubNode("MAIN"),k=e.getSubNode("MAINI"),z=e.properties.borderType=="none"?0:2,m,f,y;if(x){if(x=="auto"){w.height=x}else{if(e._toggle){m=u.height();f=g?0:n.height();if((y=x-m-f)>0){w.height=y-z}}else{q.height(h.height()||"auto")}}}if(d){w.width=d-(g?0:(parseInt(k.css("paddingRight"),10)||0))-(g?0:(parseInt(l.css("paddingLeft"),10)||0))-r._borderW()}r.cssSize(w,true)}}});Class("xui.UI.PageBar",["xui.UI","xui.absValue"],{Instance:{_setCtrlValue:function(c){return this.each(function(g){if(!g.renderId){return}var m,e=g.properties,d=g.box._v2a(c),w=d[0],f=d[1],z=d[2],n=g.keys,A=function(C,B){return C.getSubNode(B)},h=A(g,"FIRST"),q=A(g,"PREV"),p=A(g,"PREM"),u=A(g,"CUR"),r=A(g,"NEXT"),x=A(g,"NEXTM"),k=A(g,"LAST"),l=function(E,D,C,B){if(D){E.first(3).attr("href",e.uriTpl.replace("*",D))}if(_.isSet(C)){E.first(3).html(e.textTpl.replace("*",C),false)}if(_.isSet(B)){E.get(0)._real_page=B}},y=function(C,B){C.css("display",B?"":"none")};l(h,w,w);l(p,"",".."+_.str.repeat(".",String(f-1-w).length),1);l(q,f-1,e.prevMark);l(u,f,f);l(r,f+1,e.nextMark);l(x,"",".."+_.str.repeat(".",String(z-f-1).length),1);l(k,z,z);if((m=f-w)<=0){y(h,0);y(p,0);y(q,0)}else{if(m==1){y(h,1);y(p,0);y(q,0)}else{if(m==2){y(h,1);y(p,0);y(q,1);l(q,f-1,f-1)}else{y(h,1);y(p,1);y(q,1);if(m==3){l(q,f-1,f-1);l(p,f-2,f-2,0)}}}}if((m=z-f)<=0){y(k,0);y(x,0);y(r,0)}else{if(m==1){y(k,1);y(x,0);y(r,0)}else{if(m==2){y(k,1);y(x,0);y(r,1);l(r,f+1,f+1)}else{y(k,1);y(x,1);y(r,1);if(m==3){l(r,f+1,f+1);l(x,f+2,f+2,0)}}}}})},setPage:function(c){return this.each(function(g){var f=(g.properties.$UIvalue||""),e=f.split(":"),d=e[1]||e[0];e[1]=parseInt(c,10)||d;g.boxing().setUIValue(e.join(":"),false,false,"page");if(g.onPageSet){g.boxing().onPageSet(g,e[1],d)}})}},Static:{Templates:{style:"{_style}",className:"{_className}",POOL:{style:"position:absolute;display:none;",POP:{tagName:"div",className:"xui-uibg-base"}},LABEL:{text:"{caption}"},FIRST:{$order:1,className:"xui-ui-btn",FIRSTI:{className:"xui-ui-btni",FIRSTC:{className:"xui-ui-btnc",FIRSTA:{tagName:"a",href:"#",tabindex:"{tabindex}"}}}},PREM:{$order:2,className:"xui-ui-btn",PREMI:{className:"xui-ui-btni",PREMC:{className:"xui-ui-btnc",PREMA:{tagName:"a",href:"#",tabindex:"{tabindex}"}}}},PREV:{$order:3,className:"xui-ui-btn",PREVI:{className:"xui-ui-btni",PREVC:{className:"xui-ui-btnc",PREVA:{tagName:"a",href:"#",tabindex:"{tabindex}",text:"{prevMark}"}}}},CUR:{$order:4,className:"xui-ui-btn xui-ui-btn-focus",CURI:{className:"xui-ui-btni",CURC:{className:"xui-ui-btnc",CURA:{tagName:"a",href:"#",tabindex:"{tabindex}"}}}},NEXT:{$order:5,className:"xui-ui-btn",NEXTI:{className:"xui-ui-btni",NEXTC:{className:"xui-ui-btnc",NEXTA:{tagName:"a",href:"#",tabindex:"{tabindex}",text:"{nextMark}"}}}},NEXTM:{$order:6,className:"xui-ui-btn",NEXTMI:{className:"xui-ui-btni",NEXTMC:{className:"xui-ui-btnc",NEXTMA:{tagName:"a",href:"#",tabindex:"{tabindex}"}}}},LAST:{$order:7,className:"xui-ui-btn",LASTI:{className:"xui-ui-btni",LASTC:{className:"xui-ui-btnc",LASTA:{tagName:"a",href:"#",tabindex:"{tabindex}"}}}}},Appearances:{LABEL:{"font-size":"12px",padding:"3px 6px 0 6px","vertical-align":"top","white-space":"nowrap"},KEY:{display:"inline",overflow:"visible"},"KEY a:focus, POP a:focus":{"outline-offset":"","-moz-outline-offset":(xui.browser.gek&&xui.browser.ver<3)?"":null},"KEY .xui-ui-btn, POP .xui-ui-btn":{"margin-right":"3px"},"KEY .xui-ui-btn a, POP .xui-ui-btn a":{padding:"0 3px 0 3px"},"PREV,CUR,NEXT":{"font-weight":"bold"},POP:{border:"dotted 1px gray",background:"#fff",position:"absolute",padding:"3px","line-height":"26px"}},Behaviors:{HoverEffected:{FIRST:"FIRST",PREM:"PREM",PREV:"PREV",NEXT:"NEXT",NEXTM:"NEXTM",LAST:"LAST",POPI:"POPI",CUR:"CUR"},ClickEffected:{FIRST:"FIRST",PREM:"PREM",PREV:"PREV",NEXT:"NEXT",NEXTM:"NEXTM",LAST:"LAST",POPI:"POPI",CUR:"CUR"},POP:{onClick:function(c,f,h){var g=xui(h),d=xui.Event.getSrc(f);g.setBlurTrigger(c.key+":"+c.$xid,null);c.getSubNode("POOL").append(g);if(d.tagName.toLowerCase()=="a"||((d=d.firstChild)&&(d.tagName.toLowerCase()=="a"))||((d=d.firstChild)&&(d.tagName.toLowerCase()=="a"))||((d=d.firstChild)&&(d.tagName.toLowerCase()=="a"))){return c.box._click(c,d.parentNode.parentNode.parentNode)}}},FIRST:{onClick:function(c,d,f){return c.box._click(c,f)}},PREM:{onClick:function(c,d,f){if(xui.use(f).get(0)._real_page){c.box._show(c,d,f,0);return false}else{return c.box._click(c,f)}}},PREV:{onClick:function(c,d,f){return c.box._click(c,f)}},CUR:{onClick:function(c,d,f){return c.box._click(c,f)}},NEXT:{onClick:function(c,d,f){return c.box._click(c,f)}},NEXTM:{onClick:function(c,d,f){if(xui.use(f).get(0)._real_page){c.box._show(c,d,f,1);return false}else{return c.box._click(c,f)}}},LAST:{onClick:function(c,d,f){return c.box._click(c,f)}}},DataModel:{dataField:null,dataBinder:null,readonly:null,autoTips:false,dirtyMark:false,showDirtyMark:false,caption:{ini:" Page: ",action:function(c){c=(_.isSet(c)?c:"")+"";this.getSubNode("LABEL").html(xui.adjustRes(c,true))}},value:"1:1:1",uriTpl:"#*",textTpl:"*",prevMark:"&lt;",nextMark:"&gt;",_moreStep:100},EventHandlers:{onClick:function(c,d){},onPageSet:function(d,e,c){}},_ensureValue:function(f,g){g=g+"";var e=g.split(":"),c=[],d=function(h){return parseInt(h,10)||1};if(e.length<3){c=f.properties.$UIvalue.split(":");e[1]=e[0];e[0]=c[0];e[2]=c[2]}c[0]=d(e[0]);c[1]=d(e[1]);c[2]=d(e[2]);c[0]=Math.max(c[0],1);c[0]=Math.min(c[0],c[1]);c[2]=Math.max(c[1],c[2]);return c.join(":")},_v2a:function(c){c=typeof c=="string"?c.split(":"):c;c[0]=parseInt(c[0],10);c[1]=parseInt(c[1],10);c[2]=parseInt(c[2],10);return c},_click:function(f,h){if(f.properties.disabled){return false}var c=f.boxing(),d=(f.properties.$UIValue||"").split(":"),e=parseInt(xui(h).first(3).attr("href").split("#")[1],10)||d[1]||d[0];var g=c.onClick(e);d=(f.$UIValue||"").split(":");if(!d.length||(e+"")!==(d[1]+"")){c.setPage(e)}return typeof g=="boolean"?g:false},_show:function(k,E,p,D){if(k.properties.disabled){return false}var f=k.properties,c=k.box._v2a(f.value),A=c[0],h=c[1],C=c[2],u=k.keys,F=function(l,e){return l.getSubNode(e)},w=F(k,"POOL"),q=F(k,"POP"),d=function(e){return Math.ceil((e+1)/10)*10},G=[],r,y,x,B,z;if(D){if((r=C-1-h)<=0){return}x=h+1;z=C}else{if((r=h-1-A)<=0){return}x=1;z=h-1}y=Math.ceil(r/f._moreStep);if(y>10){x=d(x);z=d(z)-1;y=d(y)}else{x=x+y}var g=k.keys.POPI+":"+k.serialId+":";while(x<z){G.push('<span style="margin-top:3px;" id="'+g+x+'" class="xui-node xui-node-span xui-ui-btn"><span class="xui-node xui-node-span xui-ui-btni"><span class="xui-node xui-node-span xui-ui-btnc"><a class="xui-node xui-node-a" href="'+f.uriTpl.replace("*",x)+'">'+f.textTpl.replace("*",x)+"</a></span></span></span>");x=x+y}q.width("auto");q.html(G.join(" "));xui("body").append(q);if(q.width()>300){q.width(300)}q.popToTop(p);q.setBlurTrigger(k.key+":"+k.$xid,function(){w.append(q)})}},Initialize:function(){this.addTemplateKeys(["POPI"])}});Class("xui.UI.Tabs",["xui.UI","xui.absList","xui.absValue"],{Instance:{_setCtrlValue:function(c){this.each(function(g){var e=g.domId,h=g.boxing(),p=h.getUIValue(),d=g.properties,k=g.box.$DataModel,l=function(y,r){var w=g.getSubIdByItemId(y),x=g.getItemByItemId(y);if(w){r.push(w);if(!k.hasOwnProperty("noPanel")||!d.noPanel){var u=h.getPanel(y).get(0);if(u&&(x._scrollTop=u.scrollTop||0)){u.scrollTop=0}h.getPanel(y).css("display","none")}}},q=function(y,r){var u=g.getSubIdByItemId(y),x=g.getItemByItemId(y);if(u){r.push(u);if(!k.hasOwnProperty("noPanel")||!d.noPanel){h.getPanel(y).css("display","block");if(x._scrollTop){h.getPanel(y).get(0).scrollTop=x._scrollTop}var w=g.getRootNode().style;xui.UI.$tryResize(g,w.width,w.height,true,c);w=null;g.box._forLazyAppend(g,x,c);g.box._forIniPanelView(g,x)}}};var n=[],m=[];if(k.hasOwnProperty("selMode")&&k.hasOwnProperty("noPanel")&&d.noPanel&&d.selMode=="multi"){p=p?p.split(d.valueSeparator):[];_.arr.each(p,function(r){l(r,n)});c=c?c.split(d.valueSeparator):[];var f="";_.arr.each(c,function(u){var r=m.length;q(u,m);if(r<m.length){f=u}});if(!d.noHandler&&f){_.tryF(g.box._adjustScroll,[g,f],g.box)}}else{l(p,n);q(c,m);if(!d.noHandler&&m.length){_.tryF(g.box._adjustScroll,[g,c],g.box)}}if(n.length){g.getSubNodes("ITEM",n).tagClass("-checked",false).removeClass("xui-uiborder-linkbottombar")}if(m.length){g.getSubNodes("ITEM",m).tagClass("-checked").addClass("xui-uiborder-linkbottombar")}})},append:function(g,c,f,d){var e=this.get(0).properties;if(c=c||e.$UIvalue||e.value){arguments.callee.upper.call(this,g,c+"",f,d)}return this},getCurPanel:function(){var e=this.get(0),d=e.box.$DataModel,c=e.properties.$UIvalue;if(d.hasOwnProperty("noPanel")&&d.hasOwnProperty("selMode")&&e.properties.selMode=="multi"){c=c.split(prop.valueSeparator);c=c[0]||null}return c?this.getPanel(c):null},getPanel:function(c){var d=this.get(0);return d.getSubNodeByItemId("PANEL",c+"")},addPanel:function(e,h,k){var g={},l=k&&k.id,d=this.getItems(),f=e.id||e.tag;if(d.length){if(-1!=_.arr.subIndexOf(d,"id",f)){return false}if(!l){l=d[d.length-1].id}}_.merge(g,{caption:e.caption,image:e.image,closeBtn:e.closeBtn||false,popBtn:e.popBtn||false,optBtn:e.optBtn||false,imagePos:e.imagePos,dragKey:e.dragKey,dropKeys:e.dropKeys,id:e.id||e.tag||_.id()});this.insertItems([g],l);var c=[];_.arr.each(h,function(m){c.push(m[0])});this.append(xui.UI.pack(c,false),g.id);return this},removePanel:function(e){var c=this,d=c.getItemByDom(e);return c.removeItems([d.id])},getPanelPara:function(g){var e=this.get(0),c=e.properties,f=e.getItemByDom(g),d=_.clone(f,false);if(!d.dragKey){d.dragKey=c.dragKey}if(!d.dropKeys){d.dropKeys=c.dropKeys}return d},getPanelChildren:function(e){var d=this.get(0),f=d.getItemIdByDom(e),c=[];if(f){_.arr.each(d.children,function(g){if(g[1]==f){c.push(g)}})}return c},resetPanelView:function(d,e,g){if(!_.isSet(e)){e=true}if(!_.isSet(g)){g=true}var c,f;return this.each(function(h){if(h.renderId){_.arr.each(h.properties.items,function(k){if(d===true||(d+"")===k.id){delete k._$ini}});if(e){h.boxing().removeChildren(d,g)}}})},iniPanelView:function(c){return this.each(function(d){if(c){if(c=d.getItemByItemId(c+"")){d.box._forIniPanelView(d,c)}}else{_.arr.each(d.properties.items,function(e){d.box._forIniPanelView(d,e)})}})},fireItemClickEvent:function(c){var e=this.getSubNodeByItemId("ITEM",c+""),d=xui.Event;e.onClick(true);return this},_afterInsertItems:function(f,h){if(!f.renderId){return}var g=f.box,k,d,c=f.properties;if(k=f.getSubNode(f.keys.BOX||f.keys.KEY)){k.append(f._buildItems("panels",h));if(!f.box.$DataModel.hasOwnProperty("noPanel")){if(!(d=this.getUIValue())){this.fireItemClickEvent((d=c.items[0])&&(d=d.id))}var e=f.getRootNode().style;xui.UI.$tryResize(f,e.width,e.height,true,d);e=null}}},removeItems:function(c){var d=this,g,f,e;d.each(function(h){var k=h.properties;c=_.isArr(c)?c:(c+"").split(k.valueSeparator);if(!h.box.$DataModel.hasOwnProperty("noPanel")||!h.properties.noPanel){_.arr.each(c,function(l){e=h.getSubIdByItemId(l+"");if(e&&!(f=h.getSubNode("PANEL",e)).isEmpty()){f.remove()}})}});arguments.callee.upper.apply(d,arguments);d.each(function(k){if(!k.boxing().getUIValue()){_.asyRun(function(){if(!k||!k.renderId||!k.properties||!k.properties.items.length){return}var l;k.boxing().fireItemClickEvent((l=k.properties.items[0])&&l.id)})}if(!k.box.$DataModel.hasOwnProperty("noPanel")||!k.properties.noPanel){var h=k.getRootNode().style;xui.UI.$tryResize(k,h.width,h.height,true,k.boxing().getUIValue());h=null}});return d},clearItems:function(){var c=this;c.each(function(d){if(!d.box.$DataModel.hasOwnProperty("noPanel")||!d.properties.noPanel){d.getSubNode("PANEL",true).remove()}});c.setValue(null,true,"clear");arguments.callee.upper.apply(c,arguments);return c},markItemCaption:function(d,h,f){var e=this.get(0);d=e.getItemByItemId(d+"");if((d._dirty!=h)||f){var g=d.id,c=e.getItemByItemId(g).caption;e.getSubNodeByItemId("CAPTION",g).html(e.getItemByItemId(g).caption=h?("*"+c):c.replace(/^\*/,"")).css({color:h?"#ff0000":"","font-weight":h?"bold":""});d._dirty=h}return this},_scrollToBottom:function(f,e){var d=this.get(0),g=d.getSubNode("ITEMS"),c=d.getSubNode("LIST").width();if(f){g.left(c-(f.offsetLeft+f.offsetWidth));if(!f.nextSibling){d.getSubNode("RIGHT").css("display","none")}else{if(e!==false&&f.nextSibling){d.$scrollTobottom=_.asyRun(arguments.callee,600,[f.nextSibling],this)}}d.getSubNode("LEFT").css("display","block")}},_scrollToTop:function(e,d){var c=this.get(0),f=c.getSubNode("ITEMS");if(e){f.left(-e.offsetLeft);if(!e.previousSibling){c.getSubNode("LEFT").css("display","none")}else{if(d!==false&&e.previousSibling){c.$scrollToTop=_.asyRun(arguments.callee,600,[e.previousSibling],this)}}c.getSubNode("RIGHT").css("display","block")}}},Static:{Templates:{tagName:"div",style:"{_style};",className:"{_className}",LIST:{$order:0,tagName:"div",style:"{_liststyle}",ITEMS:{tagName:"div",className:"xui-ui-unselectable",text:"{items}",style:"{HAlign}"},LEFT:{className:"xui-ui-unselectable"},RIGHT:{className:"xui-ui-unselectable"},DROP:{className:"xui-ui-unselectable"}},PNAELS:{$order:1,tagName:"text",text:"{panels}"},$submap:{items:{ITEM:{className:"{itemClass} {disabled} {readonly}",style:"{_itemDisplay} {itemStyle}",ITEMI:{ITEMC:{HANDLE:{tabindex:"{_tabindex}",IBWRAP:{tagName:"div",style:"white-space:nowrap;",RULER:{},ICON:{$order:0,className:"xui-ui-icon {imageClass}",style:"{backgroundImage} {backgroundPosition} {backgroundRepeat} {imageDisplay}"},CAPTION:{text:"{caption}",style:"{itemWidth};{itemAlign}",$order:1},CMDS:{$order:2,OPT:{$order:1,className:"xui-uicmd-opt",style:"{_opt}"},POP:{className:"xui-uicmd-pop",style:"{popDisplay}",$order:1},CLOSE:{className:"xui-uicmd-close ",style:"{closeDisplay}",$order:2}}}}}}}},panels:{PANEL:{tagName:"div",className:"xui-uibg-base",style:"{_overflow};{_bginfo}",text:"{html}"+xui.UI.$childTag}}}},Appearances:{KEY:{position:"absolute",overflow:"hidden"},LIST:{position:"relative",overflow:"hidden",left:0,width:"100%","background-image":xui.UI.$bg("line.gif",""),"background-repeat":"repeat-x","background-position":"center bottom"},LEFT:{cursor:"pointer",display:"none",position:"absolute",top:0,left:0,height:"26px",width:"16px","z-index":"10","background-image":xui.UI.$bg("cmds.png",""),"background-repeat":"no-repeat","background-position":"left top"},"LEFT-mouseover":{"background-image":xui.UI.$bg("cmds.png",""),"background-position":"-16px top"},RIGHT:{cursor:"pointer",display:"none",position:"absolute",top:0,right:"16px",height:"26px",width:"16px","z-index":"10","background-image":xui.UI.$bg("cmds.png",""),"background-repeat":"no-repeat","background-position":"-32px top"},"RIGHT-mouseover":{"background-image":xui.UI.$bg("cmds.png",""),"background-position":"-48px top"},DROP:{cursor:"pointer",display:"none",position:"absolute",top:0,right:0,height:"26px",width:"16px","z-index":"10","background-image":xui.UI.$bg("cmds.png",""),"background-repeat":"no-repeat","background-position":"-64px top"},"DROP-mouseover":{"background-image":xui.UI.$bg("cmds.png",""),"background-position":"-80px top"},ITEMS:{padding:"1px 0 2px 0",position:"relative",left:0,top:0,"white-space":"nowrap"},ITEM:{$order:0,"font-family":'"Verdana", "Helvetica", "sans-serif"',cursor:"pointer","padding-right":"6px","vertical-align":"top","background-image":xui.UI.$bg("button.gif","",true),"background-repeat":"no-repeat","background-position":"right -540px"},"ITEM-mouseover":{$order:1,"background-position":"right -690px"},"ITEM-mousedown, ITEM-checked":{$order:2,"background-position":"right -840px"},ITEMI:{$order:0,"padding-left":"6px","vertical-align":"top","background-image":xui.UI.$bg("button.gif","",true),"background-repeat":"no-repeat","background-position":"left -640px"},"ITEM-mouseover ITEMI":{$order:1,"background-position":"left -790px"},"ITEM-mousedown ITEMI, ITEM-checked ITEMI":{$order:2,"background-position":"left -940px"},ITEMC:{$order:0,padding:"5px 0 3px 0","vertical-align":"top","text-align":"center","background-image":xui.UI.$bg("button.gif","",true),"background-repeat":"repeat-x","background-position":"left -590px"},"ITEM-mouseover ITEMC":{$order:1,"background-position":"left -740px"},"ITEM-mousedown ITEMC, ITEM-checked ITEMC":{$order:2,"background-position":"left -890px"},HANDLE:{display:xui.$inlineBlock,zoom:xui.browser.ie6?1:null,cursor:"pointer","vertical-align":"middle","font-size":"12px"},RULER:{height:"18px",width:"1px","vertical-align":"middle"},PANEL:{position:"relative",display:"none",width:"100%",overflow:"auto"},CAPTION:{"vertical-align":xui.browser.ie6?"baseline":"middle",margin:"0 4px"},CMDS:{"vertical-align":"middle"}},Behaviors:{NOTIPS:["GROUP","HANDLER"],DroppableKeys:["PANEL","KEY","ITEM"],PanelKeys:["PANEL"],DraggableKeys:["ITEM"],HoverEffected:{ITEM:"ITEM",OPT:"OPT",CLOSE:"CLOSE",POP:"POP",LEFT:"LEFT",RIGHT:"RIGHT",DROP:"DROP"},ClickEffected:{ITEM:"ITEM",OPT:"OPT",CLOSE:"CLOSE",POP:"POP"},onSize:xui.UI.$onSize,CAPTION:{onMousedown:function(d,h,k){if(xui.Event.getBtn(h)!="left"){return}var c=d.properties,g=d.getItemByDom(k),f=d.boxing();if(c.disabled||g.disabled){return false}if(c.readonly||g.readonly){return false}if(f.getUIValue()==g.id){if(d.onCaptionActive){d.boxing().onCaptionActive(d,d.getItemByDom(k),h,k)}}}},ITEM:{onClick:function(g,n,c){if(xui.Event.getBtn(n)!="left"){return false}var w;if((w=xui.Event.getSrc(n).parentNode)&&w.id&&(g.getKey(w.id))==g.keys.CMDS){return false}var d=g.properties,m=g.box.$DataModel,p=g.getSubId(c),u=g.getItemByDom(c),l=g.boxing();if(d.disabled||u.disabled){return false}if(d.readonly||u.readonly){return false}if(m.hasOwnProperty("selMode")&&m.hasOwnProperty("noPanel")&&d.noPanel&&d.selMode=="multi"){var r=l.getUIValue(),k=r?r.split(d.valueSeparator):[],q=1,h=false,f=false;if(k.length){if(_.arr.indexOf(k,u.id)!=-1){_.arr.removeValue(k,u.id);q=-1}else{k.push(u.id)}k.sort();r=k.join(d.valueSeparator);if(l.getUIValue()==r){h=false}else{l.setUIValue(r,null,null,"md");if(l.get(0)&&l.getUIValue()==r){h=l.onItemSelected(g,u,n,c,q)||f}}return h}}if(l.getUIValue()!=u.id){l.setUIValue(u.id,null,null,"md");if(l.getUIValue()==u.id){h=l.onItemSelected(g,u,n,c)||f;return h}}}},HANDLE:{onKeydown:function(f,k,c){var q=xui.Event.getKey(k),p=q.key,d=q.shiftKey;if(p==" "||p=="enter"){f.getSubNode("ITEM",f.getSubId(c)).onClick();return false}var n=xui(c),l=f.getSubNode("ITEMS"),h=l.nextFocus(true,true,false),m=l.nextFocus(false,true,false);switch(p){case"tab":if(d){if(n.get(0)!=h.get(0)){h.focus();return false}}else{if(n.get(0)!=m.get(0)){m.focus();return false}}break;case"left":case"up":var g=n.nextFocus(false,true,false);if(n.get(0)==h.get(0)){m.focus()}else{n.nextFocus(false)}return false;break;case"right":case"down":var g=n.nextFocus(true,false,false);if(n.get(0)==m.get(0)){h.focus()}else{n.nextFocus()}return false;break}}},OPT:{onClick:function(c,d,f){c.boxing().onShowOptions(c,c.getItemByDom(f),d,f);return false}},CLOSE:{onClick:function(f,h,c){var l=f.properties,r=f.getItemByDom(c),m=l.$UIvalue,p;if(l.disabled||r.disabled){return}if(l.readonly||r.readonly){return false}var n=f.boxing();if(false===n.beforePageClose(f,r,c)){return}p=_.copy(r);if(m&&m==r.id){var k=l.items,g=_.arr.subIndexOf(k,"id",r.id),q,d=(q=k[g+1])?q.id:(q=k[g-1])?q.id:(q=k[0])?q.id:null;if(d&&d!=m){f.boxing().fireItemClickEvent(d)}}n.removeItems(r.id);n.afterPageClose(f,p);var q=f.getRootNode().style;xui.UI.$tryResize(f,q.width,q.height,true);q=null;return false}},POP:{onClick:function(g,k,c){var m=g.properties,r=g.getItemByDom(c),w={parent:null,host:null,properties:null,events:null,CS:null,CC:null,CB:null,CF:null,init:null},f=r.id;if(m.disabled||r.disabled){return false}if(m.readonly||r.readonly){return false}if(g.beforePagePop&&false==g.boxing().beforePagePop(g,r,w,k,c)){return false}var d=g.boxing().getPanel(f),n=g.getRoot().offset(),u=g.getRoot().cssSize(),p=_.copy(xui.UI.Dialog.$DataStruct),q={};_.merge(p,r,"with");_.merge(p,{dragKey:r.dragkey||m.dragKey,dock:"none",tag:r.tag||r.id,width:Math.max(u.width,200),height:Math.max(u.height,100),left:n.left,top:n.top,landBtn:true},"all");if(w.properties){_.merge(p,w.properties,"with")}if(w.events){_.merge(q,w.events,"all")}var l=new xui.UI.Dialog(p,q,w.host||g.host,w.CS||null,w.CC||null,w.CB||null,w.CF||null);if(_.isFun(w.init)&&false===w.init(l,g,w)){}else{l.show(w.parent||xui("body"));var h=[];_.arr.each(g.children,function(e){if(e[1]==f){h.push(e[0])}});if(h.length){l.append(xui.UI.pack(h,false))}g.boxing().removeChildren(f).removeItems(f)}return false}},ITEMS:{beforeMousedown:function(d,f,g){var c=xui.Event.getPos(f);if(!d._$scroll_l&&!d._$scroll_r){return}xui.use(g).startDrag(f,{horizontalOnly:true,dragType:"blank",dragDefer:2,targetLeft:c.left,targetTop:c.top,targetReposition:false,maxLeftOffset:d._$scroll_l,maxRightOffset:d._$scroll_r})},onDrag:function(d,f,g){var c=xui.DragDrop.getProfile();xui.use(g).left(-d._$scroll_r+c.offset.x)},onDragstop:function(c,d,f){if(c.box._adjustScroll){c.box._adjustScroll(c)}}},LEFT:{onMouseover:function(c,f,h){xui(h).css("display","none");var g=xui(h).get(0).ownerDocument||document;pos=xui.Event.getPos(f),node=g.elementFromPoint(pos.left,pos.top),pnode=c.getSubNode("ITEM",c.getSubId(node.id));xui(h).css("display","block");if(pnode=pnode.get(0)){c.boxing()._scrollToTop(pnode)}xui(h).css("display","block")},onMouseout:function(c,d,f){_.clearTimeout(c.$scrollToTop)},onClick:function(c,f,h){xui(h).css("display","none");var g=xui(h).get(0).ownerDocument||document;pos=xui.Event.getPos(f),node=g.elementFromPoint(pos.left,pos.top),pnode=c.getSubNode("ITEM",c.getSubId(node.id));xui(h).css("display","block");if(pnode=pnode.get(0)){if(pnode.previousSibling){pnode=pnode.previousSibling}_.clearTimeout(c.$scrollToTop);c.boxing()._scrollToTop(pnode,false)}}},RIGHT:{onMouseover:function(c,f,h){xui(h).css("display","none");var g=xui(h).get(0).ownerDocument||document;pos=xui.Event.getPos(f),node=g.elementFromPoint(pos.left,pos.top),pnode=c.getSubNode("ITEM",c.getSubId(node.id));xui(h).css("display","block");if((pnode=pnode.get(0))&&(pnode=pnode.nextSibling)){c.boxing()._scrollToBottom(pnode)}},onMouseout:function(c,d,f){_.clearTimeout(c.$scrollTobottom)},onClick:function(c,f,h){xui(h).css("display","none");var g=xui(h).get(0).ownerDocument||document;pos=xui.Event.getPos(f),node=g.elementFromPoint(pos.left,pos.top),pnode=c.getSubNode("ITEM",c.getSubId(node.id));xui(h).css("display","block");if(pnode=pnode.get(0)){if(pnode.nextSibling){pnode=pnode.nextSibling}_.clearTimeout(c.$scrollTobottom);c.boxing()._scrollToBottom(pnode,false)}}},DROP:{onMouseover:function(f,n,c){var d=f._droppopmenu;if(d){return}var m=f.boxing(),p=f.properties.items,h=[],g=p.length,q;if(p.length>10){q=Math.ceil(g/10);for(var k=0;k<q;k++){h.push({caption:(k*10+1)+" - "+Math.min(g,((k+1)*10+1)),sub:[]})}_.arr.each(p,function(l,e){h[parseInt(e/10)].sub.push(_.clone(l,false,1))})}else{h=_.clone(p,false,2)}d=f._droppopmenu=new xui.UI.PopMenu({items:h,autoHide:true},{onMenuSelected:function(e,l){m.fireItemClickEvent(l.id)},beforeHide:function(y,x){if(x){var r=xui(c),z=xui.Event.getPos(x),l=r.cssSize(),w=3,u=r.offset();if(z.left>u.left&&z.top>u.top-w&&z.left<u.left+l.width&&z.top<u.top+l.height){return false}}},onHide:function(){f._droppopmenu.destroy(true);delete f._droppopmenu}});d.pop(c)},onMouseout:function(f,g,c){var k;if(k=f._droppopmenu){var d=k.get(0).getRoot(),l=xui.Event.getPos(g),n=d.cssSize(),m=3,h=d.offset();if(l.left>h.left&&l.top>h.top-m&&l.left<h.left+n.width&&l.top<h.top+n.height){}else{k.hide()}}},onClick:function(d,c,f){xui(f).onMouseover(true)}},PANEL:{onClick:function(c,g,h){var f=c.properties,d=c.getItemByDom(h);if(f.disabled||d.disabled){return false}if(c.onClickPanel){return c.boxing().onClickPanel(c,d,g,h)}}}},DataModel:{rotate:null,selectable:true,dirtyMark:false,lazyAppend:true,dock:"fill",noPanel:false,width:200,height:200,position:"absolute",itemWidth:{ini:0,action:function(c){this.getSubNode("CAPTION",true).width(c)}},itemAlign:{ini:"",listbox:["","left","center","right"],action:function(c){this.getSubNode("CAPTION",true).css("text-align",c)}},HAlign:{ini:"left",listbox:["left","center","right"],action:function(c){this.getSubNode("ITEMS").css("textAlign",c)}},dropKeysPanel:"",value:{ini:""},selMode:{ini:"single",listbox:["single","multi"]},noHandler:{ini:false,action:function(d){this.getSubNode("LIST").css("display",d?"none":"");var c=this.getRootNode().style;xui.UI.$tryResize(this,c.width,c.height,true,this.$UIValue)}}},EventHandlers:{onIniPanelView:function(c,d){},beforePagePop:function(d,f,c,g,h){},beforePageClose:function(c,d,e){},afterPageClose:function(c,d){},onShowOptions:function(c,d,f,g){},onItemSelected:function(d,f,g,h,c){},onCaptionActive:function(c,d,f,g){},onClickPanel:function(c,d,f,g){}},RenderTrigger:function(){var d=this,c,f,e;if(c=d.properties.value){(e=d.boxing()).setUIValue(c,null,null,"render");if(f=d.getItemByItemId(c)){e.onItemSelected(d,f)}}},_prepareData:function(c){var d=arguments.callee.upper.call(this,c);d.panels=d.items;if(d.HAlign){d.HAlign="text-align:"+d.HAlign+";"}d._liststyle=d.noHandler?"display:none":"";return d},_prepareItem:function(d,e){var g="display:none",f=d.properties,c;e.closeDisplay=e.closeBtn?"":g;e.popDisplay=e.popBtn?"":g;e._opt=e.optBtn?"":g;e._itemDisplay=e.hidden?g:"";if(c=e.itemWidth||f.itemWidth){e.itemWidth="width:"+c+(_.isFinite(c)?"px":"")}if(c=e.itemAlign||f.itemAlign){e.itemAlign="text-align:"+c}e._bginfo="";if(c=e.panelBgClr||f.panelBgClr){e._bginfo+="background-color:"+c+";"}if(c=e.panelBgImg||f.panelBgImg){e._bginfo+="background-image:url("+xui.adjustRes(c)+");"}if(c=e.panelBgImgPos||f.panelBgImgPos){e._bginfo+="background-position:"+c+";"}if(c=e.panelBgImgRepeat||f.panelBgImgRepeat){e._bginfo+="background-repeat:"+c+";"}if(c=e.panelBgImgAttachment||f.panelBgImgAttachment){e._bginfo+="background-attachment:"+c+";"}if(_.isStr(e.overflow)){e._overflow=e.overflow.indexOf(":")!=-1?(e.overflow):(data.overflow?("overflow:"+data.overflow):"")}else{if(_.isStr(f.overflow)){e._overflow=f.overflow.indexOf(":")!=-1?(f.overflow):(f.overflow?("overflow:"+f.overflow):"")}}},getDropKeys:function(c,d){return c.properties[c.getKey(xui.use(d).id())==c.keys.PANEL?"dropKeys":"dropKeysPanel"]},_forLazyAppend:function(d,m,k){var c=d.properties,f=d.boxing();if(c.lazyAppend){var g=d.children,h=[];_.arr.each(g,function(n){if(n[1]==k&&(!n[0].renderId||xui.UIProfile.getFromDom(xui(n[0].renderId).parent().id())!=d)){h.push(n[0])}});if(h.length){f.append(xui.UI.pack(h),k)}if(d.$attached){for(var e=0,l;l=d.$attached[e++];){if(l._render){l._render(true)}}delete d.$attached}g=d.exchildren;if(g&&g.length){h=[];_.filter(g,function(n){if(n[1]==k){h.push(n[0]);return false}});if(h.length){_.arr.each(h,function(n){f.append(xui(n),k)})}}g=d.excoms;if(g&&g.length){h=[];_.filter(g,function(n){if(n[1]==k){h.push(n[0]);return false}});if(h.length){_.arr.each(h,function(n){n.show(null,f,k,false)})}}}},_forIniPanelView:function(g,p){if(!p){return}var c=g.properties,k=g.boxing();if(!p._$ini){p._$ini=true;if(g.onIniPanelView){k.onIniPanelView(g,p)}if(p.iframeAutoLoad){k.getPanel(p.id).css("overflow","hidden");var n=typeof p.iframeAutoLoad=="string"?{url:p.iframeAutoLoad}:_.clone(p.iframeAutoLoad,true),d="diframe_"+_(),m=xui.browser.ie&&xui.browser.ver<9,h=document.createElement(m?"<iframe name='"+d+"'>":"iframe");n.url=xui.adjustRes(n.url,false,true);h.id=h.name=d;if(_.isHash(p.iframeAutoLoad)){p.iframeAutoLoad.frameName=d}p._frameName=d;if(!n.query){n.query={}}n.query._rand=_();h.frameBorder="0";h.marginWidth="0";h.marginHeight="0";h.vspace="0";h.hspace="0";h.allowTransparency="true";h.width="100%";h.height="100%";k.getPanel(p.id).html("").append(h);if((n.method||"").toLowerCase()=="post"){xui.Dom.submit(n.url,n.query,"post",d,n.enctype)}else{h.src=n.url}}else{if(p.ajaxAutoLoad){var l=typeof p.ajaxAutoLoad=="string"?{url:p.ajaxAutoLoad}:_.clone(p.ajaxAutoLoad,true),q={rspType:"text"};_.merge(q,l.options);if(!l.query){l.query={}}l.query._rand=_();k.busy(null,null,"PANEL",g.getSubIdByItemId(p.id));var f=k.getPanel(p.id);xui.Ajax(xui.adjustRes(l.url,false,true),l.query,function(e){f.html(e,true,true);k.free()},function(e){f.html("<div>"+e+"</div>",true,false);k.free()},null,q).start()}}}},_showTips:function(f,e,k){if(f.properties.disableTips){return}if(f.onShowTips){return f.boxing().onShowTips(f,e,k)}if(!xui.Tips){return}var c=e.id,g,d,l=f.keys;g=_.get(e,["parentNode","id"])||"";d=_.get(e,["parentNode","parentNode","id"])||"";if(c.indexOf(l.ITEM)===0||g.indexOf(l.ITEM)===0||d.indexOf(l.ITEM)===0||c.indexOf(l.HANDLE)===0||g.indexOf(l.HANDLE)===0||d.indexOf(l.HANDLE)===0||c.indexOf(l.CMDS)===0||g.indexOf(l.CMDS)===0||d.indexOf(l.CMDS)===0){var m=arguments.callee.upper,h=m.apply(this,_.toArr(arguments));m=null;return h}},_onresize:function(f,d,n,c,m){var q=f.properties,p=f.getItemByItemId(m);if(!p){m=q.$UIvalue}p=f.getItemByItemId(m);var e=f.boxing().getPanel(m),k=f.getSubNode("LIST"),l;if(!e||e.isEmpty()){return}var h=null,g=null;if(c){p._w=p._h=null}if(n&&p._h!=n){p._h=n;if(n&&n!="auto"){if(!q.noHandler){l=k.get(0).offsetHeight||k.offsetHeight();n=n-l}if(n>0){h=n}}else{h=n}}if(d&&p._w!=d){k.width(p._w=d);if(!q.noHandler){this._adjustScroll(f)}g=d}if(h||g){e.height(h).onSize()}},_adjustScroll:function(f,k){var m=f.getSubNode("LIST"),q=m.offsetWidth(),n=f.getSubNode("ITEMS"),h=n.left(),e=f.getSubNode("LEFT"),r=f.getSubNode("RIGHT"),d=f.getSubNode("DROP"),c=0,g=0,p=0;n.children().each(function(l){if(k&&f.getItemIdByDom(l.id)==k){g=c;p=l.offsetWidth}c+=l.offsetWidth});n.width(Math.max(c,q));if(c<=q){n.left(0);f._$scroll_r=f._$scroll_l=0;n.css("cursor","")}else{if(p){if((g+h<0)||(g+p-h>q)){h=-g}}if(c+h<q){n.left(q-c);f._$scroll_r=c-q;f._$scroll_l=0}else{n.left(h);f._$scroll_r=-h;f._$scroll_l=c-q+h}n.css("cursor","move")}e.css("display",f._$scroll_r?"block":"none");r.css("display",f._$scroll_l?"block":"none");d.css("display",(f._$scroll_l||f._$scroll_r)?"block":"none")}}});Class("xui.UI.Stacks","xui.UI.Tabs",{Initialize:function(){var c=this.getTemplate(),d=this.$Keys;c.BOX={tagName:"div",LIST:c.LIST,PNAELS:c.PNAELS};delete c.LIST.LEFT;delete c.LIST.RIGHT;delete c.LIST.DROP;delete c.LIST;delete c.PNAELS;this.setTemplate(c);delete d.LEFT;delete d.RIGHT;delete d.DROP},Static:{Appearances:{BOX:{border:"solid 1px #648CB4",position:"absolute",left:0,top:0},LIST:{position:"static"},ITEMS:{position:"static"},ITEM:{$order:0,display:"block",position:"absolute",cursor:"pointer","background-image":xui.UI.$bg("bar_vertical.gif","",true),"background-repeat":"repeat-x","background-position":"left -380px",width:"100%",left:0},ITEMC:{display:"block"},ITEMI:{display:"block"},"ITEM-mouseover":{$order:1,"background-position":"right -410px"},"ITEM-mousedown, ITEM-checked":{$order:2,"background-position":"right -440px"},HANDLE:{cursor:"pointer",display:"block","font-size":"12px",height:"100%",height:"18px",padding:"5px 8px","white-space":"nowrap"},PANEL:{position:"absolute",display:"none",overflow:"auto"},CMDS:{position:"absolute",top:"6px",right:"8px","text-align":"right","vertical-align":"middle"}},DataModel:{$border:1,noPanel:null,noHandler:null,selMode:null},_onresize:function(f,d,w,c,r){var y=f.properties,x=f.getItemByItemId(r),q=y.$border*2;if(!x){r=y.$UIvalue}var u,m,k,h,p,g=null,l=null,n=f.getSubNode("BOX"),e=f.boxing().getPanel(r);if(!e||e.isEmpty()){return}if(w){w-=q;k=m=0;_.arr.each(y.items,function(z){h=f.getSubNodeByItemId("ITEM",z.id);h.cssRegion({bottom:"auto",top:m});m+=h.height();if(z.id==r){return false}});_.arr.each(y.items,function(z){if(z.id==r){return false}h=f.getSubNodeByItemId("ITEM",z.id);h.cssRegion({top:"auto",bottom:k});k+=h.height()},null,true);u=w-m-k;if(u>0){p=m;l=u}n.height(w)}if(d){d-=q;g=d;n.width(d)}e.cssRegion({width:g?g:null,height:l?l:null,top:p,left:0},true);if(g){f.getSubNode("LIST").width(g)}},_adjustScroll:null}});Class("xui.UI.ButtonViews","xui.UI.Tabs",{Initialize:function(){var c=this.getTemplate(),d=this.$Keys;c.LIST.className="xui-uibg-bar xui-uiborder-outset";delete c.LIST.LEFT;delete c.LIST.RIGHT;delete c.LIST.DROP;this.setTemplate(c);delete d.LEFT;delete d.RIGHT;delete d.DROP},Static:{Appearances:{LIST:{"z-index":"2",position:"absolute"},ITEMS:{"z-index":"2",position:"absolute",left:0,top:0},"ITEMS-left, ITEMS-left ITEMC":{$order:1,"text-align":"left"},"ITEMS-center, ITEMS-center ITEMC":{$order:1,"text-align":"center"},"ITEMS-right, ITEMS-right ITEMC":{$order:1,"text-align":"right"},ITEM:{$order:0,margin:"2px",position:"relative","font-family":'"Verdana", "Helvetica", "sans-serif"',cursor:"pointer","padding-right":"4px","vertical-align":"top","background-image":xui.UI.$bg("button.gif","",true),"background-repeat":"no-repeat","background-position":"right -270px"},"ITEM-mouseover":{$order:1,"background-position":"right -360px"},"ITEM-mousedown, ITEM-checked":{$order:2,"background-position":"right -450px"},ITEMI:{$order:0,"padding-left":"4px","vertical-align":"top","background-image":xui.UI.$bg("button.gif","",true),"background-repeat":"no-repeat","background-position":"left -330px"},"ITEM-mouseover ITEMI":{$order:1,"background-position":"left -420px"},"ITEM-mousedown ITEMI, ITEM-checked ITEMI":{$order:2,"background-position":"left -510px"},ITEMC:{$order:0,"vertical-align":"top",height:"20px",padding:"2px 0","background-image":xui.UI.$bg("button.gif","",true),"background-repeat":"repeat-x","background-position":"left -300px"},"ITEMS-block ITEM, ITEMS-block ITEMI, ITEMS-block ITEMC":{$order:2,display:"block"},"ITEM-mouseover ITEMC":{$order:1,"background-position":"left -390px"},"ITEM-mousedown ITEMC, ITEM-checked ITEMC":{$order:2,"background-position":"left -480px"},HANDLE:{display:xui.$inlineBlock,zoom:xui.browser.ie6?1:null,cursor:"pointer","vertical-align":"middle","font-size":"12px",margin:"1px"}},DataModel:{HAlign:null,barLocation:{ini:"top",listbox:["top","bottom","left","right"],action:function(d){var c=this,e=c.getSubNode("LIST"),f=c.getSubNode("ITEMS");switch(d){case"left":e.cssRegion({left:0,top:0,right:"auto",bottom:0});break;case"top":e.cssRegion({left:0,top:0,right:0,bottom:"auto"});break;case"right":e.cssRegion({left:"auto",top:0,right:0,bottom:0});break;case"bottom":e.cssRegion({left:0,top:"auto",right:0,bottom:0});break}switch(d){case"left":case"right":f.tagClass("-block",true);break;case"top":case"bottom":f.tagClass("-block",false);e.height("auto");break}c.boxing().setBarSize(c.properties.barSize,true)}},barHAlign:{ini:"left",listbox:["left","center","right"],action:function(d){var c=this.getSubNode("ITEMS");c.tagClass("(-left|-right|-center)",false).tagClass("-"+d,true)}},barVAlign:{ini:"top",listbox:["top","bottom"],action:function(d){var c=this.getSubNode("ITEMS");if(d=="top"){c.cssRegion({top:0,bottom:"auto"})}else{c.cssRegion({bottom:0,top:"auto"})}}},barSize:{ini:50,action:function(e){var d=this,g=d.properties,h=g.noPanel,f=d.getSubNode("LIST"),c=d.getSubNode("ITEMS");if(g.barLocation=="left"||g.barLocation=="right"){if(!h){f.merge(c).width(e)}}else{if(!h){f.height(e)}}var g=d.getRootNode().style;xui.UI.$tryResize(d,g.width,g.height,true)}},noPanel:{ini:false,action:function(c){this.boxing().setBarSize(this.properties.barSize,true)}}},LayoutTrigger:function(){var c=this.properties;this.boxing().setBarLocation(c.barLocation,true).setBarHAlign(c.barHAlign,true).setBarVAlign(c.barVAlign,true)},_onresize:function(k,e,u,d,r){var x=k.properties,m=x.noPanel,w=k.getItemByItemId(r);if(!w){r=x.$UIvalue}var g=k.boxing().getPanel(r),p,h,q=k.getSubNode("LIST"),c=k.getSubNode("ITEMS"),l=null,n=null,f;if(!x.noHandler){if(x.barLocation=="top"||x.barLocation=="bottom"){if(e){q.width(e-2);c.width(e-2);if(m){q.height(u-2)}h=0;l=e}q.height(f=c.offsetHeight());if(u-f>0){n=u-f-2}p=x.barLocation=="top"?2- -f:0}else{if(u){if(m){q.width(e-2);c.width(e-2)}q.height(u-2);p=0;n=u}if(e){h=x.barLocation=="left"?2- -x.barSize:0;l=e-x.barSize-2}}}else{l=e;n=u}if(!m){if(g&&!g.isEmpty()){g.cssRegion({width:l?l:null,height:n?n:null,left:h,top:p},true)}}},_adjustScroll:null}});Class("xui.UI.RadioBox","xui.UI.List",{Initialize:function(){var c=this.getTemplate();c.className="{_className}";c.ITEMS.className="{_bordertype}";c.$submap={items:{ITEM:{className:"{_itemRow} {itemClass} {disabled} {readonly}",style:"{itemStyle}{_itemDisplay}",tabindex:"{_tabindex}",MARK:{$order:0,className:"{_markcls}"},ICON:{$order:1,className:"xui-ui-icon {imageClass}",style:"{backgroundImage} {backgroundPosition} {backgroundRepeat} {imageDisplay}"},CAPTION:{text:"{caption}",$order:2}}}};this.setTemplate(c)},Static:{_DIRTYKEY:"MARK",_ITEMMARKED:true,Appearances:{ITEM:{display:xui.$inlineBlock,"font-family":' "Verdana", "Helvetica", "sans-serif"',border:0,padding:"4px",position:"relative",zoom:xui.browser.ie?1:null,cursor:"pointer",overflow:"hidden","vertical-align":"middle","font-size":"12px"},CAPTION:{"vertical-align":xui.browser.ie6?"baseline":"middle"},ITEMS:{overflow:"auto","overflow-x":"hidden",position:"relative","line-height":"14px"},MARK:{$order:1,cursor:"pointer",width:"16px",height:"16px","vertical-align":"middle"},"ITEM-checked MARK":{$order:2}},DataModel:{tagCmds:null,borderType:{ini:"none"},checkBox:{ini:false,action:function(c){this.getSubNode("MARK",true).replaceClass(c?/(uicmd-radio)|(\s+uicmd-radio)/g:/(^uicmd-check)|(\s+uicmd-check)/g,c?" xui-uicmd-check":" xui-uicmd-radio")}}},Behaviors:{HoverEffected:{ITEM:null,MARK:"MARK"},ClickEffected:{ITEM:null,MARK:"MARK"}},EventHandlers:{onCmd:null},_prepareItem:function(c,d){d._markcls=c.properties.checkBox?"xui-uicmd-check":"xui-uicmd-radio";d._itemRow=c.properties.itemRow?"xui-item-row":""}}});Class("xui.UI.StatusButtons",["xui.UI.List"],{Initialize:function(){var c=this.getTemplate();c.className="{_className}";c.ITEMS.className="{_bordertype}";c.$submap={items:{ITEM:{className:"{itemClass} {_endsClass} {disabled} {readonly}",style:"{itemMargin};{itemWidth};{itemAlign};{itemStyle}",tabindex:"{_tabindex}",ICON:{$order:10,className:"xui-ui-icon {imageClass}",style:"{backgroundImage} {backgroundPosition} {backgroundRepeat} {imageDisplay}"},CAPTION:{$order:11,text:"{caption}"}}}};this.setTemplate(c)},Static:{Appearances:{ITEMS:{position:"relative",overflow:"auto","overflow-x":"hidden"},ITEM:{"vertical-align":"middle",position:"relative",height:"16px",padding:"3px",cursor:"pointer","font-size":0,"line-height":0,"white-space":"nowrap"},"ITEM-none":{"background-image":xui.UI.$bg("icons.gif","",true),"background-repeat":"no-repeat","background-position":"-12px -130px"},"ITEM-left":{"background-image":xui.UI.$bg("icons.gif","",true),"background-repeat":"no-repeat","background-position":"left -130px",padding:"4px 4px 2px 12px"},"ITEM-right":{"background-image":xui.UI.$bg("icons.gif","",true),"background-repeat":"no-repeat","background-position":"right -130px",padding:"4px 12px 2px 2px"},"ITEM-mouseover, ITEM-mousedown, ITEM-checked":{},"ITEM-mouseover":{},"ITEM-mousedown":{},"ITEM-checked":{},"ITEM-left-mouseover":{$order:1,"background-position":"left -153px"},"ITEM-left-mousedown":{$order:2,"background-position":"left -176px"},"ITEM-left-checked":{$order:3,"background-position":"left -176px"},"ITEM-none-mouseover":{$order:1,"background-position":"-20px -153px"},"ITEM-none-mousedown":{$order:2,"background-position":"-20px -176px"},"ITEM-none-checked":{$order:3,"background-position":"-20px -176px"},"ITEM-right-mouseover":{$order:1,"background-position":"right -153px"},"ITEM-right-mousedown":{$order:2,"background-position":"right -176px"},"ITEM-right-checked":{$order:3,"background-position":"right -176px"},CAPTION:{display:xui.$inlineBlock,zoom:xui.browser.ie6?1:null,"vertical-align":"middle","font-size":"12px","line-height":"14px"},"ITEM-none CAPTION":{padding:"1px 4px"}},DataModel:({maxHeight:null,tagCmds:null,itemMargin:{ini:"",action:function(c){this.getSubNode("ITEM",true).css("margin",c)}},itemWidth:{ini:0,action:function(c){this.getSubNode("ITEM",true).width(c||"auto")}},itemAlign:{ini:"",listbox:["","left","center","right"],action:function(c){this.getSubNode("ITEM",true).css("text-align",c)}},itemLinker:{ini:"left",listbox:["none","left","right"],action:function(c){this.getSubNode("ITEM",true).tagClass("-none",false).tagClass("-left",false).tagClass("-right",false).tagClass("-"+c,true).removeClass(/^xui-uiborder-[lr]/).addClass(c=="left"?"xui-uiborder-r":c=="right"?"xui-uiborder-l":"xui-uiborder-l xui-uiborder-r")}}}),Behaviors:{DroppableKeys:["ITEMS"]},EventHandlers:{onCmd:null},_prepareItem:function(d,e){var f=d.properties,c;e._tabindex=f.tabindex;if(c=e.itemMargin||f.itemMargin){e.itemMargin="margin:"+c}if(c=e.itemWidth||f.itemWidth){e.itemWidth="width:"+(c=="auto"?c:(c+"px"))}if(c=e.itemAlign||f.itemAlign){e.itemAlign="text-align:"+c}if(c=e.itemLinker||f.itemLinker){e._endsClass=d.getClass("ITEM","-"+c)+" "+(c=="left"?"xui-uiborder-r":c=="right"?"xui-uiborder-l":"xui-uiborder-l xui-uiborder-r")}}}});Class("xui.UI.TreeBar",["xui.UI","xui.absList","xui.absValue"],{$Start:function(c){if(c=this.Static.RenderTrigger){c.$order=-1}},Instance:{_setCtrlValue:function(d,c){return this.each(function(f){if(!f.renderId){return}var m=f.boxing(),w=m.getUIValue(),p=f.properties,q=function(A,B,z){f.getSubNodeByItemId(A,B).tagClass("-checked",z)},k=p.selMode;if(k=="single"){var u=f.getSubIdByItemId(w);if(w&&u){f.getSubNode("BAR",u).tagClass("-checked",false)}u=f.getSubIdByItemId(d);if(u){f.getSubNode("BAR",u).tagClass("-checked");if(!f._noScroll){var e=f.getSubNode("ITEM",u);if(e){var n=f.getSubNode("BOX"),h=e.offset(null,n),r=h?h.top:0,x=e.offsetHeight(),l=n.scrollHeight(),y=n.scrollTop(),g=n.height();if(l>g){if(r<y||(r+x)>(y+g)){n.scrollTop(r)}}}}}}else{if(k=="multi"||k=="multibycheckbox"){w=w?w.split(p.valueSeparator):[];d=d?d.split(p.valueSeparator):[];if(c){_.arr.each(d,function(z){q("BAR",z)})}else{_.arr.each(w,function(z){q("BAR",z,false)});_.arr.each(d,function(z){q("BAR",z)})}}}})},insertItems:function(e,f,l,k,d){var g,h,c=this._afterInsertItems;return this.each(function(q){var m,u,n;h=q.box._adjustItems(e);if(!f){n=q.properties;m=n.items||(n.items=[])}else{n=q.getItemByItemId(f);m=_.isArr(n.sub)?n.sub:(n.sub=[])}if(q.renderId){if(!l){if(!f){g=q.getSubNode("ITEMS")}else{if(f&&n._inited){g=q.getSubNodeByItemId("SUB",f)}}if(g){u=q._buildItems("items",q.box._prepareItems(q,h,f));if(k){g.prepend(u)}else{g.append(u)}}}else{g=q.getSubNodeByItemId("ITEM",l);if(g){u=q._buildItems("items",q.box._prepareItems(q,h,f));if(k){g.addPrev(u)}else{g.addNext(u)}}}}if(!l){_.arr.insertAny(m,h,k?0:-1)}else{var p=_.arr.subIndexOf(m,"id",l);_.arr.insertAny(m,h,k?p:(p+1))}if(q.renderId&&d!==false){if(!f){q.boxing()._toggleNodes(h,true,true,true)}else{if(q.getItemByItemId(f)._inited){if(!(("iniFold" in n)?n.iniFold:q.properties.iniFold)){q.boxing()._toggleNodes(h,true,true,true)}}}}if(c&&q.renderId){q.boxing()._afterInsertItems(q,h,f,l,k)}if(q.renderId&&f){q.box._tofold(q,n,f)}})},_toggleNodes:function(d,g,e,m){var c=this,k=c.get(0),l=k.properties,h=function(f,p,n,q){if(_.isArr(f)){_.arr.each(f,function(r){if(q&&(_.isBool(r.iniFold)?r.iniFold:l.iniFold)){return}c.toggleNode(r.id,p,false,n);if(n&&r.sub&&_.isArr(r.sub)&&r.sub.length){h(r.sub,p,true,q)}})}};h(d,g,e,m);return c},toggleNode:function(l,g,d,h){var f=this.get(0),e=this,c=arguments.callee;if(l){var k=f.getItemByItemId(l);if(k&&k.sub){f.box._setSub(f,k,typeof g=="boolean"?g:!k._checked,d,h||d)}}else{_.arr.each(f.properties.items,function(m){c.call(e,m.id,g,d)})}return this},openToNode:function(d,c){return this.each(function(h){var g=false,f=[],e=function(k,m,l){l=l||0;var n=arguments.callee;_.arr.each(k,function(p){if(p.id==m){f.push(p);g=true;return false}if(p.sub&&_.isArr(p.sub)){g=n.call(n,p.sub,m,++l);if(g){f.push(p);return false}}});return g};e(h.properties.items,d);if(g){f.reverse();_.arr.each(f,function(l,k){if(l.sub){h.boxing().toggleNode(l.id,true);if(c!==false&&k==f.length-1&&!(l.hasOwnProperty("group")?l.group:h.properties.group)){h.boxing().fireItemClickEvent(l.id)}}else{if(c!==false){h.boxing().fireItemClickEvent(l.id)}}})}})}},Static:{_focusNodeKey:"BAR",Templates:{tagName:"div",style:"{_style}",className:"{_className}",ondrag:"return false",onselectstart:"return false",BORDER:{tagName:"div",className:"xui-uibg-content",BOX:{tagName:"div",onselectstart:"return false",ITEMS:{tagName:"div",text:"{items}"}}},$submap:{items:{ITEM:{className:"",style:"{_itemDisplay}",tagName:"div",BAR:{$order:0,tabindex:"{_tabindex}",className:"xui-uibarbg  xui-uiborder-tb {itemClass} {cls_group} {cls_fold} {disabled} {readonly}",style:"{itemStyle}",RULER:{$order:2,style:"{rulerStyle}",text:"{innerIcons}"},TOGGLE:{$order:4,className:"{togglemark}"},LTAGCMDS:{$order:3,tagName:"span",text:"{ltagCmds}"},MARK:{$order:5,style:"{mark2Display}"},ITEMICON:{$order:6,className:"xui-ui-icon {imageClass}",style:"{backgroundImage} {backgroundPosition} {backgroundRepeat} {imageDisplay}"},ITEMCAPTION:{text:"{caption}",className:"{disabled}  {readonly}",$order:7},EXTRA:{text:"{ext}",$order:8},OPT:{$order:9},RTAGCMDS:{$order:10,tagName:"span",text:"{rtagCmds}"}},SUB:{$order:1,tagName:"div",text:xui.UI.$childTag}}},"items.ltagCmds":function(g,f,e,d,c){var h=arguments.callee,k=h._m||(h._m={text:".text",button:".button",image:".image"});xui.UI.$doTemplate(g,f,e,"items.tagCmds"+(k[e.type]||".button"),c)},"items.rtagCmds":function(g,f,e,d,c){var h=arguments.callee,k=h._m||(h._m={text:".text",button:".button",image:".image"});xui.UI.$doTemplate(g,f,e,"items.tagCmds"+(k[e.type]||".button"),c)},"items.tagCmds.text":{CMD:{tagName:"a",title:"{tips}",href:xui.$DEFAULTHREF,style:"{_style}{itemStyle}",className:"{itemClass}",tabindex:"{_tabindex}",text:"{caption}"}},"items.tagCmds.button":{CMD:{_NativeElement:true,tagName:"button",title:"{tips}",style:"{_style}{itemStyle}",className:"xui-uiborder-outset xui-list-cmd {itemClass}",tabindex:"{_tabindex}",text:"{caption}"}},"items.tagCmds.image":{CMD:{tagName:"image",title:"{tips}",src:"{image}",border:"0",style:"{_style}{itemStyle}",className:"{cmdClas}",tabindex:"{_tabindex}",alt:"{caption}"}}}},Appearances:{KEY:{"font-family":"Verdana, Helvetica, sans-serif",border:0},EXTRA:{display:"none"},BOX:{left:0,overflow:"auto","overflow-x":"hidden",position:"relative",clear:"both"},ITEMS:{overflow:"hidden"},ITEM:{"white-space":"nowrap",position:"relative",overflow:"hidden"},BAR:{cursor:"pointer",zoom:xui.browser.ie?1:null,position:"relative",display:"block",overflow:"hidden","font-size":"12px",padding:"1px 4px","outline-offset":"-1px","-moz-outline-offset":(xui.browser.gek&&xui.browser.ver<3)?"-1px !important":null},"BAR-GROUP":{$order:2,"border-top":"none","border-bottom":"none",padding:"5px 4px",height:"18px","background-image":xui.UI.$bg("bar_vertical.gif","",true),"background-repeat":"repeat-x","background-position":"left -380px"},"BAR-GROUP-mouseover":{$order:3,"background-position":"left -410px"},"BAR-GROUP-expand":{$order:4,"background-position":"left -440px"},SUB:{overflow:"hidden",zoom:xui.browser.ie?1:null,height:0,"font-size":"1px","line-height":"1px",position:"relative","margin-left":"22px"},MARK:{cursor:"pointer",width:"16px",height:"16px","vertical-align":"middle","background-image":xui.UI.$bg("icons.gif","",true),"background-repeat":"no-repeat","background-position":"-20px -70px"},"BAR-checked MARK":{$order:3,"background-position":"0 -70px"},ITEMCAPTION:{"vertical-align":xui.browser.ie6?"baseline":"middle",padding:"2px"},OPT:{$order:10,position:"absolute",left:"auto",top:"auto",right:"2px",top:"2px",width:"16px",height:"16px",display:"none","background-image":xui.UI.$bg("icons.gif","",true),"background-repeat":"no-repeat","background-position":"-130px -224px"},"OPT-mouseover":{$order:20,"background-position":"-130px -244px"},"OPT-mousedown":{$order:30,"background-position":"-130px -264px"},LTAGCMDS:{"padding-left":"4px","padding-right":"4px","vertical-align":"middle"},RTAGCMDS:{"padding-left":"4px","vertical-align":"middle"},"BOX-tagcmdleft TAGCMDS":{"padding-right":"4px","float":"left"},CMD:{"margin-left":"2px",padding:"0 2px","vertical-align":"middle",cursor:"pointer"}},Behaviors:{HoverEffected:{TOGGLE:"TOGGLE",BAR:"BAR",OPT:"OPT",CMD:"CMD"},ClickEffected:{TOGGLE:"TOGGLE",BAR:"BAR",OPT:"OPT",CMD:"CMD"},DraggableKeys:["BAR"],NoDraggableKeys:["TOGGLE"],DroppableKeys:["BAR","TOGGLE","BOX"],onSize:xui.UI.$onSize,TOGGLE:{onClick:function(d,h,k){var c=d.properties,g=xui.use(k).id(),f=d.getItemByDom(g);if(c.disabled||f.disabled){return false}if(!("sub" in f)){return false}d.box._setSub(d,f,!f._checked);return false}},BAR:{onDblclick:function(d,h,k){var c=d.properties,g=d.getItemByDom(k),f=d.onDblclick&&d.boxing().onDblclick(d,g,h,k);if(g.sub&&f!==false){d.getSubNode("TOGGLE",d.getSubId(k)).onClick()}},onClick:function(c,d,f){return c.box._onclickbar(c,d,f)},onKeydown:function(c,d,f){return c.box._onkeydownbar(c,d,f)},onContextmenu:function(c,d,f){if(c.onContextmenu){return c.boxing().onContextmenu(c,d,f,c.getItemByDom(f))!==false}},onMouseover:function(c,f,g){var d=c.getItemByDom(g);if(!c.properties.optBtn&&!d.optBtn){return}c.getSubNode("OPT",c.getSubId(g)).setInlineBlock()},onMouseout:function(c,f,g){var d=c.getItemByDom(g);if(!c.properties.optBtn&&!d.optBtn){return}c.getSubNode("OPT",c.getSubId(g)).css("display","none")}},OPT:{onClick:function(c,f,g){if(c.onShowOptions){var d=c.getItemByDom(g);if(!c.properties.optBtn&&!d.optBtn){return}c.boxing().onShowOptions(c,d,f,g)}return false},onDblclick:function(c,d,f){return false}},CMD:{onClick:function(c,f,g){var h=c.properties,d=c.getItemByDom(xui.use(g).parent().get(0));if(!d){return false}if(h.disabled||d.disabled){return false}if(c.onCmd){c.boxing().onCmd(c,d,xui.use(g).id().split("_")[1],f,g)}return false}},BOX:{onScroll:function(c,d,f){if((d=xui.use(f)).scrollLeft()!==0){d.scrollLeft(0)}}}},EventHandlers:{onDblclick:function(c,d,f,g){},onGetContent:function(c,d,e){},onShowOptions:function(c,d,f,g){},onClick:function(c,d,f,g){},onCmd:function(c,d,g,f,h){},beforeClick:function(c,d,f,g){},afterClick:function(c,d,f,g){},onItemSelected:function(d,f,g,h,c){},beforeFold:function(c,d){},beforeExpand:function(c,d){},afterFold:function(c,d){},afterExpand:function(c,d){}},DataModel:{listKey:null,width:200,height:200,iniFold:true,animCollapse:true,dock:"fill",group:{ini:false,action:function(h){var g=this,f=g.properties.items,k=g.queryItems(f,function(l){return l.sub&&l.group===undefined}),e=xui();_.arr.each(k,function(l){e.merge(g.getSubNodeByItemId("BAR",l.id))});var d=g.getClass("BAR"),c=g.getClass("BAR","-group");if(h){e.replaceClass(new RegExp("(\\b)"+d+"([^b]*\\b)","g"),"$1"+c+"$2")}else{e.replaceClass(new RegExp("(\\b)"+c+"([^b]*\\b)","g"),"$1"+d+"$2")}}},selMode:{ini:"single",listbox:["single","none","multi","multibycheckbox"],action:function(e){var d=this,f=this.properties,c=[];_.each(this.SubSerialIdMapItem,function(g){if(!(g.sub&&(g.hasOwnProperty("group")?g.group:f.group))){c.push(d.getSubNodeByItemId("MARK",g.id).get(0))}});xui(c).css("display",(e=="multi"||e=="multibycheckbox")?"":"none")}},noCtrlKey:true,singleOpen:false,dynDestory:false,position:"absolute",optBtn:false,togglePlaceholder:false,tagCmds:{ini:[],action:function(){this.boxing().refresh()}},tagCmdsAlign:{ini:"right",listbox:["left","right"],action:function(c){var d=this;if(c=="left"){d.getSubNode("BOX").addClass(d.getClass("BOX","-tagcmdleft"))}else{d.getSubNode("BOX").removeClass(d.getClass("BOX","-tagcmdleft"))}}}},RenderTrigger:function(){this.boxing()._toggleNodes(this.properties.items,true,true,true)},_onclickbar:function(f,x,k){var l=f.properties,g=xui.use(k).id(),y=f.getItemByDom(g),n=f.getSubId(g),m=f.boxing(),A=xui.Event.getKey(x),z=f.getKey(xui.Event.getSrc(x).id||""),d=z==f.keys.TOGGLE||z==f.keys.MARK;if(!d&&f.beforeClick&&false===m.beforeClick(f,y,x,k)){return false}if(l.disabled||y.disabled){return false}if(!d&&f.onClick){m.onClick(f,y,x,k)}if(y.sub&&(y.hasOwnProperty("group")?y.group:l.group)){f.getSubNode("TOGGLE",n).onClick();return}f.getSubNode(f.box._focusNodeKey,n).focus();switch(l.selMode){case"none":m.onItemSelected(f,y,x,k,0);break;case"multibycheckbox":if(l.readonly||y.readonly){return false}if(f.keys.MARK){if(z!=f.keys.MARK){m.onItemSelected(f,y,x,k,0);break}}case"multi":if(l.readonly||y.readonly){return false}var r=m.getUIValue(),c=r?r.split(l.valueSeparator):[],h=1;if(c.length&&(A.ctrlKey||A.shiftKey||l.noCtrlKey)){if(A.shiftKey){if(f.$firstV._pid!=y._pid){return}var p=l.items;if(y._pid){var B=f.getItemByItemId(y._pid);if(B){p=B.sub}}var u=_.arr.subIndexOf(p,"id",f.$firstV.id),q=_.arr.subIndexOf(p,"id",y.id),w;c.length=0;for(w=Math.min(u,q);w<=Math.max(u,q);w++){c.push(p[w].id)}}else{if(_.arr.indexOf(c,y.id)!=-1){_.arr.removeValue(c,y.id);h=-1}else{c.push(y.id)}}c.sort();r=c.join(l.valueSeparator);if(m.getUIValue()!=r){f._noScroll=1;m.setUIValue(r,null,null,"click");delete f._noScroll;if(m.get(0)&&m.getUIValue()==r){m.onItemSelected(f,y,x,k,h)}}break}case"single":if(m.getUIValue()!=y.id){f.$firstV=y;f._noScroll=1;m.setUIValue(y.id,null,null,"click");delete f._noScroll;if(m.get(0)&&m.getUIValue()==y.id){m.onItemSelected(f,y,x,k,1)}}break}if(!d&&f.afterClick){m.afterClick(f,y,x,k)}return !d},_onkeydownbar:function(g,k,c){var q=xui.Event.getKey(k),p=q.key,f=q.shiftKey,d=q.ctrlKey,n=g.getSubNode(g.box._focusNodeKey,g.getSubId(c)),l=g.getRoot(),h=l.nextFocus(true,true,false),m=l.nextFocus(false,true,false);switch(p){case"enter":n.onClick();break;case"tab":if(f){if(n.get(0)!=h.get(0)){h.focus();return false}}else{if(n.get(0)!=m.get(0)){m.focus();return false}}break;case"up":if(d){g.getSubNode("TOGGLE",g.getSubId(c)).onClick();return false}if(n.get(0)==h.get(0)){m.focus()}else{n.nextFocus(false,true,false).focus()}return false;break;case"down":if(d){g.getSubNode("TOGGLE",g.getSubId(c)).onClick();return false}if(n.get(0)==m.get(0)){h.focus()}else{n.nextFocus(true,false,false).focus()}return false;break;case"right":case"left":g.getSubNode("TOGGLE",g.getSubId(c)).onClick();return false}},_onStartDrag:function(c,d,f,g){var g=xui.Event.getPos(d);xui.use(f).startDrag(d,{dragType:"icon",shadowFrom:f,targetLeft:g.left+12,targetTop:g.top+12,dragCursor:"pointer",dragDefer:2,dragKey:c.box.getDragKey(c,f),dragData:c.box.getDragData(c,d,f)});return false},_onDropTest:function(f,n,c,q,l,r){var h=l&&l.domId;if(h){var k=xui.use(c).id();if(h==k){return false}if(_.get(xui.use(c).get(0),["parentNode","previousSibling","firstChild","id"])==h){return false}var g=f.getItemByDom(h);if(r&&g._pid==r.id){return false}var d=xui.use(c).get(0),m=f.getRootNode();while((d=d.parentNode)){if(f.getSubId(d.id)==f.getSubId(h)){return false}if(d.id==_.get(m,["parentNode","id"])){break}}}},_onDrop:function(g,p,d,u,m,x){xui.DragDrop.setDragIcon("none");var l=g.getKey(xui.use(d).id()),f=m.profile,c=m.domId,h,r=g.keys,w=xui.absObj.$specialChars,q=g.boxing(),n=_.copy(q.getUIValue(true));h=_.clone(f.getItemByDom(c),function(k,e){return !w[(e+"").charAt(0)]});f.boxing().removeItems([h.id]);if(l==r.BOX){q.insertItems([h],null,null,false)}else{if(l==r.BAR){q.insertItems([h],x._pid,x.id,true)}else{if(l==r.TOGGLE){q.insertItems([h],x.id,null,false)}}}if(n&&n.length){if(_.arr.indexOf(n,h.id)!=-1){g._noScroll=1;q.setUIValue(n,true,null,"drop");delete g._noScroll}}return false},_prepareItem:function(e,n,f,g,l,m){var c=e.properties,k=e.ItemIdMapSubSerialId,h=e.SubSerialIdMapItem,d;if(g){f._pid=g}n.togglemark=n.sub?("xui-uicmd-toggle"+(n._checked?" xui-uicmd-toggle-checked":"")):(c.togglePlaceholder?"xui-uicmd-empty":"xui-uicmd-none");n.disabled=n.disabled?"xui-ui-disabled":"";n._itemDisplay=n.hidden?"display:none;":"";n.mark2Display=("showMark" in n)?(n.showMark?"":"display:none;"):(c.selMode=="multi"||c.selMode=="multibycheckbox")?"":"display:none;";n._tabindex=c.tabindex;if(n.sub&&(n.hasOwnProperty("group")?n.group:c.group)){n.cls_group=e.getClass("BAR","-group");n.mark2Display="display:none"}xui.UI.List._prepareCmds(e,n)},_setSub:function(f,z,w,y,l){var q=f.domId,d=f.boxing(),m=f.getSubIdByItemId(z.id),h=f.properties,x=f.getSubNode("BAR",m),e=f.getSubNode("TOGGLE",m),u=f.getSubNode("SUB",m);if(xui.Thread.isAlive(f.key+f.id)){return}if(!w){if(z._checked){if(d.beforeFold&&false===d.beforeFold(f,z)){return}var c=function(){u.css({display:"none",height:0});e.tagClass("-checked",false);x.tagClass("-expand",false).tagClass("-fold");z._checked=false;if(h.dynDestory||z.dynDestory){var D=z.sub,r=[];for(var C=0,B=D.length;C<B;C++){r.push(D[C].id)}f.boxing().removeItems(r);z.sub=true;delete z._inited}if(d.afterFold){d.afterFold(f,z)}};if(!l){if(h.animCollapse){u.animate({height:[u.height(),0]},null,c,200,null,"expoOut",f.key+f.id).start()}else{c()}}else{c()}}if(y&&z.sub&&!h.dynDestory&&!z.dynDestory){_.arr.each(z.sub,function(r){if(r.sub&&r.sub.length){f.box._setSub(f,r,w,y,true)}})}}else{if(!z._checked){if(d.beforeExpand&&false===d.beforeExpand(f,z)){return}var c=function(r){u.css({display:"",height:"auto"});if(xui.browser.ie&&xui.browser.ver<=8){e.css({backgroundImage:"",backgroundRepeat:"",backgroundPositionX:"",backgroundPositionY:"",backgroundColor:"",backgroundAttachment:""})}else{e.css("background","")}if(r){}else{e.tagClass("-checked");x.tagClass("-fold",false).tagClass("-expand");z._checked=true;if(d.afterExpand){d.afterExpand(f,z)}}},A=function(D,M,C,F,K,J,r,E){var L=D.boxing(),B=D.properties,I=r===false;if(!I&&!M._inited){delete M.sub;M._inited=true;if(r){if(typeof r=="string"){K.html(M.sub=r,false)}else{if(_.isArr(r)){L.insertItems(r,M.id,null,false,false);if(!M.sub){M.sub=r}}else{if(r["xui.Template"]||r["xui.UI"]){K.append(M.sub=r.render(true))}}}var N=0,H=L.getUIValue(true);if(H&&H.length){_.arr.each(r,function(O){if(_.arr.indexOf(H,O.id||O)!=-1){N=1;return false}});if(N){D._noScroll=1;L._setCtrlValue(L.getUIValue());delete D._noScroll}}}}if(B.singleOpen){L._toggleNodes(M._pid?D.getItemByItemId(M._pid).sub:B.items,false)}if(!l){K.css("height","0px").css("display","");if(B.animCollapse){var G=0;K.children().each(function(O){G+=O.offsetHeight});K.animate({height:[0,G]},null,function(){c(I)},200,null,"expoIn",D.key+D.id).start()}else{c(I)}}else{c(I)}},k=z.sub,g=function(r){A(f,z,q,e,u,x,r,y)},n;if((n=typeof k)=="string"||n=="object"){g(k)}else{if(f.onGetContent){e.css("background","url("+xui.ini.img_busy+") no-repeat");var p=f.boxing().onGetContent(f,z,g);if(p||p===false){if(p===true){z._inited=true}g(p)}}}}if(y&&z.sub){_.arr.each(z.sub,function(r){if(r.sub&&r.sub.length&&!r._checked){f.box._setSub(f,r,w,y,true)}})}}},_tofold:function(d,e,c){d.getSubNodeByItemId("BAR",c).addClass(d.getClass("BAR","-fold"));d.getSubNodeByItemId("TOGGLE",c).replaceClass(new RegExp("\\buicmd-(none|empty)\\b"),"xui-uicmd-toggle")},_onresize:function(e,d,c){e.getSubNode("BORDER").cssSize({width:d?d:null,height:c?c:null});e.getSubNode("BOX").cssSize({width:d?d:null,height:c?c:null})}}});Class("xui.UI.TreeView","xui.UI.TreeBar",{Instance:{_afterInsertItems:function(d,e,c){d.box._reorderItems(d,c)},_afterRemoveItems:function(c,d){_.arr.each(d,function(e){c.box._reorderItems(c,e._pid)})}},Initialize:function(){this.addTemplateKeys(["IMAGE"]);var c=this.getTemplate();c.$submap.items.ITEM.BAR.className="xui-uitembg {cls_group} {cls_fold} {disabled} {readonly}";this.setTemplate(c)},Static:{Appearances:{ITEMS:{padding:"1px"},ITEM:{"white-space":"nowrap",position:"relative",overflow:"hidden"},BAR:{zoom:xui.browser.ie?1:null,position:"relative",display:"block","font-size":"12px","outline-offset":"-1px","-moz-outline-offset":(xui.browser.gek&&xui.browser.ver<3)?"-1px !important":null},"BAR-mouseover, BAR-mousedown, BAR-checked":{"background-image":xui.UI.$bg("item.gif","","List"),"background-repeat":"repeat-x"},"BAR-mouseover":{$order:1,"background-position":"left -51px"},"BAR-mousedown":{$order:2,"background-position":"left -101px"},"BAR-checked":{$order:2,"background-position":"left top"},SUB:{zoom:xui.browser.ie?1:null,height:0,"font-size":"1px","line-height":"1px",position:"relative",overflow:"hidden"},BOX:{left:0,overflow:"auto",position:"relative"},"BAR ITEMICON":{"background-image":xui.UI.$bg("icons.gif","",true),"background-repeat":"no-repeat","background-position":"-244px -236px"},"BAR-fold ITEMICON":{$order:1,"background-position":"-260px -236px"},"BAR-expand ITEMICON":{$order:1,"background-position":"-276px -236px"},"IMAGE-vertical, IMAGE-path-1, IMAGE-path-2, IMAGE-path-3, IMAGE-fold-1, IMAGE-fold-2, IMAGE-fold-3":{$order:1,"background-image":xui.UI.$bg("icons.gif","",true),"background-repeat":"no-repeat","background-position":"0 0",width:"16px",height:"18px","vertical-align":"middle"},"IMAGE-none":{width:"16px",height:"18px","vertical-align":"middle"},"IMAGE-path-1,IMAGE-path-2":{$order:2,"background-position":"-196px -236px"},"IMAGE-path-3":{$order:3,"background-position":"-212px -236px"},"IMAGE-fold-1":{$order:4,"background-position":"-196px -254px"},"IMAGE-fold-2":{$order:5,"background-position":"-212px -254px"},"IMAGE-fold-3":{$order:6,"background-position":"-228px -254px"},"IMAGE-fold-1-checked":{$order:7,"background-position":"-244px -254px"},"IMAGE-fold-2-checked":{$order:8,"background-position":"-260px -254px"},"IMAGE-fold-3-checked":{$order:9,"background-position":"-276px -254px"},"IMAGE-fold-1-mousedown":{$order:10,"background-position":"-196px -272px"},"IMAGE-fold-2-mousedown":{$order:11,"background-position":"-212px -272px"},"IMAGE-fold-3-mousedown":{$order:12,"background-position":"-228px -272px"},"IMAGE-fold-1-checked-mousedown":{$order:13,"background-position":"-244px -272px"},"IMAGE-fold-2-checked-mousedown":{$order:14,"background-position":"-260px -272px"},"IMAGE-fold-3-checked-mousedown":{$order:15,"background-position":"-276px -272px"},"IMAGE-vertical":{$order:16,"background-position":"-228px -236px"}},Behaviors:{MARK:{onClick:function(c,d,f){c.box._onclickbar(c,d,xui.use(f).parent().xid());return false}},ITEMICON:{onClick:function(c,d,f){c.box._onclickbar(c,d,xui.use(f).parent().xid());return false}}},DataModel:{$subMargin:22,group:null,noIcon:{ini:false,action:function(c){this.getSubNode("ITEMICON",true).css("display",c?"none":"")}}},_buildIcon:function(c,d){return"<span class='"+c+d+"'></span>"},_getType:function(e,d,c,g){var f=e?d=="last"?"-fold-3":d=="first"?"-fold-1":"-fold-2":d=="last"?"-path-3":d=="first"?"-path-1":"-path-2";return g?(c+f+" "+c+f+"-checked xui-treebar-toggle-checked"):(c+f)},_prepareItem:function(e,y,f,k,n,q){var c=e.properties,m=e.ItemIdMapSubSerialId,l=e.SubSerialIdMapItem,d,h,u,g,x=e.getClass("IMAGE"),w=this._buildIcon,r=this._getType;if(k){f._pid=k;if(d=l[m[k]]){f._deep=d._deep+1;h=_.copy(d._icons);h.push(n==q-1?"last":n===0?"first":"middle");f._icons=h;y.rulerStyle="width:"+(f._deep*c.$subMargin)+"px;";g="";u=h.length-1;_.arr.each(h,function(z,p){if(p!==u){g+=w(x,z=="last"?(c.togglePlaceholder?"-empty":"-none"):"-vertical")}});y.innerIcons=g;y.togglemark=y.sub?(r(y.sub,h[u],x,y._checked)):(c.togglePlaceholder?"xui-uicmd-empty":"xui-uicmd-none")}}else{f._deep=0;f._icons=[n==q-1?"last":n===0?"first":"middle"];y.rulerStyle="";y.innerIcons="";y.togglemark=y.sub?(r(y.sub,f._icons[0],x,y._checked)):(c.togglePlaceholder?"xui-uicmd-empty":"xui-uicmd-none")}y.imageDisplay=(y.noIcon||c.noIcon)?"display:none;":"";y.cls_fold=y.sub?e.getClass("BAR","-fold"):"";y.disabled=y.disabled?"xui-ui-disabled":"";y._itemDisplay=y.hidden?"display:none;":"";y.mark2Display=("showMark" in y)?(y.showMark?"":"display:none;"):(c.selMode=="multi"||c.selMode=="multibycheckbox")?"":"display:none;";y._tabindex=c.tabindex;xui.UI.List._prepareCmds(e,y)},_reorderItems:function(e,g){var c=e.properties,m=e.ItemIdMapSubSerialId,k=e.SubSerialIdMapItem,y=e.getClass("IMAGE"),q=this._getType;var x=function(A,p){if(A.sub&&A.sub.length){var z=arguments.callee;_.arr.each(A.sub,function(B){if(B._icons){p.push(B)}z(B,p)})}};if(g&&!m[g]){return}var u=e.box.KEY+"-RULER:"+e.serialId+":",f=g?k[m[g]].sub:c.items,l=f.length,d,n,w=0,h,r;_.arr.each(f,function(A,z){if(A._icons){d=A._icons[A._icons.length-1];n=z==l-1?"last":z===0?"first":"middle";if(d!=n){r=[];h=null;A._icons[w=A._icons.length-1]=n;h=A;var p=[];x(A,p);_.arr.each(p,function(B){B._icons[w]=n;r.push(B.id)});if(h){e.getSubNodeByItemId("TOGGLE",h.id).replaceClass(new RegExp("\\b"+y+"-[\\w]+-[\\w]+((-[\\w]+)*)\\b","g"),q(h.sub,n,y)+"$1")}if(r.length){_.arr.each(r,function(C,B){r[B]=u+m[C]});r=xui(r).first();if(w){r=r.next(w)}r.removeClass(new RegExp("\\b"+y+"[-\\w]+\\b")).addClass(y+(n=="last"?(c.togglePlaceholder?"-empty":"-none"):"-vertical"))}}}})},_tofold:function(e,f,d){var c=e.getClass("IMAGE");e.getSubNodeByItemId("BAR",d).addClass(e.getClass("BAR","-fold"));e.getSubNodeByItemId("TOGGLE",d).replaceClass(new RegExp("\\b"+c+"-path([-\\w]+)\\b"),c+"-fold$1")}}});Class("xui.UI.PopMenu",["xui.UI.Widget","xui.absList"],{Instance:{adjustSize:function(){this.each(function(c){if(c.renderId){var n=c.getRoot();if(n.css("display")=="none"){c._needadjust=1;return}var f=c.getSubNode("BORDER"),l=c.getSubNode("BOX"),m=c.getSubNode("ITEMS"),e=c.getSubNode("ITEM",true),q=c.properties,g=0,d=0;m.cssSize({width:"auto",height:"auto"});d=m.height();if(d%2==1){d+=1}m.addClass(c.getClass("ITEMS","-inline"));e.each(function(h){g=Math.max(g,h.offsetWidth)});if(g%2==1){g+=1}m.removeClass(c.getClass("ITEMS","-inline"));m.cssSize({width:g,height:d});var k=Math.min(q._maxHeight,d),p=Math.min(q._maxWidth,g),r={width:p,height:k};q.width=p;q.height=k;n.cssSize(r);l.cssSize(r);f.cssSize(r)}});return this._setScroll()},_setScroll:function(){return this.each(function(g){if(g.renderId){var k=g.getSubNode("ITEMS"),e=k.offsetTop(),f=k.offsetHeight(),c=g.getRoot(),d=c.offsetHeight();g.getSubNode("TOP").css("display",e===0?"none":"block");g.getSubNode("BOTTOM").css("display",(d>=f+e)?"none":"block")}})},_scrollToBottom:function(){return this.each(function(g){var l=g.getSubNode("ITEMS"),e=g.getSubNode("BORDER"),m=l.offsetTop(),k,f=l.offsetHeight(),c=false,d=e.height();if(d<f+m){if(!g.$scrollStep){g.$scrollStep=1}if(g.$scrollStep<5){g.$scrollStep=g.$scrollStep*1.01}m-=g.$scrollStep;if(d>f+m){m=d-f;c=true}l.top(m);if(c){g.getSubNode("BOTTOM").css("display","none");g.$scrollTobottom=false;g.$scrollStep=null}else{g.getSubNode("TOP").css("display","block");if(g.$scrollTobottom){_.asyRun(arguments.callee,0,[g],this)}}}})},_scrollToTop:function(){return this.each(function(d){var e=d.getSubNode("ITEMS"),f=e.offsetTop(),c=false;if(f<0){if(!d.$scrollStep){d.$scrollStep=1}if(d.$scrollStep<5){d.$scrollStep=d.$scrollStep*1.01}f+=d.$scrollStep;if(f>=-1){f=0;c=true}e.top(f);if(c){d.getSubNode("TOP").css("display","none");d.$scrollToTop=false;d.$scrollStep=null}else{d.getSubNode("BOTTOM").css("display","block");if(d.$scrollToTop){_.asyRun(arguments.callee,0,[d],this)}}}})},pop:function(l,n,u,k){var h=this.get(0),d=h.properties,c="$subPopMenuShowed",e="$highLight",r="$childPopMenu";if(!h.renderId){var g=h.boxing().render(true);xui.Dom.getEmptyDiv().append(g)}var q=h.getRoot();if(h.$highLight){xui([h.$highLight]).tagClass("-mouseover",false)}h._conainer=u;q.popToTop(l,n,u);if(h._needadjust){delete h._needadjust;h.boxing().adjustSize()}var m=function(){var f=arguments.callee.profile;if(f.box){f.boxing().hide();if(f.$popGrp){f.$popGrp.length=0}}};m.profile=h;if(!h.$popGrp||!h.$popGrp.length){h.$popGrp=[q._get(0)];q.setBlurTrigger(h.$xid,null);q.setBlurTrigger(h.$xid,m,h.$popGrp)}h[r]=h[c]=h[e]=null;return this},hide:function(n,h,k){var r,g=this.get(0),f=g.properties,m=g.getRoot(),c="$subPopMenuShowed",d="$highLight",q="$childPopMenu",l=function(){if(false!==n){if(false===g.boxing().beforeHide(g,h,k)){return this}}if(!m||m.css("display")=="none"){return}m.setBlurTrigger(g.$xid,null);if(g.$hideMenuPool){g.$hideMenuPool.append(m)}else{m.css("display","none")}if(r=g[d]){xui([r]).tagClass("-mouseover",false)}var u=g[q],e;if(r=g[c]){r.hide(n,h)}while(u){u.boxing().hide(n,h);u=(e=u)[q];e[q]=e[c]=e[d]=null}g[q]=g[c]=g[d]=null;if(r=g.$parentPopMenu){r[c]=null}if(g.$popGrp){_.arr.removeValue(g.$popGrp,m._get(0))}if(false!==n){g.boxing().onHide(g)}};m.hide(l,null,h);return this},_afterInsertItems:function(c){if(!c.renderId){return}c.boxing().adjustSize()},_afterRemoveItems:function(c){if(!c.renderId){return}c.boxing().adjustSize()}},Initialize:function(){var c=this.getTemplate();_.merge(c.FRAME.BORDER,{className:"xui-uiborder-outset",TOP:{},BOTTOM:{},BOX:{tagName:"div",className:"xui-uibg-base",ITEMS:{tagName:"div",text:"{items}"}},POOL:{}},"all");c.$submap={items:function(k,h,f,e,d){var g;e=e+"."+f.type;if(g=f.object){d[d.length]=g.build(f)}else{if(h[e]){xui.UI.$doTemplate(k,h,f,e,d)}}},"items.split":{ITEMSPLIT:{style:"{_itemDisplay}"}},"items.button":{ITEM:{tabindex:-1,className:" xui-uibarbg2 {itemClass} {disabled}",style:"{itemStyle}{_itemDisplay}",ICON:{$order:0,className:"xui-ui-icon {imageClass}",style:"{backgroundImage} {backgroundPosition} {backgroundRepeat}"},CAPTION:{text:"{caption}",$order:1},RULER:{style:"{displayAdd}",$order:2},ADD:{tagName:"div",style:"{displayAdd}",text:"{add}",$order:2},SUB:{style:"{displaySub}"}}},"items.checkbox":{ITEM:{tabindex:-1,className:"{itemClass} {disabled}",style:"{itemStyle}{_itemDisplay}",CHECKBOX:{$order:0,className:"xui-ui-icon {checkboxCls}"},CAPTION:{text:"{caption}",$order:1},RULER:{style:"{displayAdd}",$order:2},ADD:{tagName:"div",style:"{displayAdd}",text:"{add}",$order:2}}},"items.radiobox":{ITEM:{tabindex:-1,className:"{itemClass} {disabled}",style:"{itemStyle}{_itemDisplay}",RADIOBOX:{$order:0,className:"xui-ui-icon {radioboxCls}"},CAPTION:{text:"{caption}",$order:1},RULER:{style:"{displayAdd}",$order:2},ADD:{tagName:"div",style:"{displayAdd}",text:"{add}",$order:2}}}};this.setTemplate(c)},Static:{$initRootHidden:true,Appearances:{KEY:{"font-size":"12px",visibility:"hidden"},POOL:{"font-size":"0","line-height":"0",position:"absolute",display:"none"},BOX:{overflow:"hidden",position:"relative","font-size":"12px","z-index":"3"},BORDER:{position:"relative"},ITEMS:{position:"relative",top:0,left:0,overflow:"hidden","background-image":xui.UI.$bg("bg.gif",""),"background-repeat":"repeat-y","background-position":"left top"},"ITEMS-inline ITEM":{$order:5,display:xui.$inlineBlock},ITEM:{display:"block",position:"relative",overflow:"visible","white-space":"nowrap","font-family":'"Verdana", "Helvetica", "sans-serif"',cursor:"pointer",padding:"2px 20px 2px 2px",outline:0},ITEMSPLIT:{display:"block",position:"relative",overflow:"visible","white-space":"nowrap","font-size":"1px","line-height":"1px",padding:"2px 0",margin:"2px 2px 2px 26px","background-image":xui.UI.$bg("split_horizontal.gif","",true),"background-repeat":"repeat-x","background-position":"left top"},ICON:{margin:0},TOP:{cursor:"pointer",display:"none",position:"absolute","margin-left":"-8px",right:0,height:"16px",width:"16px","z-index":"10",top:0,"background-image":xui.UI.$bg("icons.gif","",true),"background-repeat":"no-repeat","background-position":"-48px -244px"},BOTTOM:{cursor:"pointer",display:"none",position:"absolute","margin-left":"-8px",right:0,height:"16px",width:"16px","z-index":"10",bottom:0,"background-image":xui.UI.$bg("icons.gif","",true),"background-repeat":"no-repeat","background-position":"-66px -244px"},"RADIOBOX, CHECKBOX, RADIOBOX-checked, CHECKBOX-checked":{cursor:"pointer","vertical-align":"middle",width:"16px",height:"16px"},CHECKBOX:{"background-image":xui.UI.$bg("icons.gif","",true),"background-repeat":"no-repeat","background-position":"-20px -70px",margin:0},"CHECKBOX-checked":{$order:1,"background-image":xui.UI.$bg("icons.gif","",true),"background-repeat":"no-repeat","background-position":"0 -70px"},RADIOBOX:{"background-image":xui.UI.$bg("icons.gif","",true),"background-repeat":"no-repeat","background-position":"-60px -70px",margin:0},"RADIOBOX-checked":{$order:1,"background-image":xui.UI.$bg("icons.gif","",true),"background-repeat":"no-repeat","background-position":"-40px -70px"},CAPTION:{"vertical-align":xui.browser.ie6?"baseline":"middle","padding-left":"6px"},RULER:{width:"100px","font-size":0,"line-height":0},ADD:{position:"absolute",top:"3px",right:0,width:"80px","padding-right":"20px","text-align":"right","z-index":"10",zoom:xui.browser.ie?1:null},SUB:{position:"absolute",top:"2px",right:"6px",width:"8px",height:"16px","background-image":xui.UI.$bg("icons.gif","",true),"background-repeat":"no-repeat","background-position":"-200px -70px"}},Behaviors:{ITEM:{onMouseover:function(k,m,d){var g="$subPopMenuShowed",u="$allPops",h="$highLight",q="$showpops",l="$popGrp";if(k[h]==d){return}var n=k.properties,A=k.getItemByDom(d),p=A.id,z=false,x,f,y;if(y=k[g]){if(y==_.get(k,[u,p])){z=true}else{y.hide();k[g]=null}}if(!z){if(y=k[h]){xui([y]).tagClass("-mouseover",false)}k[h]=d;xui.use(d).tagClass("-mouseover");try{xui.use(d).get(0).focus()}catch(m){}}if(!z&&A.sub){if(!(_.isArr(A.sub)&&A.sub.length)){if(k.onShowSubMenu){var c=k["$sub:"+A.id];if(c&&c["xui.UI"]&&!c.isEmpty()){}else{c=k.boxing().onShowSubMenu(k,A,d)}if(c&&c["xui.UI"]&&!c.isEmpty()){k[g]=c;c=c.reBoxing();c.onMouseout(function(B,r,C){k.box._mouseout(k,r,C)},null,-1);k[l].push(c._get(0));c.popToTop(d,2,k._conainer);return}else{if(c&&_.isArr(c)&&c.length){A.sub=c}}}}if(_.isArr(A.sub)&&A.sub.length){k[u]=k[u]||{};if(!(x=k[u][p])){var w=k.properties;x=(new xui.UI.PopMenu({position:"absolute",items:A.sub,autoHide:w.autoHide,showEffects:w.showEffects,hideEffects:w.hideEffects})).render(true);x.onShowSubMenu(function(B,e,r){return k.boxing().onShowSubMenu(k,e,r)});x.onMenuSelected(function(B,e,r){return k.boxing().onMenuSelected(k,e,r)});f=x.get(0);f.$hideMenuPool=k.$hideMenuPool||k.getSubNode("POOL");k[u][p]=x;k[q]=k[q]||[k];f[q]=k[q];k[q].push(f)}else{f=x.get(0)}k[l].push(f.getRoot()._get(0));f[l]=k[l];f.$parentPopMenu=k;k.$childPopMenu=f;x.pop(d,2);k[g]=x}}},onMouseout:function(g,l,c){var m=g.properties,r=g.getItemByDom(c),n=r.id,h=true,d="$highLight",q;if(g[d]==c){return}if(q=g.$subPopMenuShowed){var f=l.toElement||l.relatedTarget,k=q.get(0).getRootNode();try{do{if(f==k){return}}while((f&&(f=f.parentNode)))}catch(p){}}xui.use(c).tagClass("-mouseover",false);g[d]=null},onClick:function(c,f,h){var k=c.properties,d=c.getItemByDom(h),g=d.id;if(k.disabled||d.disabled){return false}if(!d.group){if(d.type=="checkbox"){c.getSubNodeByItemId("CHECKBOX",d.id).tagClass("-checked",d.value=!d.value)}else{if(d.type=="radiobox"){c.getSubNode("RADIOBOX",true).tagClass("-checked",false);_.arr.each(k.items,function(e){if(e.type=="radiobox"){e.value=false}});c.getSubNodeByItemId("RADIOBOX",d.id).tagClass("-checked",d.value=true)}}if(c.onMenuSelected){c.boxing().onMenuSelected(c,d,h)}if(k.hideAfterClick){xui.use(h).tagClass("-mouseover",false);_.asyRun(function(){var l=c,e;if(!l.renderId){return}while(l){l.boxing().hide();l=(e=l).$parentPopMenu;e.$parentPopMenu=e.$subPopMenuShowed=null}c.$subPopMenuShowed=null;if(c.$popGrp){c.$popGrp.length=0}},100)}}},onFocus:function(d,k,l){var f=d.getSubNode("BOX"),g=f.scrollTop(),c=f.scrollHeight(),m=xui.use(l).offsetTop();if(m<g||m>g+c){xui.use(l).offsetTop(g)}xui.use(l).onMouseover()},onKeydown:function(g,k,d){var u=g.getItemByDom(d),l=g.properties.items,p=xui.Event.getKey(k).key,n=u.id,m,c,h,f,q;switch(p){case"enter":xui(d).onClick();break;case"up":c=true;m=false;_.arr.each(l,function(r,e){if(r.type=="split"){return}if(m){h=r.id;return c=false}if(r.id==n){m=true}},null,true);if(c){h=l[l.length-1].id}f=g.getSubNodeByItemId("ITEM",h).get(0);break;case"down":c=true;m=false;_.arr.each(l,function(r,e){if(r.type=="split"){return}if(m){h=r.id;return c=false}if(r.id==n){m=true}});if(c){h=l[0].id}f=g.getSubNodeByItemId("ITEM",h).get(0);break;case"left":if(q=g.$parentPopMenu){if(q=g.$parentPopMenu.$highLight){f=q}}break;case"right":if((q=g.$subPopMenuShowed)&&q==g.$allPops[n]){q.activate()}break}if(f&&f.tagName){try{f.focus()}catch(k){}}}},TOP:{onMouseover:function(c){c.$scrollToTop=true;c.boxing()._scrollToTop()},onMouseout:function(c){c.$scrollToTop=false;c.$scrollStep=null},onClick:function(c){c.$scrollStep*=2}},BOTTOM:{onMouseover:function(c){c.$scrollTobottom=true;c.boxing()._scrollToBottom()},onMouseout:function(c){c.$scrollTobottom=false;c.$scrollStep=null},onClick:function(c){c.$scrollStep*=2}},ITEMS:{afterKeydown:function(d,f){var c=xui.Event.getKey(f).key;if(c=="tab"||c=="enter"){return true}else{if(c=="esc"){do{d.boxing().hide()}while(d=d.$parentPopMenu);return false}else{return false}}}},BORDER:{onMouseout:function(c,d,f){c.box._mouseout(c,d,f)}}},DataModel:({dock:null,tabindex:null,tips:null,border:null,resizer:null,showEffects:"Blur",hideEffects:"",autoTips:false,shadow:true,_maxHeight:260,_maxWidth:300,left:-10000,hideAfterClick:true,autoHide:false,height:"auto",width:"auto",position:"absolute",$hborder:0,$vborder:0}),EventHandlers:{onShowSubMenu:function(c,d,e){},beforeHide:function(c,d){},onHide:function(c){},onMenuSelected:function(c,d,e){}},RenderTrigger:function(){this.boxing().adjustSize()},_mouseout:function(f,h){if(f.properties.autoHide){var k=xui.Event.getPos(h),d,g,c;_.arr.each(f.$popGrp,function(e){e=xui([e]);g=e.offset();d=e.cssSize();if(k.left>g.left&&k.top>g.top&&k.left<g.left+d.width&&k.top<g.top+d.height){return c=1}});if(!c){while(c=f.$parentPopMenu){f=c}f.boxing().hide(true,null,h);if(f.$popGrp){f.$popGrp.length=0}}}},_prepareItem:function(d,e){var c="display:none;";e.add=e.add||"";e.displayAdd=e.add?"":c;e.displaySub=e.sub?"":c;e._itemDisplay=e.hidden?c:"";e.type=e.type||"button";if(e.type=="checkbox"){e.checkboxCls=d.getClass("CHECKBOX",e.value?"-checked":"")}else{if(e.type=="radiobox"){e.radioboxCls=d.getClass("RADIOBOX",e.value?"-checked":"")}}},_onresize:null}});Class("xui.UI.MenuBar",["xui.UI","xui.absList"],{Instance:{updateItem:function(f,e){var d=this,h=d.get(0),c=h.properties.items;if(_.arr.subIndexOf(c,"id",f)!=-1){arguments.callee.upper.call(d,f,e)}else{var g=0;_.each(h.$allPops,function(k){k.updateItem(f,e);g=1});if(!g){arguments.callee.upper.call(d,f,e)}}return d},_pop:function(m,d){var n=this,g=n.get(0);if(g.$curPop){n.hide()}if(!m.sub){return}if(g.beforePopMenu&&false==g.boxing().beforePopMenu(g,m,d)){return}else{xui.use(d).tagClass("-mousedown");var f,e=m.id,k=g.properties,h="$allPops";g.$curPop=e;g.$curElem=d;g.$menuPop=e;g[h]=g[h]||{};if(!g[h][e]){var l=function(p){var q={position:"absolute",items:p,autoHide:!!k.autoShowTime};if(k.showEffects){q.showEffects=k.showEffects}if(k.hideEffects){q.hideEffects=k.hideEffects}var r=xui.create("PopMenu",q);g.getSubNode("POOL").append(r);r.onHide(function(u){n.hide(false)}).onMenuSelected(function(x,u,w){return g.boxing().onMenuSelected(g,x,u,w)}).onShowSubMenu(function(x,u,w){return g.boxing().onShowSubMenu(g,x,u,w)});r.get(0).$hideMenuPool=g.getSubNode("POOL");r.get(0)[h]=g[h];g[h][e]=r};if(_.isArr(m.sub)&&m.sub.length){l(m.sub)}else{if(g.onGetPopMenu){var c=g.boxing().onGetPopMenu(g,m,l);if(_.isArr(c)&&c.length){l(m.sub=c)}}}}if(g[h][e]){g[h][e].pop(xui(d),1,xui(k.parentID))}return false}},_afterInsertItems:function(){this.clearPopCache()},hide:function(c){var d=this.get(0),f,g=d.$curPop,e=d.$curElem;if(f=d.$allPops[g]){if(false!==arguments[0]){f.hide(false,c)}d.getSubNode("POOL").append(f.reBoxing());xui([e]).tagClass("-mousedown",false)}d.$menuPop=d.$curPop=d.$curElem=null},clearPopCache:function(){var c=this.get(0);if(c.renderId){c.getSubNode("POOL").empty();c.$allPops=c.$curPop=c.$curElem=null}}},Initialize:function(){xui.SC("xui.UI.PopMenu")},Static:{_nocap2tip:true,Templates:{tagName:"div",className:"{_className}",style:"{_style}",POOL:{tagName:"div"},BORDER:{className:"xui-uibg-bar xui-uiborder-outset",tagName:"div",LIST:{tagName:"div",HANDLER:{style:"{handler}"},ITEMS:{$order:1,text:"{items}"}}},$submap:{items:{ITEM:{style:"{itemStyle}{_itemDisplay}",ITEMI:{ITEMC:{ITEMA:{tabindex:"{_tabindex}",className:" {typeCls} {disabled}",ICON:{$order:1,className:"xui-ui-icon {imageClass}",style:"{backgroundImage} {backgroundPosition} {backgroundRepeat} {imageDisplay}"},CAPTION:{$order:2,text:"{caption}",style:"{captionDisplay}"}}}}}}}},Appearances:{KEY:{"font-size":0,"line-height":0,position:"absolute",left:0,top:0},POOL:{width:0,height:0,visibility:"hidden",position:"absolute",left:"-10000px",top:"-10000px"},BORDER:{left:0,top:0,"font-size":0,"line-height":0},HANDLER:{height:"22px",width:"7px","background-image":xui.UI.$bg("handler.gif","",true),"background-position":"left top",cursor:"move","vertical-align":"middle"},LIST:{padding:"1px"},ITEMS:{"vertical-align":"middle"},"LIST-disabled":{"background-color":"#E4E4E4"},"ITEM-mouseover, ITEM-mouseover ITEMI, ITEM-mouseover ITEMC, ITEM-mousedown, ITEM-mousedown ITEMI, ITEM-mousedown ITEMC":{"background-image":xui.UI.$bg("button.gif","",true),"background-repeat":"no-repeat"},ITEM:{height:"22px","white-space":"nowrap","vertical-align":"top",overflow:"hidden",margin:"0  3px 0 3px","padding-right":"6px","font-size":0,"line-height":0},"ITEM *":{cursor:"pointer"},ITEMI:{height:"22px","padding-left":"6px","vertical-align":"top"},ITEMC:{height:"22px","padding-top":"3px","vertical-align":"top"},ITEMA:{display:xui.$inlineBlock},"ITEM-mouseover":{$order:2,"background-position":"right -90px"},"ITEM-mousedown":{$order:3,"background-position":"right -180px"},"ITEM-mouseover ITEMI":{$order:2,"background-position":"left -150px"},"ITEM-mousedown ITEMI":{$order:3,"background-position":"left -240px"},"ITEM-mouseover ITEMC":{$order:2,"background-position":"left -120px","background-repeat":"repeat-x"},"ITEM-mousedown ITEMC":{$order:3,"background-position":"left -210px","background-repeat":"repeat-x"},CAPTION:{"font-size":"12px","line-height":"14px","vertical-align":xui.browser.ie6?"baseline":"middle"}},Behaviors:{ITEM:{onMouseover:function(d,h,l){var g=d.properties,c=l;if(g.disabled){return}var f=d.getItemByDom(l),k=f.id;if(f.disabled){return}xui.use(c).tagClass("-mouseover");if(d.$menuPop){if(d.$menuPop!=k){d.boxing()._pop(f,c)}}else{if(g.autoShowTime){_.resetRun(d.$xid+":autoShowTime",function(){d.boxing()._pop(f,c)},g.autoShowTime)}}},onMouseout:function(g,h,c){var d=g.properties;if(d.disabled){return}var q=g.getItemByDom(c);if(q.disabled){return}xui.use(c).tagClass("-mouseover",false);if(d.autoShowTime){var l=g.$allPops;if(l=l&&l[g.$curPop]){var f=l.get(0).getRoot(),m=xui.Event.getPos(h),r=f.cssSize(),n=3,k=f.offset();if(m.left>k.left&&m.top>k.top-n&&m.left<k.left+r.width&&m.top<k.top+r.height){}else{l.hide()}}_.resetRun(g.$xid+":autoShowTime",null)}},onMousedown:function(c,g,k){var f=c.properties;if(f.disabled){return}var d=c.getItemByDom(k),h=d.id;if(d.disabled){return}xui.use(k).tagClass("-mousedown");return c.boxing()._pop(d,k)},onMouseup:function(c,f,g){var d=c.getItemByDom(g);if(c.$menuPop!=d.id){xui.use(g).tagClass("-mousedown",false)}},onKeydown:function(f,k,c){var p=xui.Event.getKey(k),n=p.key,d=p.shiftKey,m=xui(c),h=f.getRoot().nextFocus(true,true,false),l=f.getRoot().nextFocus(false,true,false);switch(xui.Event.getKey(k).key){case"tab":if(d){if(m.get(0)!=h.get(0)){h.focus();return false}}else{if(m.get(0)!=l.get(0)){l.focus();return false}}break;case"left":case"up":var g=m.nextFocus(false,true,false);if(m.get(0)==h.get(0)){l.focus()}else{m.nextFocus(false)}return false;break;case"right":case"down":var g=m.nextFocus(true,false,false);if(m.get(0)==l.get(0)){h.focus()}else{m.nextFocus()}return false;break;case"enter":m.onMousedown();break}},onClick:function(c,f,g){var d=c.getItemByDom(g);if(c.$menuPop!=d.id){if(c.onMenuBtnClick){c.boxing().onMenuBtnClick(c,d,g)}}}}},DataModel:{listKey:null,autoTips:false,height:{ini:"auto",readonly:true},width:"auto",parentID:"",$hborder:1,$vborder:1,left:0,top:0,autoShowTime:200,handler:{ini:true,action:function(c){this.getSubNode("HANDLER").css("display",c?"":"none")}},position:"absolute",dock:{ini:"top",listbox:["top","bottom"]}},EventHandlers:{onGetPopMenu:function(c,d,e){},onMenuBtnClick:function(c,d,e){},beforePopMenu:function(c,d,e){},onShowSubMenu:function(c,f,d,e){},onMenuSelected:function(c,f,d,e){}},RenderTrigger:function(){if(this.properties.disabled){this.boxing().setDisabled(true,true)}},_prepareData:function(d){var c="display:none;";var e=arguments.callee.upper.call(this,d);e.handler=e.handler?"":c;e._itemDisplay=e.hidden?c:"";return e}}});Class("xui.UI.ToolBar",["xui.UI","xui.absList"],{Instance:{updateItem:function(g,e){if(e.type){return arguments.callee.upper.call(this,g,e)}else{var u=this,d=u.get(0),n=d.box,w=d.properties.items,x=d.queryItems(w,function(A){return typeof A=="object"?A.id===g:A==g},true,true,true),p,y,m,l,k,h,f,r;if(_.isStr(e)){e={caption:e}}if(x.length){x=x[0];if(y=x[0]){if(_.isSet(e.id)){e.id+=""}if(e.id&&g!==e.id){p=e.id;var c=d.ItemIdMapSubSerialId,q;if(!c[p]){if(q=c[g]){c[p]=q;delete c[g];d.SubSerialIdMapItem[q].id=p}else{y.id=p}}}delete e.id;if(_.isEmpty(e)){return u}m=d.getSubNodeByItemId("ICON",p||g);l=d.getSubNodeByItemId("CAPTION",p||g);k=d.getSubNodeByItemId("ITEM",p||g);h=d.getSubNodeByItemId("LABEL",p||g);f=d.getSubNodeByItemId("BTN",p||g);if("value" in e&&e.value!==y.value){d.getSubNodeByItemId("BTN",p||g).tagClass("-checked",!!e.value)}if("caption" in e&&e.caption!==y.caption){l.html(e.caption);if(e.caption&&!y.caption){l.css("display","")}if(!e.caption&&y.caption){l.css("display","none")}}if("label" in e&&e.label!==y.label){h.html(e.label);if(e.label&&!y.label){h.css("display","")}if(!e.label&&y.label){h.css("display","none")}}if("disabled" in e&&e.disabled!==y.disabled){if(e.disabled){k.addClass("xui-ui-itemdisabled")}else{k.removeClass("xui-ui-itemdisabled")}f.onMouseout(true,{$force:true})}if("image" in e&&e.image!==y.image){m.css("background-image",e.image)}if("imagePos" in e&&e.imagePos!==y.imagePos){m.css("background-position",e.imagePos)}if("imageClass" in e&&e.imageClass!==y.imageClass){if(y.imageClass){m.removeClass(y.imageClass)}if(e.imageClass){m.addClass(e.imageClass)}}if("hidden" in e){var z=!!e.hidden;if(z){if(y.hidden!==true){k.css("display","none")}}else{if(y.hidden===true){k.css("display","")}}}_.merge(y,e,"all")}}return u}},showItem:function(d,c){return this.each(function(e){var f=e.getItemByItemId(d);if(f){f.hidden=c===false;e.getSubNodeByItemId("ITEM",d).css("display",c===false?"none":"")}})},showGroup:function(c,d){return this.each(function(e){_.arr.each(e.properties.items,function(g){if(g.id==c){g.hidden=d===false;return false}});var f=e.getSubNodeByItemId("GROUP",c);f.css("display",d===false?"none":"");if(e.renderId&&e.getRootNode().offsetWidth){xui.UI.$dock(e,true,true)}})}},Static:{_focusNodeKey:"BTN",_ITEMKEY:"GROUP",Templates:{tagName:"div",className:"{_className}",style:"{_style}",ITEMS:{className:"xui-uibg-bar xui-uiborder-outset",tagName:"div",style:"{mode}",text:"{items}"},$submap:{items:{GROUP:{className:"{groupClass}",style:"{grpDisplay} {groupStyle}",HANDLER:{style:"{mode2}"},LIST:{$order:1,tagName:"text",text:"{sub}"}}},"items.sub":{ITEM:{style:"{_itemDisplay}",className:" {disabled}",IBWRAP:{tagName:"div",SPLIT:{style:"{splitDisplay}"},LABEL:{style:"{labelDisplay}",text:"{label}"},BTN:{className:"xui-ui-btn {itemcls} {itemClass}",style:"{itemStyle} {boxDisplay}",BTNI:{className:"xui-ui-btni",BTNC:{className:"xui-ui-btnc",BOX:{tabindex:"{_tabindex}",BOXWRAP:{tagName:"div",RULER:{},ICON:{$order:1,className:"xui-ui-icon {imageClass}",style:"{backgroundImage} {backgroundPosition} {backgroundRepeat}  {imageDisplay}"},CAPTION:{$order:2,text:"{caption}",style:"{captionDisplay}"},DROP:{$order:3,style:"{dropDisplay}"}}}}}}}}}}},Appearances:{KEY:{"font-size":0,"line-height":0,position:"absolute",overflow:"hidden",left:0,top:0},"ITEM-object":{"vertical-align":"middle","margin-left":"4px"},RULER:{padding:"0px",margin:"0px",width:"0px"},ICON:{margin:0,"vertical-align":"middle"},ITEMS:{display:"block","padding-bottom":"1px","font-size":0,"line-height":0},HANDLER:{height:"22px",width:"7px","background-image":xui.UI.$bg("handler.gif","",true),"background-position":"left top",cursor:"move","vertical-align":"middle"},GROUP:{"font-size":0,"line-height":0,position:"static",padding:"1px 2px 0px 1px","vertical-align":"middle"},ITEM:{"vertical-align":"middle",padding:"0px 1px"},"BTNC a":{padding:0},SPLIT:{$order:1,width:"6px",height:"15px","vertical-align":"middle","background-image":xui.UI.$bg("split_vertical.gif","",true),"background-position":"left top","background-repeat":"repeat-y"},BTN:{"padding-right":"3px"},BTNI:{"padding-left":"3px"},DROP:{width:"14px",height:"16px","vertical-align":"middle","background-image":xui.UI.$bg("drop.gif","","Button"),"background-position":"left center","background-repeat":"no-repeat"},"BTN-mouseover DROP":{$order:2,"background-position":"-16px center"},"BTN-mousedown DROP, BTN-checked DROP":{$order:2,"background-position":"-32px center"},BOX:{height:"auto"},"LABEL, CAPTION":{"vertical-align":"middle","margin-left":"2px","margin-right":"2px","font-size":"12px"},LABEL:{cursor:"default","padding-top":"3px"}},Behaviors:{NoTips:["GROUP","HANDLER"],HoverEffected:{BTN:["BTN"]},ClickEffected:{BTN:["BTN"]},BTN:{onClick:function(f,h,k){if(f.properties.disabled){return false}var d=xui.use(k).parent(3).id(),c=f.getItemByDom(d);if(c.disabled){return false}var g=f.getItemByDom(k);if(g.disabled){return false}xui.use(k).focus();if(g.type=="statusButton"){xui.use(k).tagClass("-checked",g.value=!g.value)}f.boxing().onClick(f,g,c,h,k);return false}}},DataModel:{listKey:null,height:{ini:"auto",readonly:true},width:"auto",left:0,top:0,handler:{ini:true,action:function(c){this.getSubNode("HANDLER",true).css("display",c?"":"none")}},position:"absolute",hAlign:{ini:"left",listbox:["left","center","right"],action:function(c){this.getSubNode("ITEMS",true).css("textAlign",c)}},dock:{ini:"top",listbox:["top","bottom"]}},EventHandlers:{onClick:function(c,d,g,f,h){}},_adjustItems:function(d){if(!d){d=[_()+""]}if(_.isStr(d)){d=[d]}var e=_.copy(d),c;_.arr.each(e,function(g,f){if(_.isArr(g)){g={id:_.id(),sub:g}}if(_.isHash(g)){e[f]=_.copy(g);e[f].sub=[];if(g.sub){_.arr.each(g.sub,function(h){e[f].sub.push(_.isHash(h)?_.copy(h):{id:h+""})})}}});return e},_prepareData:function(c){var f=arguments.callee.upper.call(this,c);var e=c.properties;f.mode=e.hAlign!="left"?("text-align:"+e.hAlign+";"):"";return f},_prepareItem:function(d,e,u,m,n,p,f,h){var k="display:none",g=d.properties.tabindex,q=function(y,w,H,C,D,E,z,A){var x=w[xui.UI.$tag_subId]=typeof A=="string"?A:("a_"+y.pickSubId("aitem")),G;if(typeof H=="string"){H={caption:H}}if(false!==z){y.ItemIdMapSubSerialId[H.id]=x;y.SubSerialIdMapItem[x]=H}if(G=H.object){G=w.object=G["xui.absBox"]?G.get(0):G;if(G["xui.UIProfile"]){G.properties.position="relative";var F=y.getClass("ITEM","-object"),B=G.CC.KEY||(B=G.CC.KEY="");if(B.indexOf(F)===-1){G.CC.KEY=B+" "+F}}H.$xid=G.$xid;G.$item=H;G.$holder=y;if(!G.host||G.host===G){G.boxing().setHost(y.host,G.alias)}if(!y.$attached){y.$attached=[]}y.$attached.push(G)}else{if(H.statusButton){H.type="statusButton";delete H.statusButton}else{if(H.dropButton){H.type="dropButton";delete H.dropButton}else{if(H.split){H.type="split";delete H.split}}}if(H.type!=="split"&&!H.caption){H.caption=""}xui.UI.adjustData(y,H,w);if(H.type=="statusButton"&&!!H.value){w.itemcls=" xui-ui-btn-checked "+y.getClass("BTN","-checked",!!H.value)}w._tabindex=g;w.splitDisplay=w.type=="split"?"":k;w.labelDisplay=w.label?"":k;w.captionDisplay=w.caption?"":k;w.dropDisplay=H.type=="dropButton"?"":k;w.boxDisplay=(w.type!=="split"&&(w.caption||w.image||w.imageClass))?"":k}w._itemDisplay=H.hidden?k:"";H._pid=C};if(m){q(d,e,u,m,n,p,f,h)}else{var l=[],c,r=u.sub||[];m=u.id;e.mode2=("handler" in u)?(u.handler?"":k):(d.properties.handler?"":k);e.grpDisplay=u.hidden?k:"";e.sub=l;_.arr.each(r,function(w){c={id:w.id};q(d,c,w,m,n,p,f,h);l.push(c)})}}}});Class("xui.UI.Layout",["xui.UI","xui.absList"],{Instance:{getPanel:function(c){return this.get(0).getSubNodeByItemId("PANEL",c)},append:function(f,c,e,d){var g=this.get(0);return arguments.callee.upper.call(this,f,c||"main",e,d)},insertItems:function(c,e,d){return this._insertItems(c,e,d)},_insertItems:function(h,d,q,u){var e,l,m,k,c,f,g,p="before",n=this._afterInsertItems;return this.each(function(w){g=w.box;m=w.properties.items;if(!u){k=_.arr.subIndexOf(m,"id",d);if(k==-1){p=q?"before":"after"}else{if(m[k].id=="main"){p=q?"before":"after"}else{p=m[k].pos}}l=g._adjustItems2(h,p)}else{l=h}if(k==-1){_.arr.insertAny(m,l,q?0:-1)}else{_.arr.insertAny(m,l,q?k:k+1)}if(w.renderId){f=g._prepareItems(w,l,d);c=w._buildItems("items",f);w.getRoot().prepend(c);var r=w.getRootNode().style;xui.UI.$tryResize(w,r.width,r.height,true);r=null}if(n){w.boxing()._afterInsertItems(w,f,d,q)}})},_afterRemoveItems:function(d){if(d.renderId){var c=d.getRootNode().style;xui.UI.$tryResize(d,c.width,c.height,true);c=null}},updateItem:function(h,g){var r=this,f=r.get(0),e=f.properties.type=="vertical",l=f.box,u=f.properties.items,y=f.queryItems(u,function(A){return typeof A=="object"?A.id===h:A==h},true,true,true),m,z,w,x,k,p;if(typeof g!="object"){return}if(y.length){y=y[0];if(typeof y[0]!="object"){z=y[2][y[1]]={id:y[0]}}else{z=y[0]}if(_.isSet(g.id)){g.id+=""}if(g.id&&h!==g.id){m=g.id;var c=f.ItemIdMapSubSerialId,n;if(!c[m]){if(n=c[h]){c[m]=n;delete c[h];f.SubSerialIdMapItem[n].id=m}else{z.id=m}}}delete g.id;if(_.isEmpty(g)){return r}var q=false;x=f.getSubNodeByItemId("ITEM",h);if(!x.isEmpty()){if(g.hasOwnProperty("size")){g.size=parseInt(""+g.size,10);if(g.size!=z._size){z._size=g.size;if(e){x.height(g.size)}else{x.width(g.size)}q=true}}if(g.hasOwnProperty("hidden")){g.hidden=!!g.hidden;if(g.hidden!==z.hidden){f.getSubNodeByItemId("ITEM",h).css("display",g.hidden?"none":"");q=true}}if(g.hasOwnProperty("locked")){g.locked=!!g.locked;if(g.locked!==z.locked){f.getSubNodeByItemId("MOVE",h).css("cursor",g.locked?"default":e?"n-resize":"w-resize");q=true}}if(g.hasOwnProperty("folded")){g.folded=!!g.folded;if(g.folded!==z.folded){f.boxing().fireCmdClickEvent(h)}}if(g.hasOwnProperty("cmd")){g.cmd=!!g.cmd;if(g.cmd!==z.cmd){f.getSubNodeByItemId("CMD",h).css("display",g.cmd?"":"none")}}var d={};if(g.hasOwnProperty("panelBgClr")){d["background-color"]=g.panelBgClr}if(g.hasOwnProperty("panelBgImg")){d["background-image"]=g.panelBgImg?("url("+xui.adjustRes(g.panelBgImg)+")"):""}if(g.hasOwnProperty("panelBgImgPos")){d["position-color"]=g.panelBgImgPos}if(g.hasOwnProperty("panelBgImgRepeat")){d["background-repeat"]=g.panelBgImgRepeat}if(g.hasOwnProperty("panelBgImgAttachment")){d["background-attachment"]=g.panelBgImgAttachment}if(g.hasOwnProperty("overflow")){var n=g.overflow;if(n){if(n.indexOf(":")!=-1){_.arr.each(n.split(/\s*;\s*/g),function(B){var A=B.split(/\s*:\s*/g);if(A.length>1){d[_.str.trim(A[0])]=_.str.trim(A[1]||"")}})}}d.overflow=n||""}if(!_.isEmpty(d)){f.getSubNodeByItemId("PANEL",h).css(d)}}_.merge(z,g,"all");if(q){var p=f.getRootNode().style;xui.UI.$tryResize(f,p.width,p.height,true);p=null}}return r},fireCmdClickEvent:function(c){this.getSubNodeByItemId("CMD",c).onMousedown();return this}},Static:{Templates:{tagName:"div",style:"{_style}",className:"{_className}",text:"{items}",$submap:{items:{ITEM:{tagName:"div",className:"{cls1} {itemClass}",style:"{size};{itemStyle};{display}",MOVE:{$order:0,tagName:"div",className:"xui-ui-unselectable xui-uibg-bar {clsmovebg} {cls2} ",style:"cursor:{_cursor}"},CMD:{$order:1,tagName:"div",style:"{cmdDisplay}",className:"xui-ui-unselectable {cls3} "},PANEL:{tagName:"div",className:"xui-uibg-base",style:"position:absolute;left:0;top:0;{_bginfo};{_overflow};",text:xui.UI.$childTag}}}}},Appearances:{".setting-xui-layout":{width:"9px"},KEY:{position:"absolute",overflow:"hidden",left:0,top:0,"font-size":xui.browser.ie?0:null,"line-height":xui.browser.ie?0:null},MOVE:{$order:0,position:"absolute","z-index":"10","font-size":xui.browser.ie?0:null,"line-height":xui.browser.ie?0:null},CMD:{position:"absolute",cursor:"pointer","z-index":"20","font-size":xui.browser.ie?0:null,"line-height":xui.browser.ie?0:null},ITEM:{position:"absolute","z-index":1,overflow:"hidden","border-width":xui.browser.opr?"0px":null,"font-size":xui.browser.ie?0:null,"line-height":xui.browser.ie?0:null},PANEL:{position:"absolute",overflow:"auto","border-width":xui.browser.opr?"0px":null,"font-size":xui.browser.ie?0:null,"line-height":xui.browser.ie?0:null},"ITEM-MAIN":{left:0,right:0,top:0,bottom:0},"ITEM-TOP, ITEM-BOTTOM":{left:0,right:0},"ITEM-LEFT, ITEM-RIGHT":{top:0,bottom:0},"MOVE-TOP, MOVE-BOTTOM":{width:"100%",height:"7px",cursor:"n-resize"},"MOVE-LEFT, MOVE-RIGHT":{height:"100%",width:"7px",cursor:"w-resize"},"MOVE-TOP":{bottom:0},"MOVE-BOTTOM":{top:0},"MOVE-LEFT":{right:"0px"},"MOVE-RIGHT":{left:0},"CMD-TOP, CMD-BOTTOM, CMD-LEFT, CMD-RIGHT":{"background-image":xui.UI.$bg("icons.gif","",true),"background-repeat":"no-repeat"},"CMD-TOP":{$order:1,left:"50%","margin-left":"-20px",bottom:0,width:"40px",height:"9px","background-position":"-360px -232px"},"CMD-BOTTOM":{$order:1,left:"50%","margin-left":"-20px",top:0,width:"40px",height:"9px","background-position":"-360px -258px"},"CMD-LEFT":{$order:1,top:"50%","margin-top":"-20px",right:0,height:"40px",width:"9px","background-position":"-310px -240px"},"CMD-RIGHT":{$order:1,top:"50%","margin-top":"-20px",left:0,height:"40px",width:"9px","background-position":"-336px -240px"},"CMD-TOP-mouseover":{$order:2,"background-position":"-360px -245px"},"CMD-BOTTOM-mouseover":{$order:2,"background-position":"-360px -271px"},"CMD-LEFT-mouseover":{$order:2,"background-position":"-323px -240px"},"CMD-RIGHT-mouseover":{$order:2,"background-position":"-349px -240px"},"MOVE-MAIN":{$order:5,display:"none"},"CMD-MAIN":{$order:5,display:"none"}},Behaviors:{DroppableKeys:["PANEL"],PanelKeys:["PANEL"],HoverEffected:{MOVE:"MOVE",CMD:"CMD"},onSize:xui.UI.$onSize,MOVE:{beforeMousedown:function(k,r,c){if(xui.Event.getBtn(r)!="left"){return}var u=k.getSubId(c),B=k.getItemByDom(c);if(B.folded){return}if(B.locked){return}var n=k.getItemByItemId("main"),g=k.getSubNode("ITEM",u),l=k.getSubNodeByItemId("ITEM","main"),z=xui.use(c).css("cursor"),A=k.properties,p,x,q,y,f,d;k.pos=B.pos;if(A.type=="vertical"){p=k._cur=g.height();q=l.height();if(B.pos=="before"){f=p-B.min;d=B.max?Math.min(parseInt(B.max,10)-p,(q-n.min)):(q-n.min)}else{f=B.max?Math.min(parseInt(B.max,10)-p,(q-n.min)):(q-n.min);d=p-B.min}xui.use(c).startDrag(r,{dragType:"copy",targetReposition:false,verticalOnly:true,maxTopOffset:f,maxBottomOffset:d,dragCursor:z,targetWidth:xui.browser.ie?xui.use(c).offsetWidth():null,targetHeight:xui.browser.ie?xui.use(c).offsetHeight():null,targetCallback:xui.browser.ie?function(e){e.tagClass("-(top|bottom)",false)}:null})}else{x=k._cur=g.width();y=l.width();if(B.pos=="before"){f=x-B.min;d=B.max?Math.min(parseInt(B.max,10)-x,(y-n.min)):(y-n.min)}else{f=B.max?Math.min(parseInt(B.max,10)-x,(y-n.min)):(y-n.min);d=x-B.min}xui.use(c).startDrag(r,{dragType:"copy",targetReposition:false,horizontalOnly:true,maxLeftOffset:f,maxRightOffset:d,dragCursor:z,targetWidth:xui.browser.ie?xui.use(c).offsetWidth():null,targetHeight:xui.browser.ie?xui.use(c).offsetHeight():null,targetCallback:xui.browser.ie?function(e){e.tagClass("-(left|right)",false)}:null})}k._limited=0},onDrag:function(g,k,m){var f=g.properties,l=xui.DragDrop,h=xui.DragDrop._profile,c=0;if(f.type=="vertical"){if((h.y<=h.restrictedTop)||(h.y>=h.restrictedBottom)){c=true}}else{if(h.x<=h.restrictedLeft||h.x>=h.restrictedRight){c=true}}if(c){if(!g._limited){g._bg=h.proxyNode.css("backgroundColor");h.proxyNode.css("backgroundColor","#ff6600");g._limited=true}}else{if(g._limited){h.proxyNode.css("backgroundColor",g._bg);g._limited=0}}},onDragstop:function(h,q,c){var y=h.properties,g=xui.use(c).parent(),d=h.getRoot(),x=h.getItemByDom(c),p=0,w,n=null,f=null,u;for(var m=0,k=y.items.length;m<k;m++){p+=y.items[m].size||80;if(y.items[m].id=="main"){u=y.items[m]}}if(y.type=="vertical"){f=d.height();g.height(x._size=h._cur+(h.pos=="before"?1:-1)*xui.DragDrop.getProfile().offset.y);w=p*x._size/f}else{n=d.width();g.width(x._size=h._cur+(h.pos=="before"?1:-1)*xui.DragDrop.getProfile().offset.x);w=p*x._size/n}u.size-=w-x.size;x.size=w;xui.UI.$tryResize(h,n,f,true);h._limited=0}},CMD:{onMousedown:function(l,q,d){if(xui.Event.getBtn(q)!="left"){return}var x=l.properties,u=l.getSubId(d),w=l.getItemByDom(d),f=l.getRoot(),n=l.getItemByItemId("main"),k=l.getSubNodeByItemId("ITEM","main"),g=l.getSubNode("ITEM",u),c=l.getSubNode("PANEL",u),h=l.getSubNode("MOVE",u),p=xui.UI.$getCSSValue("setting-xui-layout","width");if(x.type=="vertical"){if(w.folded){g.height(w._size);c.show();w.folded=false;if(w.pos=="before"){xui.use(d).replaceClass(/bottom/g,"top")}else{xui.use(d).replaceClass(/top/g,"bottom")}if(!w.locked){h.css("cursor","n-resize")}l.getSubNode("MOVE").tagClass("-checked",false)}else{g.height(p);c.hide();w.folded=true;if(w.pos=="before"){xui.use(d).replaceClass(/top/g,"bottom")}else{xui.use(d).replaceClass(/bottom/g,"top")}if(!w.locked){h.css("cursor","default")}l.getSubNode("MOVE").tagClass("-checked")}xui.UI.$tryResize(l,null,f.height(),true)}else{if(w.folded){g.width(w._size);c.show();w.folded=false;if(w.pos=="before"){xui.use(d).replaceClass(/right/g,"left")}else{xui.use(d).replaceClass(/left/g,"right")}if(!w.locked){h.css("cursor","w-resize")}l.getSubNode("MOVE").tagClass("-checked",false)}else{g.width(p);c.hide();w.folded=true;if(w.pos=="before"){xui.use(d).replaceClass(/left/g,"right")}else{xui.use(d).replaceClass(/right/g,"left")}if(!w.locked){h.css("cursor","default")}l.getSubNode("MOVE").tagClass("-checked")}xui.UI.$tryResize(l,f.width(),null,true)}return false}},PANEL:{onClick:function(c,g,h){var f=c.properties,d=c.getItemByDom(h);if(f.disabled||d.disabled){return false}if(c.onClickPanel){return c.boxing().onClickPanel(c,d,g,h)}}}},DataModel:{rotate:null,selectable:true,disabled:null,position:"absolute",type:{listbox:["vertical","horizontal"],ini:"vertical",action:function(g,h){if(g!=h){var e=this,l="auto",c=e.getSubNode("ITEM",true),d=e.getSubNode("MOVE",true),k=e.getSubNode("CMD",true);d.merge(c).merge(k);if(g=="vertical"){d.replaceClass(/(-left)(\b)/ig,"-top$2");d.replaceClass(/(-right)(\b)/ig,"-bottom$2");c.each(function(m){xui(m).height(xui(m).width())}).css({left:0,top:l,right:l,bottom:l})}else{d.replaceClass(/(-top)(\b)/ig,"-left$2");d.replaceClass(/(-bottom)(\b)/ig,"-right$2");c.each(function(m){xui(m).width(xui(m).height())}).css({left:l,top:0,right:l,bottom:l})}var f=e.getRoot().cssSize();xui.UI.$tryResize(e,f.width,f.height,true)}}},dock:"fill",listKey:null,width:200,height:200,flexSize:{ini:false,action:function(){var d=this,c=d.getRoot();xui.UI.$tryResize(d,c.width(),c.height(),true)}},items:{ini:[],set:function(h){var l=this;if(l.renderId){var f=l.boxing(),c=xui.$getGhostDiv(),e=_.copy(l.children),k,g;l.children.length=0;_.arr.each(e,function(m){delete m[0].$dockParent;c.appendChild(m[0].getRootNode())});f.clearItems();g=l.box._adjustItems(h);f._insertItems(g,null,null,true);_.arr.each(e,function(m){f.append.apply(f,m)});c.innerHTML="";var d=l.getRoot().cssSize();xui.UI.$tryResize(l,d.width,d.height,true)}else{l.properties.items=_.copy(h)}}}},EventHandlers:{onClickPanel:function(c,d,f,g){}},_adjustItems2:function(d,e){var c=[];_.arr.each(d,function(f){if(f.id!="main"){c.push(f=_.isHash(f)?f:{id:""+f});f.pos=e}});_.arr.each(c,function(f){f.id=_.isStr(f.id)?f.id:_.id();f.min=f.min||10;f._size=f.size=parseInt(f.size,10)||80;f.locked=typeof f.locked=="boolean"?f.locked:false;f.folded=typeof f.folded=="boolean"?f.folded:false;f.hidden=typeof f.hidden=="boolean"?f.hidden:false;f.cmd=typeof f.cmd=="boolean"?f.cmd:true});return c},_adjustItems:function(d){var c,e=[],f=[];_.arr.each(d,function(g){g=_.copy(g);if(g.id=="main"){c=g}else{if(g.pos=="before"){e.push(g)}else{g.pos="after";f.push(g)}}});c=c||{};c.id="main";c.min=c.min||10;c.size=parseInt(c.size,10)||80;d.length=0;_.arr.insertAny(d,this._adjustItems2(e,"before"));_.arr.insertAny(d,c);_.arr.insertAny(d,this._adjustItems2(f,"after"));return d},_prepareData:function(c){var d=c.properties;if(!d.items||!_.isArr(d.items)){d.items=_.clone([{id:"before",pos:"before",locked:false,size:60,min:50,max:200},{id:"after",pos:"after",locked:false,size:60,min:50,max:200}])}d.items=this._adjustItems(d.items);return arguments.callee.upper.call(this,c)},_prepareItems:function(d,c){var e=arguments.callee.upper.apply(this,arguments);_.arr.each(c,function(f){delete f.caption});return e},_prepareItem:function(d,f,e){var g=d.properties,c;if(f.id=="main"){f.cls1=d.getClass("ITEM","-main");f.cls2=d.getClass("MOVE","-main");f.cls3=d.getClass("CMD","-main")}else{if(g.type=="vertical"){f._size="height:"+f._size+"px"}else{f._size="width:"+f._size+"px"}var h;if(g.type=="vertical"){f.clsmovebg="xui-uiborder-tb";if(f.pos=="before"){h="top"}else{h="bottom"}}else{f.clsmovebg="xui-uiborder-lr";if(f.pos=="before"){h="left"}else{h="right"}}f.cls1=d.getClass("ITEM","-"+h);f.cls2=d.getClass("MOVE","-"+h);f.cls3=d.getClass("CMD","-"+h);f.display=f.hidden?"display:none":"";f._cursor=f.locked?"default":(g.type=="vertical")?"n-resize":"w-resize";f.cmdDisplay=f.cmd?"":"display:none"}f._bginfo="";if(c=f.panelBgClr||g.panelBgClr){f._bginfo+="background-color:"+c+";"}if(c=f.panelBgImg||g.panelBgImg){f._bginfo+="background-image:url("+xui.adjustRes(c)+");"}if(c=f.panelBgImgPos||g.panelBgImgPos){f._bginfo+="background-position:"+c+";"}if(c=f.panelBgImgRepeat||g.panelBgImgRepeat){f._bginfo+="background-repeat:"+c+";"}if(c=f.panelBgImgAttachment||g.panelBgImgAttachment){f._bginfo+="background-attachment:"+c+";"}if(_.isStr(f.overflow)){f._overflow=f.overflow.indexOf(":")!=-1?(f.overflow):(f.overflow?("overflow:"+f.overflow):"")}else{if(_.isStr(g.overflow)){f._overflow=g.overflow.indexOf(":")!=-1?(g.overflow):(g.overflow?("overflow:"+g.overflow):"")}}},RenderTrigger:function(){var c,d=this;_.arr.each(d.properties.items,function(e){if(e.id!="main"){if(e.folded&&(c=d.getSubIdByItemId(e.id))){e.folded=false;d.getSubNode("CMD",c).onMousedown()}}})},_onresize:function(e,d,w){var x=e.properties,q,u=e.keys.ITEM,c=e.keys.PANEL,f=e.getSubNode("MOVE",true),h=e.getItemByItemId("main"),m=h.min||10,k=xui.UI.$getCSSValue("setting-xui-layout","width"),r=x.flexSize,n=0;var l={},g={};_.arr.each(x.items,function(y){q=e.getSubIdByItemId(y.id);l[q]={};g[q]={};if(r){n+=y.size||80}});var p=function(y,J,A,D,L,F,I){var N,C,O,H,B=0,z=0,M=0,K=0,E=F;_.arr.each(y.items,function(P){if(P.id=="main"){return}if(P.pos=="before"){H=e.getSubIdByItemId(P.id);if(P.hidden){C=0;g[H][A]=r?parseInt(J*Math.min(1,(P.size/n)),10):P._size}else{if(P.folded){C=g[H][A]=k}else{K++;C=O=r?parseInt(J*Math.min(1,(P.size/n)),10):P._size;if(C>F+P.min){C-=F}else{F=C-P.min;C=P.min}C-=I;C=Math.max(C,k)}}g[H][D]=B;B+=C;l[H][D]=0;l[H][A]=C-k;g[H][L]=l[H][L]="auto";g[H][A]=C;m+=k}});_.arr.each(y.items,function(P){if(P.id=="main"){return}if(P.pos=="after"){H=e.getSubIdByItemId(P.id);if(P.hidden){C=0;g[H][A]=r?parseInt(J*Math.min(1,(P.size/n)),10):P._size}else{if(P.folded){C=g[H][A]=k}else{K++;C=O=r?parseInt(J*Math.min(1,(P.size/n)),10):P._size;if(C>F+P.min){C-=F}else{F=C-P.min;C=P.min}C-=I;C=Math.max(C,k)}}g[H][L]=z;z+=C;l[H][L]=0;l[H][A]=C-k;g[H][D]=l[H][D]="auto";g[H][A]=C;m+=k}},null,true);M=B+z;if(J-M>=m||I){N=e.getSubIdByItemId("main");g[N][A]=l[N][A]=J-M;g[N][D]=B}else{var G=_.toArr(arguments);if(!E){G[G.length-2]=(m-(J-M))/K}else{G[G.length-2]=E;G[G.length-1]=(m-(J-M))/K}p.apply(null,G)}};if(x.type!="vertical"){if(!_.isNull(d)){p(x,d,"width","left","right",0,0)}if(!_.isNull(w)){_.each(l,function(y,z){g[z].height=y.height=w})}}else{if(!_.isNull(w)){p(x,w,"height","top","bottom",0,0)}if(!_.isNull(d)){_.each(l,function(y,z){g[z].width=y.width=d})}}_.each(g,function(y,z){e.getSubNode("PANEL",z).cssRegion(l[z],true);e.getSubNode("ITEM",z).cssRegion(g[z])})}}});Class("xui.UI.TreeGrid",["xui.UI","xui.absValue"],{Instance:{activate:function(){var d=this.get(0),c;if(!d.renderId){return}d.getSubNode("ROWS22").nextFocus(true,true,true);return this},_setCtrlValue:function(c){return this.each(function(e){if(!e.renderId){return}if(e.properties.activeMode=="none"){return}var l=e.boxing(),q=l.getUIValue(),d=e.properties,h=e.rowMap,f=d.activeMode=="row"?["CELLS1","CELLS2"]:"CELL",g=function(p,r){return e.getSubNodes(p,r)},m=function(k){var u=e.rowMap2;if(d.activeMode=="row"){return u[k]}else{if(!k){return}var p=(""+k).split("|");return _.get(e.rowMap,[u[p[0]],"_cells",p[1]])}};if(d.selMode=="single"){var n=m(q);if(q&&n){g(f,n).tagClass("-checked",false)}n=m(c);if(n){g(f,n).tagClass("-checked")}}else{if(d.selMode=="multi"||d.selMode=="multibycheckbox"){q=q?(""+q).split(d.valueSeparator):[];c=c?(""+c).split(d.valueSeparator):[];_.arr.each(q,function(p,k){p=m(p);if(k=h[p]){delete k._selected}g(f,p).tagClass("-checked",false)});_.arr.each(c,function(k){k=m(k);if(i=h[k]){i._selected=1}g(f,k).tagClass("-checked")});if(c.length===0){g("HFMARK").tagClass("-checked",false);delete e._$checkAll}}}})},_insertRowsToDom:function(d,c,q,e,p,z){if(q){var h=d.rowMap[q];if(h&&!h._inited){return}}if(!c){c=[]}var w,r,A,k=d.box,A=d.getSubNode("FHCELL").width();_.arr.each(c,function(l){l._row0DfW=A?("width:"+A+"px"):"";_.arr.each(l.cells,function(C,D){C.width=C._col._pxWidth})});if(d.properties.freezedRow){var n=d.getSubNode("ROWS12");if(!n.isEmpty()&&n.query("div","id",/-ROWS12\:/).isEmpty()){delete d._passFreezedRow}}var g=d._buildItems("rows21",c),f=d._buildItems("rows22",c);if(z&&z.length){var m=[],y=[];_.arr.each(z,function(l){if(k.getCellOption(d,l,"editable")&&k.getCellOption(d,l,"editMode")=="inline"){m.push(l)}});z.length=0;if(m.length){for(var x=0,u=m.length,n;x<u;x++){n=parseInt(x/25,10);if(!y[n]){y[n]=[]}y[n].push(m[x])}m.length=0;var B=function(){if(y.length){var D=y.shift();if(D&&D.length){for(var E=0,C=D.length;E<C;E++){if(d&&d.box&&!d.destroyed&&D[E]&&D[E]._row){d.box._editCell(d,D[E])}}_.asyRun(B)}}else{y=null}};B()}}if(!e){if(q){w=d.getSubNode("SUB1",q);r=d.getSubNode("SUB2",q)}else{w=d.getSubNode("ROWS21");r=d.getSubNode("ROWS22")}if(p){w.prepend(g);r.prepend(f)}else{w.append(g);r.append(f)}}else{w=d.getSubNode("ROW1",e);r=d.getSubNode("ROW2",e);if(p){w.addPrev(g);r.addPrev(f)}else{w.addNext(g);r.addNext(f)}}_.arr.each(c,function(l){l.open=false;if(false===k.getCellOption(d,l,"iniFold")){d.boxing()._toggleRows([l],true)}});delete d.$allrowscache1;delete d.$allrowscache2;d.box._adjustBody(d,"addrow")},_refreshHeader:function(d){var c=this.get(0),m=c.properties,e=c.box,n=_.clone(m.grpCols,false,2),f,g,p=this.getRows("data");_.breakO(c.colMap,2);d=e._adjustHeader(d||[]);f=e._prepareHeader(c,d);m.header=d;this.removeAllRows();c.getSubNode("HCELL",true).remove();var l,k;if(f.length){l=c._buildItems("header1",f);c.getSubNode("HCELLS1").append(l);k=c._buildItems("header2",f);c.getSubNode("LHCELL").addPrev(k)}if(n&&_.isArr(n)&&n.length>0){n=e._adjustGrpColsData(c,n);m.grpCols=n;g=e._prepareGrpCols(c,n,f);if(g&&g.length){l=c._buildItems("grpCols1",g);c.getSubNode("GRPCELLBOX1").append(l);k=c._buildItems("grpCols2",g);c.getSubNode("GRPCELLBOX2").append(k)}e._adjustColsWidth(c);e._adjustColsHeight(c);xui.UI.$tryResize(c,c.getRoot().width(),c.getRoot().height(),true)}if(p&&p.length){this.setRows(p)}e._adjustBody(c,"addcol");var h=c.properties.colOptions;_.arr.each(f,function(q){if(_.isFun(q.colRenderer||h.colRenderer)){(q.colRenderer||h.colRenderer).call(null,c,q)}});if(c.$col_pop){c.$col_pop.destroy(true);delete c.$col_pop}_.each(c.$cache_editor,function(q){if(!q.destroyed){q.destroy(true)}});c.$cache_editor={}},_toggleRows:function(e,d){var c=this;if(e&&e.length){_.arr.each(e,function(f){c.toggleRow(f.id,d)})}},autoRowHeight:function(c){return this.each(function(e){if(e.renderId){var d=xui.Event;if(d.__realtouch){d.__simulatedMousedown=1}if(c&&e.rowMap2[c]){e.getSubNode("FHANDLER",e.rowMap2[c]).onDblclick(true)}else{_.each(e.rowMap,function(g,f){e.getSubNode("FHANDLER",f).onDblclick(true)})}if(d.__realtouch){d.__simulatedMousedown=0}}})},autoColWidth:function(c){return this.each(function(e){if(e.renderId){var d=xui.Event;if(d.__realtouch){d.__simulatedMousedown=1}if(c&&e.colMap2[c]){e.getSubNode("HHANDLER",e.colMap2[c]).onDblclick(true)}else{_.each(e.colMap,function(g,f){e.getSubNode("HHANDLER",f).onDblclick(true)})}if(d.__realtouch){d.__simulatedMousedown=0}}})},autoColHeight:function(){return this.each(function(d){if(d.renderId){var c=xui.Event;if(c.__realtouch){c.__simulatedMousedown=1}d.getSubNode("FHANDLER").onDblclick(true);if(c.__realtouch){c.__simulatedMousedown=0}}})},addHotRow:function(c){var d=this.get(0);if(d.renderId){d.box._addTempRow(d,c||null)}return this},removeHotRow:function(){var c=this.get(0);c.box._sethotrowoutterblur(c,true);delete c.__hastmpRow;this.removeRows([c.box._temprowid],false);return this},isDirtied:function(){var c=false;_.each(this.get(0).cellMap,function(d){if(d._oValue!==d.value){c=true;return false}});_.each(this.get(0).rowMap,function(d){if(d._oValue!==d.value){c=true;return false}});return c},_getObjByDom:function(f,d){var e=this.get(0),c=e.getSubId(typeof f=="string"?f.charAt(0)=="!"?((f=xui.use(f).get(0))&&f.id):f:f.id);return e[d=="row"?"rowMap":d=="col"?"colMap":"cellMap"][c]},getRowByDom:function(d,c){return this.get(0).box._getRow(this.get(0),this._getObjByDom(d,"row"),c)},getHeaderByDom:function(c){return this._getObjByDom(c,"col")},getCellByDom:function(c){return this._getObjByDom(c,"cell")},getRows:function(f){var e=this.get(0).properties.rows,d,c;if(!_.isArr(e)){return[]}if(f=="data"||f=="min"||f=="map"){d=_.clone(e,true);if(d&&d.length&&d[d.length-1]&&d[d.length-1].id==this.constructor._temprowid){d.pop()}if(f=="min"){_.arr.each(d,function(h,g){if(d[g].cells){_.each(c=d[g]=(d[g].cells||d[g]),function(k,l){c[l]=k.value})}})}return d}else{return e}},getRowbyRowId:function(g,f){var e=this.get(0),c=e.rowMap2,d;if(_.isNumb(g)){g=_.get(e.properties.rows,[g,"id"])}if(c&&c[g]){return e.box._getRow(e,e.rowMap[c[g]],f)}if((c=e.queryItems(e.properties.rows,function(l,h){return l.id==g},1,1))&&c.length){return e.box._getRow(e,c[0],f)}},getRowbyCell:function(c,d){return this.constructor._getRow(this.get(0),c._row,d)},toggleRow:function(f,d){var c=this.get(0),e=c.rowMap[c.rowMap2[f]];if(e&&e.sub){c.box._setSub(c,e,typeof d=="boolean"?d:!e._checked)}return this},updateRow:function(r,n,p,k){var J=this,G=J.getRowbyRowId(r);if(!G){return J}var m=J.get(0),u=m.box,l=m.properties,D=l.dirtyMark,d=D&&l.showDirtyMark,F=G.id==u._temprowid,g=xui.absObj.$specialChars,q;if(!_.isHash(n)){n={value:n}}n=_.filter(n,function(M,K,L){L=!g[K.charAt(0)]||K=="_$caption";if(!L){q=q||{};q[K]=M}return L});if(k){if(m.beforeRowUpdated&&false===m.boxing().beforeRowUpdated(m,G,n,F,q)){return}}if(!_.isEmpty(n)){if(G){var C=G._serialId,y,c,w;if(_.isSet(n.id)){n.id+=""}if(n.id&&n.id!==r){w=n.id;var f=m.rowMap2,x;if(!f[w]){if(x=f[r]){f[w]=x;delete f[r];m.rowMap[x].id=w;_.each(m.colMap,function(K){if(K=K._cells){K[w]=K[r];delete K[r]}})}}}else{n.id=r}if(_.isEmpty(n)){return J}if(("group" in n&&n.group!=G.group)||"cells" in n||("sub" in n&&!((n.sub===true&&!G.sub)||(!n.sub&&G.sub===true)))){var A="__special",z=G._pid?m.rowMap[G._pid].id:null;G.id=A;m.rowMap2[A]=m.rowMap2[w||r];delete m.rowMap2[w||r];_.each(m.colMap,function(K){if(K=K._cells){delete K[w||r]}});G=_.clone(G,true);_.merge(G,n,"all");if("sub" in n&&!n.sub){delete G.sub}J.insertRows([G],z,A,true);J.removeRows([A]);if(m.properties.activeMode=="row"){var I=m.properties.$UIvalue||"",e=(""+I).split(m.properties.valueSeparator);if(e.length&&_.arr.indexOf(e,r)!=-1){if(w){_.arr.removeValue(e,r)}J.setUIValue(e.join(m.properties.valueSeparator),true,null,"sub")}}}else{if("sub" in n){y=u._getToggleNode(m,C);if(n.sub){y.addClass("xui-uicmd-toggle2");if(G._layer){y.removeClass("xui-uicmd-empty")}}else{y.removeClass("xui-uicmd-toggle2");if(G._layer){y.addClass("xui-uicmd-empty")}}}c=J.getSubNodes(["CELLS1","CELLS2"],C);if(y=n.height){m.box._adjusteditorH(m,c.height(G._height=y),y)}if(y=n.rowStyle){c.attr("style",c.attr("style")+";"+y)}if(y=n.rowClass){c.addClass(y)}if(n.hasOwnProperty("disabled")){var h=m.getClass("CELLS2","-disabled");if(n.disabled){c.addClass(h)}else{c.removeClass(h)}}if(n.hasOwnProperty("readonly")){var h=m.getClass("CELLS2","-readonly");if(n.readonly){c.addClass(h)}else{c.removeClass(h)}}if(y=n.firstCellStyle){(c=J.getSubNode("FCELL",C)).first().attr("style",c.attr("style")+";"+y)}if(y=n.firstCellClass){J.getSubNode("FCELL",C).first().addClass(y)}if(n.hasOwnProperty("value")&&!n.hasOwnProperty("caption")){n.caption=n.value+""}if(n.hasOwnProperty("caption")){J.getSubNode("FCELLCAPTION",C).get(0).innerHTML=n.caption}if(n.hasOwnProperty("rowResizer")){y=!!n.rowResizer;J.getSubNode("FHANDLER",C).css("display",(n.rowResizer=y)?"block":"none")}if(n.hasOwnProperty("hidden")){var H=!!n.hidden;if(H){if(G.hidden!==true){J.getSubNodes(["ROW1","ROW2"],C).css("display","none")}}else{if(G.hidden===true){J.getSubNodes(["ROW1","ROW2"],C).css("display","")}}}_.merge(G,n,"all");if(n.hasOwnProperty("value")){var B=m.getSubNode("CELLA",C);if(!D||p===false){G._oValue=G.value}else{if(G.value===G._oValue){if(d){B.removeClass("xui-ui-dirty")}delete G.dirty}else{if(d){B.addClass("xui-ui-dirty")}G.dirty=true}}if(G._editor){G._editor.setValue(n.value,true,"editorini")}}}}else{var E=J.get(0).queryItems(J.getRows(),function(K){return typeof K=="object"?K.id===r:K==r},true,true,true);if(E.length){_.merge(G=E[0][0],n,"all")}}}if(k){if(m.afterRowUpdated){m.boxing().afterRowUpdated(m,G,n,F,q)}}return J},insertRows:function(m,l,d,w){var e=arguments[4],r=this.constructor,g=this.get(0);if(_.isHash(m)){m=[m]}if(m&&_.isArr(m)&&m.length>0){var x=g.properties,f=g.rowMap2,p=x.rowOptions,u=g.rowMap,n,y,h;l=f&&f[l];d=f&&f[d];if(d){y=g.rowMap[d];if(y){l=y._pid}}m=r._adjustRows(g,m);if(!l){n=_.isArr(x.rows)?x.rows:(x.rows=[])}else{h=u&&u[l];n=_.isArr(h.sub)?h.sub:(h.sub=[])}var z;if(g.renderId){if(!l||h._inited){temp=[];z=r._prepareItems(g,m,l,temp);this._insertRowsToDom(g,z,l,d,w,temp);_.arr.each(m,function(c){if(_.isFun(c.rowRenderer||p.rowRenderer)){(c.rowRenderer||p.rowRenderer).call(null,g,c)}})}}if(!d){_.arr.insertAny(n,m,w?0:-1)}else{var q=_.arr.subIndexOf(n,"_serialId",d);_.arr.insertAny(n,m,w?q:(q+1))}if(g.renderId){g.box._asy(g)}if(z&&z.length){_.breakO(z,2);z.length=0}}if(e!==false&&g.renderId&&g.__hastmpRow){g.box.__ensurehotrow(g,null)}return this},removeRows:function(c){var f=arguments[1],m=this,g=m.get(0),e=g.properties,l=g.cellMap,d=[],k,h=0;c=_.isArr(c)?c:(c+"").split(e.valueSeparator);_.arr.each(c,function(p,n){c[n]=""+p});_.arr.each(c,function(x){if(x=g.rowMap2[x]){h++;var w;if(w=g.rowMap[x]){var q=w._cells,r=w.id,p;if(w.sub&&_.isArr(w.sub)){var n=[];_.arr.each(w.sub,function(y){n.push(y.id)});m.removeRows(n)}_.each(q,function(z,y){delete l[z]._col._cells[r];_.breakO(l[z]);delete l[z];g.reclaimSubId(z.slice(3),"cell")});if(p=w._pid?(p=g.rowMap[w._pid])?p.sub:null:g.properties.rows){if(_.isArr(p)){_.filter(p,function(y){return y._serialId!=x})}}delete g.rowMap2[r];_.breakO(g.rowMap[x]);delete g.rowMap[x];d.push(g.getSubNode("ROW1",x).get(0));d.push(g.getSubNode("ROW2",x).get(0))}g.reclaimSubId(x.slice(3),"row")}else{var u=function(z){var y=_.arr.subIndexOf(z,"id",x);if(y!==-1){_.arr.removeFrom(z,y)}_.arr.each(z,function(A){if(A.sub){u(A.sub)}})};u(e.rows)}});if(h>0){if(k=e.$UIvalue){if((k=(""+k).split(e.valueSeparator)).length>1){_.filter(k,function(n){return _.arr.indexOf(c,n)==-1});e.$UIvalue=k.join(e.valueSeparator)}else{if(_.arr.indexOf(c,e.$UIvalue)!=-1){e.$UIvalue=null}}}xui(d).remove();if(g.$activeCell&&!xui.Dom.byId(g.$activeCell)){delete g.$activeCell}if(g.$activeRow&&!xui.Dom.byId(g.$activeRow)){delete g.$activeRow}delete g.$allrowscache1;delete g.$allrowscache2;g.box._asy(g);g.box._adjustBody(g,"delrow")}if(f!==false&&g.renderId&&g.__hastmpRow){g.box.__ensurehotrow(g,null)}return m},insertCol:function(l,h,p){var g=this.get(0),f=g.properties,x=g.box,w=f.rows,d,n,C,B;p=_.isNumb(p)?p:-1;if(p===-1||f.header.length<p){p=f.header.length}if(p<0){p=0}if(f.treeMode=="infirstcell"&&p===0){return false}var r=p<=f.freezedColumn-1;var c=f.grpCols;if(c&&_.isArr(c)&&c.length){for(var A=0,y=c.length,u;A<y;A++){u=c[A];if(u.from>p){u.from++;u.to++}else{if(p>=u.from&&p<=u.to){u.to++}}}}if(g.renderId){C=x._parepareCol(g,l,f.header);l=C[0];_.arr.insertAny(f.header,l,p);n=g.getSubNode(r?"HCELLS1":"HCELLS2").children().get(p);if(n){xui(n).addNext(g._buildItems(r?"header1":"header2",[C[1]]))}var q=g.properties.colOptions;if(_.isFun(l.colRenderer||q.colRenderer)){(l.colRenderer||q.colRenderer).call(null,g,l)}f.grpCols=x._adjustGrpColsData(g,c);x._adjustColsWidth(g);x._adjustColsHeight(g);x._adjustBody(g,"addcol")}else{_.arr.insertAny(f.header,l,p)}h=_.isArr(h)?h:[];var z=0,e=function(m){var k=[];_.arr.each(m,function(E,D){if(E.group){e(E.sub)}else{d=h[z];n=g.getSubNode(r?"CELLS1":"CELLS2",E._serialId).children().get(p);if(n){B=x._parepareCell(g,d,E,l,k);_.arr.insertAny(E.cells,B[0],p);xui(n).addNext(g._buildItems(r?"rows21.cells":"rows22.cells",[B[1]]))}else{_.arr.insertAny(E.cells,d||{},p)}}z++});if(k.length){_.arr.each(k,function(D){if(x.getCellOption(g,D,"editable")&&x.getCellOption(g,D,"editMode")=="inline"){x._editCell(g,D)}});k.length=0}};if(w&&_.isArr(w)){e(w)}},removeCols:function(c){var f=arguments[1],q=this,h=q.get(0),l=h.box,e=h.properties,n=h.cellMap,g=xui.UI.$tag_subId,d=[],m=0;c=_.isArr(c)?c:(c+"").split(e.valueSeparator);_.arr.each(c,function(r,p){c[p]=""+r});if(c&&c.length>1){c.sort(function(p,w){var r=_.arr.indexOf(e.header,p);if(r==-1){r=_.arr.subIndexOf(e.header,"id",p)}var u=_.arr.indexOf(e.header,w);if(u==-1){u=_.arr.subIndexOf(e.header,"id",w)}return r>u?1:r===u?0:-1})}var k=e.grpCols;if(k&&_.isArr(k)&&k.length){_.arr.each(c,function(x){var w=_.arr.indexOf(e.header,x);if(w==-1){w=_.arr.subIndexOf(e.header,"id",x)}if(w==-1){return}for(var u=0,r=k.length,p;u<r;u++){p=k[u];if(p.from>w){p.from--;p.to--}else{if(w>=p.from&&w<=p.to){p.to--}}}},null,true);_.filter(k,function(u){var p=u.to>=u.from;if(!p&&h.renderId){h.getSubNode("HCELL",u[g]).remove();delete h.colMap[u[g]];delete h.colMap2[u.id]}return p})}_.arr.each(c,function(y){var r=_.arr.indexOf(e.header,y);if(r==-1){r=_.arr.subIndexOf(e.header,"id",y)}if(r==-1){return}if(h.colMap2&&(y=h.colMap2[y])){m++;var p;if(p=h.colMap[y]){var x=p._cells,u=p.id;_.each(x,function(A,z){d.push(h.getSubNode("CELL",A).get(0));delete n[A]._row._cells[u];_.breakO(n[A]);delete n[A];h.reclaimSubId(A.slice(3),"cell")});delete h.colMap2[u];_.breakO(h.colMap[y]);delete h.colMap[y];d.push(h.getSubNode("HCELL",y).get(0))}h.reclaimSubId(y.slice(3),"header")}var w=function(z){_.arr.each(z,function(A){if(A.cells){_.arr.removeFrom(A.cells,r)}if(A.sub){w(A.sub)}})};w(e.rows);_.arr.removeFrom(e.header,r)},null,true);if(m>0){xui(d).remove();if(h.$activeCell&&!xui.Dom.byId(h.$activeCell)){delete h.$activeCell}e.grpCols=l._adjustGrpColsData(h,k);l._adjustColsWidth(h);l._adjustColsHeight(h);l._adjustBody(h,"delcol")}return q},removeAllRows:function(){var e=arguments[0],d=this.get(0),f=d.box,g=d.properties;if(!g.rows||g.rows.length<0){return this}for(var c in d.cellMap){d.reclaimSubId(c.slice(3),"cell")}for(var c in d.rowMap){d.reclaimSubId(c.slice(3),"row")}_.each(d.colMap,function(h){h._cells={}});_.breakO([d.rowMap,d.cellMap],3);d.rowMap={};d.cellMap={};d.rowMap2={};delete d.$activeCell;delete d.$activeRow;d.properties.rows.length=0;if(d.renderId){if(d.$sl!=0){d.getSubNode("HEADER2").get(0).scrollLeft=d.$sl=0}d.getSubNodes(["SCROLL21","SCROLL22"]).scrollTop(0).scrollLeft(0);d.getSubNodes(["ROWS21","ROWS22"]).empty()}delete d.$allrowscache1;delete d.$allrowscache2;d.properties.$UIvalue=null;if(e!==false&&d.renderId&&d.__hastmpRow){f.__ensurehotrow(d,null)}f._adjustBody(d,"delrow");return this},resetRowValue:function(e){var d=this.get(0),f=this.getRowbyRowId(e),c=[],g=d.properties;_.arr.each(f.cells,function(h){if(h._oValue!==h.value){h._oValue=h.value;delete h.dirty;if(g.dirtyMark){c.push(d.getSubNode("CELLA",h._serialId).get(0))}}});f._oValue=f.value;delete f.dirty;if(g.dirtyMark){c.push(d.getSubNode("CELLA",f._serialId).get(0))}if(g.dirtyMark&&g.showDirtyMark){xui(c).removeClass("xui-ui-dirty")}},resetColValue:function(f){var e=this.get(0),d=this.getHeaderByColId(f),c=[],g=e.properties;_.arr.each(d.cells,function(h){if(h._oValue!==h.value){h._oValue=h.value;delete h.dirty;if(g.dirtyMark){c.push(e.getSubNode("CELLA",h._serialId).get(0))}}});if(g.dirtyMark&&g.showDirtyMark){xui(c).removeClass("xui-ui-dirty")}},getActiveRow:function(e){var c,d=this.get(0);if(d.properties.activeMode!="row"){return}if(!(c=d.$activeRow)){return}c=d.rowMap[d.getSubId(c)];if(c&&c.id&&c.id==d.box._temprowid){c=null}return d.box._getRow(d,c,e)},setActiveRow:function(e){var d,f,c=this.get(0);if(c.properties.activeMode!="row"){return}c.box._activeRow(c,false);if(!(f=this.getRowbyRowId(e))){return}if(!(d=c.getSubNodes(["CELLS1","CELLS2"],f._serialId)).isEmpty()){c.box._activeRow(c,d.get(0).id)}return this},getRowMap:function(h){var e=this.get(0),c=e.boxing(),g=e.properties,d,f;if(!_.isSet(h)&&e.renderId&&!e.destroyed){if(g.activeMode="row"){if(d=c.getActiveRow()){h=d.id}}else{if(g.activeMode="cell"){if(d=c.getActiveCell()){h=d._row.id}}}}return c.getRowbyRowId(h,"map")},setRowMap:function(f,e,d,c){return this.each(function(k){var g=k.boxing(),m=k.properties,h;if(!_.isSet(l)&&k.renderId&&!k.destroyed){if(m.activeMode="row"){if(h=g.getActiveRow()){l=h.id}}else{if(m.activeMode="cell"){if(h=g.getActiveCell()){l=h._row.id}}}}if(l){var n=g.getRowbyRowId(l),l=n.id,q=g.getHeader("min");_.arr.each(n.cells,function(r,p){g.updateCellByRowCol(l,q[p],f[q[p]],d,c)})}m.rowMap=f})},getHeader:function(f){var e=this.get(0).properties.header;if(!_.isArr(e)){return[]}if(f=="data"){return _.clone(e,true)}else{if(f=="min"){var d=_.clone(e,true),c;_.arr.each(d,function(h,g){d[g]=h.id});return d}else{return e}}},getHeaderByColId:function(f,e){var c=this.get(0).properties.header,d;if(_.isNumb(f)){f=_.get(profile.properties.header,[f,"id"])}d=_.arr.subIndexOf(c,"id",f);return d==-1?null:e=="data"?_.clone(c[d],true):e=="min"?c[d].id:c[d]},getHeaderByCell:function(c,e){var d=c._col;return !d?null:e=="data"?_.clone(d,true):e=="min"?d.id:d},updateHeader:function(c,u){var p=this,f=p.get(0),e=p.getHeaderByColId(c),q;if(!e){var g=f.properties.grpCols,h=_.arr.subIndexOf(g,"id",c);e=g[h];q=true}if(e){if(typeof u!="object"){u={caption:u+""}}else{_.filter(u,true)}delete u.id;if(f.renderId){var m=e._serialId,r,k;if(!q){if(r=u.width){var d=[];d.push(p.getSubNode("HCELL",m).get(0));_.each(e._cells,function(n){d.push(p.getSubNode("CELL",n).get(0))});f.box._adjusteditorW(f,xui(d).width(e._pxWidth=r),r);p.getSubNode("SCROLL22").onScroll();p.constructor._adjustColsWidth(p.get(0));p.constructor._adjustBody(p.get(0),"setcol")}if(u.hasOwnProperty("visibility")&&!u.hasOwnProperty("hidden")){u.hidden=!u.visibility}if("hidden" in u){var l=!!u.hidden;if(l){if(e.hidden!==true){p.showColumn(c,false)}}else{if(e.hidden===true){p.showColumn(c,true)}}}if("type" in u){delete e.editorCacheKey}}if(r=u.headerStyle||u.colStyle){(k=p.getSubNode("HCELLA",m)).attr("style",k.attr("style")+";"+r)}if(r=u.headerClass){p.getSubNode("HCELLA",m).addClass(r)}if(u.hasOwnProperty("caption")){p.getSubNode("HCELLCAPTION",m).get(0).innerHTML=u.caption}if("colResizer" in u){r=!!u.colResizer;p.getSubNode("HHANDLER",m).css("display",(u.colResizer=r)?"block":"none")}}_.merge(e,u,"all");if("flexSize" in u){xui.UI.$tryResize(f,f.getRoot().width(),f.getRoot().height(),true)}}},showColumn:function(e,k){var h=this.get(0),c=h.colMap2,l=h.colMap,g,d,m,f=[];if(g=l[d=c[e]]){if(h.beforeColShowHide&&false===h.boxing().beforeColShowHide(h,e,k)){return false}f.push(h.getSubNode("HCELL",d).get(0));_.each(g._cells,function(n){f.push(h.getSubNode("CELL",n).get(0))});xui(f).css("display",(g.hidden=(k===false?true:false))?"none":"");if(h.afterColShowHide){h.boxing().afterColShowHide(h,e,k)}}h.box._adjustColsWidth(h);h.box._adjustBody(h,"setcol");return true},sortColumn:function(e,h,g){var f=this.get(0),d=f.colMap2[e],c=f.colMap[d];if(d&&c){if(_.isBool(h)){c._order=!h}if(_.isFun(g)){c.sortby=g}f.getSubNode("HCELLA",d).onClick()}return this},getCell:function(h,g){var e=this,f=this.get(0),d,c;_.each(f.cellMap,function(k){if(k.id&&k.id===h){h=k._serialId;return false}});d=f.cellMap[h];return !d?null:g=="data"?_.merge({rowId:d._row.id,colId:d._col.id},_.clone(d,true)):g=="min"?d.value:g=="map"?((c={})&&((c[d._col.id]=d.value)||1)&&c):d},getCellbyRowCol:function(e,c,k){var n=this,f=n.get(0),l,g;if(_.isNumb(e)){e=_.get(f.properties.rows,[e,"id"])}if(_.isNumb(c)){c=_.get(f.properties.header,[c,"id"])}l=_.get(f.rowMap,[f.rowMap2[e],"_cells",c]);l=l&&f.cellMap[l];if(!l){var p=n.getRowbyRowId(e),h=n.getHeader("min"),d;if(p&&p.cells){d=_.arr.indexOf(h,c);if(d!=-1){l=p.cells[d]}}}return !l?null:k=="data"?_.merge({rowId:e,colId:c},_.clone(l,true)):k=="min"?l.value:k=="map"?((g={})&&((g[c]=l.value)||1)&&g):l},getCells:function(f,d,c){var e={};_.each(this.get(0).cellMap,function(g){if((f?(f==g._row.id):1)&&(d?(d==g._col.id):1)){e[g.id]=c=="data"?_.merge({rowId:g._row.id,colId:g._col.id},_.clone(g,true)):c=="min"?g.value:g}});return e},updateCellByRowCol:function(f,d,p,k,h){var l,m=this,c=m.constructor;if(l=c._getCellId(m.get(0),f,d)){c._updCell(m.get(0),l,p,k,h)}else{var n=m.getRowbyRowId(f),g=m.getHeader("min"),e;if(n&&n.cells){e=_.arr.indexOf(g,d);if(e!=-1){if(!_.isHash(n.cells[e])){n.cells[e]={value:n.cells[e]}}_.merge(n.cells[e],p)}}}return m},updateCellByRowCol2:function(f,e,h,g){var c=f.split(":"),k=parseInt(c[0],10),d=parseInt(c[1],10);return this.updateCellByRowCol(k,d,e,h,g)},updateCell:function(f,d,h,g){var c=this,e=this.get(0);_.each(e.cellMap,function(k){if(k.id&&k.id===f){f=k._serialId;return false}});c.constructor._updCell(e,f,d,h,g);return c},editCellbyRowCol:function(f,e){var d=this.get(0),c=d.box;c._editCell(d,c._getCellId(d,f,e));return this},editCell:function(c){this.constructor._editCell(this.get(0),c);return this},editFirstCell:function(f){var g=this.get(0),k=function(r){return g.box.getCellOption(g,q,r)},q=typeof f=="string"?(g.rowMap[g.rowMap2[f]]):f,l;if(!g.properties.firstCellEditable||!q){return}if(k(g,q,"disabled")||k(g,q,"readonly")){return}if(!(g&&g.renderId)||g.destroyed){return}var h=g.getSubNode("FCELLCAPTION",q._serialId);if(!h.isEmpty()){if(g.beforeIniEditor){l=g.boxing().beforeIniEditor(g,q,h,d,"row");if(l===false){return}}var d=h.parent(),p=d.cssSize(),e=g.getSubNode("BORDER"),c=h.offset(null,d),n=d.offset(null,e);if(n.left>p.width-8){return}l=g.$cache_editor.firstCellEditor;if(!l||!l["xui.UI"]||l.isDestroyed()){l=new xui.UI.ComboInput({type:"input"});g.$cache_editor.firstCellEditor=l}l.setWidth(p.width-c.left+2).setHeight(p.height+2).setValue(q.value||q.value||"");if(g.onBeginEdit){g.boxing().onBeginEdit(g,q,l,"row")}l.undo=function(){var r=this,u=r.get(0)&&r.get(0).$row;r.undo=null;if(g.box){if(u&&u._oValue!==u.value&&u.id!=g.box._temprowid&&g.onRowDirtied){g.boxing().onRowDirtied(g,u)}}if(r.get(0)&&r.get(0).box){r.getSubNode("INPUT").onBlur(true);r.getRoot().setBlurTrigger("tg_editor_blur:"+g.$xid);if(g.properties){r.afterUIValueSet(null).beforeNextFocus(null).onCancel(null);r.setValue("",true,"editorreset")}delete r.get(0).$row;delete r.get(0)._smartnav;r.setVisibility("hidden")}if(u){delete u._editor}g.$curEditor=null;if(g.onEndEdit){g.boxing().onEndEdit(g,u,r,"row")}if(r.get(0)){r.destroy(true)}r=null};l.afterUIValueSet(function(A,y,u,z,r){var w={value:u},x;if(A.properties.hasOwnProperty("tagVar")&&!_.isEmpty(x=A.properties.tagVar)){w.tagVar=x}if(false!==(g.beforeEditApply&&g.boxing().beforeEditApply(g,q,w,l,r,"row"))){g.boxing().updateRow(q.id,{value:u,caption:u+""});_.tryF(l.undo,[],l)}}).beforeNextFocus(function(w,u){_.tryF(l.undo,[true],l);var r=xui.Event.getEventPara(u);if(r.key=="enter"){r.key="right"}g.getSubNode("CELLA",q._serialId).onKeydown(true,r);return false}).onCancel(function(){_.tryF(l.undo,[],l)});e.append(l);l.reBoxing().show((c.left+n.left-1)+"px",(n.top-1)+"px");var m=l.getRoot();m.setBlurTrigger("tg_editor_blur:"+g.$xid,function(){_.tryF(l.undo,[],l);return false});l.get(0).$row=q;l.get(0)._smartnav=true;q._editor=l;g.$curEditor=l;l.activate()}return this},focusCellbyRowCol:function(h,f){var d=this.get(0),c=d.box,g=c._getCellId(d,h,f),e=d.getSubNode("CELLA",g);if(e&&e.get(0)){e.focus(true)}return this},focusCell:function(c){var d=c._serialId;this.get(0).getSubNode("CELLA",d).focus(true);return this},getActiveCell:function(g){var e,f=this.get(0),c,d;if(f.properties.activeMode!="cell"){return}if(!(e=f.$activeCell)){return}d=f.cellMap[f.getSubId(e)];return !d?null:g=="data"?_.merge({rowId:d._row.id,colId:d._col.id},_.clone(d,true)):g=="min"?d.value:g=="map"?((c={})&&((c[d._col.id]=d.value)||1)&&c):d},setActiveCell:function(g,e){var f,c,d=this.get(0);if(d.properties.activeMode!="cell"){return}d.box._activeCell(d,false);if(typeof g=="object"){c=g}else{c=this.getCellbyRowCol(g,e)}if(!c){return}if(!(f=d.getSubNode("CELL",c._serialId)).isEmpty()){d.box._activeCell(d,f.get(0).id)}return this},resetGridValue:function(){return this.each(function(c){var d=c.properties;_.each(c.cellMap,function(e){e._oValue=e.value;delete e.dirty});_.each(c.rowMap,function(e){e._oValue=e.value;delete e.dirty});if(d.dirtyMark&&d.showDirtyMark){c.getSubNode("CELLA",true).removeClass("xui-ui-dirty")}})},getDirtied:function(e,c){var d={};_.each(this.get(0).cellMap,function(f){if(f._oValue!==f.value&&(e?(e==f._row.id):1)&&(c?(c==f._col.id):1)){d[f.id]={rowId:f._row.id,colId:f._col.id,value:f.value,_oValue:f._oValue}}});return d},getSubNodeInGrid:function(d,g,f){var e=this,c=(g&&f)?e.getCellbyRowCol(g,f):f?e.getHeaderByColId(f):g?e.getRowbyRowId(g):null;return e.getSubNode(d,(c&&c._serialId)||true)},getEditor:function(){return _.get(this.get(0),["$curEditor"])},getEditCell:function(){return _.get(this.get(0),["$cellInEditor"])},offEditor:function(){var d=this.get(0),c;if(d&&d.$curEditor){c=d.$curEditor;_.tryF(c.undo,[],c)}},adjustEditor:function(f){var k=this,l=this.get(0);if(l&&l.$curEditor){var h=l.$curEditor,d=l.$cellInEditor;if(typeof f=="function"){f.apply(k,[h,d])}else{if(h.KEY=="xui.UI.ComboInput"){var e=l.getSubNode("CELL",d.id),c=e.offset(null,l.getSubNode("SCROLL22")),g=e.cssSize();h.setLeft(c.left-1).setTop(c.top-1).setWidth(g.width+3).setHeight(g.height+2).reLayout(true)}}}return k}},Before:function(d,c,e){this.Behaviors.CELLS1=this.Behaviors.CELLS2;this.Behaviors.GCELLA=this.Behaviors.CELLA;return arguments.callee.upper.apply(this,arguments)},Initialize:function(){this.addTemplateKeys(["ALT","PROGRESS"]);this.getCellPro=this.getCellOption;var c=this.prototype;c.getColumn=c.getHeader;c.updateColumn=c.updateHeader;c.getColByDom=c.getHeaderByDom;c.getColByColId=c.getHeaderByColId;c.getColByCell=c.getHeaderByCell},Static:{Templates:{tagName:"div",style:"{_style}",className:"{_className}",BORDER:{tagName:"div",BOX:{tagName:"table",cellspacing:"0",cellpadding:"0",className:"xui-uibg-content",TBODY:{tagName:"tbody",TRHEADER:{tagName:"tr",TDHEADER1:{tagName:"td",HEADER1:{tagName:"div",style:"{showHeader}",HI1:{tagName:"div",HCELLS1:{tagName:"div",style:"{headerHeight};",FHCELL:{$order:0,style:"{rowHandlerDisplay};{_row0DfW};height:{_hcellheight}px;",className:"{cellCls}",tabindex:"{_tabindex}",HCELLA:{style:"{firstCellStyle};",className:"xui-v-wrapper {firstCellClass}",HHANDLER:{tagName:"div",style:"{colDDDisplay}"},FHANDLER:{tagName:"div",style:"{rowDDDisplay}"},LTAGCMDS:{$order:1,tagName:"span",text:"{ltagCmds}"},HFMARK:{$order:2,className:"xui-uicmd-check",style:"{_rowMarkDisplay}"},GRIDCAPTION:{$order:2,text:"{gridHandlerCaption}"},SORT:{style:"{sortDisplay}"}}},OTHERHCELLS:{$order:1,tagName:"text",text:"{header1}"}},GRPCELLBOX1:{tagName:"div",style:"{headerHeight};",GRPCELLS:{$order:3,tagName:"text",text:"{grpCols1}"}}}}},TDHEADER2:{tagName:"td",HEADER2:{$order:0,tagName:"div",style:"{showHeader}",HI2:{tagName:"div",HCELLS2:{tagName:"div",style:"{headerHeight};",OTHERHCELLS:{$order:1,tagName:"text",text:"{header2}"},LHCELL:{$order:2,className:"xui-v-wrapper",RTAGCMDS:{$order:1,tagName:"span",text:"{rtagCmds}"}}},GRPCELLBOX2:{tagName:"div",style:"{headerHeight};",GRPCELLS:{$order:3,tagName:"text",text:"{grpCols2}"}}}}}},TRLOCKED:{tagName:"tr",TDBODY11:{tagName:"td",SCROLL11:{$order:1,tagName:"div",className:"{_rowfreezed} {_columnfreezed}",BODY11:{tagName:"div",ROWS11:{$order:1,tagName:"div",text:"{rows11}"}}}},TDBODY12:{tagName:"td",SCROLL12:{$order:1,tagName:"div",className:"{_rowfreezed}",BODY12:{tagName:"div",ROWS12:{$order:1,tagName:"div",text:"{rows12}"}}}}},TRBODY:{tagName:"tr",TDBODY21:{tagName:"td",SCROLL21:{$order:1,tagName:"div",className:"{_columnfreezed}",BODY21:{tagName:"div",ROWS21:{$order:1,tagName:"div",text:"{rows21}"}}}},TDBODY22:{tagName:"td",SCROLL22:{$order:1,tagName:"div",BODY22:{tagName:"div",ROWS22:{$order:1,tagName:"div",text:"{rows22}"}}}}},TRTAIL:{tagName:"tr",TDTAIL1:{tagName:"td"},TDTAIL2:{tagName:"td",FOOTER:{$order:2}}}}},COLLIST:{tagName:"div",className:"xui-uiborder-rb"},ARROW:{}},$submap:{header1:function(h,g,e,d,c,f){if(f>h.properties.freezedColumn){return false}h.colMap[e._serialId]._region=1;d="header";xui.UI.$doTemplate(h,g,e,d,c);return d},header2:function(h,g,e,d,c,f){if(f>h.properties.freezedColumn){h.colMap[e._serialId]._region=2;d="header";xui.UI.$doTemplate(h,g,e,d,c);return d}},header:{HCELL:{style:"width:{_pxWidth}px;height:{_hcellheight}px;{colDisplay};",className:"{cellCls}",HCELLA:{className:"xui-v-wrapper {headerClass}",style:"{headerStyle};{colStyle}",tabindex:"{_tabindex}",HCELLCAPTION:{className:"xui-v-node",text:"{caption}"},SORT:{style:"{sortDisplay}"},HHANDLER:{$order:2,tagName:"div",style:"{colDDDisplay}"}}}},grpCols1:function(h,g,e,d,c,f){if(e.to>h.properties.freezedColumn-1){return false}h.colMap[e._serialId]._region=1;d="grpCols";xui.UI.$doTemplate(h,g,e,d,c);return d},grpCols2:function(h,g,e,d,c,f){if(e.to>h.properties.freezedColumn-1){h.colMap[e._serialId]._region=2;d="grpCols";xui.UI.$doTemplate(h,g,e,d,c);return d}},grpCols:{HCELL:{style:"position:absolute;width:{_pxWidth}px;height:{_hcellheight}px;top:{_hcelltop}px;left:{_hcellleft}px;",className:"{cellCls}",HCELLA:{className:"xui-v-wrapper {headerClass}",style:"{headerStyle};{colStyle}",tabindex:"{_tabindex}",HCELLCAPTION:{className:"xui-v-node",text:"{caption}"},HHANDLER:{$order:2,tagName:"div",style:"{colDDDisplay}"}}}},rows11:function(h,g,e,d,c,f){if(h._passFreezedRow){return false}if(f>h.properties.freezedRow){return false}h.rowMap[e._serialId]._region=1;xui.UI.$doTemplate(h,g,e,"row1",c,f,"rows1")},rows12:function(h,g,e,d,c,f){if(h._passFreezedRow){return false}if(f>h.properties.freezedRow){return false}h.rowMap[e._serialId]._region=1;xui.UI.$doTemplate(h,g,e,"row2",c,f,"rows2")},rows21:function(h,g,e,d,c,f){if(!h._passFreezedRow&&f<=h.properties.freezedRow){return}h.rowMap[e._serialId]._region=2;xui.UI.$doTemplate(h,g,e,"row1",c,f,"rows1")},rows22:function(h,g,e,d,c,f){if(!h._passFreezedRow&&f<=h.properties.freezedRow){return}h._passFreezedRow=1;h.rowMap[e._serialId]._region=2;xui.UI.$doTemplate(h,g,e,"row2",c,f,"rows2")},row1:{ROW1:{tagName:"div",style:"{rowDisplay}",CELLS1:{$order:2,tagName:"div",className:"xui-uirowbg xui-uiborder-b2 {rowCls} {rowClass}",style:"height:{rowHeight}px;{rowStyle}",GRPCELL1:{tagName:"text",text:"{_cellhandler}"},OTHERCELLS:{tagName:"text",$order:2,text:"{cells}"}},SUB1:{$order:3,tagName:"div"}}},row2:{ROW2:{tagName:"div",style:"{rowDisplay}",CELLS2:{$order:2,tagName:"div",className:"xui-uirowbg xui-uiborder-b2 {rowCls} {rowClass}",style:"height:{rowHeight}px;{rowStyle}",GRPCELL2:{tagName:"text",text:"{_fgrpcell}"},OTHERCELLS:{tagName:"text",$order:2,text:"{cells}"},LCELL:{$order:3,className:"xui-v-wrapper",RTAGCMDS:{$order:1,tagName:"span",text:"{rtagCmds}"}}},SUB2:{$order:3,tagName:"div"}}},"rows1._cellhandler":function(h,g,e,d,c,f){xui.UI.$doTemplate(h,g,e,h.properties.treeMode=="infirstcell"&&!h.properties.freezedColumn?"rows1.infirstcell":"rows1.inhandler",c)},"rows1.inhandler":{FCELL:{$order:0,style:"{rowHandlerDisplay};{_row0DfW};",className:"{cellCls}",CELLA:{tabindex:"{_tabindex}",style:"{cellStyle}{firstCellStyle}",className:"xui-v-wrapper {cellClass}{firstCellClass}",ROWLRULER:{$order:1,style:"{_treeMode};width:{_rulerW}px"},MARK:{$order:2,style:"{_rowMarkDisplay}"},ROWNUM:{$order:3,style:"{_rowNumbDisplay}"},ROWTOGGLE:{$order:4,style:"{_treeMode};",className:"{_subClass}"},LTAGCMDS:{$order:1,tagName:"span",text:"{ltagCmds}"},FCELLCAPTION:{$order:5,className:"xui-v-node",text:"{caption}"},FHANDLER:{$order:6,tagName:"div",style:"{rowDDDisplay}"}}}},"rows1.infirstcell":{FCELL:{$order:0,style:"{rowHandlerDisplay};{_row0DfW};",className:"{cellCls}",CELLA:{tabindex:"{_tabindex}",style:"{cellStyle}{firstCellStyle}",className:"xui-v-wrapper {cellClass}{firstCellClass}",MARK:{$order:2,style:"{_rowMarkDisplay}"},ROWNUM:{$order:3,style:"{_rowNumbDisplay}"},LTAGCMDS:{$order:1,tagName:"span",text:"{ltagCmds}"},FHANDLER:{$order:6,tagName:"div",style:"{rowDDDisplay}"}}}},"rows2._fgrpcell":{GCELL:{$order:0,style:"{_row0DfW};",className:"{cellCls}",GCELLA:{tabindex:"{_tabindex}",style:"{cellStyle}{firstCellStyle}",className:"xui-v-wrapper {cellClass}{firstCellClass}",ROWLRULER:{$order:1,style:"{_treeMode};width:{_rulerW}px"},ROWTOGGLE:{$order:4,style:"{_treeMode};",className:"{_subClass}"},FCELLCAPTION:{$order:5,className:"xui-v-node",text:"{caption}"}}}},"rows1.cells":function(d,g,h,l,m,e){if(e>d.properties.freezedColumn){return}l="rows.cells";var f=arguments.callee,c=f._m||(f._m={textarea:".textarea",checkbox:".checkbox",button:".button",progress:".progress"}),k=c[h.type]||".input";if(d.properties.treeMode=="infirstcell"&&e==1&&k==".input"){k=".firstinput"}xui.UI.$doTemplate(d,g,h,l+k,m);return l},"rows2.cells":function(d,g,h,l,m,e){if(e<=d.properties.freezedColumn){return}l="rows.cells";var f=arguments.callee,c=f._m||(f._m={textarea:".textarea",checkbox:".checkbox",button:".button",progress:".progress"}),k=c[h.type]||".input";if(d.properties.treeMode=="infirstcell"&&e==1&&k==".input"){k=".firstinput"}xui.UI.$doTemplate(d,g,h,l+k,m);return l},"rows.cells.firstinput":{CELL:{style:"width:{width}px;{cellDisplay};",className:"xui-treegrid-fcell {cellCls}",CELLA:{className:"xui-v-wrapper {cellClass}",style:"{bgcolor};{color};{cellStyle}",tabindex:"{_tabindex}",ROWLRULER:{$order:1,style:"{_treeMode};width:{_rulerW}px"},ROWTOGGLE:{$order:2,style:"{_treeMode};",className:"{_subClass}"},CELLCAPTION:{$order:3,className:"xui-v-node xui-treegrid-fcellcaption",text:"{caption}"}}}},"rows.cells.input":{CELL:{style:"width:{width}px;{cellDisplay};",className:"{cellCls}",CELLA:{className:"xui-v-wrapper {cellClass}",style:"{bgcolor};{color};{cellStyle}",tabindex:"{_tabindex}",CELLCAPTION:{className:"xui-v-node",text:"{caption}"}}}},"rows.cells.textarea":{CELL:{style:"width:{width}px;{cellDisplay};",className:"{cellCls}",CELLA:{className:"xui-v-wrapper xui-cls-wordwrap {cellClass}",style:"{bgcolor};{color};{cellStyle}",tabindex:"{_tabindex}",CELLCAPTION:{className:"xui-v-node",text:"{caption}"}}}},"rows.cells.button":{CELL:{style:"width:{width}px;{cellDisplay};",className:"{cellCls}",CELLA:{_NativeElement:true,tagName:"button",className:"xui-wrapper xui-treegrid-tgbtn {cellClass}",style:"{cellStyle}",tabindex:"{_tabindex}",text:"{caption}"}}},"rows.cells.checkbox":{CELL:{style:"width:{width}px;{cellDisplay}",className:"{cellCls}",CELLA:{className:"xui-v-wrapper {cellClass}",style:"{cellStyle}",tabindex:"{_tabindex}",CHECKBOX:{className:"{checkboxCls}"}}}},"rows.cells.progress":{CELL:{style:"width:{width}px;{cellDisplay}",className:"{cellCls}",CELLA:{className:"{cellClass}",style:"{cellStyle}",tabindex:"{_tabindex}",PROGRESS:{$order:2,tagName:"div",className:"xui-v-wrapper",style:"width:{progress};",CELLCAPTION:{className:"xui-v-node",text:"{caption}"}}}}},"rows2.rtagCmds":function(g,f,e,d,c){var h=arguments.callee,k=h._m||(h._m={text:".text",button:".button",image:".image"});xui.UI.$doTemplate(g,f,e,"rows.tagCmds"+(k[e.type]||".button"),c)},"rows1.ltagCmds":function(g,f,e,d,c){var h=arguments.callee,k=h._m||(h._m={text:".text",button:".button",image:".image"});xui.UI.$doTemplate(g,f,e,"row.tagCmds"+(k[e.type]||".button"),c)},rtagCmds:function(g,f,e,d,c){var h=arguments.callee,k=h._m||(h._m={text:".text",button:".button",image:".image"});xui.UI.$doTemplate(g,f,e,"rows.tagCmds"+(k[e.type]||".button"),c)},ltagCmds:function(g,f,e,d,c){var h=arguments.callee,k=h._m||(h._m={text:".text",button:".button",image:".image"});xui.UI.$doTemplate(g,f,e,"rows.tagCmds"+(k[e.type]||".button"),c)},"rows.tagCmds.text":{CMD:{tagName:"a",title:"{tips}",href:xui.$DEFAULTHREF,style:"{_style}{itemStyle}",className:"{itemClass}",tabindex:"{_tabindex}",text:"{caption}"}},"rows.tagCmds.button":{CMD:{_NativeElement:true,tagName:"button",title:"{tips}",style:"{_style}{itemStyle}",className:"xui-uiborder-outset xui-list-cmd {itemClass}",tabindex:"{_tabindex}",text:"{caption}"}},"rows.tagCmds.image":{CMD:{tagName:"image",title:"{tips}",src:"{image}",border:"0",style:"{_style}{itemStyle}",className:"{itemClass}",tabindex:"{_tabindex}",alt:"{caption}"}}}},Appearances:{KEY:{display:"block",position:"absolute",overflow:"hidden"},BOX:{"border-collapse":"collapse",height:"100%",width:"100%"},"HEADER1, HEADER2":{"background-image":xui.UI.$bg("head.gif"),"background-repeat":"repeat-x","background-position":"left top","background-color":"#CAE3FF",position:"relative",overflow:"hidden","text-align":"left"},"HI1, HI2":{position:"relative"},"GRPCELLBOX1, GRPCELLBOX2":{position:"absolute",overflow:"visible",left:0,top:0,width:0,height:0,"font-size":0,"line-height":0},"SCROLL11, SCROLL12, SCROLL21, SCROLL22":{position:"relative","text-align":"left"},"SCROLL11, SCROLL12, SCROLL21":{overflow:"hidden"},"SCROLL11.columnfreezed, SCROLL21.columnfreezed":{"border-right":"1px solid #9a9a9a"},"SCROLL11.rowfreezed, SCROLL12.rowfreezed":{"border-bottom":"1px solid #9a9a9a"},SCROLL22:{overflow:"auto"},ARROW:{position:"absolute","z-index":"20",left:0,top:0,display:"none",width:"14px",height:"22px","background-image":xui.UI.$bg("icons.gif","",true),"background-repeat":"no-repeat","background-position":"-72px -270px"},COLLIST:{position:"absolute","z-index":"10",left:0,top:0,cursor:"pointer",visibility:"hidden","background-image":xui.UI.$bg("collist.gif",""),"background-repeat":"no-repeat","background-position":"center bottom"},"BODY11, BODY12, BODY21, BODY22":{overflow:"visible",position:"absolute",left:0,top:"0","font-size":0,"line-height":0},"SORT, SORT-checked":{width:"16px",height:"16px"},SORT:{"background-image":xui.UI.$bg("icons.gif","",true),"background-repeat":"no-repeat","background-position":"-110px -220px",position:"absolute",right:"2px",bottom:"2px"},"HCELL-mouseover SORT":{$order:1,"background-position":"-110px -240px"},"HCELL-mousedown SORT":{$order:2,"background-position":"-110px -260px"},"SORT-checked":{$order:3,"background-position":"-130px -220px"},"HCELL-mouseover SORT-checked":{$order:4,"background-position":"-130px -240px"},"HCELL-mousedown SORT-checked":{$order:5,"background-position":"-130px -260px"},HHANDLER:{position:"absolute",background:xui.browser.ie?"url("+xui.ini.img_bg+")":null,width:"4px",top:"0",right:"0",height:"100%",cursor:"e-resize","font-size":0,"line-height":0},"HCELLS1, HCELLS2, CELLS1, CELLS2":{"overflow-y":xui.browser.ie?"hidden":"",position:"relative","white-space":"nowrap","font-size":"12px","line-height":"18px"},"HCELLS1, HCELLS2, GRPCELLBOX1, GRPCELLBOX2":{overflow:"visible"},"CELLS1, CELLS2":{overflow:"visible"},"CELLS1-group FCELL, CELLS2-group FCELL":{"border-right":0,"padding-right":"1px",overflow:"visible"},"CELLS1-group FCELLCAPTION, CELLS1-group CELLA, CELLS1-group ROWNUM, CELLS2-group FCELLCAPTION, CELLS2-group CELLA":{"font-weight":"bold",color:"#3764A0",overflow:"visible"},"CELLS1-mouseover, CELLS2-mouseover":{$order:4,"background-color":"#DFE8F6"},"CELLS1-readonly CELLA,CELLS2-readonly CELLA":{$order:5,color:"#808080"},"CELL-readonly CELLA":{$order:6,color:"#808080"},"CELLS1-disabled, CELLS2-disabled":{$order:7,"background-color":"#EBEADB"},"CELLS1-disabled CELLA, CELLS2-disabled CELLA":{$order:7,color:"#808080"},"CELL-disabled":{$order:8,"background-color":"#EBEADB"},"CELL-disabled CELLA":{$order:8,color:"#808080"},"CELLS1-active, CELLS2-active, CELL-active":{$order:5,"background-color":"#A3BAE9"},"CELLS1-hot, CELLS2-hot":{$order:6,"background-color":"#FFE97F"},"CELLS1-checked, CELLS2-checked, CELL-checked, CELL-checked CELLA":{$order:6,"background-color":"#7199E8",color:"#fff"},"FCELL CELLA":{"text-align":"left"},"FHCELL HCELLA":{"text-align":"center"},"CELLCAPTION,HCELLCAPTION,SORT,HHANDLER":{"vertical-align":"middle"},"CELLCAPTION,HCELLCAPTION,FCELLCAPTION,GRIDCAPTION":{"max-width":"100%","text-overflow":"ellipsis","white-space":"nowrap",overflow:"hidden"},"FCELL FCELLCAPTION, FHCELL GRIDCAPTION":{display:"inline"},"CELL-textarea CELLCAPTION":{$order:10,"white-space":"normal"},FHANDLER:{position:"absolute",height:"4px",left:"0px",width:"100%",bottom:"0px",cursor:"n-resize","z-index":10,"font-size":0,"line-height":0},"FCELLCAPTION, ROWNUM":{"vertical-align":"middle",overflow:"hidden"},"FHCELL, HCELL":{"background-image":xui.UI.$bg("head.gif",""),"background-repeat":"repeat-x","background-position":"left top","background-color":"#CAE3FF","border-left":"1px solid #fff","border-top":"1px solid #fff","border-right":"1px solid #A2BBD9","border-bottom":"1px solid #A2BBD9",padding:0,"vertical-align":"bottom","font-size":"12px"},"FHCELL-mouseover, HCELL-mouseover":{"background-image":xui.UI.$bg("head_mouseover.gif",""),"background-repeat":"repeat-x","background-position":"left top","background-color":"#FFF1A0"},"ROW1, ROW2":{position:"relative",zoom:xui.browser.ie?1:null,width:xui.browser.ie?"100%":null,"font-size":0,"line-height":0},ROWNUM:{"padding-right":"6px",color:"#808080"},"FCELL, CELL":{height:"100%","padding-left":"1px","border-right":"1px solid #A2BBD9",position:"relative",overflow:xui.browser.ie6?"hidden":"","font-size":"12px","line-height":"20px","vertical-align":"top"},"LHCELL, LCELL":{height:"100%",position:"relative","font-size":"12px","line-height":"20px","vertical-align":"top"},ALT:{"background-color":"#EFF8FF"},"CELL-label a":{color:"#000"},"CELL-input":{},"CELL-number, CELL-spin, CELL-currency":{"text-align":"right"},"CELL-checkbox":{"text-align":"center"},"KEY-tgbtn":{$order:100,width:"100%",padding:0,"vertical-align":"text-bottom","line-height":"100%",height:"100%"},"CELL-disabled KEY-tgbtn":{$order:101,color:"#ababab"},"CELL-mouseover":{$order:5,"background-color":"#DFE8F6"},"FCELL CELLA, HCELLA":{position:"relative","text-overflow":"ellipsis"},HCELLA:{$order:3,"text-align":"center","vertical-align":"middle","line-height":"inherit"},"HCELLA, CELLA":{display:"block",overflow:"hidden","-moz-box-flex":"1","outline-offset":"-1px","-moz-outline-offset":(xui.browser.gek&&xui.browser.ver<3)?"-1px !important":null,height:"100%",color:"#000",width:xui.browser.ie?"100%":"","line-height":"inherit"},"CELLA-inline":{$order:5,display:xui.$inlineBlock,width:"auto","-moz-box-flex":0},PROGRESS:{height:"100%","background-color":"#00ffff","line-height":"22px",overflow:"visible",opacity:0.7,"*filter":"alpha(opacity=70)"},"CHECKBOX, MARK":{cursor:"pointer",width:"16px",height:"16px","vertical-align":"middle","background-image":xui.UI.$bg("icons.gif","",true),"background-repeat":"no-repeat","background-position":"-20px -70px"},"CELL-mouseover CHECKBOX":{$order:1,"background-position":"-20px -90px"},"CELL-mousedown CHECKBOX":{$order:2,"background-position":"-20px -110px"},"CHECKBOX-checked, CELLS1-checked MARK, CELLS2-checked MARK":{$order:3,"background-position":"0 -70px"},"CELL-mouseover CHECKBOX-checked":{$order:4,"background-position":"0 -90px"},"CELL-mousedown CHECKBOX-checked":{$order:5,"background-position":"0 -110px"},"SUB1, SUM22":{zoom:xui.browser.ie?1:null,height:0,position:"relative",overflow:"visible","font-size":"1px","line-height":"1px"},LTAGCMDS:{"padding-right":"2px","vertical-align":"middle"},RTAGCMDS:{"vertical-align":"middle"},CMD:{"margin-left":"2px",padding:"0 2px","vertical-align":"middle",cursor:"pointer"}},_objectProp:{rowOptions:1,colOptions:1},Behaviors:{HoverEffected:{ROWTOGGLE:"ROWTOGGLE",CELL:"CELL",HCELL:"HCELL",FCELL:"FHCELL",FCELL:"FHCELL",CMD:"CMD",SCROLL22:"SCROLL22",BODY11:"BODY11",BODY12:"BODY12",BODY21:"BODY22",BODY11:"BODY22",HEADER1:"HEADER1",HEADER2:"HEADER2"},ClickEffected:{ROWTOGGLE:"ROWTOGGLE",CELL:"CELL",HCELL:"HCELL",CMD:"CMD"},DroppableKeys:["SCROLL22","CELLS1","CELLS2","FCELL"],DraggableKeys:["FCELL"],onSize:xui.UI.$onSize,HFMARK:{onClick:function(c,f,g){if(c.properties.selMode!="multi"&&c.properties.selMode!="multibycheckbox"){return}var d=[];_.each(c.rowMap,function(e){d.push(e.id)});if(c._$checkAll){delete c._$checkAll;c.boxing().setUIValue("",null,null,"checkbox");xui.use(g).tagClass("-checked",false);c.boxing().onRowSelected(c,"allrows",f,g,-1)}else{c._$checkAll=true;xui.use(g).tagClass("-checked");c.boxing().setUIValue(d.join(c.properties.valueSeparator),null,null,"click");c.boxing().onRowSelected(c,"allrows",f,g,1)}}},SCROLL22:{onScroll:function(f,h,k){var g=xui.use(k).get(0),c=g.scrollLeft||0,d=g.scrollTop||0;if(f.$sl!=c){f.getSubNodes(["HEADER2","SCROLL12"]).scrollLeft(f.$sl=c)}if(f.$st!=d){f.getSubNode("SCROLL21").get(0).scrollTop=f.$st=d;if((d=f.getSubNode("SCROLL21").get(0).scrollTop)&&d!=f.$st){g.scrollTop=f.$st=d}}}},SCROLL21:{onScroll:function(d,g,h){var f=xui.use(h).get(0),c=f.scrollTop||0;if(d.$st!=c){d.getSubNode("SCROLL22").get(0).scrollTop=d.$st=c}}},HEADER2:{onScroll:function(d,g,h){var f=xui.use(h).get(0),c=f.scrollLeft||0;if(d.$sl!=c){d.getSubNodes(["SCROLL12","SCROLL22"]).scrollLeft(d.$sl=c)}}},SCROLL12:{onScroll:function(d,g,h){var f=xui.use(h).get(0),c=f.scrollLeft||0;if(d.$sl!=c){d.getSubNodes(["HEADER2","SCROLL22"]).scrollLeft(d.$sl=c)}}},HHANDLER:{beforeMousedown:function(l,n,c){if(xui.Event.getBtn(n)!="left"){return}var g=l.properties,f=l.getSubId(c),k=l.colMap[f],h;if(k&&k.flexSize){return}if(k&&k._isgroup){h=l.getSubNode("HHANDLER",l.properties.header[k.to]._serialId)}else{h=xui(c)}var m=h.parent(2).width()-g._minColW,q=l.getSubNode("SCROLL22"),d=q.offset().left+q.width()-xui.Event.getPos(n).left-4;if(g.disabled){return false}if(k&&k.disabled){return false}h.startDrag(n,{horizontalOnly:true,dragType:"blank",dragDefer:2,maxLeftOffset:m,maxRightOffset:d,targetReposition:false});xui.use(c).parent(2).onMouseout(true,{$force:true}).onMouseup(true)},onDragbegin:function(c,d,f){xui.DragDrop.getProfile().proxyNode.css({height:c.getRoot().height()+"px",width:"4px",backgroundColor:"#ddd",cursor:"e-resize"})},onDrag:function(f,h,l){var k=xui.DragDrop,g=k.getProfile(),c=0;if(g.x<=g.restrictedLeft||g.x>=g.restrictedRight){c=true}if(c){if(!f._limited){g.proxyNode.css("backgroundColor","#ff6600");f._limited=true}}else{if(f._limited){g.proxyNode.css("backgroundColor","#ddd");f._limited=0}}},onDragstop:function(h,k,c){var f=xui(c).parent(2),g=h.colMap[h.getSubId(c)];if(g){if(g&&g._isgroup){g=h.properties.header[g.to];f=h.getSubNode("HCELL",g._serialId)}if("maxWidth" in g){m=Math.min(g.maxWidth,m)}if("minWidth" in g){m=Math.max(g.minWidth,m)}}var m=f.width()+xui.DragDrop.getProfile().offset.x;if(h.beforeColResized&&false===h.boxing().beforeColResized(h,g?g.id:null,m)){h._limited=0;return}f.width(m);if(g){g._pxWidth=g.width=m}var d=[],l=[];if(h.getKey(xui.use(c).parent(2).id())==h.keys.FHCELL){h.box._setRowHanderW(h,m)}else{var n=g._cells;_.each(n,function(e){d.push(h.getSubNode(h.keys.CELL,e).id())});h.box._adjusteditorW(h,xui(d).width(m),m)}if(h.afterColResized){h.boxing().afterColResized(h,g?g.id:null,m)}h.getSubNode("SCROLL22").onScroll();h.box._adjustColsWidth(h);h.box._adjustBody(h,"setcol");h._limited=0},onClick:function(){return false},onDblclick:function(k,m,c){var f=k.properties,g=xui.use(c).parent(2),d=k.getSubId(c);col=k.colMap[d];if(col&&col._isgroup){col=k.properties.header[col.to];g=k.getSubNode("HCELL",col._serialId)}if(col&&col.flexSize){return}if(k.getKey(xui.use(c).parent(2).id())==k.keys.FHCELL){k.box._setRowHanderW(k,true);return}if(k.getRootNode().clientHeight<=0){return}var u=col._cells,x=k.getClass("CELLA","-inline"),h,q=[],l=[],r;_.each(u,function(e){h=k.getSubNode("CELLA",e);if(h._nodes.length){q.push(h.get(0));l.push(h.addClass(x).width())}});l.push(f._minColW);r=parseInt(Math.max.apply(null,l),10);if(r>f._maxColW){r=f._maxColW}if(k.beforeColResized&&false===k.boxing().beforeColResized(k,col?col.id:null,r)){return}if(col){if("maxWidth" in col){r=Math.min(col.maxWidth,r)}if("minWidth" in col){r=Math.max(col.minWidth,r)}}r+=2;k.box._adjusteditorW(k,xui(q).parent().width(r),r);k,g.width(col._pxWidth=col.width=r);xui(q).removeClass(x);if(k.afterColResized){k.boxing().afterColResized(k,col.id,r)}k.box._adjustColsWidth(k);k.box._adjustBody(k,"setcol");return false}},FHANDLER:{beforeMousedown:function(g,h,c){if(xui.Event.getBtn(h)!="left"){return}var d=g.properties,m=g.rowMap[g.getSubId(c)],f=xui(c),n=f.parent(3).height()-d._minRowH,l=g.getSubNode("SCROLL21"),k=l.offset().top+l.height()-xui.Event.getPos(h).top-4;if(d.disabled||(m&&m.disabled)){return false}f.startDrag(h,{verticalOnly:true,dragType:"blank",dragDefer:2,maxTopOffset:n,maxBottomOffset:k,targetReposition:false});xui.use(c).parent(2).onMouseout(true,{$force:true}).onMouseup(true);if(!m){g.getSubNode("COLLIST").css("visibility","hidden")}},onDragbegin:function(c,d,f){xui.DragDrop.getProfile().proxyNode.css({width:c.getRoot().width()+"px",height:"4px",backgroundColor:"#ddd",cursor:"n-resize"})},onDrag:function(f,h,l){var k=xui.DragDrop,g=k.getProfile(),c=0;if(g.y<=g.restrictedTop||g.y>=g.restrictedBottom){c=true}if(c){if(!f._limited){g.proxyNode.css("backgroundColor","#ff6600");f._limited=true}}else{if(f._limited){g.proxyNode.css("backgroundColor","#ddd");f._limited=0}}},onDragstop:function(f,g,m){var c=f.getSubId(m),l=xui(m).parent(3),d=l.height()+xui.DragDrop.getProfile().offset.y,k=f.rowMap[f.getSubId(m)],n=f.properties.header;f.getSubNode("CELLS2",c).height(d);if(xui.browser.ie&&d%2==1){d+=1}if(f.beforeRowResized&&false===f.boxing().beforeRowResized(f,k?k.id:null,d)){f._limited=0;return}if(f.getKey(xui.use(m).parent(2).id())==f.keys.FHCELL){f.properties.headerHeight=d;f.box._adjustColsHeight(f);xui.UI.$tryResize(f,f.getRoot().width(),f.getRoot().height(),true)}else{f.box._adjusteditorH(f,l.height(k._height=d),d);k.height=d}if(f.afterRowResized){f.boxing().afterRowResized(f,k?k.id:null,d)}f.box._adjustBody(f,"setrow");f._limited=0},onDblclick:function(g,l,n){var k=g.properties,c=g.getSubId(n),m,d;if(g.getRootNode().clientHeight<=0){return}if(c){m=g.rowMap[c];d=g.getSubNodes(["CELLS2","CELLS1"],c);var f=d.height("auto").height();if(g.beforeRowResized&&false===g.boxing().beforeRowResized(g,m.id,f)){return}g.box._adjusteditorH(g,d.height(m.height=m._height=f),f)}else{var f=(g._headerLayers||0)*g.box.$DataStruct.headerHeight;if(g.beforeRowResized&&false===g.boxing().beforeRowResized(g,null,f)){return}g.box._adjustColsHeight(g,true);xui.UI.$tryResize(g,g.getRoot().width(),g.getRoot().height(),true)}if(g.afterRowResized){g.boxing().afterRowResized(g,m?m.id:null,f)}g.box._adjustBody(g,"setrow");return false},onClick:function(){return false}},ROWTOGGLE:{onClick:function(d,g,k){var f=d.properties,c,h=d.rowMap[d.getSubId(k)];if(!h){c=d.cellMap[d.getSubId(k)];if(c){h=c._row}}if(!h){return}if(f.disabled||h.disabled){return false}if(!h.sub){return}d.box._setSub(d,h,!h._checked);return false},beforeMousedown:function(){return false}},HCELLA:{onClick:function(k,n,c){var f=k.properties,d=k.getSubId(c),g=k.colMap[d];if(!g){if(k.onClickGridHandler){k.boxing().onClickGridHandler(k,n,c)}if(f.disabled){return false}if(!f.colSortable){return}}else{if(k.onClickHeader){k.boxing().onClickHeader(k,g,n,c)}if(f.disabled||g.disabled){return false}if(!(g.hasOwnProperty("colSortable")?g.colSortable:f.colSortable)){return}}if(g&&g._isgroup){g=k.properties.header[g.from]}if(k.beforeColSorted&&false===k.boxing().beforeColSorted(k,g)){return false}var l=(g?g._order:k._order)||false,u=(g?g.type:null)||"input",w=g?g.sortby:null,m=g?_.arr.indexOf(f.header,g):-1,r=arguments.callee,q=r.fun||(r.fun=function(e,F,E,p,M,P,L,K){var I,D,B,O=arguments.callee;if(F){I=F.sub;D=e.getSubNode("SUB1",F._serialId).get(0);B=e.getSubNode("SUB2",F._serialId).get(0)}else{F={_inited:true};I=e.properties.rows;D=e.getSubNode("ROWS21").get(0);B=e.getSubNode("ROWS22").get(0)}var Z=[],X=[],U=[],J,N;var C=[],A=[],Y=[],W=[];_.arr.each(I,function(aa){if(aa._region==1){return}if(aa.sub&&aa.sub.length>1){O(e,aa,E,p,M,P,null)}Z[Z.length]=E==-1?aa.caption:(J=aa.cells)?(J=J[E])?J.value:"":aa[E];U[U.length]=E==-1?aa:(J=aa.cells)?J[E]:aa[E];X[X.length]=X.length});var R;if(typeof M!="function"){switch(p){case"number":case"spin":case"currency":N=function(aa){return parseFloat(aa)||0};break;case"datetime":case"date":N=function(aa){return _.isDate(aa)?aa.getTime():_.isFinite(aa)?parseInt(aa,10):0};break;default:N=function(aa){return aa||""}}R=function(aa,ad){var ab=N(Z[aa]),ac=N(Z[ad]);return(ab>ac?(P?1:-1):ab===ac?(aa>ad?-1:1):(P?-1:1))}}else{R=function(aa,ab){return M.apply(e,[aa,ab,Z,P,E,U])}}X.sort(R);var T=F._inited,V=_.copy(I),S;if(T){C=D.childNodes;A=B.childNodes}_.arr.each(X,function(ab,aa){I[aa]=V[ab];if(T){Y[aa]=C[ab];W[aa]=A[ab]}});if(T){var H=document.createDocumentFragment(),G=document.createDocumentFragment();for(var Q=0;J=Y[Q];Q++){H.appendChild(J)}for(var Q=0;J=W[Q];Q++){G.appendChild(J)}if(L){D.insertBefore(H,L);B.insertBefore(G,K)}else{D.appendChild(H);B.appendChild(G)}}});var z,y,x;if(k.__hastmpRow){z=k.properties.rows.pop();y=k.getSubNode("ROWS21").get(0).lastChild;x=k.getSubNode("ROWS22").get(0).lastChild}q(k,null,m,u,w,l,y,x);if(k.__hastmpRow){k.properties.rows.push(z)}k.getSubNode("SORT",true).css("display","none");var h=(g?k.getSubNode("SORT",g._serialId):k.getSubNode("SORT")).css("display","");h.tagClass("-checked",g?(!(g._order=!g._order)):(!(k._order=!k._order)));k.box._asy(k);delete k.$allrowscache1;delete k.$allrowscache2;if(k.afterColSorted){k.boxing().afterColSorted(k,g)}},beforeMousedown:function(d,g,l){if(xui.Event.getBtn(g)!="left"){return}var f=d.properties;if(f.disabled){return}var c=d.colMap[d.getSubId(l)];if(!c||c._isgroup){return}if(f.disabled||c.disabled){return false}if(f.treeMode=="infirstcell"&&f.header[0]==c){return false}if(!(c.hasOwnProperty("colMovable")?c.colMovable:f.colMovable)){return}if(false===d.boxing().beforeColDrag(d,c.id)){return}var m=xui.Event.getPos(g),k=xui(l),h=d.getSubId(l);k.startDrag(g,{dragType:"icon",shadowFrom:k.parent(),dragCursor:"pointer",targetLeft:m.left+12,targetTop:m.top+12,targetReposition:false,dragDefer:2,dragKey:d.$xid+":col",dragData:k.parent().id()})},onDragbegin:function(c,d,f){xui(f).parent().onMouseout(true,{$force:true});xui(f).onMouseup(true)},beforeMouseover:function(h,l,c){var f=h.properties,d=h.getSubId(c),g=h.colMap[d];if(!g||g._isgroup){return}if(f.disabled||g.disabled){return false}var k=xui.DragDrop.getProfile();if(!k.dragData||k.dragKey!=h.$xid+":col"){return}var m=xui.use(c).parent().xid();if(false===h.box._colDragCheck(h,m)){return}xui.DragDrop.setDropElement(c).setDropFace(c,"move");var n=xui.use(m).get(0);h.getSubNode("ARROW").left(n.offsetLeft+(h._leftregionw||0)-8).top(n.offsetTop+n.offsetHeight).css("display","block")},beforeMouseout:function(f,h,k){var g=f.properties,m=f.getSubId(k),d=f.colMap[m];if(!d){return}if(g.disabled||d.disabled){return false}var l=xui.DragDrop.getProfile();if(!l.dragData||l.dragKey!=f.$xid+":col"){return}var c=xui.use(k).parent().xid();xui.DragDrop.setDropElement(null).setDropFace(null,"none");if(false===f.box._colDragCheck(f,c)){return}f.getSubNode("ARROW").css("display","none")},onDrop:function(g,D,q){var y=g.properties,x=g.box,z=g.getSubId(q),l=xui.UI.$tag_subId,k=g.colMap[z];if(!k){return}if(y.disabled||k.disabled){return false}var H=xui.use(q).parent().xid();g.getSubNode("ARROW").css("display","none");if(false===x._colDragCheck(g,H)){return}var G=xui.DragDrop.getProfile().dragData,r=G&&g.getSubId(G),w=g.getSubId(H),F=g.colMap,c=F[r],f=F[w];if(false===g.boxing().beforeColMoved(g,c.id,f.id)){return}xui.DragDrop.setDropFace(H,"none");var h=_.arr.subIndexOf(y.header,"_serialId",r),B=_.arr.subIndexOf(y.header,"_serialId",w);if(h===B||h===B-1){return}g.getSubNode("HCELL",w).addPrev(xui(xui.DragDrop.getProfile().dragData));_.each(f._cells,function(m,e){g.getSubNode("CELL",m).addPrev(g.getSubNode("CELL",c._cells[e]))});var E=y.header[h];_.arr.insertAny(y.header,E,B);_.arr.removeFrom(y.header,h+(h>B?1:0));var n=g.queryItems(y.rows,true,true);_.arr.each(n,function(e){e=e.cells?e.cells:e;if(!e||!_.isArr(e)){return}E=e[h];_.arr.removeFrom(e,h);_.arr.insertAny(e,E,B)});var d=y.grpCols;if(d&&_.isArr(d)&&d.length){for(var C=0,A=d.length,u;C<A;C++){u=d[C];if(u.from>B){u.from++;u.to++}else{if(B>=u.from&&B<=u.to){u.to++}}}for(var C=0,A=d.length,u;C<A;C++){u=d[C];if(u.from>h){u.from--;u.to--}else{if(h>=u.from&&h<=u.to){u.to--}}}_.filter(d,function(m){var e=m.to>=m.from;if(!e&&g.renderId){g.getSubNode("HCELL",m[l]).remove();delete g.colMap[m[l]];delete g.colMap2[m.id]}return e});y.grpCols=x._adjustGrpColsData(g,d);x._adjustColsWidth(g);x._adjustColsHeight(g)}g.boxing().afterColMoved(g,c.id,f.id);delete g.$allrowscache1;delete g.$allrowscache2},onMouseover:function(h,k,c){var f=h.properties,d=h.getSubId(c),g=h.colMap[d];if(g){if(f.disabled||g.disabled){return false}if(!(g.hasOwnProperty("colHidable")?g.colHidable:f.colHidable)){return}if(!(g.hasOwnProperty("colDroppable")?g.colDroppable:f.colDroppable)){return}}else{if(f.disabled){return false}if(!f.colHidable){return}}_.resetRun(h.$xid+":collist",null);var m={},l=xui.use(c).parent().offset(null,h.getSubNode("BOX")),n=xui.use(c).parent().cssSize();if(n.width<16){return}m.height=n.height;m.width=14;m.left=l.left;m.top=l.top;h.getSubNode("COLLIST").cssRegion(m).css("visibility","visible")},onMouseout:function(d,g,h){var f=d.properties,k=d.getSubId(h),c=d.colMap[k];if(c){if(f.disabled||c.disabled){return false}if(!(c.hasOwnProperty("colHidable")?c.colHidable:f.colHidable)){return}}else{if(f.disabled){return false}if(!f.colHidable){return}}_.resetRun(d.$xid+":collist",function(){if(!d.box){return}d.getSubNode("COLLIST").css({visibility:"hidden",left:0,top:0})})},onContextmenu:function(d,f,g){if(d.onContextmenu){var c=d.getSubId(g);return d.boxing().onContextmenu(d,f,g,c?d.colMap[c]:null)!==false}}},COLLIST:{onMouseover:function(c,d,f){_.resetRun(c.$xid+":collist",null)},onMouseout:function(c,d,f){_.resetRun(c.$xid+":collist",function(){if(!c.box){return}xui.use(f).css("visibility","hidden")})},onClick:function(f,h,k){var g=f.properties;if(!f.$col_pop){var d=[],c;_.arr.each(f.properties.header,function(e){if(e.hasOwnProperty("colHidable")?e.colHidable:g.colHidable){d.push({id:e.id,caption:e.caption,type:"checkbox",value:e.hidden!==true})}});if(d.length){c=f.$col_pop=new xui.UI.PopMenu({hideAfterClick:false,items:d}).render(true);c.onMenuSelected(function(n,l,m){var e=1;_.arr.each(n.properties.items,function(p){if(p.value!==false){return e=false}});if(!e){f.boxing().showColumn(l.id,l.value)}else{n.getSubNodeByItemId("CHECKBOX",l.id).tagClass("-checked");l.value=true}})}}if(f.$col_pop){f.$col_pop.pop(k)}}},CELLS2:{afterMouseover:function(d,g,k){var f=d.properties;if(f.disabled){return}if(f.disableHoverEffect){return}if(f.activeMode=="row"){var c=d.getSubId(k);d.getSubNodes(["CELLS1","CELLS2"],c).tagClass("-mouseover");if(d.onRowHover){var h=d.rowMap[c];d.boxing().onRowHover(d,h,true,g,k)}}},afterMouseout:function(d,g,k){var f=d.properties;if(f.disabled){return}if(f.disableHoverEffect){return}if(f.activeMode=="row"){var c=d.getSubId(k);d.getSubNodes(["CELLS1","CELLS2"],c).tagClass("-mouseover",false);if(d.onRowHover){var h=d.rowMap[c];d.boxing().onRowHover(d,h,false,g,k)}}},onDblclick:function(c,f,h){var d=c.properties,g=c.rowMap[c.getSubId(h)];if(!g||d.disabled||g.disabled){return false}if(c.onDblclickRow){c.boxing().onDblclickRow(c,g,f,h)}return false},onClick:function(f,h,l){var g=f.properties,c=f.getSubId(l),m=f.keys,k=f.rowMap[c],d=f.getKey(xui.Event.getSrc(h).id||"");if(g.disabled||k.disabled){return false}if(d==m.ROWTOGGLE||d==m.MARK){return false}if(k.group){f.box._getToggleNode(f,k._serialId).onClick()}if(f.onClickRow){f.boxing().onClickRow(f,k,h,l)}}},CELL:{afterMouseover:function(d,h,k){var f=d.box,g=d.properties,c=xui.use(k).id();if(g.disableHoverEffect){return}c=c.split(":")[2];if(!c){return}c=d.cellMap[c];if(f.getCellOption(d,c,"disabled")){return}if(g.activeMode=="cell"){xui.use(k).tagClass("-mouseover")}if(!d._inHoverEdit&&f.getCellOption(d,c,"editable")&&f.getCellOption(d,c,"editMode")=="hover"){_.resetRun(d.key+":"+d.$xid+":hovereditor",function(){if(d.destroyed){return}if(d&&d.$curEditor){editor=d.$curEditor;_.tryF(editor.undo,[],editor)}d.box._editCell(d,d.getSubId(k),true)})}},afterMouseout:function(c,f,g){var d=c.properties;if(d.disabled){return}if(d.disableHoverEffect){return}if(d.activeMode=="cell"){xui.use(g).tagClass("-mouseover",false)}}},CELLA:{onDblclick:function(f,l,c){var n=f.cellMap[f.getSubId(c)];if(!n){return}if(f.properties.disabled){return}var k=f.box,h=k.getCellOption,m=h(f,n,"type"),g=h(f,n,"disabled"),d=h(f,n,"editable");if(!g&&(!d||(m=="button"||m=="label"))){f.boxing().onDblclickCell(f,n,l,c);if(m=="button"){return false}}},afterMousedown:function(c,d,f){xui.setNodeData(f,"_tmp_forcefocus")},onClick:function(k,w,c){var g=k.properties,q=k.box,n=q.getCellOption,y=k.cellMap[k.getSubId(c)],f;if(y){if(k.properties.disabled){return false}var x=n(k,y,"type"),l=n(k,y,"disabled"),m=n(k,y,"readonly"),d=n(k,y,"event"),r=g.activeMode,h=n(k,y,"editable");if(!l&&(!h||(x=="button"||x=="label"))){if(typeof d=="function"&&false===d.call(k._host||k,k,y,null,null,w,c)){}else{if(k.onClickCell){k.boxing().onClickCell(k,y,w,c)}}if(x=="button"){return false}}if(!l&&!m&&x=="checkbox"){if(h){q._updCell(k,y,!y.value,g.dirtyMark,true);k.box._trycheckrowdirty(k,y);var u=y._row.id==k.box._temprowid;if(u){k.__needchecktmprow=true;k.box._sethotrowoutterblur(k)}}}if(!g.editable){if(r=="cell"){if(n(k,y,"disabled")){return false}f=xui(c).parent().id();q._sel(k,"cell",c,f,w)}else{if(r=="row"){if(g.disabled||y._row.disabled){return false}f=xui(c).parent(3).id();q._sel(k,"row",c,f,w)}}}}else{var z=k.rowMap[k.getSubId(c)];if(g.disabled||z.disabled){return false}if(typeof d=="function"&&false===d.call(k._host||k,k,z,null,null,w,c)){}else{if(k.onClickRowHandler){k.boxing().onClickRowHandler(k,z,w,c)}}if(g.activeMode=="row"){f=xui(c).parent(3).id();q._sel(k,"row",c,f,w)}}if(k.box){if(xui.use(c).get(0)){if(!xui.getNodeData(c,"_tmp_forcefocus")){k.box._focusEvent(k,w,c)}}}},onFocus:function(c,d,f){xui.setNodeData(f,"_tmp_forcefocus",1);c.box._focusEvent(c,d,f)},onKeydown:function(h,V,C){var X={tab:1,left:1,right:1,up:1,down:1},J=xui.Event.getKey(V),y=J.key;if(y=="enter"){xui(C).onClick();return}if(!X[y]){return}var M=h.cellMap[h.getSubId(C)];if(h.beforeCellKeydown&&false===h.boxing().beforeCellKeydown(h,M,J)){return false}var R=h.properties,L=J.shiftKey,U=J.ctrlKey,l=xui(C),P=h.getSubNode("BODY11"),O=h.getSubNode("BODY12"),B=h.getSubNode("BODY21"),A=h.getSubNode("BODY22"),T=new RegExp("^"+h.box.$Keys.CELLA+":"+h.serialId+":"),z=!!O.offsetWidth(),d=!!B.offsetWidth(),c=!!A.offsetHeight(),H=P.nextFocus(true,true,false,T),G=O.nextFocus(true,true,false,T),n=B.nextFocus(true,true,false,T),m=A.nextFocus(true,true,false,T),E=P.nextFocus(false,true,false,T),D=O.nextFocus(false,true,false,T),g=B.nextFocus(false,true,false,T),f=A.nextFocus(false,true,false,T),q=z?d?H:G:d?n:m,x=A?f:O?D:B?g:E,N=l.parent(),I=N.parent().id(),u=h.getSubId(I),r=M?M._row:h.rowMap[h.getSubId(C)],W=M?(M._row._region+""+M._col._region):(r._region+"1"),Q;var F=function(e){if(C!=q.xid()){var p;if(!N.get(0).previousSibling||!N.get(0).previousSibling.clientWidth){switch(W){case"11":case"21":if(c){if(C==n.xid()){D.focus();p=1}else{var Y=h.getSubNode("ROW2",u).prev();if(Y){Y.nextFocus(false,true,true,T);p=1}}}break;case"12":case"22":if(d){h.getSubNode("CELLS1",u).last(2).focus();p=1}break}}if(!p){l.nextFocus(false,false,true,T)}return false}else{if(e){x.focus()}}},k=function(e){if(C!=x.xid()){var p;if(W=="11"||W=="21"?!N.get(0).nextSibling:(!(Q=N.get(0).nextSibling)||!Q.clientWidth)){switch(W){case"11":case"21":if(c){h.getSubNode("CELLS2",u).first(2).focus();p=1}break;case"12":case"22":if(d){if(C==D.xid()){n.focus();p=1}else{var Y=h.getSubNode("ROW1",u).next();if(Y){Y.nextFocus(true,true,true,T);p=1}}}break}}if(!p){l.nextFocus(true,false,true,T)}return false}else{if(e){q.focus()}}},w=function(Z){var ab=1,ag=l.parent().get(0),ad=ag.parentNode.childNodes.length;while(ag=ag.previousSibling){ab++}ag=l.parent(2).get(0);if(!h.$allrowscache2){h.box._cacheRows(h)}var ac=_.arr.indexOf(W=="12"||W=="22"?h.$allrowscache2:h.$allrowscache1,ag),ae=h.$allrowscache2.length,aa=0;if(y=="up"){ac--;if(ac==-1){ac=ae-1;ab--;if(ab==0){ab=ad}}}else{ac++;if(ac==ae){aa=1;ac=0;ab++;if(ab==ad+1){ab=1}}}if(aa&&R.hotRowMode!="none"){var e;if(!M){var ah=h.rowMap[h.getSubId(C)];if(!ah){return false}}else{e=M._col.id}var Y=true;if(h.__hastmpRow){Y=h.box._checkNewLine(h,"keydown");if(!h.$allrowscache2){h.box._cacheRows(h)}}if(Y){h.box._addTempRow(h,e);return false}}var p=xui((W=="12"||W=="22"?h.$allrowscache2:h.$allrowscache1)[ac]).first(),af=p;if(ab>1){af=af.next(ab-1)}if(af.isEmpty()){af=p}if(af&&!af.isEmpty()){af=af.first()}if(!af.isEmpty()){af.focus()}},S=function(){if(C!=q.xid()){var e;if(l.get(0)==G.get(0)||l.get(0)==m.get(0)){if(d){g.focus();e=1}else{E.focus();e=1}}if(!e){w(true)}}else{x.focus()}},K=function(){if(C!=x.xid()){var e;if(l.get(0)==E.get(0)||l.get(0)==g.get(0)){if(z){G.focus();e=1}else{m.focus();e=1}}if(!e){w()}}else{q.focus()}};switch(y){case"tab":if(L){if(false===F()){return false}}else{if(false===k()){return false}}break;case"left":if(false===F(true)){return false}break;case"right":if(false===k(true)){return false}break;case"up":if(U){if(r&&!(R.disabled||r.disabled)&&(r.group||r.sub)){h.box._getToggleNode(h,r._serialId).onClick();return false}}S();return false;break;case"down":if(U){if(r&&!(R.disabled||r.disabled)&&(r.group||r.sub)){h.box._getToggleNode(h,r._serialId).onClick();return false}}K();return false;break}},onContextmenu:function(d,f,g){if(d.onContextmenu){var c=d.getSubId(g);return d.boxing().onContextmenu(d,f,g,c?(d.cellMap[c]||d.rowMap[c]):null)!==false}}},CMD:{onClick:function(c,g,k){var f=c.properties,l=xui.use(k).id().split("_"),d=l[l.length-1];l.pop();var h=c.rowMap[c.getSubId(l.join("_"))];if(f.disabled||(h&&h.disabled)){return false}if(c.onCmd){c.boxing().onCmd(c,h,d,g,k)}return false}}},DataModel:{directInput:true,listKey:null,currencyTpl:"$ *",numberTpl:"",valueSeparator:";",activeRow:{hidden:true,ini:null},activeCell:{hidden:true,ini:null},rowMap:{hidden:true,ini:null},selMode:{ini:"none",listbox:["single","none","multi","multibycheckbox"],action:function(c){this.getSubNodes(["HFMARK","MARK"],true).css("display",(c=="multi"||c=="multibycheckbox")?"":"none")}},editMode:{ini:"focus",listbox:["focus","sharp","hover","inline"]},dock:"fill",altRowsBg:{ini:false,action:function(k){var f=this;var e=f.getClass("ALT"),c=f.getSubNode("CELLS1",true),l=f.getSubNode("CELLS2",true),d,h,g;c.removeClass(e);l.removeClass(e);if(k){alt=[];d=0;l.each(function(n,m){if(n.clientHeight){n=xui([n]);h=xui([c.get(m)]);if((d++)%2==1){if(!h.hasClass(e)){h.addClass(e)}if(!n.hasClass(e)){n.addClass(e)}}else{if(h.hasClass(e)){h.removeClass(e)}if(n.hasClass(e)){n.removeClass(e)}}}})}}},rowNumbered:{ini:false,action:function(q){var p=this,m=p.CF.getNumberedStr||function(f){return f},e=p.getSubNode("ROWNUM",true),k=0,d=p.rowMap,x,n=0,h=0,g=[],c=[],w="",r,u;e.css("display",q?"":"none");if(q){e.each(function(f){x=d[p.getSubId(f.id)];h=x._layer;if(h>n){g.push(k);c.push(w);w=w+k+".";k=0}else{if(h<n){while(h<n--){k=g.pop();w=c.pop()}}}k++;n=h;x._autoNumber=m(w+k);r=x.rowNumber||x._autoNumber;if(u=f.firstChild){if(u.nodeValue!=r){u.nodeValue=r}}else{f.appendChild(document.createTextNode(r))}})}else{e.text("")}}},editable:false,firstCellEditable:false,$subMargin:22,iniFold:true,animCollapse:false,position:"absolute",width:300,height:200,_minColW:5,_maxColW:300,_minRowH:20,gridHandlerCaption:{ini:"",action:function(c){c=(_.isSet(c)?c:"")+"";this.getSubNode("GRIDCAPTION").html(xui.adjustRes(c,true))}},rowHandlerWidth:{ini:50,set:function(c){var d=this;if(d.renderId){d.box._setRowHanderW(d,c)}else{d.properties.rowHandlerWidth=c}}},showHeader:{ini:true,action:function(c){this.getSubNodes(["HEADER1","HEADER2"]).css("display",c?"":"none")}},headerHeight:{ini:22,action:function(c){var d=this;d.box._adjustColsHeight(d);xui.UI.$tryResize(d,d.getRoot().width(),d.getRoot().height(),true)}},rowHeight:{ini:20,action:function(c){this.box._adjusteditorH(this,this.getSubNodes(["CELLS1","CELLS2"],true).height(c),c)}},_colDfWidth:80,rowHandler:{ini:true,action:function(c){this.getSubNode("FHCELL").css("display",c?"":"none");this.getSubNode("FCELL",true).css("display",c?"":"none");this.box._adjustColsWidth(this);this.box._adjustBody(this,"rowhandler")}},rowResizer:{ini:false,action:function(c){this.getSubNode("FHANDLER",true).css("display",c?"":"none")}},colHidable:false,colResizer:{ini:true,action:function(c){this.getSubNode("HHANDLER",true).css("display",c?"":"none")}},colSortable:{ini:true,action:function(c){if(!c){this.getSubNode("SORT",true).css("display","none")}}},colMovable:false,header:{ini:{},set:function(c){var d=this;if(d.renderId){d.boxing()._refreshHeader(c)}else{d.properties.header=_.copy(c)}}},grpCols:{ini:{},set:function(c){var d=this;d.properties.grpCols=_.copy(c);if(d.renderId){d.boxing()._refreshHeader(_.clone(d.properties.header,false,2))}}},rows:{ini:{},set:function(c){var d=this;if(d.renderId){d.boxing().removeAllRows(false).insertRows(c)}else{d.properties.rows=_.copy(c)}}},rawData:{ini:[],set:function(q){if(!q||!_.isArr(q)||!q.length){return}var c=this,p={},m=[],r=[],h,f,d=q.length,g;for(h=0;h<d;h++){if(!_.isHash(g=q[h])){return}for(var e in g){if(!(e in p)){p[e]=[]}p[e][h]=g[e]}}f=0;for(var e in p){m.push(e);for(h=0;h<d;h++){if(!r[h]){r[h]=[]}r[h][f]=p[e][h]}f++}var n=c.boxing();if(n.getHeader("min").join(";")!=m.join(";")){n.setHeader(m)}n.setRows(r)},get:function(){var d=this,c=d.properties,m=c.header,p=c.rows,e=m.length,n=p.length;columns=[],data=[];if(n){for(var k=0;k<e;k++){columns.push(m[k].id)}for(var f=0;f<n;f++){var g={};for(var k=0;k<e;k++){g[columns[k]]=p[f].cells[k].value}data.push(g)}}return data}},tagCmds:{ini:[],action:function(){this.boxing().refresh()}},activeMode:{ini:"row",listbox:["row","cell","none"],action:function(d){var c=this;if(d!="cell"&&c.$activeCell){xui(c.$activeCell).tagClass("-active",false);delete c.$activeCell}if(d!="row"&&c.$activeRow){xui(c.$activeRow).tagClass("-active",false);delete c.$activeRow}}},rowOptions:{ini:{},action:function(e){var c=this.boxing(),d=c.getRows("data");c.removeAllRows();c.insertRows(d)}},colOptions:{ini:{},action:function(e){var c=this.boxing(),d=c.getRows("data");c.removeAllRows();c.insertRows(d)}},treeMode:{ini:"inhandler",listbox:["none","inhandler","infirstcell"],action:function(c,d){if((d=="inhandler"&&c=="infirstcell")||(d=="infirstcell"&&c=="inhandler")){this.boxing().refresh()}else{this.getSubNodes(["ROWLRULER","ROWTOGGLE"],true).css("display",c?"":"none")}}},freezedColumn:{ini:0,action:function(){this.boxing().refresh();this.box._adjustColsWidth(this)}},freezedRow:{ini:0,action:function(){this.boxing().refresh()}},hotRowMode:{ini:"none",listbox:["none","show","hide","auto"],action:function(c){if(this.renderId){if(c=="none"){this.boxing().removeHotRow()}else{this.box.__ensurehotrow(this,null)}}}},hotRowNumber:"[*]",noCtrlKey:true},EventHandlers:{onBodyLayout:function(d,c){},beforeCellKeydown:function(d,c,e){},afterCellFocused:function(d,c,e){},beforeInitHotRow:function(c){},onInitHotRow:function(c){},beforeHotRowAdded:function(d,e,c){},afterHotRowAdded:function(c,d){},onGetContent:function(c,d,e){},onRowSelected:function(d,h,f,g,c){},onCmd:function(c,h,f,d,g){},beforeColDrag:function(c,d){},beforeColMoved:function(d,e,c){},afterColMoved:function(d,e,c){},beforeColSorted:function(d,c){},afterColSorted:function(d,c){},beforeColShowHide:function(d,e,c){},afterColShowHide:function(d,e,c){},beforeColResized:function(d,e,c){},afterColResized:function(d,e,c){},beforeRowResized:function(d,e,c){},afterRowResized:function(d,e,c){},beforePrepareRow:function(d,e,c){},beforePrepareCol:function(d,c){},beforeRowActive:function(c,d){},afterRowActive:function(c,d){},beforeCellActive:function(d,c){},afterCellActive:function(d,c){},beforeIniEditor:function(f,g,c,d,e){},onBeginEdit:function(e,f,d,c){},beforeEditApply:function(g,h,d,f,c,e){},onEndEdit:function(e,f,d,c){},beforeCellUpdated:function(e,c,d,f){},afterCellUpdated:function(e,c,d,f){},beforeRowUpdated:function(d,e,c,f){},afterRowUpdated:function(d,e,c,f){},onRowDirtied:function(c,d){},onRowHover:function(d,h,c,f,g){},onClickHeader:function(d,c,f,g){},onClickRow:function(c,g,d,f){},onClickRowHandler:function(c,g,d,f){},onDblclickRow:function(c,g,d,f){},onClickCell:function(d,c,f,g){},onDblclickCell:function(d,c,f,g){},onClickGridHandler:function(c,d,f){},beforeComboPop:function(f,d,c,k,g,h){},beforePopShow:function(e,d,c,f){},afterPopShow:function(e,d,c,f){},onCommand:function(e,d,c,f){},onEditorClick:function(e,d,c,f){}},RenderTrigger:function(){var d=this,e=d.box,f=d.properties,c=d.boxing();d.destroyTrigger=function(){var g=this,h=g.properties;_.each(g.cellMap,function(k){if(k._editor){k._editor.destroy()}});_.breakO([g.colMap,g.rowMap,g.cellMap],3);h.header.length=0;h.rows.length=0;h.grpCols.length=0};d.$cache_editor={};if(!f.iniFold){c._toggleRows(f.rows,true)}_.arr.each(f.header,function(g){if(_.isFun(g.colRenderer||f.colOptions.colRenderer)){(g.colRenderer||f.colOptions.colRenderer).call(null,d,g)}});if(_.isArr(f.grpCols)){_.arr.each(f.grpCols,function(g){if(_.isFun(g.colRenderer||f.colOptions.colRenderer)){(g.colRenderer||f.colOptions.colRenderer).call(null,d,g)}});e._adjustColsHeight(d)}_.arr.each(f.rows,function(g){if(_.isFun(g.rowRenderer||f.rowOptions.rowRenderer)){(g.rowRenderer||f.rowOptions.rowRenderer).call(null,d,g)}if(false===e.getCellOption(d,g,"iniFold")){c._toggleRows([g],true)}});d.box._asy(d);d.box._adjustBody(d,"render");d.box.__ensurehotrow(d,null);_.each(d.cellMap,function(g){if(e.getCellOption(d,g,"editable")&&e.getCellOption(d,g,"editMode")=="inline"){e._editCell(d,g)}})},_focusEvent:function(f,g,k){var d=f.boxing(),l=f.properties,c=f.cellMap[f.getSubId(k)],h;f.box._focuscell(f,g,k);if(f.afterCellFocused){if(c){h=c._row}else{h=f.rowMap[f.getSubId(k)]}d.afterCellFocused(f,c,h)}if(l.hotRowMode!="none"){var c=f.cellMap[f.getSubId(k)],h;if(c){h=c._row}else{h=f.rowMap[f.getSubId(k)]}if(f.__hastmpRow&&f.__needchecktmprow&&h.id!==f.box._temprowid){f.box._checkNewLine(f,"focuscell")}}},__ensurehotrow:function(e,c){var h=e.properties,f=e.box,d=false;if(!f||!e.renderId||h.hotRowMode=="none"){return}if(e.__hastmpRow){var g=e.properties.rows;if(g.length===0||g[g.length-1].id!=e.box._temprowid){d=true}}else{d=true}if(d){switch(h.hotRowMode){case"auto":if(!h.rows||h.rows.length===0){f._addTempRow(e,c)}break;case"show":f._addTempRow(e,c);break}}},_temprowid:"_ r _temp_",isHotRow:function(c){return(c.id||c)===this._temprowid},_addTempRow:function(e,c){var g=e.properties;if(g.readonly||g.disabled||!g.header||g.header.length<=0){return false}e.box._sethotrowoutterblur(e,true);delete e.__hastmpRow;e.boxing().removeRows([this._temprowid],false);if(e.beforeInitHotRow&&false===e.boxing().beforeInitHotRow(e)){return false}e.__needchecktmprow=true;var f=[],d=e.boxing();if(e.onInitHotRow){f=d.onInitHotRow(e)||f}if(_.isArr(f)){f={cells:f}}else{if(!_.isHash(f)){f={cells:[f]}}}f.id=this._temprowid;f.rowNumber=g.hotRowNumber;f.rowClass=e.getClass("CELLS2","-hot");d.insertRows([f],null,null,false,false);e.__hastmpRow=true;if(c!==null){d.focusCellbyRowCol(f.id,c||g.header[0].id);e.box._sethotrowoutterblur(e)}},_checkNewLine:function(f,d){var c=f.properties;f.box._sethotrowoutterblur(f,true);if(!f.__hastmpRow){return}delete f.__needchecktmprow;var k=f.boxing(),e=this._temprowid,h=k.getRowbyRowId(e),n=c.hotRowMode=="show"?d=="keydown"?true:null:d?true:false;if(!h){return}if(f.beforeHotRowAdded){var g=k.beforeHotRowAdded(f,h,!d);if(_.isDefined(g)){n=g}}if(n===null){if(c.hotRowMode=="hide"||c.hotRowMode=="auto"){f.box._sethotrowoutterblur(f)}return false}else{if(n===false){if(c.hotRowMode=="hide"||c.hotRowMode=="auto"){delete f.__hastmpRow;k.removeRows([e],false);if(c.rows.length===0&&c.hotRowMode=="auto"){this._addTempRow(f,null)}}return false}else{if(n===true){var l=_.clone(h,true);var m=f.getClass("CELLS2","-hot");if(m==l.rowClass){delete l.rowClass}else{l.rowClass=l.rowClass.replace(m,"")}delete f.__hastmpRow;k.removeRows([e],false);if(l.id==e){delete l.id}if(l.rowNumber==c.hotRowNumber){delete l.rowNumber}k.insertRows([l],null,null,false,false);if(f.afterHotRowAdded){k.afterHotRowAdded(f,c.rows[c.rows.length-1])}if(c.hotRowMode=="show"){if(!f.__hastmpRow){this._addTempRow(f,null)}}return true}else{f.__needchecktmprow=true;if(_.isHash(n)){k.focusCell(n)}else{k.focusCell(k.getCell(n))}f.box._sethotrowoutterblur(f);return false}}}},_sethotrowoutterblur:function(d,c){d.getSubNode("ROWS22").setBlurTrigger(d.$domId+":ROWS22",c?null:function(h,g){var f=xui.Event.getSrc(g)==d.getSubNode("SCROLL22").get(0)?"focusin":null;d.__tmpRowBlurTrigger=_.asyRun(function(){if(!d.box){return}d.box._checkNewLine(d,f)})},null,null,true);if(c){if(d.__tmpRowBlurTrigger){_.clearTimeout(d.__tmpRowBlurTrigger);delete d.__tmpRowBlurTrigger}}},_cacheRows:function(e){var d=e.getSubNodes("CELLS1",true).get(),c=e.getSubNodes("CELLS2",true).get();_.filter(d,function(f){return !!f.clientHeight});_.filter(c,function(f){return !!f.clientHeight});e.$allrowscache1=d;e.$allrowscache2=c},_asy:function(d){var e=d.properties,c=d.boxing(),f=d.$xid;if(e.altRowsBg){_.resetRun(f+"1",function(){if(d.rowMap){c.setAltRowsBg(true,true)}})}if(e.rowNumbered){_.resetRun(f+"2",function(){if(d.rowMap){c.setRowNumbered(true,true)}})}},_setRowHanderW:function(e,h){var m=e.properties,f=m.$subMargin,c=e.rowMap,k=e.getSubNode("FHCELL"),d,l;if(typeof h=="number"){l=h}else{if(h===true){var g=[],p;e.getSubNode("FCELLCAPTION",true).each(function(n){if((p=n.parentNode).parentNode.offsetHeight>0&&xui.Dom.getStyle(p,"overflow")!="visible"){if(d=c[e.getSubId(n.id)]){g.push(xui([n]).width()+d._layer*f)}}});g.push(m._minColW);l=parseInt(Math.max.apply(null,g),10)+f*2}else{l=k.width()}}if(l){if(l<m._minColW){l=m._minColW}if(l<=0){return}if(m.rowHandlerWidth!=l){k.width(m.rowHandlerWidth=l);e.getSubNode("FCELL",true).width(l);e.box._adjustColsWidth(e);e.box._adjustBody(e,"rowhandler")}}},_onStartDrag:function(c,d,g){var f=c.rowMap[c.getSubId(g)];if(f&&f.id==c.box._temprowid){return false}var h=xui.Event.getPos(d);c.$_ond=g;xui.use(g).startDrag(d,{dragType:"icon",shadowFrom:xui.use(g).parent()._get(0),targetLeft:h.left+12,targetTop:h.top+12,dragCursor:"pointer",dragDefer:2,dragKey:c.box.getDragKey(c,g),dragData:c.box.getDragData(c,d,g)});return false},_onDropTest:function(d,m,c,q,l,u){var f=l&&l.domId,h=c,n=l&&l.profile,r;if(h){var g=d.getKey(h),p=d.keys,w=d.rowMap[d.getSubId(h)];if(g==p.FCELL&&!w.sub){return false}}if(n&&n.$xid==d.$xid){if(f&&d.getSubId(f)==d.getSubId(h)){return false}r=d.$_ond;c=xui(c).get(0);if(_.get(c,["parentNode","previousSibling"])==r){return false}do{if(c==r){c=r=null;return false}}while(c&&(c=c.parentNode)&&c!==document&&c!==window);c=r=null}},_onDragstop:function(d,h,k,c,g,f){delete d.$_ond},_onDrop:function(h,q,f,w,n,y){xui.DragDrop.setDragIcon("none");if(!n.profile||!n.profile[h.KEY]){return}var m=h.getKey(f),g=n.profile,d=n.domId,l,u=h.keys,x=xui.absObj.$specialChars,r=h.boxing(),p=_.copy(r.getUIValue(true)),c=g.rowMap[g.getSubId(d)],z=h.rowMap[h.getSubId(f)];c=_.clone(c,function(k,e){return !x[(e+"").charAt(0)]});g.boxing().removeRows([c.id]);if(m==u.SCROLL22){r.insertRows([c],null,null,false)}else{if((m==u.FCELL)&&z.sub){r.insertRows([c],z.id,null,false)}else{if(m==u.CELLS2){r.insertRows([c],z._pid,z.id,true)}}}if(p&&p.length){if(_.arr.indexOf(p,c.id)!=-1){r.setUIValue(p,true,null,"drop")}}return false},_beforeSerialized:function(e){var g=arguments.callee.upper.call(this,e),c=e.properties,f=xui.absObj.$specialChars,h=g.properties,d;h.header=_.clone(c.header,function(m,k,l){return !f[((l===1?m.id:k)+"").charAt(0)]&&m!=undefined});h.grpCols=_.clone(c.grpCols,function(m,k,l){return !f[((l===1?m.id:k)+"").charAt(0)]&&m!=undefined});h.rows=_.clone(c.rows,function(m,k,l){return !f[((l===1?m.id:k)+"").charAt(0)]&&m!=undefined&&((k=="id"&&typeof(m)=="string")?m.charAt(0)!="-":true)});if(h.header.length===0){delete h.header}if(h.grpCols.length===0){delete h.grpCols}if(h.rows.length===0){delete h.rows}delete h.activeRow;delete h.activeCell;delete h.rawData;return g},_clsCache:{},_colDragCheck:function(f,k){var h=f.properties,c=xui.DragDrop.getProfile(),e=c.dragKey,g=c.dragData,d=f.colMap[f.getSubId(k)];if(!d||d._isgroup){return false}if(h.treeMode=="infirstcell"&&h.header[0]==d){return false}if(!(d.hasOwnProperty("colMovable")?d.colMovable:f.properties.colMovable)){return false}if(!e||!g||e!=(f.$xid+":col")){return false}if(g==xui.use(k).id()||g==xui.use(k).prev().id()){return false}},_prepareData:function(c){var d=arguments.callee.upper.call(this,c),f="display:none",e=c.properties;c.rowMap2={};c.rowMap={};c.cellMap={};d.showHeader=e.showHeader?"":f;d.colDDDisplay=e.colResizer?"":f;d.rowDDDisplay=e.rowResizer?"":f;d.rowHandlerDisplay=e.rowHandler?"":f;d.sortDisplay=f;d._hcellheight=d.headerHeight?(d.headerHeight-2):"";d.headerHeight=d.headerHeight?("height:"+d.headerHeight+"px;"):"";d._rowMarkDisplay=(e.selMode=="multi"||e.selMode=="multibycheckbox")?"":"display:none;";if(!e.header||!_.isArr(e.header)){e.header=[]}if(!e.grpCols||!_.isArr(e.grpCols)){e.grpCols=[]}if(!e.rows||!_.isArr(e.rows)){e.rows=[]}e.header=this._adjustHeader(e.header);d.header=this._prepareHeader(c,e.header);d.header1=d.header2=d.header;d._row0DfW=d.rowHandlerWidth?("width:"+d.rowHandlerWidth+"px"):"";e.grpCols=this._adjustGrpColsData(c,e.grpCols);d.grpCols=this._prepareGrpCols(c,e.grpCols,d.header);d.grpCols1=d.grpCols2=d.grpCols;arguments.callee.upper.call(this,c);e.rows=this._adjustRows(c,e.rows);d.rows11=d.rows12=d.rows21=d.rows22=this._prepareItems(c,e.rows);xui.UI.List._prepareCmds(c,d,function(g){return !g.tag||!!g.tag.match(/\bheader\b/)});d._columnfreezed=e.freezedColumn?"columnfreezed":"";d._rowfreezed=e.freezedRow?"rowfreezed":"";return d},_parepareCol:function(g,e,p,l){var d=xui.UI.$tag_subId,c=g.properties,k=c.headerHeight,n="display:none",r,q=1,m,f,h;if(!_.isHash(e)){f=e+"";e={id:f}}else{f=e.id+""}e._cells={};r=g.pickSubId("header");e[d]="-h_"+r;e.id=e.id||r;while((m=_.arr.subIndexOf(p,"id",e.id))!=-1&&m!==l){e.id=r+(q++)}g.colMap[e[d]]=e;e.width=e.width||c._colDfWidth;if("relWidth" in e){e.flexSize=e.relWidth;delete e.relWidth}if(!e.flexSize){if(e.hasOwnProperty("minWidth")){e.width=Math.max(e.minWidth)}if(e.hasOwnProperty("maxWidth")){e.width=Math.min(e.minWidth)}}e._pxWidth=e.width;e._hcellheight=k-2;h={sortDisplay:n,rowHandlerDisplay:c.rowHandler?"":n};h[d]=e[d];h._tabindex=c.tabindex;h.colDDDisplay=(("colResizer" in e)?e.colResizer:c.colResizer)?"":n;if(e.flexSize){h.colDDDisplay=n}if(e.hasOwnProperty("visibility")&&!e.hasOwnProperty("hidden")){e.hidden=!e.visibility}h.colDisplay=e.hidden===true?n:"";h.firstCellStyle=c.colOptions.firstCellStyle||"";h.firstCellClass=c.colOptions.firstCellClass||"";if(!e.type){e.type=c.colOptions.type||"input"}if(!("caption" in e)){e.caption=f}xui.UI.adjustData(g,e,h);g.colMap2[e.id]=e[d];return[e,h]},_parepareCell:function(g,n,q,f,p,e,k){var m=this,d=xui.UI.$tag_subId,c=g.properties,l="display:none",h={};n=_.isSet(n)?_.isHash(n)?n:{value:n}:{};n._row=q;n._col=f;n[d]="-c_"+g.pickSubId("cell");n.id=n.id||n[d];m._adjustCell(g,n,h);g.cellMap[h[d]]=n;if(p){p.push(n)}q._cells[f.id]=h[d];f._cells[q.id]=h[d];if(c.treeMode=="infirstcell"&&k===0&&e){h._treeMode=q._treeMode;q._treeMode=l;h._rulerW=e._rulerW;h._subClass=e._subClass;e._rulerW=0;e._subClass=""}return[n,h]},_prepareGrpCols:function(f,c,d){var e=f.properties;if(e.showHeader&&c&&_.isArr(c)&&c.length){var G=e.header,D=e.headerHeight,g=xui.UI.$tag_subId,r="display:none",q=[],x,u,H,I,J=f._headerLayers,H=parseInt(D/(J+1),10),F=false;for(var E=0,B=c.length,l;E<B;E++){x={};u=0;F=false;I=0;l=c[E];xui.UI.adjustData(f,l,x);for(var C=0,z;C<=l.to;C++){z=G[C];y=d[C];if(C===l.from){F=true;x._hcellleft=I}I+=y._pxWidth+2;if(F&&!z.hidden){u+=y._pxWidth+2}}x._pxWidth=u-2;x._hcellheight=H-2;x._hcelltop=H*(l._layer-1);x._tabindex=e.tabindex;x.colDDDisplay=(("colResizer" in l)?l.colResizer:e.colResizer)?"":r;q.push(x)}for(var C=0,A=G.length,z,y;C<A;C++){z=G[C];y=d[C];if(z._grp&&z._grp.length){y._hcellheight=D-z._grp.length*H-2}}return q}},_prepareHeader:function(d,c){var f=[],e;d.colMap2={};d.colMap={};_.arr.each(c,function(h,g){if(d.beforePrepareCol&&false===d.boxing().beforePrepareCol(d,h)){return}e=d.box._parepareCol(d,h,c,g);c[g]=e[0];f.push(e[1])});return f},_renderCell:function(g,e,l,B,h){var H=g.box.getCellOption,L=g.properties.treeMode=="infirstcell",k=H(g,e,"type"),q="",p="",E,m=B,C=("caption" in e)&&xui.adjustRes(e.caption),F=/</g,I=arguments.callee,J=I._dcls||(I._dcls=g.getClass("CELL","-disabled")),d=I._rcls||(I._rcls=g.getClass("CELL","-readonly")),f=I._ren||(I._ren=function(N,c,O,M){return(typeof c._$caption=="string"?c._$caption:(O&&typeof O.caption=="string")?O.caption:typeof(c.renderer||c._renderer)=="function"?(c.renderer||c._renderer).call(N,c):typeof M=="function"?M(c.value,N,c):(_.isSet(c.value)?(""+c.value):""))||""}),D=I._f0=(I._f0=function(M,N,c){return M?xui.Date.getText(M,H(N,c,"dateEditorTpl")||"ymdhn"):""}),A=I._f1=(I._f1=function(M,N,c){return M?xui.Date.getText(M,H(N,c,"dateEditorTpl")||"ymd"):""}),z=I._f2=(I._f2=function(c){return c?(c+"").replace(F,"&lt;").replace(/\t/g,"    ").replace(/(\r\n|\n|\r)/g,"<br />"):""}),y=I._f3=(I._f3=function(c){return(c||c===0)?((c*100).toFixed(2)+"%"):""}),x=I._f4=(I._f4=function(M,N,c){if(M||M===0){return _.formatNumeric(parseFloat(M),H(N,c,"precision"),H(N,c,"groupingSeparator"),H(N,c,"decimalSeparator"),H(N,c,"forceFillZero"))}else{return""}}),w=I._f5=(I._f5=function(N,O,c){if(N||N===0){var M=H(O,c,"precision");return _.formatNumeric(parseFloat(N),_.isSet(M)?M:2,H(O,c,"groupingSeparator"),H(O,c,"decimalSeparator"),H(O,c,"forceFillZero"))}else{return""}}),u=I._f6=(I._f6=function(N,Q,c){var P=H(Q,c,"editorListItems");if(!P){if(P=H(Q,c,"editorListKey")){P=xui.UI.getCachedData(typeof(P)=="function"?P():P)}}if((typeof(P)=="function"?(P=P()):P)&&P.length){for(var O=0,M=P.length;O<M;O++){if(P[O].id===N){return P[O].caption||N}}}return N});if(B&&B.get(0)){B=L?B.last():B.first()}switch(k){case"number":case"spin":var r=parseFloat(e.value);e.value=(r||r===0)?r:null;E=C||f(g,e,l,x);var K=H(g,e,"numberTpl");if(K&&E){E=K.replace("*",E)}if(B){B.html(E,false)}break;case"currency":var r=parseFloat((e.value+"").replace(/[^\d.-]/g,""));e.value=(r||r===0)?r:null;E=C||f(g,e,l,w);var K=H(g,e,"currencyTpl");if(K&&E!==""){E=K.replace("*",E)}if(B){B.html(E,false)}break;case"date":case"datepicker":e.value=_.isDate(e.value)?e.value:_.isFinite(e.value)?new Date(parseInt(e.value,10)):null;E=C||f(g,e,l,A);if(B){B.html(E,false)}break;case"datetime":e.value=_.isDate(e.value)?e.value:_.isFinite(e.value)?new Date(parseInt(e.value,10)):null;E=C||f(g,e,l,D);if(B){B.html(E,false)}break;case"textarea":e.value=e.value||"";E=C||f(g,e,l,z);if(B){B.html(E,false)}break;case"color":case"colorpicker":var G=xui.UI.ColorPicker._ensureValue(0,e.value);e.value=e.value?((G!=="transparent"?"#":"")+G):"";E=C||f(g,e,l);if(e.value){q=xui.UI.ColorPicker.getTextColor(e.value);if(B){B.html(E,false);B.css("color",q).css("backgroundColor",e.value)}else{l.color="color:"+q+";";l.bgcolor="background-color:"+e.value+";"}}else{if(B){B.html(E,false);B.css("color","").css("backgroundColor","")}else{}}break;case"checkbox":e.value=!!e.value;E=e.value+"";if(B){B.tagClass("-checked",e.value)}else{l.checkboxCls=g.getClass("CHECKBOX",e.value?"-checked":"")}break;case"progress":e.value=parseFloat(e.value)||0;e.value=Math.min(Math.max(e.value,0),1);E=C||f(g,e,l,y);if(B){B.first().html(E,false);B.width(E)}else{l.progress=E}break;case"listbox":e.value=e.hasOwnProperty("value")?e.value:"";E=C||f(g,e,l,u);if(B){B.html((E===null||E===undefined)?e.value:E,false)}break;default:e.value=e.hasOwnProperty("value")?e.value:"";E=C||f(g,e,l);if(B){B.html((E===null||E===undefined)?e.value:E,false)}}e._$tips=E;var p=H(g,e,"disabled"),n=H(g,e,"readonly");if(l){l.cellCls=g.getClass("CELL","-"+k)+(p?(" "+J):"")+(n?(" "+d):"");l.type=k;l.value=e.value;l.caption=E;l.cellStyle=H(g,e,"cellStyle");l.cellClass=H(g,e,"cellClass")}else{if(p){m.parent().addClass(J)}else{m.parent().removeClass(J)}if(n){m.parent().addClass(d)}else{m.parent().removeClass(d)}if(p=h.cellStyle){m.attr("style",m.attr("style")+";"+p)}if(p=h.cellUnclass){m.removeClass(p)}if(p=h.cellClass){m.addClass(p)}}},_prepareItems:function(d,c,u,A){var w=this,k=d.properties,n=k.treeMode,z=k.$subMargin,F=d.rowMap2,C=d.rowMap,r=u?C[u]?(C[u]._layer+1):0:0,f=xui.UI.$tag_subId,G=arguments.callee,D=G._id||(G._id=new _.id()),m=[],B,e,q,g,p,E,h="display:none";n=!(!n||n=="none");for(var y=0,x=c.length;y<x;y++){g=c[y];if(!g.id||F[g.id]){while(F[q=D.next()]){}g.id="-"+q}else{g.id+=""}if(d.beforePrepareRow&&false===d.boxing().beforePrepareRow(d,g,u,A)){continue}B="-r_"+d.pickSubId("row");g[f]=B;C[B]=g;g._pid=u;g._cells={};g._layer=r;g._tabindex=k.tabindex;g._rowMarkDisplay=(k.selMode=="multi"||k.selMode=="multibycheckbox")?"":h;g._treeMode=n?"":h;g._rowNumbDisplay=k.rowNumbered?"":h;q={id:g.id};q.rowCls="";if(g.disabled){q.rowCls+=d.getClass("CELLS2","-disabled")}if(g.readonly){q.rowCls+=d.getClass("CELLS2","-readonly")}if(g.group){q.rowCls+=d.getClass("CELLS1","-group")+" xui-uiborder-r2"}if(g.hidden){q.rowDisplay=h}q._row0DfW=k.rowHandlerWidth?("width:"+k.rowHandlerWidth+"px"):"";q._rulerW=4+r*z;g._height=q.rowHeight=g._height||g.height||k.rowHeight;q.rowHandlerDisplay=k.rowHandler?"":h;q.rowDDDisplay=(("rowResizer" in g)?g.rowResizer:k.rowResizer)?"":h;q.firstCellStyle=g.firstCellStyle||k.rowOptions.firstCellStyle||"";q.firstCellClass=g.firstCellClass||k.rowOptions.firstCellClass||"";e=q.cells=[];q[f]=B;q._subClass=g.sub?"xui-uicmd-toggle2":"";F[g.id]=B;if(!g.hasOwnProperty("caption")&&g.hasOwnProperty("value")){g.caption=""+g.value}g._oValue=g.value;if(g.caption&&!g.tips){g._$tips=g.caption}if(!g.group&&(p=g.cells)){_.arr.each(k.header,function(H,l){E=d.box._parepareCell(d,p[l],g,H,A,q,l);p[l]=E[0];e.push(E[1])})}xui.UI.adjustData(d,g,q);xui.UI.List._prepareCmds(d,q,function(l){return !l.tag||!!l.tag.match(/\brow\b/)});if(g.group){g.cells=null;if(k.treeMode=="infirstcell"&&!k.freezedColumn){q._fgrpcell={};_.merge(q._fgrpcell,q,function(l){return _.isNumb(l)||_.isStr(l)})}}q._cellhandler={};_.merge(q._cellhandler,q,function(l){return _.isNumb(l)||_.isStr(l)});m.push(q)}return m},_adjustCell:function(f,c,k){var d=this,h=f.properties,e=c._col,g;if(g=d.getCellOption(f,c,"cellRenderer")){c._renderer=g}xui.UI.adjustData(f,c,k);if(!k.width){k.width=e._pxWidth}k._tabindex=h.tabindex;k.cellDisplay=e.hidden===true?"display:none;":"";d._renderCell(f,c,k);c._oValue=c.value},_setSub:function(g,x,p){var e=g.domId,q=g.properties,l=g.rowMap2[x.id],m=g.box._getToggleNode(g,l),k=g.getSubNode("SUB1",l),h=g.getSubNode("SUB2",l),n=g.getSubNodes(["SUB1","SUB2"],l);if(xui.Thread.isAlive(g.key+g.id)){return}if(x._checked){if(!p){var y=function(){n.css({display:"none",overflow:"",height:0});m.tagClass("-checked",false);x._checked=false;g.box._asy(g);delete g.$allrowscache1;delete g.$allrowscache2;g.box._adjustBody(g,"showrow")};if(q.animCollapse){n.css("overflow","hidden");n.animate({height:[h.height(),0]},null,y,200,0,"expoOut",g.key+g.id).start()}else{y()}}}else{if(p){var f=function(B,J,A,E,D,C,H,r){var I=B.boxing(),z=B.properties,G=r===false;if(!G&&!J._inited){delete J.sub;J._inited=true;if(r){if(typeof r=="string"){C.html(J.sub=r,false)}else{if(_.isArr(r)){I.insertRows(r,J.id)}else{if(r["xui.Template"]||r["xui.UI"]){C.append(J.sub=r.render(true))}}}}I._setCtrlValue(I.getUIValue(),true)}H.css("height","0px").css("display","");var K=function(){if(xui.browser.ie&&xui.browser.ver<=8){E.css({backgroundImage:"",backgroundRepeat:"",backgroundPositionX:"",backgroundPositionY:"",backgroundColor:"",backgroundAttachment:""})}else{E.css("background","")}if(G){}else{H.css({display:"",height:"auto",overflow:""});if(!D.height()){D.height(C.height())}E.tagClass("-checked");J._checked=true}B.box._asy(B);delete B.$allrowscache1;delete B.$allrowscache2;B.box._adjustBody(B,"showrow")};if(z.animCollapse){var F=0;C.children().each(function(L){F+=L.offsetHeight});H.css("overflow","hidden");H.animate({height:[0,F]},null,K,200,0,"expoIn",B.key+B.id).start()}else{K()}};var d=x.sub,u=function(r){f(g,x,e,m,k,h,n,r)},w;if((w=typeof d)=="string"||w=="object"){u(d)}else{if(g.onGetContent){m.css("background","url("+xui.ini.img_busy+") no-repeat");var c=g.boxing().onGetContent(g,x,u);if(c||c===false){if(c===true){x._inited=true}u(c)}}}}}},_getCellId:function(c,e,d){if(_.isNumb(e)){e=_.get(c.properties.rows,[e,"id"])}if(_.isNumb(d)){d=_.get(c.properties.header,[d,"id"])}return _.get(c.rowMap,[c.rowMap2[e],"_cells",d])},_updCell:function(h,e,x,w,q){var k=h.box,c=h.properties,r=c.dirtyMark,g=r&&c.showDirtyMark,p=xui.absObj.$specialChars,u,f,n,d;if(typeof e=="string"){u=h.cellMap[e]}else{u=e;e=u._serialId}if(!u||!u._row){return}n=u._row.id==k._temprowid;if(!_.isHash(x)){x={value:x}}x=_.filter(x,function(A,y,z){z=!p[y.charAt(0)]||y=="_$caption";if(!z){d=d||{};d[y]=A}return z});if(q){if(h.beforeCellUpdated&&false===h.boxing().beforeCellUpdated(h,u,x,n,d)){return}}if(!_.isEmpty(x)){delete u._$caption;delete u._$tips;_.merge(u,x,"all");f=h.getSubNode("CELLA",e);if("type" in x){var m={};k._adjustCell(h,u,m);f.parent().replace(h._buildItems("rows22.cells",[m]));f=h.getSubNode("CELLA",e)}k._renderCell(h,u,null,f,x);var l=u._editor;if("value" in x){if(!r||w===false){u._oValue=u.value}else{if(u.value===u._oValue){if(g){f.removeClass("xui-ui-dirty")}delete u.dirty}else{if(g){f.addClass("xui-ui-dirty")}u.dirty=true}}if(l){l.setValue(u.value,true,"editorini")}}if(("caption" in x)&&l&&l.setCaption){l.setCaption(x.caption,true)}}if(q){if(h.afterCellUpdated){h.boxing().afterCellUpdated(h,u,x,n,d)}}},_ensureValue:function(d,e){if(d.properties.selMode=="multi"||d.properties.selMode=="multibycheckbox"){var c=_.isArr(e)?e:(e?(""+e):"").split(d.properties.valueSeparator);_.arr.removeValue(c,this._temprowid);c.sort();return c.join(d.properties.valueSeparator)}else{return e==this._temprowid?null:e}},_sel:function(g,h,m,x,C){var n=g.properties;if(n.activeMode!=h){return}var f=g.getSubId(x),D=h=="cell"?g.cellMap:g.rowMap,r=g.boxing(),p=D[f],F=xui.Event.getKey(C),k=h=="cell"?(p._row.id+"|"+p._col.id):p.id,u=n.selMode;switch(u){case"none":r.onRowSelected(g,p,C,m,0);break;case"multibycheckbox":if(g.keys.MARK){var q=g.getKey(xui.Event.getSrc(C).id||""),c=q==g.keys.MARK;if(!c){r.onRowSelected(g,p,C,m,0);break}}case"multi":var z=r.getUIValue(),d=z?(""+z).split(n.valueSeparator):[],l=1;if(d.length&&(F.ctrlKey||F.shiftKey||n.noCtrlKey)){if(F.shiftKey&&h=="row"){if(g.$firstV._pid!=p._pid){return false}var w=n.rows;if(p._pid){var E=D[p._pid];if(E){w=E.sub}}var A=_.arr.subIndexOf(w,"id",g.$firstV.id),y=_.arr.subIndexOf(w,"id",p.id),B;d.length=0;for(B=Math.min(A,y);B<=Math.max(A,y);B++){d.push(w[B].id)}}else{if(_.arr.indexOf(d,k)!=-1){_.arr.removeValue(d,k);l=-1}else{d.push(k)}}d.sort();z=d.join(n.valueSeparator);if(r.getUIValue()!=z){r.setUIValue(z,null,null,"click");if(r.get(0)&&r.getUIValue()==z){r.onRowSelected(g,p,C,m,l)}}break}case"single":if(r.getUIValue()!=k){g.$firstV=p;r.setUIValue(k,null,null,"click");if(r.get(0)&&r.getUIValue()==k){r.onRowSelected(g,p,C,m,1)}}break}},_activeCell:function(e,g){if(e.properties.activeMode!="cell"){return}if(e.$activeCell==g){return}var c=null;if(e.$activeCell){xui(e.$activeCell).tagClass("-active",false);delete e.$activeCell}if(g!==false){var d=e.getSubId(g),f=e.cellMap;c=f[d];if(e.beforeCellActive&&(false===e.boxing().beforeCellActive(e,c))){return}xui(e.$activeCell=g).tagClass("-active")}if(e.afterCellActive){e.boxing().afterCellActive(e,c)}},_activeRow:function(f,h){if(f.properties.activeMode!="row"){return}if(f.$activeRow==h){return}var e=null,d;if(f.$activeRow){d=f.getSubId(f.$activeRow);f.getSubNodes(["CELLS1","CELLS2"],d).tagClass("-active",false);delete f.$activeRow}if(h!==false){var c=f.getSubId(h),g=f.rowMap;e=g[c];if(f.beforeRowActive&&(false===f.boxing().beforeRowActive(f,e))){return}d=f.getSubId(f.$activeRow=h);f.getSubNodes(["CELLS1","CELLS2"],d).tagClass("-active")}if(f.afterRowActive){f.boxing().afterRowActive(f,e)}},getCellOption:function(f,c,e){var d=c,g=f.properties;return(d&&d.hasOwnProperty(e)&&_.isSet(d[e]))?d[e]:(c&&(d=c._row)&&d.hasOwnProperty(e)&&_.isSet(d[e]))?d[e]:((d=g.rowOptions)&&d.hasOwnProperty(e)&&_.isSet(d[e]))?d[e]:(c&&(d=c._col)&&d.hasOwnProperty(e)&&_.isSet(d[e]))?d[e]:((d=g.colOptions)&&d.hasOwnProperty(e)&&_.isSet(d[e]))?d[e]:((d=g)&&d.hasOwnProperty(e)&&_.isSet(d[e]))?d[e]:null},_trycheckrowdirty:function(d,c){if(!c||!c._row){return}_.resetRun(d.key+":"+d.$xid+":"+c._row.id,function(){if(!d.box){return}var f=d.$cellInEditor;if(c._row&&(!f||(f._row&&f._row!=c._row))){var e=false;_.arr.each(c._row.cells,function(g){if(g._oValue!==g.value){e=true;return false}});if(e&&c._row.id!=d.box._temprowid&&d.onRowDirtied){d.boxing().onRowDirtied(d,c._row)}}},100)},_adjusteditorW:function(e,c,d){if(c){c.each(function(g,f){if(!(f=g.id)){return}f=f.split(":")[2];if(f=e.cellMap[f]){if(f._editor){f._editor.setWidth(d+2)}}})}},_adjusteditorH:function(e,d,c){d.each(function(h,g){if(!(g=h.id)){return}g=g.split(":")[2];if(g=e.rowMap[g]){g=g.cells;for(var f in g){f=g[f];if(f._editor){f._editor.setHeight(c+1)}}}})},_editCell:function(l,I,al){var P=typeof I=="string"?(l.cellMap[I]||l.cellMap[l.cellMap2[I]]):I;if(!P){return}I=P._serialId;var n=l.box,M=function(h){return n.getCellOption(l,P,h)};if(M("disabled")||M("readonly")||!M("editable")){return}var c,ab=this,G=l.properties,q=P._col,g=q.id,D=P._row,W=D.id,aa=W==l.box._temprowid,T=M("editMode"),C=T=="inline",k=l.getSubNode("SCROLL"+D._region+q._region),S=l.getSubNode("CELL",I),y=G.treeMode=="infirstcell"&&l.getSubNode("ROWTOGGLE",I);if(y&&(y.isEmpty()||!y.get(0).clientWidth)){y=null}if(!C){c=l.$curEditor;if(c){_.tryF(c.undo,[],c)}c=null}if((c=M("customEditor"))&&typeof c.iniEditor=="function"){c.iniEditor(l,P,S);_.tryF(c.activate,[],c);if(l.onBeginEdit){l.boxing().onBeginEdit(l,P,c,"cell")}}else{if(l.beforeIniEditor){c=l.boxing().beforeIniEditor(l,P,S,k,"cell");if(c===false){return}}if(!c||!c["xui.UI"]){var am=M("type")||"input",N=M("editorAutoPop"),z=M("editorCacheKey"),d=M("editorProperties"),H=M("editorCC"),w=M("editorCS"),x=M("editorEvents"),F=M("editorFormat"),ai=M("editorMask"),B=M("editorReadonly"),V=M("editorDropListWidth"),ad=M("editorDropListHeight"),ac,af;if(am=="checkbox"){if(!C){S.focus()}return}else{if(am=="button"||am=="label"){return}}if(!C){if(z&&l.$cache_editor[z]){c=l.$cache_editor[z]}if(c&&(!c.get(0)||c.isDestroyed())){c=nulll}}if(!c){var U={dirtyMark:false,cachePopWnd:false,left:-1000,top:-1000,position:"absolute",visibility:"hidden",zIndex:100};if(C){_.merge(U,{left:0,top:0,cachePopWnd:true,width:P._col._pxWidth+2,height:P._row._height+1,visibility:"visible"},"all")}c=new xui.UI.ComboInput(U)}switch(am){case"number":case"spin":case"currency":var aj=M("precision"),Y=M("increment"),ak=M("min"),K=M("max"),X=M("maxlength"),u=M("currencyTpl"),Q=M("numberTpl"),ae=M("groupingSeparator"),O=M("decimalSeparator"),J=M("forceFillZero");c.setType(am);if(am=="currency"){if(!_.isSet(aj)){aj=2}if(_.isSet(u)){c.setCurrencyTpl(u)}}else{if(!_.isSet(aj)){aj=0}if(_.isSet(Q)){c.setNumberTpl(Q)}if(am=="spin"&&_.isSet(Y)){c.setIncrement(Y)}if(_.isSet(ak)){c.setMin(ak)}if(_.isSet(K)){c.setMax(K)}if(_.isSet(X)){c.setMaxlength(X)}}if(_.isSet(aj)){c.setPrecision(aj)}if(_.isSet(ae)){c.setFroupingSeparator(ae)}if(_.isSet(O)){c.setDecimalSeparator(O)}if(_.isSet(J)){c.setForceFillZero(J)}break;case"progress":c.setType("spin").setMax(1).setMin(0).setPrecision(4).setIncrement(0.01);break;case"input":c.setType("none");break;case"textarea":c.setType("none").setMultiLines(true).setCommandBtn("save").onCommand(function(h){h.boxing().hide()});if(!C){_.tryF(c.setResizer,[true],c)}break;case"date":case"datepicker":case"datetime":var E=M("dateEditorTpl");if(E){c.setDateEditorTpl(E)}case"listbox":case"combobox":case"helpinput":case"time":case"timepicker":case"color":case"colorpicker":case"getter":case"popbox":case"cmd":case"cmdbox":case"droplist":c.setType(am);if(l.box.getCellOption(l,P,"disabled")){}else{c.beforeComboPop(function(aq,ar,ao,ap){var h=aq.$cell,an=l.box.getCellOption(l,h,"event");if(typeof an=="function"){return an.call(l._host||l,l,h,aq,ar,ao,ap)}else{return l.boxing().beforeComboPop(l,h,aq,ar,ao,ap)}});if(l.beforePopShow){c.beforePopShow(function(an,h){return l.boxing().beforePopShow(l,an.$cell,an,h)})}if(l.afterPopShow){c.afterPopShow(function(an,h){return l.boxing().afterPopShow(l,an.$cell,an,popCt)})}if(am=="getter"||am=="popbox"||am=="cmdbox"||am=="cmd"){if(l.onEditorClick){c.onClick(function(an,h){return l.boxing().onEditorClick(l,an.$cell,an,h)})}}}break;case"file":c.setType(am);break}if(l.onCommand){c.onCommand(function(an,h){return l.boxing().onCommand(l,an.$cell,an,h)})}if(C){S.append(c);P._editor=c}else{k.append(c)}if(!C&&z){l.$cache_editor[z]=c}if(c.setInputReadonly&&B){c.setInputReadonly(true)}if(c.setDropListWidth&&V){c.setDropListWidth(V)}if(c.setDropListHeight&&ad){c.setDropListHeight(ad)}if(F){if(typeof F=="function"&&c.beforeFormatCheck){c.beforeFormatCheck(F)}else{if(typeof F=="string"&&c.setValueFormat){c.setValueFormat(F)}}}if(ai&&c.setMask){c.setMask(ai)}if(d){af={};var ah=l.getProperties();_.each(d,function(an,h){af=ah[h]});c.setProperties(d)}if(H){c.setCustomClass(_.clone(H,2))}if(w){c.setCustomStyle(_.clone(w,2))}if(x){c.setEvents(x)}if(!C){c.resetValue()}switch(am){case"listbox":case"combobox":case"helpinput":if(ac=M("editorListItems")){c.setListKey(null);c.setItems(typeof(ac)=="function"?ac():ac)}else{if(ac=M("editorListKey")){c.setItems(null);c.setListKey(typeof(ac)=="function"?ac():ac)}}break}c.setValue(P.$editorValue||P.value,true,"editorini");delete P.$editorValue;if(c.setCaption){if(d&&("caption" in d)){c.setCaption(d.caption,true)}else{if(am=="cmdbox"||am=="cmd"||am=="popbox"){c.setCaption(P.caption||"",true)}}}if(P.$tag){if(c.setCaption){c.setCaption(P.$tag)}else{if(c.setValue){c.setValue(P.$tag,null,"editortag")}}}c.get(0).$cell=P;c.get(0)._smartnav=true;c.undo=C?null:function(an){var ap=this;ap.undo=null;if(l.box){l.box._trycheckrowdirty(l,l.$cellInEditor)}if(ap.get(0)&&ap.get(0).box){ap.getSubNode("INPUT").onBlur(true);if(an&&T=="sharp"){P._ignorefocus=1;l.boxing().focusCell(l.$cellInEditor);_.asyRun(function(){delete P._ignorefocus})}ap.getRoot().setBlurTrigger(l.$xid+":editor");if(l.properties&&!l.properties.directInput){ap.afterUIValueSet(null).beforeNextFocus(null).onCancel(null).afterPopHide(null);ap.setValue("",true,"editorreset")}if(F){if(ap.beforeFormatCheck){ap.beforeFormatCheck(null)}if(ap.setValueFormat){ap.setValueFormat("")}}if(ai){if(ap.setMask){ap.setMask("")}}if(B){if(ap.setInputReadonly){ap.setInputReadonly(false)}}if(V){if(ap.setDropListWidth){ap.setDropListWidth(0)}}if(ad){if(ap.setDropListHeight){ap.setDropListHeight(0)}}if(af){ap.setProperties(af);af=null}delete ap.get(0).$cell;delete ap.get(0)._smartnav;ap.setVisibility("hidden");if(_.isFun(ap.collapse)){ap.collapse()}}if(x){var ao={};_.each(x,function(aq,h){ao[h]=null});ap.setEvents(ao)}l.$curEditor=null;l.$cellInEditor=null;l._inHoverEdit=null;if(l.onEndEdit){l.boxing().onEndEdit(l,P,ap,"cell")}if(!z&&ap.get(0)){ap.destroy(true)}ap=null};c.afterUIValueSet(function(au,aq,ao,at,an){var ar=M("type"),h;switch(ar){case"number":case"spin":case"progress":ao=parseFloat(ao);ao=(ao||ao===0)?ao:null;break;case"currency":ao=parseFloat((""+ao).replace(/[^\d.-]/g,""));ao=(ao||ao===0)?ao:null;break;case"cmdbox":case"cmd":case"popbox":case"combobox":case"listbox":case"helpinput":h=au.boxing().getShowValue();break}var ap={value:ao};if(_.isDefined(h)){ap._$caption=h}if(au.properties.hasOwnProperty("tagVar")&&!_.isEmpty(au.properties.tagVar)){ap.tagVar=au.properties.tagVar}if(false!==(l.beforeEditApply&&l.boxing().beforeEditApply(l,P,ap,c,an,"cell"))){ab._updCell(l,I,ap,l.properties.dirtyMark,true);if(T=="sharp"){_.tryF(c.undo,[true],c)}}}).beforeNextFocus(function(ao,an){if(c.undo){_.tryF(c.undo,[true],c)}var h=xui.Event.getEventPara(an);if(h.key=="enter"){h.key="right"}l.getSubNode("CELLA",P._serialId).onKeydown(true,h);return false});if(!C){c.onCancel(function(){if(c){_.tryF(c.undo,[],c)}}).afterPopHide(function(ao,an,h){if(T=="sharp"){_.tryF(c.undo,[h!="blur"&&h!="call"],c)}}).getRoot().setBlurTrigger(l.$xid+":editor",function(){if(c){_.tryF(c.undo,[],c)}return false});var Z=S.offset(null,k),p=S.cssSize(),A=y?y.offset(null,S):null,R=y?y.width():null;if(A){A.left+=R}if(y&&(A.left>p.width-8)){return}if(am=="textarea"){c.setWidth(Math.max(200,p.width-(y?A.left:0)+3)).setHeight(Math.max(100,p.height+2)).reLayout(true,true).reBoxing().popToTop(S,4,k)}else{c.setWidth(p.width-(y?A.left:0)+3).setHeight(p.height+2).reLayout(true);c.reBoxing().show((Z.left+(y?A.left:0)-1)+"px",(Z.top-1)+"px")}var f,m=c.getInputReadonly&&c.getInputReadonly(),r=T=="sharp"&&(N||m||(am=="listbox"||am=="cmdbox"||am=="cmd"||am=="file"||am=="upload"));if(_.isFun(c.expand)&&N!==false&&(r||((T=="sharp"||T=="focus")&&(N||am=="listbox"||am=="date"||am=="datepicker"||am=="datetime"||am=="time"||am=="timepicker"||am=="color"||am=="colorpicker")))){f=1;c.expand()}if(!C){c.setVisibility(r?"hidden":"visible")}if(T!="hover"||!al){_.asyRun(function(){if(!l.box){return}var h=c;if(h.get(0)&&h.get(0).box){if(f&&c.getPopWnd){h=c.getPopWnd()}_.tryF(h&&h.activate,[],h);h.get(0)._stopmouseupcaret=1}})}else{var e=function(){if(c){c.getRoot().onMouseout(null,"tg-hover-edit")}l._inHoverEdit=1},L=function(){if(c){c.getRoot().onMouseout(function(){if(c){_.tryF(c.undo,[],c)}},"tg-hover-edit")}l._inHoverEdit=0},ag=function(){if(c){_.tryF(c.undo,[],c)}};c.onFocus(e).beforePopShow(function(){e();c.onBlur(null);if(l.beforePopShow){return l.boxing().beforePopShow(l,pro.$cell,pro,popCtl)}}).afterPopHide(function(){L();c.onBlur(ag)}).onBlur(ag)}}if(l.onBeginEdit){l.boxing().onBeginEdit(l,P,c,"cell")}}}if(!C){l.$curEditor=c;l.$cellInEditor=P}if(aa){l.__needchecktmprow=true;l.box._sethotrowoutterblur(l)}},_adjustBody:function(d,c,e){if(!d.renderId||d.destroyed){return}_.resetRun(d.$xid+"4",function(){if(!d.renderId||d.destroyed){return}var g=d.properties,E=d.getSubNode("BORDER").cssSize(),M=E.width,J=E.height,F=g.rowHandler?(g.rowHandlerWidth+2):0,A,r=d.getSubNode("HEADER1"),q=d.getSubNode("HEADER2"),Q=d.getSubNode("BODY12"),h=d.getSubNode("BODY21"),n=d.getSubNode("SCROLL11"),m=d.getSubNode("SCROLL12"),L=d.getSubNode("SCROLL21"),I=d.getSubNode("SCROLL22"),K=q.height(),x=Q.height();if(g.freezedColumn){_.arr.each(g.header,function(l,w){if(w==g.freezedColumn){return false}if(!l.hidden){F+=l.width+2}})}if(x){x-=1}if(F&&g.freezedColumn){F-=1}A=M-F;d._leftregionw=F;q.width(A);I.width(A);_.asyRun(function(){h.css("padding-bottom",(I.isScrollBarShowed("x")?xui.Dom.getScrollBarSize():0)+"px");L.scrollTop(I.scrollTop());if(g.freezedRow){Q.css("padding-right",(I.isScrollBarShowed("y")?xui.Dom.getScrollBarSize():0)+"px");m.scrollLeft(I.scrollLeft())}},100);n.height((x?x:0)+"px");m.height((x?x:0)+"px");L.height((J-K-x)+"px");I.height((J-K-x)+"px");I.css("overflow","hidden");var u=d.box._adjustRelWith(d);var D=d.getSubNode("ROWS22"),O=d.getSubNode("HCELLS2"),C=d.properties.header,f=d.getSubNode("SCROLL22"),G,N,y,H=d.keys,R,P;if(D.get(0).clientHeight){if(O.get(0).clientHeight){if(G=O.get(0).childNodes){N=G.length;while(N){if(G[N-1].clientHeight){y=G[N-1];break}--N}}R=y?(y.offsetWidth+y.offsetLeft+100):0;O.parent().width(R);D.width(P=R)}else{if(G=D.get(0).childNodes){N=G.length;while(N){if(G[N-1].clientHeight){y=G[N-1];break}--N}if(y){var k=d.getSubId(y.id);G=d.getSubNode("CELLS2",k);if(G=G.get(0).childNodes){N=G.length;while(N){if(G[N-1].clientHeight){y=G[N-1];break}--N}}}}}}if(y){D.width(P=y.offsetLeft)}else{var g=d.properties,p=g.header,z=g.rows,B=0;_.each(p,function(l){if(l.hidden!==true){B+=("_pxWidth" in l)?l._pxWidth:(l.width+2)}});D.width(P=B)}G=y=null;f.css("overflow","auto");if(P>f.width()+2){u="auto"}f.css("overflowX",u);f.onScroll();if(d.onBodyLayout){d.boxing().onBodyLayout(d,c)}if(e){e()}})},_adjustHeader:function(d){var e=_.copy(d),c;_.arr.each(e,function(g,f){e[f]=_.copy(g)});return e},_adjustGrpColsData:function(f,l){if(!_.isArr(l)){return _.copy(l)}var c=f.properties,k=c.header,q=k.length,p=(q+"").length,d=xui.UI.$tag_subId,r=_.copy(l,function(m){m.from=parseInt(m.from,10)||0;m.to=parseInt(m.to,10)||0;return m.from<=q&&m.to<=q&&m.to>=m.from});_.arr.each(r,function(w,m){r[m]=_.isHash?_.copy(w):{}});_.arr.stableSort(r,function(m,w){return m.from>w.from?1:m.from==w.from?(m.to>w.to?-1:m.to==w.to?0:1):-1});for(var g=0,e=r.length,u;g<e;g++){u=r[g];u[d]=u[d]||("-g_"+f.pickSubId("grpCol"));u.id=u.id||u[d];if(!u.caption){u.caption=u.id}u._isgroup=1;delete u._grp;f.colMap[u[d]]=u;f.colMap2[u.id]=u[d]}_.arr.each(r,function(x,w){for(var m=0;m<w;m++){if(r[w].to>r[m].from&&r[w].from<r[m].to){if(r[w].to>r[m].to){r[w].to=r[m].to}(r[w]._grp||(r[w]._grp=[])).push(r[m].id)}}});_.arr.each(k,function(m){delete m._grp});var n=0;for(var g=0,e=r.length,u;g<e;g++){u=r[g];for(var h=u.from;h<=u.to;h++){o=k[h];(o._grp||(o._grp=[])).push(u.id);if(!u._layer){u._layer=o._grp.length}n=Math.max(n,u._layer)}}f._headerLayers=n;return r},_adjustRows:function(g,d){var e,c,f={};_.arr.each(g.properties.header,function(k,h){f[k.id||k]=h});if(_.isArr(d)&&d.length&&typeof d[0]!="object"){e=[d]}else{e=_.copy(d)}_.arr.each(e,function(l,k){if(_.isArr(l)){e[k]={cells:l}}else{e[k]=_.copy(l)}if(!l.group&&(!e[k].cells||!_.isArr(e[k].cells))){var h=[];_.each(e[k],function(m,n){if(n in f){h[f[n]]=_.isHash(m)?m:{value:m}}});e[k]={cells:h}}c=e[k].cells=_.copy(e[k].cells);_.arr.each(c,function(n,m){if(!!n&&_.isHash(n)){c[m]=_.copy(n)}else{c[m]={value:n}}})});return e},_adjustColsWidth:function(g){var c=g.properties,q=c.header,r=c.grpCols;if(c.showHeader&&r&&_.isArr(r)&&r.length){var z,h,w,u=false,y=0;for(var p=0,f=r.length,x,e;p<f;p++){h=w=0;u=false;x=r[p];z=0;for(var l=0,d;l<=x.to;l++){d=q[l];if(c.freezedColumn&&c.freezedColumn==l&&!y){y=z}if(l===x.from){u=true;h=z}z+=d._pxWidth+2;if(u&&!d.hidden){w+=d._pxWidth+2}}e=g.getSubNode("HCELL",x._serialId);if(w>2){e.css({display:"",left:(h-(c.freezedColumn?(x.to>c.freezedColumn-1?y:(c.rowHandler?-(c.rowHandlerWidth+2):0)):0))+"px",width:(w-2)+"px"})}else{e.css({display:"none"})}}}},_adjustColsHeight:function(k,e){var c=k.colMap,q=k.colMap2,y=k._headerLayers,p=k.properties.headerHeight,u=k.box.$DataModel.headerHeight.ini*(y+1),r,n,d,g,m,w,x,f;if(e||p<u){p=u}k.getSubNodes(["HCELLS1","HCELLS2","GRPCELLBOX1","GRPCELLBOX2"]).height(p);k.getSubNode("FHCELL").css({height:p-2+"px"});if(!y){k.getSubNode("HCELL",true).css({height:p-2+"px"})}else{d=parseInt(p/(y+1),10);k.getSubNode("HCELL",true).each(function(l){g=k.getSubId(l.id);if(g=c[g]){if(g&&g._isgroup){x=0;for(var h in c){r=c[h];if(r._isgroup&&r._layer<g._layer&&r.from<=g.to&&r.to>=g.from){x+=r.height||d}}xui(l).top(x);w=g.height||d}else{if(g._grp&&(n=g._grp.length)){f=0;for(var h=0;h<n;h++){if(r=q[g._grp[h]]){f+=c[r].height||d}}w=p-f}else{w=p}}xui(l).css({height:w-2+"px"})}})}},_focuscell:function(g,m,c){if(g.properties.disabled||g.properties.readonly){return}if(!xui.use(c).get(0)){return}if(!g.$_ensureOnce){g.$_ensureOnce=1;_.asyRun(function(){g.$_ensureOnce=0})}else{return}var f=g.properties,k=g.box,h=k.getCellOption,q=g.cellMap[g.getSubId(c)],l=f.activeMode,d;if(q&&q._ignorefocus){return}if(q){var n=false;if(h(g,q,"editable")){if(h(g,q,"disabled")||h(g,q,"readonly")){n=false}else{n=true;if(h(g,q,"editMode")=="inline"){if(q._editor){q._editor.activate()}}else{k._editCell(g,q._serialId);xui(c).parent().tagClass("-mousedown",false);_.asyRun(function(){if(!g.box){return}xui.use(c).parent().onMouseout(true,{$force:true}).parent().onMouseout(true,{$force:true})})}}}if(!n){if(q&&l=="cell"){d=xui.use(c).parent().id();k._activeCell(g,d)}}else{if(q&&l=="cell"){k._activeCell(g,false)}}}else{var r=g.rowMap[g.getSubId(c)];if(h(g,r,"editable")){if(h(g,r,"disabled")||h(g,r,"readonly")){}else{g.boxing().editFirstCell(r)}}}if(l=="row"){d=xui.use(c).parent(2).id();k._activeRow(g,d)}},_getToggleNode:function(c,d){var e;if(c.properties.treeMode=="infirstcell"){e=c.getSubNode("ROWTOGGLE",_.get(c.rowMap,[d,"cells",0,"_serialId"]))}if(!e||e.isEmpty()){e=c.getSubNode("ROWTOGGLE",d)}return e},_showTips:function(g,f,k){if(g.properties.disableTips){return}if(g.onShowTips){return g.boxing().onShowTips(g,f,k)}if(!xui.Tips){return}var l=g.keys,n,m=l.HCELL+":",d,c,h,e;if(g.properties.disabled){return}c=f.id;h=_.get(f,["parentNode","id"])||"";e=_.get(f,["parentNode","parentNode","id"])||"";d=g.getSubId(c);if(c.indexOf(l.FHCELL)==0||h.indexOf(l.FHCELL)==0||e.indexOf(l.FHCELL)==0){n={tips:g.properties.tips}}else{if(c.indexOf(l.FCELL)==0||h.indexOf(l.FCELL)==0){n=g.rowMap[d]}else{if(c.indexOf(l.HCELL)==0||h.indexOf(l.HCELLA)==0){n=g.colMap[d]}else{if(c.indexOf(l.CELL)==0||h.indexOf(l.CELLA)==0){n=g.cellMap[d]}}}}if(n){xui.Tips.show(k,("tips" in n)?n.tips:(n._$tips||n.caption));return false}else{return true}},_adjustRelWith:function(d){var c=d.properties,r=d.colMap,p=d.getSubNode("SCROLL22"),m=d.getSubNode("BODY22"),y=p.width(),C=0,f=0;d.getSubNodes("HCELL",true).each(function(l){if(l.clientHeight){C=l.offsetWidth-parseInt(l.style.width);return false}});var g=0,x=0,u=[],n=[],k;_.each(d.colMap,function(l){if(l.hidden||l._isgroup){return}if(l._region==1){return}if(!l.flexSize){g+=l.width}else{x+=parseFloat(l.width);u.push(l);n.push(l)}f++});var h=d.getSubNode("LHCELL").get(0).clientWidth||0;d.getSubNodes("LCELL",true).each(function(l){if(l.children.length){h=Math.max(h,l.clientWidth)}});d.__lcellW=h;if(!u.length){k="auto";d.box._adjustColsWidth(d);return}else{k="hidden";if(p.isScrollBarShowed("y")){y-=xui.Dom.getScrollBarSize()}}y-=d.__lcellW;while(u.length&&y!=g+f*C){var D=y-(g+f*C),E=0,z=u.length,B=0;for(var A=z-1;A>=0;A--){var e=u[A],q=A===0?(D-E):Math.round(D*(e.width/x));if(q<0){q=0}e._pxWidth=q;if(e.hasOwnProperty("minWidth")){if(e.minWidth>q){g+=e.minWidth;e._pxWidth=e.minWidth;_.arr.removeFrom(u,A);B++}}if(e.hasOwnProperty("maxWidth")){if(e.maxWidth<q){g+=e.maxWidth;e._pxWidth=e.maxWidth;_.arr.removeFrom(u,A);B++}}E+=e._pxWidth}if(B===0||B===z){break}}d.box._adjustColsWidth(d);if(n.length){_.arr.each(n,function(w){var F,l=[];_.each(w._cells,function(G){F=d.getSubNode("CELL",G);if(F._nodes.length){l.push(F.get(0))}});F=d.getSubNode("HCELL",w._serialId);if(F._nodes.length){l.push(F.get(0))}d.box._adjusteditorW(d,xui(l).width(w._pxWidth),w._pxWidth)})}return k},_getRow:function(f,g,e){if(g){if(e=="data"){return _.clone(g,true)}else{if(e=="min"){var c=[];_.each(g.cells||g,function(h,l){c[l]=("value" in h)?h.value:h});return c}else{if(e=="map"){var k=f.properties.header,d={};_.each(g.cells||g,function(h,l){d[k[l].id]=("caption" in h)?{caption:h.caption,value:("value" in h)?h.value:h}:("value" in h)?h.value:h});return d}else{return g}}}}},_onresize:function(f,e,x){f.getSubNode("BORDER").cssSize({width:e||null,height:x||null});var d=f.properties,m=d.rowHandler?(d.rowHandlerWidth+2):0,k,p=f.getSubNode("HEADER1"),n=f.getSubNode("HEADER2"),c=f.getSubNode("BODY12"),r=f.getSubNode("BODY21"),w=f.getSubNode("SCROLL11"),q=f.getSubNode("SCROLL12"),l=f.getSubNode("SCROLL21"),h=f.getSubNode("SCROLL22"),u=n.height(),g=c.height();if(e){if(d.freezedColumn){_.arr.each(d.header,function(y,z){if(z==d.freezedColumn){return false}if(!y.hidden){m+=y.width+2}})}if(g){g-=1}if(m&&d.freezedColumn){m-=1}k=e-m;f._leftregionw=m;n.width(k);h.width(k)}if(x){w.height((g?g:0)+"px");q.height((g?g:0)+"px");l.height((x-u-g)+"px");h.height((x-u-g)+"px")}this._adjustBody(f,"resize")}}});Class("xui.UI.Dialog","xui.UI.Widget",{Instance:{showModal:function(d,f,e,g,c){this.show(d,true,f,e,g,c)},show:function(d,e,g,f,h,c){d=d||xui("body");return this.each(function(n){if(n.inShowing){return}var m,q=n.properties,l=n.boxing();switch(q.initPos){case"auto":if(_.isHash(g)){f=g.top;g=g.left}else{f=(f||f===0)?f:q.top;g=(g||g===0)?g:q.left}break;case"center":if(_.isHash(g)){f=g.top+(g.height-q.height)/2;g=g.left+(g.width-q.width)/2}else{var r=d.get(0)==xui("body").get(0)?xui.win:(d["xui.UI"]?d.getRoot():d);f=(f||f===0)?f:Math.max(0,(r.height()-q.height)/2+r.scrollTop());g=(g||g===0)?g:Math.max(0,(r.width()-q.width)/2+r.scrollLeft())}break}if(g<0){g=0}if(f<0){f=0}q.left=g;q.top=f;if(q.status=="max"){g=f=0}var k=function(){if(g||g===0){l.setLeft(g)}if(f||f===0){l.setTop(f)}d.append(l);var x=n.box,u=n.getRoot();if(q.iframeAutoLoad||q.ajaxAutoLoad){xui.UI.Div._applyAutoLoad(n)}if((e||q.modal)&&!n.$inModal){x._modal(n)}l.activate();var w=n._$rs_args,p=function(){if(n.onShow){n.boxing().onShow(n)}delete n.inShowing;_.tryF(h)};if(q.status=="min"){x._min(n,"normal",p,c)}else{if(q.status=="max"){x._max(n,"normal",p,c)}else{xui.UI.$doResize(n,(w&&w[1])||q.width,(w&&w[2])||q.height);u.show(g?(parseInt(g,10)||0)+"px":null,f?(parseInt(f,10)||0)+"px":null,p,null,c);x._refreshRegion(n)}}};n.inShowing=1;if(m=q.fromRegion){xui.Dom.animate({border:"solid 1px #555",background:"#888",opacity:0.1},{left:[m.left,g],top:[m.top,f],width:[m.width,q.width],height:[m.height,q.height]},null,k,300,0,"expoIn").start()}else{k()}})},hide:function(c){this.each(function(f){var h=f.properties,g=f.box,e=f.getRoot();var d=function(){if(f.inHiding){return}f.inHiding=1;if(f.$inModal){g._unModal(f)}if(h.status=="max"||h.status=="min"){var m=h.status;g._restore(f);h.status=m}var l=h.fromRegion,k=function(){delete f.inHiding};if(l){xui.Dom.animate({border:"solid 1px #555",background:"#888",opacity:0.1},{left:[h.left,l.left],top:[h.top,l.top],width:[h.width,l.width],height:[h.height,l.height]},null,k,300,0,"expoOut").start()}else{k()}};e.hide(d,null,c)});return this},close:function(d,c){return this.each(function(g){if(false!==d&&g.beforeClose&&false===g.boxing().beforeClose(g)){return}if(g.inClosing){return}g.inClosing=1;var h=g.properties,f=h.fromRegion,e=function(){g.boxing().destroy(c);delete g.inClosing};if(f){xui.Dom.animate({border:"solid 1px #555",background:"#888",opacity:0.1},{left:[h.left,f.left],top:[h.top,f.top],width:[h.width,f.width],height:[h.height,f.height]},null,e,300,0,"expoOut").start()}else{e()}})},activate:function(c){var d=this,e=this.get(0),f;e.box._active(e,c);this.getChildren(null,true).each(function(h){if(_.get(h,["properties","defaultFocus"])){try{_.asyRun(function(){h.boxing().activate()})}catch(g){}f=1;return false}});_.asyRun(function(){if(c!==false&&!f){try{e.getSubNode("CAPTION").focus()}catch(g){}}if(d.onActivated){d.onActivated(e)}})},isPinned:function(){return !!_.get(this.get(0),["properties","pinned"])}},Initialize:function(){var d=this,c=d.getTemplate();_.merge(c.FRAME.BORDER,{tabindex:"{tabindex}",TABSTOP1:{$order:-1},TBAR:{tagName:"div",className:"xui-uibar-top",TBART:{cellpadding:"0",cellspacing:"0",width:"100%",border:"0",tagName:"table",className:"xui-uibar-t",TBARTR:{tagName:"tr",TBARTDL:{tagName:"td",className:"xui-uibar-tdl"},TBARTDM:{$order:1,width:"100%",tagName:"td",className:"xui-uibar-tdm"},TBARTDR:{$order:2,tagName:"td",className:"xui-uibar-tdr"}}},BARCMDL:{$order:1,tagName:"div",className:"xui-uibar-cmdl",ICON:{$order:0,className:"xui-ui-icon {imageClass}",style:"{backgroundImage} {backgroundPosition} {backgroundRepeat} {imageDisplay}"},CAPTION:{$order:1,tabindex:"{tabindex}",text:"{caption}"}},BARCMDR:{$order:2,tagName:"div",className:"xui-uibar-cmdr",INFO:{className:"xui-uicmd-info",style:"{infoDisplay}",$order:1},OPT:{className:"xui-uicmd-opt",style:"{optDisplay}",$order:1},PIN:{$order:2,className:"xui-uicmd-pin",style:"{pinDisplay}"},LAND:{$order:3,className:"xui-uicmd-land",style:"{landDisplay}"},REFRESH:{className:"xui-uicmd-refresh",style:"{refreshDisplay}",$order:4},MIN:{$order:5,className:"xui-uicmd-min",style:"{minDisplay}"},RESTORE:{$order:6,className:"xui-uicmd-restore",style:"display:none;"},MAX:{$order:7,className:"xui-uicmd-max",style:"{maxDisplay}"},CLOSE:{$order:8,className:"xui-uicmd-close ",style:"{closeDisplay}"}}},MAIN:{$order:2,tagName:"div",className:"xui-uicon-main",MAINI:{tagName:"div",className:"xui-uibg-bar xui-uicon-maini",PANEL:{tagName:"div",style:"{_panelstyle};{_overflow};",text:"{html}"+xui.UI.$childTag}}},BBAR:{$order:3,tagName:"div",className:"xui-uibar-bottom",BBART:{cellpadding:"0",cellspacing:"0",width:"100%",border:"0",tagName:"table",className:"xui-uibar-t",BBARTR:{tagName:"tr",BBARTDL:{tagName:"td",className:"xui-uibar-tdl"},BBARTDM:{$order:1,width:"100%",tagName:"td",className:"xui-uibar-tdm"},BBARTDR:{$order:2,tagName:"td",className:"xui-uibar-tdr"}}}},TABSTOP2:{$order:9}},"all");d.setTemplate(c);xui.alert=d.alert;xui.confirm=d.confirm;xui.pop=d.pop;xui.prompt=d.prompt},Static:{_shadowRB:"BBARTDR",Appearances:{KEY:{overflow:"visible"},"TABSTOP1,TABSTOP2":{height:0,"font-size":0,"line-height":0,width:"16px",display:"inline",position:"absolute"},PANEL:{position:"relative",overflow:"auto","font-size":"12px","line-height":"auto"},CAPTION:{"font-size":"12px",display:"inline","vertical-align":xui.browser.ie6?"baseline":"middle"},BORDER:{position:"relative","font-size":0,"line-height":0,outline:0}},Behaviors:{DroppableKeys:["PANEL"],PanelKeys:["PANEL"],DraggableKeys:["LAND"],HoverEffected:{INFO:"INFO",OPT:"OPT",PIN:"PIN",MIN:"MIN",MAX:"MAX",RESTORE:"RESTORE",CLOSE:"CLOSE",REFRESH:"REFRESH",LAND:"LAND"},ClickEffected:{INFO:"INFO",OPT:"OPT",PIN:"PIN",MIN:"MIN",MAX:"MAX",RESTORE:"RESTORE",CLOSE:"CLOSE",REFRESH:"REFRESH",LAND:"LAND"},onMousedown:function(c,d){if(!c.$inModal){c.box._active(c)}},afterKeydown:function(h,l){var k=xui.Event.getKey(l);if((l.$key||l.keyCode||l.charCode)==9){if(xui.browser.ie){var n="xui::_specialforietab";if(!xui.Dom.byId(n)){xui("body").append("<div style='display:none;position:absolute;' id="+n+"></div>")}xui.Dom.byId(n).innerHTML=_()+""}var g=h.getSubNode("TABSTOP1").get(0),f=h.getSubNode("TABSTOP2").get(0),c=xui.Event.getSrc(l),d;if(k.shiftKey){if(c!==g){g.tabIndex=c.tabIndex}f.removeAttribute("tabIndex")}else{if(c!==f){f.tabIndex=c.tabIndex}g.removeAttribute("tabIndex")}g=f=c=null}},onDragstop:function(e){var g=e.getRoot().cssPos(),f=e.properties,c=null,d=null;if(f.left!==g.left){f.left=c=g.left}if(f.top!==g.top){f.top=d=g.top}if(e.onMove&&(c!==null||d!==null)){e.boxing().onMove(e,c,d,null,null)}},TABSTOP1:{onFocus:function(h,q,c){var m=parseInt(xui.use(c).get(0).tabIndex||1+"",10)-1;var f=h.getRoot().get(0).getElementsByTagName("*"),r,g;for(var p=0,k=f.length,d;d=f[p];p++){if(d.nodeType==1){if(d.tabIndex&&d.tabIndex<=m){if(!r){r=(g=d).tabIndex}if(d.tabIndex>r){r=(g=d).tabIndex}if(r===m){break}}}}if(d){xui(d).focus();xui.use(c).get(0).tabIndex=d.tabIndex}else{d=h.getRoot().nextFocus(false,true,false);xui(d).focus();xui.use(c).get(0).tabIndex=d.get(0).tabIndex}f=d=null}},TABSTOP2:{onFocus:function(h,q,c){var m=parseInt(xui.use(c).get(0).tabIndex||1+"")+1;var f=h.getRoot().get(0).getElementsByTagName("*"),r,g;for(var p=0,k=f.length,d;d=f[p];p++){if(d.nodeType==1){if(d.tabIndex&&d.tabIndex>=m){if(!r){r=(g=d).tabIndex}if(d.tabIndex<r){r=(g=d).tabIndex}if(r===m){break}}}}if(d){xui(d).focus();xui.use(c).get(0).tabIndex=d.tabIndex}else{d=h.getRoot().nextFocus(true,true,false);xui(d).focus();xui.use(c).get(0).tabIndex=d.get(0).tabIndex}f=d=null}},TBAR:{beforeMousedown:function(c,d,f){if(xui.Event.getBtn(d)!="left"){return}if(c.getKey(xui.Event.getSrc(d).parentNode.id)==c.keys.BARCMDR){return}if(c.properties.status=="max"){return false}if(c.properties.movable&&!c._locked){c.box._active(c);c.getRoot().startDrag(d,{dragDefer:2,maxTopOffset:c.getRoot().top(),maxLeftOffset:c.getRoot().left(),targetOffsetParent:c.getRoot().parent()})}},onDblclick:function(c,d,f){if(c.getKey(xui.Event.getSrc(d).parentNode.id)==c.keys.BARCMDR){return}if(!c.properties.maxBtn){return}if(c.properties.status=="max"){c.box._restore(c)}else{c.box._max(c)}}},PIN:{onClick:function(g,h,k){var f=g.keys.PIN,d=g.properties,c=g.boxing();if(g.beforePin&&false===g.boxing().beforePin(g,d.pinned)){return}d.pinned=!d.pinned;g.getSubNode("PIN").tagClass("-checked",d.pinned);g._locked=d.pinned;if(d.resizer){if(!d.pinned){if(d.status!="min"){c._resizer()}}else{if(g.$resizer){c._unResizer()}}}}},MIN:{onClick:function(c,d,f){c.box._min(c)}},MAX:{onClick:function(c,d,f){c.box._max(c)}},RESTORE:{onClick:function(c,d,f){c.box._restore(c)}},INFO:{onClick:function(c,d,f){c.boxing().onShowInfo(c,d,f)}},OPT:{onClick:function(c,d,f){c.boxing().onShowOptions(c,d,f)}},REFRESH:{onClick:function(c,d,f){c.boxing().onRefresh(c)}},CLOSE:{onClick:function(c,d,f){c.boxing().close()}},LAND:{onClick:function(c,d,f){c.boxing().onLand(c,d,f)}},PANEL:{onClick:function(c,f,g){var d=c.properties;if(d.disabled){return false}if(c.onClickPanel){return c.boxing().onClickPanel(c,f,g)}}}},DataModel:{rotate:null,selectable:true,tips:null,border:null,disabled:null,dock:"none",showEffects:"Classic",hideEffects:"",initPos:{ini:"center",listbox:["auto","center"]},iframeAutoLoad:{ini:"",action:function(){xui.UI.Div._applyAutoLoad(this)}},ajaxAutoLoad:{ini:"",action:function(){xui.UI.Div._applyAutoLoad(this)}},html:{html:1,action:function(c){this.getSubNode("PANEL").html(xui.adjustRes(c,0,1))}},caption:{ini:undefined,action:function(c){c=(_.isSet(c)?c:"")+"";this.getSubNode("CAPTION").html(xui.adjustRes(c,true))}},image:{format:"image",action:function(c){this.getSubNode("ICON").css("display",c?"":"none").css("backgroundImage",c?("url("+xui.adjustRes(c||"")+")"):"")}},imagePos:{action:function(c){this.getSubNode("ICON").css("backgroundPosition",c)}},shadow:true,resizer:true,movable:true,minBtn:{ini:true,action:function(c){var d=this.getSubNode("MIN");if(c){d.setInlineBlock()}else{d.css("display","none")}}},maxBtn:{ini:true,action:function(c){var d=this.getSubNode("MAX");if(c){d.setInlineBlock()}else{d.css("display","none")}}},restoreBtn:{ini:true,action:function(c){var d=this.getSubNode("RESTORE");if(c){d.setInlineBlock()}else{d.css("display","none")}}},infoBtn:{ini:false,action:function(c){this.getSubNode("INFO").css("display",c?"":"none")}},optBtn:{ini:false,action:function(c){this.getSubNode("OPT").css("display",c?"":"none")}},closeBtn:{ini:true,action:function(c){var d=this.getSubNode("CLOSE");if(c){d.setInlineBlock()}else{d.css("display","none")}}},refreshBtn:{ini:false,action:function(c){this.getSubNode("REFRESH").css("display",c?"":"none")}},pinBtn:{ini:false,action:function(c){var d=this.getSubNode("PIN");if(c){d.setInlineBlock()}else{d.css("display","none")}}},landBtn:{ini:false,action:function(c){var d=this.getSubNode("LAND");if(c){d.setInlineBlock()}else{d.css("display","none")}}},width:300,height:300,minWidth:200,minHeight:100,position:"absolute",fromRegion:{hidden:true,ini:null},modal:{ini:false,action:function(c){if(this.box){if(c){this.box._modal(this)}else{this.box._unModal(this)}}}},status:{ini:"normal",listbox:["normal","min","max"],action:function(e,f){var d=this,c=d.box;if(e=="min"){c._min(d,f)}else{if(e=="max"){c._max(d,f)}else{c._restore(d,f)}}}}},EventHandlers:{onRefresh:function(c){},onShow:function(c){},beforeClose:function(c){},onShowInfo:function(c,d,f){},onShowOptions:function(c,d,f){},onLand:function(c,d,f){},onActivated:function(c){},beforePin:function(c,d){},beforeStatusChanged:function(e,c,d){},afterStatusChanged:function(e,c,d){},onClickPanel:function(c,d,f){}},RenderTrigger:function(){var c=this;c.destroyTrigger=function(){var d=this;if(d.$inModal){d.box._unModal(d)}}},LayoutTrigger:function(){var d=this,e=d.properties;if(e.modal){var f=d.$modalDiv&&d.$modalDiv.parent(),c=d.box;if(f&&f.get(0)&&f.get(0)!==d.getRootNode()){c._unModal(d)}c._modal(d)}},_prepareData:function(e){var f=arguments.callee.upper.call(this,e),d="display:none";f.minDisplay=f.minBtn?"":d;f.maxDisplay=f.maxBtn?"":d;f.infoDisplay=f.infoBtn?"":d;f.optDisplay=f.optBtn?"":d;f.closeDisplay=f.closeBtn?"":d;f.pinDisplay=f.pinBtn?"":d;f.landDisplay=f.landBtn?"":d;f.refreshDisplay=f.refreshBtn?"":d;f.statusDisplay=f.statusDisplay?"":d;f.statusHeight="height:"+f.statusHeight+"px";var c=e.properties.status;if(c=="min"||c=="max"){e.$noR=1}if(_.isStr(f.overflow)){f._overflow=f.overflow.indexOf(":")!=-1?(f.overflow):(f.overflow?("overflow:"+f.overflow):"")}return f},_min:function(e,g,u,f){var d=e.getRoot(),l=e.box,c=d.parent(),m=e.boxing(),w=e.properties,r=xui.Dom._getEffects(w.showEffects,1);if(!g){g=w.status}if(e.beforeStatusChanged&&false===e.boxing().beforeStatusChanged(e,"min",g)){return}if(g=="max"){l._unMax(e)}else{l._refreshRegion(e)}e.getSubNodes(["PANEL","STATUS"]).css("display","none");if(w.minBtn){if(w.restoreBtn){e.getSubNode("RESTORE").setInlineBlock()}e.getSubNode("MIN").css("display","none")}if(w.resizer&&e.$resizer){m._unResizer()}if(w.shadow){m._unShadow(false)}w.status="min";var q=d.height(),n=e.getSubNode("BORDER").height(),k=e.getSubNode("TBAR").height();d.cssSize({width:w.minWidth,height:k+q-n},true);if(e.afterStatusChanged){e.boxing().afterStatusChanged(e,"min",g)}if(r&&xui.browser.ie&&xui.browser.ver<=8){_.filter(r.params,function(p,h){return !!xui.Dom._cssfake[h]})}d.show(null,null,u,null,f)},_max:function(e,g,m,f){var d=e.getRoot(),h=e.box,k=e.boxing(),c=d.parent(),n=e.properties,l=xui.Dom._getEffects(n.showEffects,1);if(!g){g=n.status}if(e.beforeStatusChanged&&false===e.boxing().beforeStatusChanged(e,"max",g)){return}if(g=="min"){h._unMin(e)}else{h._refreshRegion(e)}if(n.pinBtn){e.getSubNode("PIN").css("display","none")}if(n.maxBtn){e.getSubNode("MAX").css("display","none");if(n.restoreBtn){e.getSubNode("RESTORE").setInlineBlock()}}if(n.resizer&&e.$resizer){k._unResizer()}if(n.shadow&&(parseInt(n.dockMargin.right,10)<xui.UI.Shadow.SIZE||parseInt(n.dockMargin.bottom)<xui.UI.Shadow.SIZE)){k._unShadow(false)}n.status="max";k.setDock("cover",true);if(e.afterStatusChanged){e.boxing().afterStatusChanged(e,"max",g)}if(l&&xui.browser.ie&&xui.browser.ver<=8){_.filter(l.params,function(q,p){return !!xui.Dom._cssfake[p]})}d.show(null,null,m,null,f)},_restore:function(e,c){var g=e.getRoot(),f=e.box,d=e.properties;if(!c){c=d.status}d.status="normal";if(e.beforeStatusChanged&&false===e.boxing().beforeStatusChanged(e,"normal",c)){return}if(c=="max"){f._unMax(e)}if(c=="min"){f._unMin(e)}e.getSubNode("BORDER").ieRemedy();e.getSubNode("RESTORE").css("display","none")},_unMax:function(e){var d=e.properties,c=e.boxing();e.getSubNode("MAX").setInlineBlock();if(d.pinBtn){e.getSubNode("PIN").setInlineBlock()}if(d.shadow){c._shadow()}if(d.resizer&&!d.pinned){c._resizer()}c.setDock("none");xui.UI.$tryResize(e,d.width,d.height,true);if(e.afterStatusChanged){e.boxing().afterStatusChanged(e,"normal",status)}},_unMin:function(e){var d=e.properties,c=e.boxing();e.getSubNodes(["PANEL","STATUS"]).css("display","block");e.getSubNode("MIN").setInlineBlock();if(d.shadow){c._shadow()}if(d.resizer&&!d.pinned){c._resizer()}e.getRoot().cssSize({width:d.width,height:d.height});xui.UI.$tryResize(e,d.width,d.height,true)},_active:function(f,c){var d=this;if(c!==false&&xui.$cache.unique.activeWndId==f.$xid){return}d._deActive();if(c!==false){var h=xui(f.domId),g=h.topZindex(),e=parseInt(h.css("zIndex"),0);h.css("zIndex",g>e?g:e);f.getSubNode("TBAR").tagClass("-focus");xui.$cache.unique.activeWndId=f.$xid}},_deActive:function(){var c;if(c=xui.UI._cache["$"+xui.$cache.unique.activeWndId]){c.getSubNode("TBAR").tagClass("-focus",false)}delete xui.$cache.unique.activeWndId},_modal:function(f){var e=f.getRoot(),c,h=e.parent(),g;if(!h.isEmpty()){if(!f.$inModal){g=f.$modalDiv;if(!g||!g.get(0)||!g.get(0).parentNode){g=f.$modalDiv=xui.create("<div class='xui-cover xui-custom xui-cover-modal' style='left:0;top:0;position:absolute;overflow:hidden;display:block;z-index:0;'></div>");g.setSelectable(false)}h.append(g);if(h.get(0)===document.body||h.get(0)===document||h.get(0)===window){h=xui.win}g.css({display:"block",width:Math.max(h.width(),h.scrollWidth())+"px",height:Math.max(h.height(),h.scrollHeight())+"px"}).onMousedown(function(){return false}).topZindex(true);h.onSize(function(k){k=xui(k);g.width(k.width()).height(k.height());_.asyRun(function(){g.width(Math.max(k.width(),k.scrollWidth()));g.height(Math.max(k.height(),k.scrollHeight()))})},"dialog:"+f.serialId);var d=(parseInt(g.css("zIndex"),10)||0)+1;e.css("zIndex",d);if(d>=xui.Dom.TOP_ZINDEX){xui.Dom.TOP_ZINDEX=d+1}f.$inModal=true;h.setBlurTrigger(f.$xid+"_anti",true,xui([g.get(0),f.getRootNode()]))}}},_unModal:function(c){if(c.$inModal){var e=c.$modalDiv.parent();if(e.get(0)===document.body||e.get(0)===document||e.get(0)===window){e=xui.win}e.onSize(null,"dialog:"+c.serialId);c.getRoot().css("zIndex",0);c.$modalDiv.css("display","none");var d=c.getSubNode("BORDER");if(!d.isEmpty()){d.append(c.$modalDiv)}c.$inModal=false;e.setBlurTrigger(c.$xid+"_anti")}},_refreshRegion:function(c){if(!c.renderId){return}var d=c.properties;return _.merge(d,c.getRoot().cssRegion(),function(f,e){return d[e]!="auto"})},_adjust:function(k,q,g,c,n){q=q||"";if(!_.isSet(g)){g=xui.adjustRes(q);q=""}var d=k.$div.reBoxing(),l="xui:temp:dialog",m=arguments.callee,p,e;if(!xui.Dom.byId(l)){f=m._cache=d.clone(false);xui("body").append(f);f.css({overflow:"visible",position:"absolute",visibility:"visible",left:xui.Dom.HIDE_VALUE,top:xui.Dom.HIDE_VALUE}).id(l,true)}var f=m._cache;f.width("auto").height("auto");f.html(g,false);var r=f.cssSize();r.width+=10;r.height+=10;d.html(g);if(r.width>500){r.width=500;f.width(500);r.height=f.offsetHeight()+10;f.width("auto")}f.html("",false);r.height+=10;if(r.height>400){r.height=400}if(r.width<150){r.width=150}if(r.height<30){r.height=30}d.cssSize(r).css("overflow","auto").show();p=r.width+20;e=r.height+60;k.setCaption(q).setWidth(p).setHeight(e);return{width:p,height:e}},alert:function(r,l,q,h,g,p,u,c,k){var n=arguments.callee,m;if(k||!(m=n.dialog)||!m.get(0)||(!m.get(0).renderId)){m=new xui.UI.Dialog({overflow:"hidden",minBtn:false,maxBtn:false,pinBtn:false,resizer:false},{beforeClose:function(){_.tryF(m._$onClose);m._$onClose=null;if(!k){m.hide();return false}},onHotKeydown:function(y,x){if(x.key=="esc"){m.close()}}});var f=m.$cmd=new xui.UI.Div({height:26,dock:"bottom",zIndex:10},null,null,null,{KEY:"text-align:center;"}),e=m.$btn=new xui.UI.SButton({position:"relative",tabindex:1},{onClick:function(){m.close()},onHotKeydown:function(y,x){if(x.key=="enter"){m.close()}}},null,null,{KEY:"margin:0 4px"});f.append(e);var d=m.$div=new xui.UI.Div({left:10,top:10});m.append(f).append(d).render();if(!k){n.dialog=m}}m._$onClose=q;m.$btn.setCaption("&nbsp;&nbsp;"+(h||xui.wrapRes("$inline.ok"))+"&nbsp;&nbsp;");var w=xui.UI.Dialog._adjust(m,r,l);if(u&&u["xui.UI"]){u=u.getContainer(c)}if(!_.isSet(u)){u=xui("body")}m.show(u,true,g,p);_.resetRun("dlg_focus:"+m.get(0).$xid,function(){m.$btn.activate()});return m},confirm:function(q,w,u,y,l,f,h,p,r,c,k){var n=arguments.callee,m;if(k||!(m=n.dialog)||!m.get(0)||(!m.get(0).renderId)){m=new xui.UI.Dialog({overflow:"hidden",minBtn:false,maxBtn:false,pinBtn:false,resizer:false},{beforeClose:function(){if(!m._$_clicked){_.tryF(m._$onNo,["close"])}else{delete m._$_clicked}m._$onYes=m._$onNo=null;if(!k){m.hide();return false}},onHotKeydown:function(A,z){if(z.key=="esc"){m.close()}}});var g=m.$cmd=new xui.UI.Div({height:26,dock:"bottom",zIndex:10},null,null,null,{KEY:"text-align:center;"}),e=m.$btn1=new xui.UI.SButton({tabindex:1,position:"relative"},{onClick:function(){_.tryF(m._$onYes,["yes"]);m._$_clicked=1;m.close()}},null,null,{KEY:"margin:0 4px"});g.append(e);e=m.$btn2=new xui.UI.SButton({tabindex:1,position:"relative"},{onClick:function(){_.tryF(m._$onNo,["no"]);m._$_clicked=1;m.close()}},null,null,{KEY:"margin:0 4px"});g.append(e);var d=m.$div=new xui.UI.Div({left:10,top:10});m.append(g).append(d).render();if(!k){n.dialog=m}}m._$onYes=u;m._$onNo=y;delete m._$_clicked;m.$btn1.setCaption("&nbsp;&nbsp;"+(l||xui.wrapRes("$inline.yes"))+"&nbsp;&nbsp;");m.$btn2.setCaption("&nbsp;&nbsp;"+(f||xui.wrapRes("$inline.no"))+"&nbsp;&nbsp;");var x=xui.UI.Dialog._adjust(m,q,w);if(r&&r["xui.UI"]){r=r.getContainer(c)}if(!_.isSet(r)){r=xui("body")}m.show(r,true,h,p);_.resetRun("dlg_focus:"+m.get(0).$xid,function(){m.$btn2.activate()});return m},pop:function(m,h,g,f,l,n,c){var k=new xui.UI.Dialog({overflow:"hidden",minBtn:false,maxBtn:false,pinBtn:false,resizer:false},{onHotKeydown:function(r,q){if(q.key=="esc"){k.close()}}}),e=k.$cmd=new xui.UI.Div({height:26,dock:"bottom",zIndex:10},null,null,null,{KEY:"text-align:center;"}).append(k.$btn=new xui.UI.SButton({caption:"&nbsp;&nbsp;"+(g||"$inline.ok")+"&nbsp;&nbsp;",tabindex:1,position:"relative"},{onClick:function(){k.destroy()},onHotKeydown:function(r,q){if(q.key=="enter"){k.close()}}},null,null,{KEY:"margin:0 4px"})),d=k.$div=new xui.UI.Div({left:10,top:10,width:80}).setCustomStyle({KEY:"overflow:visible"});k.append(e).append(d).render();var p=xui.UI.Dialog._adjust(k,m,h);if(n&&n["xui.UI"]){n=n.getContainer(c)}if(!_.isSet(n)){n=xui("body")}k.show(n,false,f,l);_.resetRun("dlg_focus:"+k.get(0).$xid,function(){k.$btn.activate()});return k},prompt:function(r,x,l,w,y,k,e,g,q,u,c,h){var m,p=arguments.callee;if(h||!(m=p.dialog)||!m.get(0)||(!m.get(0).renderId)){m=new xui.UI.Dialog({overflow:"hidden",minBtn:false,maxBtn:false,pinBtn:false,resizer:false,left:200,top:200,width:300,height:130},{beforeClose:function(){if(!m._$_clickYes){_.tryF(m._$onNo,["no"])}else{delete m._$_clickYes}m._$inp.setValue("",false,"prompt");m._$onYes=m._$onNo=null;if(!h){m.hide();return false}}});var d=m._$con=new xui.UI.Div({top:4,left:10,width:270,height:18}),f=new xui.UI.Div({height:26,dock:"bottom",zIndex:10},null,null,null,{KEY:"text-align:center;"}).append(m.$btn1=new xui.UI.SButton({position:"relative",tabindex:1},{onClick:function(){if(false!==_.tryF(m._$onYes,[m._$inp.getUIValue()])){m._$_clickYes=1;m.close()}}},null,null,{KEY:"margin:0 4px"}));f.append(m.$btn2=new xui.UI.SButton({tabindex:1,position:"relative"},{onClick:function(){m.close()}},null,null,{KEY:"margin:0 4px"}));var n=m._$inp=new xui.UI.Input({left:10,top:22,width:270,height:36,multiLines:true});m.append(d).append(f).append(n).render();if(!h){p.dialog=m}}m.setCaption(r||"Prompt");m._$con.setHtml(x||"");m._$inp.setValue(l||"",true,"prompt");m._$onYes=w;m._$onNo=y;delete m._$_clickYes;m.$btn1.setCaption("&nbsp;&nbsp;"+(k||xui.wrapRes("$inline.ok"))+"&nbsp;&nbsp;");m.$btn2.setCaption("&nbsp;&nbsp;"+(e||xui.wrapRes("$inline.cancel"))+"&nbsp;&nbsp;");if(u&&u["xui.UI"]){u=u.getContainer(c)}if(!_.isSet(u)){u=xui("body")}m.show(u,true,g,q);_.resetRun("dlg_focus:"+m.get(0).$xid,function(){m._$inp.activate()});return m},_onresize:function(e,d,q,c){if(d&&e.properties.status=="min"){d=e.properties.minWidth}var u=arguments.callee.upper.apply(this,arguments),p={},n=e.getSubNode("TBAR"),m=e.getSubNode("PANEL"),l=e.getSubNode("BBAR"),h=e.getSubNode("MAIN"),g=e.getSubNode("MAINI"),k,f,r;if(q){if(q=="auto"){p.height=q}else{k=n.height();f=l.height();if((r=u.height-k-f)>0){p.height=r}}}if(d){p.width=u.width-(parseInt(g.css("paddingRight"),10)||0)-(parseInt(h.css("paddingLeft"),10)||0)}m.cssSize(p,true)}}});